---
result: FAILURE
failure_category: code
failure_cause: chef_acceptance[top-cookbooks::provision]
failed_in:
  chef_acceptance:
  - top-cookbooks::provision
  step: CHEF-ACCEPTANCE
timestamp: 2016-07-18 23:52:10 UTC
url: http://manhattan.ci.chef.co/job/chefdk-test/architecture=x86_64,platform=acceptance,project=chefdk,role=tester/266/
trigger_url: http://manhattan.ci.chef.co/job/chefdk-trigger-release/134/
duration: 4m38s
logs:
  consoleText:
    1567: |
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:57 +0000]                              * execute[install-key 58118E89F3A912897C070ADBF76221572C52609D] action run

                                     ================================================================================
                                     Error executing action `run` on resource 'execute[install-key 58118E89F3A912897C070ADBF76221572C52609D]'
                                     ================================================================================

                                     Mixlib::ShellOut::ShellCommandFailed
                                     ------------------------------------
                                     Expected process to exit with [0], but received '2'
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:57 +0000]                                ---- Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                                     STDOUT: Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
    1585: |2
                                     Cookbook Trace:
                                     ---------------
                                     /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'
                                     /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:57 +0000]
                                     Resource Declaration:
    1627: |2


                                   ================================================================================
                                   Error executing action `add` on resource 'apt_repository[docker]'
                                   ================================================================================

                                   Mixlib::ShellOut::ShellCommandFailed
                                   ------------------------------------
                                   execute[install-key 58118E89F3A912897C070ADBF76221572C52609D] (/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb line 201) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '2'
                                   ---- Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:57 +0000]                              STDOUT: Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:57 +0000]                              gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't be retrieved
    1645: |2
                                   Cookbook Trace:
                                   ---------------
                                   /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'
                                   /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'

                                   Resource Declaration:
    1691: |2

                               Running handlers:
                               [2016-07-18T23:55:57+00:00] ERROR: Running exception handlers
                               Running handlers complete
                               [2016-07-18T23:55:57+00:00] ERROR: Exception handlers complete
                               Chef Client failed. 5 resources updated in 17 seconds
                               [2016-07-18T23:55:57+00:00] ERROR: Failed to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json
                               [2016-07-18T23:55:57+00:00] FATAL: Stacktrace dumped to /tmp/kitchen/cache/chef-stacktrace.out
                               [2016-07-18T23:55:57+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                               [2016-07-18T23:55:57+00:00] ERROR: Found 1 errors, they are stored in the backtrace
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000]                          [2016-07-18T23:55:58+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000]                   D      Cleaning up local sandbox in /tmp/cheftest/docker-default-ubuntu-1404-sandbox-20160718-27889-16j7fbk
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000]
    1770: |2
                        D      ----End Backtrace-----
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000]
              ================================================================================
              Error executing action `run` on resource 'execute[bundle exec kitchen converge  -c -l debug]'
              ================================================================================

              Mixlib::ShellOut::ShellCommandFailed
              ------------------------------------
              Expected process to exit with [0], but received '10'
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000]         ---- Begin output of bundle exec kitchen converge  -c -l debug ----
              STDOUT: -----> Starting Kitchen (v1.9.2)
    2709: |2
                         * execute[install-key 58118E89F3A912897C070ADBF76221572C52609D] action run

                           ================================================================================
                           Error executing action `run` on resource 'execute[install-key 58118E89F3A912897C070ADBF76221572C52609D]'
                           ================================================================================

                           Mixlib::ShellOut::ShellCommandFailed
                           ------------------------------------
                           Expected process to exit with [0], but received '2'
                           ---- Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                           STDOUT: Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
                           gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't be retrieved
                           STDERR: gpg: requesting key 2C52609D from hkp server p80.pool.sks-keyservers.net
                           gpg: no valid OpenPGP data found.
                           gpg: Total number processed: 0
                           ---- End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                           Ran apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D returned 2

                           Cookbook Trace:
                           ---------------
                           /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000] _compat/monkeypatches/chef/runner.rb:41:in `run_action'
                           /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'

                           Resource Declaration:
    2770: |2


                         ================================================================================
                         Error executing action `add` on resource 'apt_repository[docker]'
                         ================================================================================

                         Mixlib::ShellOut::ShellCommandFailed
                         ------------------------------------
                         execute[install-key 58118E89F3A912897C070ADBF76221572C52609D] (/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb line 201) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '2'
                         ---- Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                         STDOUT: Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
                         gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't be retrieved

      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000]            STDERR: gpg: requesting key 2C52609D from hkp server p80.pool.sks-keyservers.net
    2792: |2
                         Cookbook Trace:
                         ---------------
                         /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'
                         /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'

                         Resource Declaration:
    2838: |2

                     Running handlers:
                     [2016-07-18T23:55:57+00:00] ERROR: Running exception handlers
                     Running handlers complete
                     [2016-07-18T23:55:57+00:00] ERROR: Exception handlers complete
                     Chef Client failed. 5 resources updated in 17 seconds
                     [2016-07-18T23:55:57+00:00] ERROR: Failed to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json
                     [2016-07-18T23:55:57+00:00] FATAL: Stacktrace dumped to /tmp/kitchen/cache/chef-stacktrace.out
                     [2016-07-18T23:55:57+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                     [2016-07-18T23:55:57+00:00] ERROR: Found 1 errors, they are stored in the backtrace
                     [2016-07-18T23:55:58+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
              D      Cleaning up local sandbox in /tmp/cheftest/docker-default-ubuntu-1404-sandbox-20160718-27889-16j7fbk
              D      [SSH] shutting previous connection ubuntu@10.194.14.1<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"ubuntu"}>
    3919: |2
                       * execute[install-key 58118E89F3A912897C070ADBF76221572C52609D] action run

                         ================================================================================
                         Error executing action `run` on resource 'execute[install-key 58118E89F3A912897C070ADBF76221572C52609D]'
                         ================================================================================

                         Mixlib::ShellOut::ShellCommandFailed
                         ------------------------------------
                         Expected process to exit with [0], but received '2'
                         ---- Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                         STDOUT: Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
                         gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't be retrieved
                         STDERR: gpg: requesting key 2C52609D from hkp server p80.pool.sks-keyservers.net
                         gpg: no valid OpenPGP data found.
                         gpg: Total number processed: 0
                         ---- End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                         Ran apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D returned 2

      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000]                    Cookbook Trace:
                         ---------------
                         /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'
                         /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000]
                         Resource Declaration:
    3979: |2


                       ================================================================================
                       Error executing action `add` on resource 'apt_repository[docker]'
                       ================================================================================

                       Mixlib::ShellOut::ShellCommandFailed
                       ------------------------------------
                       execute[install-key 58118E89F3A912897C070ADBF76221572C52609D] (/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb line 201) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '2'
                       ---- Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                       STDOUT: Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
                       gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't be retrieved
                       STDERR: gpg: requesting key 2C52609D from hkp server p80.pool.sks-keyservers.net
                       gpg: no valid OpenPGP data found.
                       gpg: Total number processed: 0
                       ---- End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                       Ran apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D returned 2

                       Cookbook Trace:
                       ---------------
                       /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'
                       /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'

                       Resource
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000]  Declaration:
                       ---------------------
    4044: |2

                   Running handlers:
                   [2016-07-18T23:55:57+00:00] ERROR: Running exception handlers
                   Running handlers complete
                   [2016-07-18T23:55:57+00:00] ERROR: Exception handlers complete
                   Chef Client failed. 5 resources updated in 17 seconds
                   [2016-07-18T23:55:57+00:00] ERROR: Failed to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json
                   [2016-07-18T23:55:57+00:00] FATAL: Stacktrace dumped to /tmp/kitchen/cache/chef-stacktrace.out
                   [2016-07-18T23:55:57+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                   [2016-07-18T23:55:57+00:00] ERROR: Found 1 errors, they are stored in the backtrace
                   [2016-07-18T23:55:58+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
            D      Cleaning up local sandbox in /tmp/cheftest/docker-default-ubuntu-1404-sandbox-20160718-27889-16j7fbk
            D      [SSH] shutting previous connection ubuntu@10.194.14.1<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"ubuntu"}>
    4153: |2


          ================================================================================
          Error executing action `run` on resource 'top_cookbooks[converge]'
          ================================================================================

          Mixlib::ShellOut::ShellCommandFailed
          ------------------------------------
          cookbook_kitchen[converge docker] (/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/top_cookbooks.rb line 7) had an error: Mixlib::ShellOut::ShellCommandFailed: execute[bundle exec kitchen converge  -c -l debug] (/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb line 36) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '10'
          ---- Begin output of bundle exec kitchen converge  -c -l debug ----
          STDOUT: -----> Starting Kitchen (v1.9.2)
          D      Berksfile found at /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/docker/Berksfile, loading Berkshelf
          D      Berkshelf 4.3.5 library loaded
          -----> Creating <docker-default-ubuntu-1404>...
                 If you are not using an account that qualifies under the AWS
          free-tier, you may be charged to run these suites. The charge
          should be minimal, but neither Test Kitchen nor its maintainers
          are responsible for your incurred costs.

          D      platform name ubuntu-14.04 appears to be a standard platform. Searching for ubuntu 14.04 ...
          D      Searching for images matching {:name=>"ubuntu/images/*/ubuntu-*-14.04-*-server-*", :"owner-id"=>"099720109477", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
          D      Search returned 59 images:
          D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160714: Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-15T10:37:25.000Z
          D      - ubuntu/i
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000] mages/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160627: Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-29T15:13:53.000Z
          D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160620: Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-21T12:07:59.000Z
    5092: |2
                     * execute[install-key 58118E89F3A912897C070ADBF76221572C52609D] action run

                       ================================================================================
                       Error executing action `run` on resource 'execute[install-key 58118E89F3A912897C070ADBF76221572C52609D]'
                       ================================================================================

                       Mixlib::ShellOut::ShellCommandFailed
                       ------------------------------------
                       Expected process to exit with [0], but received '2'
                       ---- Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                       STDOUT: Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
                       gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't be retrieved
                       STDERR: gpg: requesting key 2C52609D from hkp server p80.pool.sks-keyservers.net
                       gpg: no valid OpenPGP data found.
                       gpg: Total number processed: 0
                       ---- End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                       Ran apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D returned 2

                       Cookbook Trace:
                       ---------------
                       /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'
                       /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'

                       Resource Declaration:
                       ---------------------
                       # In /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb

                       201:         declare_resource(:execute, "install-key #{key}") do
                       202:           command cmd
                       203:           sensitive new_resource.sensitive
                       204:           not_if do
                       205:             present = extract_fingerprints_from_cmd("apt-key finger").any? do |fp|
                       206:               fp.end_with? key.upcase
                       207:             end
                       208:             present && key_is_valid?("apt-key list", key.upcase)

      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000]          209:           end
    5153: |2


                     ================================================================================
                     Error executing action `add` on resource 'apt_repository[docker]'
                     ================================================================================

                     Mixlib::ShellOut::ShellCommandFailed
                     ------------------------------------
                     execute[install-key 58118E89F3A912897C070ADBF76221572C52609D] (/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb line 201) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '2'
                     ---- Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                     STDOUT: Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
                     gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't be retrieved
                     STDERR: gpg: requesting key 2C52609D from hkp server p80.pool.sks-keyservers.net
                     gpg: no valid OpenPGP data found.
                     gpg: Total number processed: 0
                     ---- End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                     Ran apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D returned 2

                     Cookbook Trace:
                     ---------------
                     /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'
                     /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'

                     Resource Declaration:
                     ---------------------
                     # In /tmp/kitchen/cache/cookbooks/chef-apt-docker/recipes/default.rb

                      20: apt_repository 'docker' do
                      21:   uri 'https://apt.dockerproject.org/repo'
                      22:   distribution "#{node['platform']}-#{node['lsb']['codename']}"
                      23:   keyserver 'p80.pool.sks-keyservers.net'
                      24:   components node['chef-apt-docker']['components']
                      25:   key '58118E89F3A912897C070ADBF76221572C52609D'
                      26: end

                     Compiled Resource:
                     ------------------
                     # Declared in /tmp/kitchen/cache/cookbooks/chef-apt-docker/recipes/default.rb:20:in `from_file'

                     apt_repository("docker") do
                       action [:add]
                       retries 0

      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:58 +0000]              retry_delay 2
    5218: |2

                 Running handlers:
                 [2016-07-18T23:55:57+00:00] ERROR: Running exception handlers
                 Running handlers complete
                 [2016-07-18T23:55:57+00:00] ERROR: Exception handlers complete
                 Chef Client failed. 5 resources updated in 17 seconds
                 [2016-07-18T23:55:57+00:00] ERROR: Failed to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json
                 [2016-07-18T23:55:57+00:00] FATAL: Stacktrace dumped to /tmp/kitchen/cache/chef-stacktrace.out
                 [2016-07-18T23:55:57+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                 [2016-07-18T23:55:57+00:00] ERROR: Found 1 errors, they are stored in the backtrace
                 [2016-07-18T23:55:58+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
          D      Cleaning up local sandbox in /tmp/cheftest/docker-default-ubuntu-1404-sandbox-20160718-27889-16j7fbk
          D      [SSH] shutting previous connection ubuntu@10.194.14.1<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"ubuntu"}>
    5334: |2

      Running handlers:
      [2016-07-18T23:55:59+00:00] ERROR: Running exception handlers
      Running handlers complete
      [2016-07-18T23:55:59+00:00] ERROR: Exception handlers complete
      Chef Client failed. 2 resources updated in 02 minutes 01 seconds
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:59 +0000] [2016-07-18T23:55:59+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/failed-audit-data.json
      [2016-07-18T23:55:59+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/chef-stacktrace.out
      [2016-07-18T23:55:59+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
      [2016-07-18T23:55:59+00:00] ERROR: Found 1 errors, they are stored in the backtrace
      TOP-COOKBOOKS::PROVISION::[2016-07-18 23:55:59 +0000] [2016-07-18T23:55:59+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
      CHEF-ACCEPTANCE::[2016-07-18 23:55:59 +0000] Encountered an error running the recipe provision: Expected process to exit with [0], but received '1'
      ---- Begin output of chef-client -z -c /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/dna.json -o acceptance-cookbook::provision --no-color ----
    6283: |2
                                   * execute[install-key 58118E89F3A912897C070ADBF76221572C52609D] action run

                                     ================================================================================
                                     Error executing action `run` on resource 'execute[install-key 58118E89F3A912897C070ADBF76221572C52609D]'
                                     ================================================================================

                                     Mixlib::ShellOut::ShellCommandFailed
                                     ------------------------------------
                                     Expected process to exit with [0], but received '2'
                                     ---- Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                                     STDOUT: Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
                                     gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't be retrieved
                                     STDERR: gpg: requesting key 2C52609D from hkp server p80.pool.sks-keyservers.net
                                     gpg: no valid OpenPGP data found.
                                     gpg: Total number processed: 0
                                     ---- End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                                     Ran apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D returned 2

                                     Cookbook Trace:
                                     ---------------
                                     /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'
                                     /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'

                                     Resource Declaration:
                                     ---------------------
                                     # In /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb

                                     201:         declare_resource(:execute, "install-key #{key}") do
                                     202:           command cmd
                                     203:           sensitive new_resource.sensitive
                                     204:           not_if do
                                     205:             present = extract_fingerprints_from_cmd("apt-key finger").any? do |fp|
                                     206:               fp.end_with? key.upcase
                                     207:             end
                                     208:             present && key_is_valid?("apt-key list", key.upcase)
                                     209:           end
                                     210:           notifies :run, "execute[apt-cache gencaches]", :immediately
                                     211:         end
                                     212:

                                     Compiled Resource:
                                     ------------------
                                     # Declared in /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb:201:in `install_key_from_keyserver'

                                     execute("install-key 58118E89F3A912897C070ADBF76221572C52609D") do
                                action [:run]
                                retries 0
    6343: |2


                                   ================================================================================
                                   Error executing action `add` on resource 'apt_repository[docker]'
                                   ================================================================================

                                   Mixlib::ShellOut::ShellCommandFailed
                                   ------------------------------------
                                   execute[install-key 58118E89F3A912897C070ADBF76221572C52609D] (/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb line 201) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '2'
                                   ---- Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                                   STDOUT: Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
                                   gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't be retrieved
                                   STDERR: gpg: requesting key 2C52609D from hkp server p80.pool.sks-keyservers.net
                                   gpg: no valid OpenPGP data found.
                                   gpg: Total number processed: 0
                                   ---- End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D ----
                                   Ran apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D returned 2

                                   Cookbook Trace:
                                   ---------------
                                   /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'
                                   /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in `run_action'

                                   Resource Declaration:
                                   ---------------------
                                   # In /tmp/kitchen/cache/cookbooks/chef-apt-docker/recipes/default.rb

                                    20: apt_repository 'docker' do
                                    21:   uri 'https://apt.dockerproject.org/repo'
                                    22:   distribution "#{node['platform']}-#{node['lsb']['codename']}"
                                    23:   keyserver 'p80.pool.sks-keyservers.net'
                                    24:   components node['chef-apt-docker']['components']
                                    25:   key '58118E89F3A912897C070ADBF76221572C52609D'
                                    26: end

                                   Compiled Resource:
                                   ------------------
                                   # Declared in /tmp/kitchen/cache/cookbooks/chef-apt-docker/recipes/default.rb:20:in `from_file'

                                   apt_repository("docker") do
                                     action [:add]
                                     retries 0
                                     retry_delay 2
                                     default_guard_interpreter :default
                                     declared_type :apt_repository
                                     cookbook_name "chef-apt-docker"
                                     recipe_name "default"
                                     uri "https://apt.dockerproject.org/repo"
                                     distribution "ubuntu-trusty"
                                     keyserver "p80.pool.sks-keyservers.net"
                                     components ["main"]
                                     key "58118E89F3A912897C070ADBF76221572C52609D"
                                     cache_rebuild true
                                   end

                                   Platform:
                                   ---------
                                   x86_64-linux

                               Starting audit phase
    6407: |2

                               Running handlers:
                               [2016-07-18T23:55:57+00:00] ERROR: Running exception handlers
                               Running handlers complete
                               [2016-07-18T23:55:57+00:00] ERROR: Exception handlers complete
                               Chef Client failed. 5 resources updated in 17 seconds
                               [2016-07-18T23:55:57+00:00] ERROR: Failed to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json
                               [2016-07-18T23:55:57+00:00] FATAL: Stacktrace dumped to /tmp/kitchen/cache/chef-stacktrace.out
                               [2016-07-18T23:55:57+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                               [2016-07-18T23:55:57+00:00] ERROR: Found 1 errors, they are stored in the backtrace
                               [2016-07-18T23:55:58+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
                        D      Cleaning up local sandbox in /tmp/cheftest/docker-default-ubuntu-1404-sandbox-20160718-27889-16j7fbk
                        D      [SSH] shutting previous connection ubuntu@10.194.14.1<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"ubuntu"}>
    6475: "                  D      ----End Backtrace-----\n\n        ================================================================================\n
      \       Error executing action `run` on resource 'execute[bundle exec kitchen
      converge  -c -l debug]'\n        ================================================================================\n\n
      \       Mixlib::ShellOut::ShellCommandFailed\n        ------------------------------------\n
      \       Expected process to exit with [0], but received '10'\n        ---- Begin
      output of bundle exec kitchen converge  -c -l debug ----\n        STDOUT: ----->
      Starting Kitchen (v1.9.2)\n        D      Berksfile found at /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/docker/Berksfile,
      loading Berkshelf\n        D      Berkshelf 4.3.5 library loaded\n        ----->
      Creating <docker-default-ubuntu-1404>...\n               If you are not using
      an account that qualifies under the AWS\n        free-tier, you may be charged
      to run these suites. The charge\n        should be minimal, but neither Test
      Kitchen nor its maintainers\n        are responsible for your incurred costs.\n\n
      \       D      platform name ubuntu-14.04 appears to be a standard platform.
      Searching for ubuntu 14.04 ...\n        D      Searching for images matching
      {:name=>\"ubuntu/images/*/ubuntu-*-14.04-*-server-*\", :\"owner-id\"=>\"099720109477\",
      :architecture=>\"x86_64\", :\"virtualization-type\"=>\"hvm\", :\"block-device-mapping.volume-type\"=>\"gp2\",
      :\"image-type\"=>\"machine\"} ...\n        D      Search returned 59 images:\n
      \       D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160714:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-07-15T10:37:25.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160627:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-06-29T15:13:53.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160620:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-06-21T12:07:59.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160602:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-06-03T01:17:21.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160516:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-05-17T09:54:45.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160509.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-05-10T11:55:52.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160406:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-04-06T22:01:48.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160314:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-03-15T08:30:56.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160222:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-02-23T13:53:30.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160217.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-02-18T01:37:46.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160201:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-02-02T12:11:43.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160119:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-01-20T12:15:17.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160114.5:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-01-15T22:11:35.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151218:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-12-20T01:45:49.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151217:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-12-18T09:40:49.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151117:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-11-18T08:17:32.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151105:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-11-06T23:03:53.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151019:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-20T09:04:11.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151015:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-15T20:43:54.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151008:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-09T08:48:14.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151007:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-08T08:57:50.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151005:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-06T09:26:41.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150930:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-01T11:24:14.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150928:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-29T11:13:44.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150924:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-25T13:37:47.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150908:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-09T05:59:15.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150901.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-02T05:15:07.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150814:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-15T08:11:39.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150813:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-14T07:14:42.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150812:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-13T08:50:05.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150810:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-11T11:43:49.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150805:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-06T19:29:13.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150731:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-01T09:17:08.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150727:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-07-28T07:13:51.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150724:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-07-25T05:22:13.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150629:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-30T09:14:39.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150609:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-09T17:42:29.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150608:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-09T03:54:29.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150603:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-04T08:13:50.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150528:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-05-29T10:15:24.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150506:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-05-07T08:14:11.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150417:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-04-17T12:06:11.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150408.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-04-09T08:52:15.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150325:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-03-25T23:56:26.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150305:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-03-05T11:02:56.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150227.2:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-02-28T07:15:31.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150225.2:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-02-26T06:03:04.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150209.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-02-10T05:22:56.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150123:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-01-23T10:57:13.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20141125:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-11-26T01:50:28.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140927:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-30T00:19:14.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140926:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-26T16:05:00.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140924:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-25T14:07:23.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140923:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-23T14:15:33.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140829:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-08-29T18:46:07.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140816:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-08-16T22:57:30.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140813:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-08-14T00:50:31.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140724:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-07-25T08:28:59.000Z\n        D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140607.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-07-23T18:05:49.000Z\n        D      Creating EC2 instance
      in region us-west-2 with properties:\n        D      - instance_type = \"m3.large\"\n
      \       D      - ebs_optimized = false\n        D      - image_id = \"ami-d732f0b7\"\n
      \       D      - key_name = \"jenkins\"\n        D      - subnet_id = \"subnet-19ac017c\"\n
      \       D      - private_ip_address = nil\n        D      - placement = {:availability_zone=>\"us-west-2a\"}\n
      \       D      - security_group_ids = [\"sg-e401eb83\", \"sg-96274af3\"]\n               Instance
      <i-666cd4c9> requested.\n               Polling AWS for existence, attempt 0...\n
      \              Attempting to tag the instance, 0 retries\n               EC2
      instance <i-666cd4c9> created.\n               Waited 0/300s for instance <i-666cd4c9>
      to become ready.\n               Waited 5/300s for instance <i-666cd4c9> to
      become ready.\n               Waited 10/300s for instance <i-666cd4c9> to become
      ready.\n               Waited 15/300s for instance <i-666cd4c9> to become ready.\n
      \              Waited 20/300s for instance <i-666cd4c9> to become ready.\n               EC2
      instance <i-666cd4c9> ready.\n        D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"]}>\n        D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout:
      Net::SSH::ConnectionTimeout>)\n               Waiting for SSH service on 10.194.14.1:22,
      retrying in 3 seconds\n        D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n        D      [SSH] connection
      failed (#<Errno::ECONNREFUSED: Connection refused - connect(2) for 10.194.14.1:22>)\n
      \              Waiting for SSH service on 10.194.14.1:22, retrying in 3 seconds\n
      \       D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n        D      [SSH] connection
      failed (#<Errno::ECONNREFUSED: Connection refused - connect(2) for 10.194.14.1:22>)\n
      \              Waiting for SSH service on 10.194.14.1:22, retrying in 3 seconds\n
      \       D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n        D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (echo '[SSH] Established')\n
      \              [SSH] Established\n        D      Using sudo_command='sudo -E'
      for ohai hints\n        D      [SSH] reusing existing connection ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n        D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sudo -E mkdir -p /etc/chef/ohai/hints;
      sudo -E touch /etc/chef/ohai/hints/ec2.json)\n        D      ec2:create '10.194.14.1'\n
      \              Finished creating <docker-default-ubuntu-1404> (0m51.84s).\n
      \       -----> Converging <docker-default-ubuntu-1404>...\n               Preparing
      files for transfer\n        D      Creating local sandbox in /tmp/cheftest/docker-default-ubuntu-1404-sandbox-20160718-27889-16j7fbk\n
      \              Preparing dna.json\n        D      Creating dna.json from {:chef_acceptance=>\"true\",
      :use_system_chef=>\"true\", :docker=>{:version=>\"1.10.0\"}, :run_list=>[\"recipe[apt]\",
      \"recipe[chef-apt-docker]\"]}\n               Resolving cookbook dependencies
      with Berkshelf 4.3.5...\n        D      Using Berksfile from /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/docker/Berksfile\n
      \              Removing non-cookbook files before transfer\n               Preparing
      validation.pem\n        D      Using a dummy validation.pem\n               Preparing
      client.rb\n        D      Creating client.rb from {:node_name=>\"docker-default-ubuntu-1404\",
      :checksum_path=>\"/tmp/kitchen/checksums\", :file_cache_path=>\"/tmp/kitchen/cache\",
      :file_backup_path=>\"/tmp/kitchen/backup\", :cookbook_path=>[\"/tmp/kitchen/cookbooks\",
      \"/tmp/kitchen/site-cookbooks\"], :data_bag_path=>\"/tmp/kitchen/data_bags\",
      :environment_path=>\"/tmp/kitchen/environments\", :node_path=>\"/tmp/kitchen/nodes\",
      :role_path=>\"/tmp/kitchen/roles\", :client_path=>\"/tmp/kitchen/clients\",
      :user_path=>\"/tmp/kitchen/users\", :validation_key=>\"/tmp/kitchen/validation.pem\",
      :client_key=>\"/tmp/kitchen/client.pem\", :chef_server_url=>\"http://127.0.0.1:8889\",
      :encrypted_data_bag_secret=>\"/tmp/kitchen/encrypted_data_bag_secret\", :audit_mode=>\":enabled\",
      :named_run_list=>{}}\n        D      [SSH] reusing existing connection ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n        D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sudo -E cat > /tmp/chef-installer.sh
      <<\"EOL\"\n        #!/bin/bash\n        #!/bin/sh\n        # WARNING: REQUIRES
      /bin/sh\n        #\n        # - must run on /bin/sh on solaris 9\n        #
      - must run on /bin/sh on AIX 6.x\n        #\n        # Copyright:: Copyright
      (c) 2010-2015 Chef Software, Inc.\n        # License:: Apache License, Version
      2.0\n        #\n        # Licensed under the Apache License, Version 2.0 (the
      \"License\");\n        # you may not use this file except in compliance with
      the License.\n        # You may obtain a copy of the License at\n        #\n
      \       #     http://www.apache.org/licenses/LICENSE-2.0\n        #\n        #
      Unless required by applicable law or agreed to in writing, software\n        #
      distributed under the License is distributed on an \"AS IS\" BASIS,\n        #
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n        #
      See the License for the specific language governing permissions and\n        #
      limitations under the License.\n        #\n\n        # helpers.sh\n        ############\n
      \       # This section has some helper functions to make life easier.\n        #\n
      \       # Outputs:\n        # $tmp_dir: secure-ish temp directory that can be
      used during installation.\n        ############\n\n        # Check whether a
      command exists - returns 0 if it does, 1 if it does not\n        exists() {\n
      \         if command -v $1 >/dev/null 2>&1\n          then\n            return
      0\n          else\n            return 1\n          fi\n        }\n\n        #
      Output the instructions to report bug about this script\n        report_bug()
      {\n          echo \"Version: $version\"\n          echo \"\"\n          echo
      \"Please file a Bug Report at https://github.com/chef/omnitruck/issues/new\"\n
      \         echo \"Alternatively, feel free to open a Support Ticket at https://www.chef.io/support/tickets\"\n
      \         echo \"More Chef support resources can be found at https://www.chef.io/support\"\n
      \         echo \"\"\n          echo \"Please include as many details about the
      problem as possible i.e., how to reproduce\"\n          echo \"the problem (if
      possible), type of the Operating System and its version, etc.,\"\n          echo
      \"and any other relevant details that might help us with troubleshooting.\"\n
      \         echo \"\"\n        }\n\n        checksum_mismatch() {\n          echo
      \"Package checksum mismatch!\"\n          report_bug\n          exit 1\n        }\n\n
      \       unable_to_retrieve_package() {\n          echo \"Unable to retrieve
      a valid package!\"\n          report_bug\n          echo \"Metadata URL: $metadata_url\"\n
      \         if test \"x$download_url\" != \"x\"; then\n            echo \"Download
      URL: $download_url\"\n          fi\n          if test \"x$stderr_results\" !=
      \"x\"; then\n            echo \"\\nDEBUG OUTPUT FOLLOWS:\\n$stderr_results\"\n
      \         fi\n          exit 1\n        }\n\n        http_404_error() {\n          echo
      \"Omnitruck artifact does not exist for version $version on platform $platform\"\n
      \         echo \"\"\n          echo \"Either this means:\"\n          echo \"
      \  - We do not support $platform\"\n          echo \"   - We do not have an
      artifact for $version\"\n          echo \"\"\n          echo \"This is often
      the latter case due to running a prerelease or RC version of chef\"\n          echo
      \"or a gem version which was only pushed to rubygems and not omnitruck.\"\n
      \         echo \"\"\n          echo \"You may be able to set your knife[:bootstrap_version]
      to the most recent stable\"\n          echo \"release of Chef to fix this problem
      (or the most recent stable major version number).\"\n          echo \"\"\n          echo
      \"In order to test the version parameter, adventurous users may take the Metadata
      URL\"\n          echo \"below and modify the '&v=<number>' parameter until you
      successfully get a URL that\"\n          echo \"does not 404 (e.g. via curl
      or wget).  You should be able to use '&v=11' or '&v=12'\"\n          echo \"succesfully.\"\n
      \         echo \"\"\n          echo \"If you cannot fix this problem by setting
      the bootstrap_version, it probably means\"\n          echo \"that $platform
      is not supported.\"\n          echo \"\"\n          # deliberately do not call
      report_bug to suppress bug report noise.\n          echo \"Metadata URL: $metadata_url\"\n
      \         if test \"x$download_url\" != \"x\"; then\n            echo \"Download
      URL: $download_url\"\n          fi\n          if test \"x$stderr_results\" !=
      \"x\"; then\n            echo \"\\nDEBUG OUTPUT FOLLOWS:\\n$stderr_results\"\n
      \         fi\n          exit 1\n        }\n\n        capture_tmp_stderr() {\n
      \         # spool up /tmp/stderr from all the commands we called\n          if
      test -f \"$tmp_dir/stderr\"; then\n            output=`cat $tmp_dir/stderr`\n
      \           stderr_results=\"${stderr_results}\\nSTDERR from $1:\\n\\n$output\\n\"\n
      \           rm $tmp_dir/stderr\n          fi\n        }\n\n        # do_wget
      URL FILENAME\n        do_wget() {\n          echo \"trying wget...\"\n          wget
      -O \"$2\" \"$1\" 2>$tmp_dir/stderr\n          rc=$?\n          # check for 404\n
      \         grep \"ERROR 404\" $tmp_dir/stderr 2>&1 >/dev/null\n          if test
      $? -eq 0; then\n            echo \"ERROR 404\"\n            http_404_error\n
      \         fi\n\n          # check for bad return status or empty output\n          if
      test $rc -ne 0 || test ! -s \"$2\"; then\n            capture_tmp_stderr \"wget\"\n
      \           return 1\n          fi\n\n          return 0\n        }\n\n        #
      do_curl URL FILENAME\n        do_curl() {\n          echo \"trying curl...\"\n
      \         curl --retry 5 -sL -D $tmp_dir/stderr \"$1\" > \"$2\"\n          rc=$?\n
      \         # check for 404\n          grep \"404 Not Found\" $tmp_dir/stderr
      2>&1 >/dev/null\n          if test $? -eq 0; then\n            echo \"ERROR
      404\"\n            http_404_error\n          fi\n\n          # check for bad
      return status or empty output\n          if test $rc -ne 0 || test ! -s \"$2\";
      then\n            capture_tmp_stderr \"curl\"\n            return 1\n          fi\n\n
      \         return 0\n        }\n\n        # do_fetch URL FILENAME\n        do_fetch()
      {\n          echo \"trying fetch...\"\n          fetch -o \"$2\" \"$1\" 2>$tmp_dir/stderr\n
      \         # check for bad return status\n          test $? -ne 0 && return 1\n
      \         return 0\n        }\n\n        # do_perl URL FILENAME\n        do_perl()
      {\n          echo \"trying perl...\"\n          perl -e 'use LWP::Simple; getprint($ARGV[0]);'
      \"$1\" > \"$2\" 2>$tmp_dir/stderr\n          rc=$?\n          # check for 404\n
      \         grep \"404 Not Found\" $tmp_dir/stderr 2>&1 >/dev/null\n          if
      test $? -eq 0; then\n            echo \"ERROR 404\"\n            http_404_error\n
      \         fi\n\n          # check for bad return status or empty output\n          if
      test $rc -ne 0 || test ! -s \"$2\"; then\n            capture_tmp_stderr \"perl\"\n
      \           return 1\n          fi\n\n          return 0\n        }\n\n        #
      do_python URL FILENAME\n        do_python() {\n          echo \"trying python...\"\n
      \         python -c \"import sys,urllib2 ; sys.stdout.write(urllib2.urlopen(sys.argv[1]).read())\"
      \"$1\" > \"$2\" 2>$tmp_dir/stderr\n          rc=$?\n          # check for 404\n
      \         grep \"HTTP Error 404\" $tmp_dir/stderr 2>&1 >/dev/null\n          if
      test $? -eq 0; then\n            echo \"ERROR 404\"\n            http_404_error\n
      \         fi\n\n          # check for bad return status or empty output\n          if
      test $rc -ne 0 || test ! -s \"$2\"; then\n            capture_tmp_stderr \"python\"\n
      \           return 1\n          fi\n          return 0\n        }\n\n        #
      returns 0 if checksums match\n        do_checksum() {\n          if exists sha256sum;
      then\n            echo \"Comparing checksum with sha256sum...\"\n            checksum=`sha256sum
      $1 | awk '{ print $1 }'`\n            return `test \"x$checksum\" = \"x$2\"`\n
      \         elif exists shasum; then\n            echo \"Comparing checksum with
      shasum...\"\n            checksum=`shasum -a 256 $1 | awk '{ print $1 }'`\n
      \           return `test \"x$checksum\" = \"x$2\"`\n          else\n            echo
      \"WARNING: could not find a valid checksum program, pre-install shasum or sha256sum
      in your O/S image to get valdation...\"\n            return 0\n          fi\n
      \       }\n\n        # do_download URL FILENAME\n        do_download() {\n          echo
      \"downloading $1\"\n          echo \"  to file $2\"\n\n          url=`echo $1`\n
      \         if test \"x$platform\" = \"xsolaris2\"; then\n            if test
      \"x$platform_version\" = \"x5.9\" -o \"x$platform_version\" = \"x5.10\"; then\n
      \             # solaris 9 lacks openssl, solaris 10 lacks recent enough credentials
      - your base O/S is completely insecure, please upgrade\n              url=`echo
      $url | sed -e 's/https/http/'`\n            fi\n          fi\n\n          #
      we try all of these until we get success.\n          # perl, in particular may
      be present but LWP::Simple may not be installed\n\n          if exists wget;
      then\n            do_wget $url $2 && return 0\n          fi\n\n          if
      exists curl; then\n            do_curl $url $2 && return 0\n          fi\n\n
      \         if exists fetch; then\n            do_fetch $url $2 && return 0\n
      \         fi\n\n          if exists perl; then\n            do_perl $url $2
      && return 0\n          fi\n\n          if exists python; then\n            do_python
      $url $2 && return 0\n          fi\n\n          unable_to_retrieve_package\n
      \       }\n\n        # install_file TYPE FILENAME\n        # TYPE is \"rpm\",
      \"deb\", \"solaris\", \"sh\", etc.\n        install_file() {\n          echo
      \"Installing $project $version\"\n          case \"$1\" in\n            \"rpm\")\n
      \             if test \"x$platform\" = \"xnexus\" || test \"x$platform\" = \"xios_xr\";
      then\n                echo \"installing with yum...\"\n                yum install
      -yv \"$2\"\n              else\n                echo \"installing with rpm...\"\n
      \               rpm -Uvh --oldpackage --replacepkgs \"$2\"\n              fi\n
      \             ;;\n            \"deb\")\n              echo \"installing with
      dpkg...\"\n              dpkg -i \"$2\"\n              ;;\n            \"bff\")\n
      \             echo \"installing with installp...\"\n              installp -aXYgd
      \"$2\" all\n              ;;\n            \"solaris\")\n              echo \"installing
      with pkgadd...\"\n              echo \"conflict=nocheck\" > $tmp_dir/nocheck\n
      \             echo \"action=nocheck\" >> $tmp_dir/nocheck\n              echo
      \"mail=\" >> $tmp_dir/nocheck\n              pkgrm -a $tmp_dir/nocheck -n $project
      >/dev/null 2>&1 || true\n              pkgadd -G -n -d \"$2\" -a $tmp_dir/nocheck
      $project\n              ;;\n            \"pkg\")\n              echo \"installing
      with installer...\"\n              cd / && /usr/sbin/installer -pkg \"$2\" -target
      /\n              ;;\n            \"dmg\")\n              echo \"installing dmg
      file...\"\n              hdiutil detach \"/Volumes/chef_software\" >/dev/null
      2>&1 || true\n              hdiutil attach \"$2\" -mountpoint \"/Volumes/chef_software\"\n
      \             cd / && /usr/sbin/installer -pkg `find \"/Volumes/chef_software\"
      -name \\*.pkg` -target /\n              hdiutil detach \"/Volumes/chef_software\"\n
      \             ;;\n            \"sh\" )\n              echo \"installing with
      sh...\"\n              sh \"$2\"\n              ;;\n            *)\n              echo
      \"Unknown filetype: $1\"\n              report_bug\n              exit 1\n              ;;\n
      \         esac\n          if test $? -ne 0; then\n            echo \"Installation
      failed\"\n            report_bug\n            exit 1\n          fi\n        }\n\n
      \       if test \"x$TMPDIR\" = \"x\"; then\n          tmp=\"/tmp\"\n        else\n
      \         tmp=$TMPDIR\n        fi\n        # secure-ish temp dir creation without
      having mktemp available (DDoS-able but not expliotable)\n        tmp_dir=\"$tmp/install.sh.$$\"\n
      \       (umask 077 && mkdir $tmp_dir) || exit 1\n\n        ############\n        #
      end of helpers.sh\n        ############\n\n\n        project=chefdk\n        version=0.16.30\n
      \       channel=unstable\n\n\n        # platform_detection.sh\n        ############\n
      \       # This section makes platform detection compatible with omnitruck on
      the system\n        #   it runs.\n        #\n        # Outputs:\n        # $platform:
      Name of the platform.\n        # $platform_version: Version of the platform.\n
      \       # $machine: System's architecture.\n        ############\n\n        #\n
      \       # Platform and Platform Version detection\n        #\n        # NOTE:
      This should now match ohai platform and platform_version matching.\n        #
      do not invented new platform and platform_version schemas, just make this behave\n
      \       # like what ohai returns as platform and platform_version for the server.\n
      \       #\n        # ALSO NOTE: Do not mangle platform or platform_version here.
      \ It is less error\n        # prone and more future-proof to do that in the
      server, and then all omnitruck clients\n        # will 'inherit' the changes
      (install.sh is not the only client of the omnitruck\n        # endpoint out
      there).\n        #\n\n        machine=`uname -m`\n        os=`uname -s`\n\n
      \       if test -f \"/etc/lsb-release\" && grep -q DISTRIB_ID /etc/lsb-release
      && ! grep -q wrlinux /etc/lsb-release; then\n          platform=`grep DISTRIB_ID
      /etc/lsb-release | cut -d \"=\" -f 2 | tr '[A-Z]' '[a-z]'`\n          platform_version=`grep
      DISTRIB_RELEASE /etc/lsb-release | cut -d \"=\" -f 2`\n        elif test -f
      \"/etc/debian_version\"; then\n          platform=\"debian\"\n          platform_version=`cat
      /etc/debian_version`\n        elif test -f \"/etc/redhat-release\"; then\n          platform=`sed
      's/^\\(.\\+\\) release.*/\\1/' /etc/redhat-release | tr '[A-Z]' '[a-z]'`\n          platform_version=`sed
      's/^.\\+ release \\([.0-9]\\+\\).*/\\1/' /etc/redhat-release`\n\n          #
      If /etc/redhat-release exists, we act like RHEL by default\n          if test
      \"$platform\" = \"fedora\"; then\n            # FIXME: stop remapping fedora
      to el\n            # FIXME: remove client side platform_version mangling and
      hard coded yolo\n            # Change platform version for use below.\n            platform_version=\"6.0\"\n
      \         fi\n\n          if test \"$platform\" = \"xenserver\"; then\n            #
      Current XenServer 6.2 is based on CentOS 5, platform is not reset to \"el\"
      server should hanlde response\n            platform=\"xenserver\"\n          else\n
      \           # FIXME: use \"redhat\"\n            platform=\"el\"\n          fi\n\n
      \       elif test -f \"/etc/system-release\"; then\n          platform=`sed
      's/^\\(.\\+\\) release.\\+/\\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`\n
      \         platform_version=`sed 's/^.\\+ release \\([.0-9]\\+\\).*/\\1/' /etc/system-release
      | tr '[A-Z]' '[a-z]'`\n          # amazon is built off of fedora, so act like
      RHEL\n          if test \"$platform\" = \"amazon linux ami\"; then\n            #
      FIXME: remove client side platform_version mangling and hard coded yolo, and
      remapping to deprecated \"el\"\n            platform=\"el\"\n            platform_version=\"6.0\"\n
      \         fi\n        # Apple OS X\n        elif test -f \"/usr/bin/sw_vers\";
      then\n          platform=\"mac_os_x\"\n          # Matching the tab-space with
      sed is error-prone\n          platform_version=`sw_vers | awk '/^ProductVersion:/
      { print $2 }' | cut -d. -f1,2`\n\n          # x86_64 Apple hardware often runs
      32-bit kernels (see OHAI-63)\n          x86_64=`sysctl -n hw.optional.x86_64`\n
      \         if test $x86_64 -eq 1; then\n            machine=\"x86_64\"\n          fi\n
      \       elif test -f \"/etc/release\"; then\n          machine=`/usr/bin/uname
      -p`\n          if grep -q SmartOS /etc/release; then\n            platform=\"smartos\"\n
      \           platform_version=`grep ^Image /etc/product | awk '{ print $3 }'`\n
      \         else\n            platform=\"solaris2\"\n            platform_version=`/usr/bin/uname
      -r`\n          fi\n        elif test -f \"/etc/SuSE-release\"; then\n          if
      grep -q 'Enterprise' /etc/SuSE-release;\n          then\n              platform=\"sles\"\n
      \             platform_version=`awk '/^VERSION/ {V = $3}; /^PATCHLEVEL/ {P =
      $3}; END {print V \".\" P}' /etc/SuSE-release`\n          else\n              platform=\"suse\"\n
      \             platform_version=`awk '/^VERSION =/ { print $3 }' /etc/SuSE-release`\n
      \         fi\n        elif test \"x$os\" = \"xFreeBSD\"; then\n          platform=\"freebsd\"\n
      \         platform_version=`uname -r | sed 's/-.*//'`\n        elif test \"x$os\"
      = \"xAIX\"; then\n          platform=\"aix\"\n          platform_version=\"`uname
      -v`.`uname -r`\"\n          machine=\"powerpc\"\n        elif test -f \"/etc/os-release\";
      then\n          . /etc/os-release\n          if test \"x$CISCO_RELEASE_INFO\"
      != \"x\"; then\n            . $CISCO_RELEASE_INFO\n          fi\n\n          platform=$ID\n
      \         platform_version=$VERSION\n        fi\n\n        if test \"x$platform\"
      = \"x\"; then\n          echo \"Unable to determine platform version!\"\n          report_bug\n
      \         exit 1\n        fi\n\n        #\n        # NOTE: platform manging
      in the install.sh is DEPRECATED\n        #\n        # - install.sh should be
      true to ohai and should not remap\n        #   platform or platform versions.\n
      \       #\n        # - remapping platform and mangling platform version numbers
      is\n        #   now the complete responsibility of the server-side endpoints\n
      \       #\n\n        major_version=`echo $platform_version | cut -d. -f1`\n
      \       case $platform in\n          # FIXME: should remove this case statement
      completely\n          \"el\")\n            # FIXME:  \"el\" is deprecated, should
      use \"redhat\"\n            platform_version=$major_version\n            ;;\n
      \         \"debian\")\n            if test \"x$major_version\" = \"x5\"; then\n
      \             # This is here for potential back-compat.\n              # We
      do not have 5 in versions we publish for anymore but we\n              # might
      have it for earlier versions.\n              platform_version=\"6\"\n            else\n
      \             platform_version=$major_version\n            fi\n            ;;\n
      \         \"freebsd\")\n            platform_version=$major_version\n            ;;\n
      \         \"sles\")\n            platform_version=$major_version\n            ;;\n
      \         \"suse\")\n            platform_version=$major_version\n            ;;\n
      \       esac\n\n        # normalize the architecture we detected\n        case
      $machine in\n          \"x86_64\"|\"amd64\"|\"x64\")\n            machine=\"x86_64\"\n
      \           ;;\n          \"i386\"|\"i86pc\"|\"x86\"|\"i686\")\n            machine=\"i386\"\n
      \           ;;\n          \"sparc\"|\"sun4u\"|\"sun4v\")\n            machine=\"sparc\"\n
      \           ;;\n        esac\n\n        if test \"x$platform_version\" = \"x\";
      then\n          echo \"Unable to determine platform version!\"\n          report_bug\n
      \         exit 1\n        fi\n\n        if test \"x$platform\" = \"xsolaris2\";
      then\n          # hack up the path on Solaris to find wget, pkgadd\n          PATH=/usr/sfw/bin:/usr/sbin:$PATH\n
      \         export PATH\n        fi\n\n        echo \"$platform $platform_version
      $machine\"\n\n        ############\n        # end of platform_detection.sh\n
      \       ############\n\n\n        # artifactory_urls.sh\n        ############\n
      \       # This section sets up the information for a build to be installed from
      artifactory\n        #  then uses $platform, $platform_version and $machine
      to select the correct\n        #  version.\n        #\n        # Inputs:\n        #
      $platform:\n        # $platform_version:\n        # $machine:\n        #\n        #
      Outputs:\n        # $download_url:\n        # $sha256:\n        ############\n\n\n
      \         artifact_info_dir=\"$tmp_dir/artifact_info/mac_os_x/10.9/x86_64\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/mac_os_x/10.9/chefdk-0.16.30-1.dmg\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 4d4b8adb26f90b572e11b7779dc5528b3de3f25033aa62d1cb64f059f04b566b\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/mac_os_x/10.10/x86_64\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/mac_os_x/10.10/chefdk-0.16.30-1.dmg\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 4d4b8adb26f90b572e11b7779dc5528b3de3f25033aa62d1cb64f059f04b566b\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/mac_os_x/10.11/x86_64\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/mac_os_x/10.11/chefdk-0.16.30-1.dmg\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 4d4b8adb26f90b572e11b7779dc5528b3de3f25033aa62d1cb64f059f04b566b\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/el/7/x86_64\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/el/7/chefdk-0.16.30-1.el7.x86_64.rpm\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 7d1aad0a56c33ef381565f29a9fd0dfaf535417b8bfa0d861f9677e0859df099\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/windows/2008r2/i386\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/windows/2008r2/chefdk-0.16.30-1-x86.msi\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 491074e24b0db0d42dd7b1ca998d7c7c80a18ff9e9b35b50c1c87409e9b851bc\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/windows/2012/i386\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/windows/2012/chefdk-0.16.30-1-x86.msi\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 491074e24b0db0d42dd7b1ca998d7c7c80a18ff9e9b35b50c1c87409e9b851bc\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/ubuntu/12.04/x86_64\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/ubuntu/12.04/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 9e4b9a102e8616169ee38c8cdceb8bfb1cf97d2b4323859ea91c805a044c7523\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/ubuntu/14.04/x86_64\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/ubuntu/14.04/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 9e4b9a102e8616169ee38c8cdceb8bfb1cf97d2b4323859ea91c805a044c7523\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/windows/2012r2/i386\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/windows/2012r2/chefdk-0.16.30-1-x86.msi\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 491074e24b0db0d42dd7b1ca998d7c7c80a18ff9e9b35b50c1c87409e9b851bc\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/el/6/x86_64\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/el/6/chefdk-0.16.30-1.el6.x86_64.rpm\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 d04a13de502ec9278dd4887c5b484536cb8e2293808d32d929adbe3670ac58c4\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/debian/6/x86_64\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/debian/6/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 91f6a25372e69e58d1dfc0370c5e381e834594bb36cfd3f0dc073872707d46f1\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/debian/7/x86_64\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/debian/7/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 91f6a25372e69e58d1dfc0370c5e381e834594bb36cfd3f0dc073872707d46f1\"
      >> \"$artifact_info_dir/artifact_info\"\n\n          artifact_info_dir=\"$tmp_dir/artifact_info/debian/8/x86_64\"\n
      \         mkdir -p $artifact_info_dir\n          touch \"$artifact_info_dir/artifact_info\"\n
      \         echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/debian/8/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n          echo \"sha256 91f6a25372e69e58d1dfc0370c5e381e834594bb36cfd3f0dc073872707d46f1\"
      >> \"$artifact_info_dir/artifact_info\"\n\n\n        artifact_info_for_platform=\"$tmp_dir/artifact_info/$platform/$platform_version/$machine/artifact_info\"\n\n
      \       download_url=`awk '$1 == \"url\" { print $2 }' \"$artifact_info_for_platform\"`\n
      \       sha256=`awk '$1 == \"sha256\" { print $2 }' \"$artifact_info_for_platform\"`\n\n\n
      \       # fetch_package.sh\n        ############\n        # This section fetchs
      a package from $download_url and verifies its metadata.\n        #\n        #
      Inputs:\n        # $download_url:\n        # $tmp_dir:\n        # Optional Inputs:\n
      \       # $cmdline_filename: Name of the package downloaded on local disk.\n
      \       # $cmdline_dl_dir: Name of the directory downloaded package will be
      saved to on local disk.\n        #\n        # Outputs:\n        # $download_filename:
      Name of the downloaded file on local disk.\n        # $filetype: Type of the
      file downloaded.\n        ############\n\n        filename=`echo $download_url
      | sed -e 's/^.*\\///'`\n        filetype=`echo $filename | sed -e 's/^.*\\.//'`\n\n
      \       # use either $tmp_dir, the provided directory (-d) or the provided filename
      (-f)\n        if test \"x$cmdline_filename\" != \"x\"; then\n          download_filename=\"$cmdline_filename\"\n
      \       elif test \"x$cmdline_dl_dir\" != \"x\"; then\n          download_filename=\"$cmdline_dl_dir/$filename\"\n
      \       else\n          download_filename=\"$tmp_dir/$filename\"\n        fi\n\n
      \       # ensure the parent directory where to download the installer always
      exists\n        download_dir=`dirname $download_filename`\n        (umask 077
      && mkdir -p $download_dir) || exit 1\n\n        # check if we have that file
      locally available and if so verify the checksum\n        cached_file_available=\"false\"\n
      \       if test -f $download_filename; then\n          echo \"$download_filename
      already exists, verifiying checksum...\"\n          if do_checksum \"$download_filename\"
      \"$sha256\"; then\n            echo \"checksum compare succeeded, using existing
      file!\"\n            cached_file_available=\"true\"\n          else\n            echo
      \"checksum mismatch, downloading latest version of the file\"\n          fi\n
      \       fi\n\n        # download if no local version of the file available\n
      \       if test \"x$cached_file_available\" != \"xtrue\"; then\n          do_download
      \"$download_url\"  \"$download_filename\"\n          do_checksum \"$download_filename\"
      \"$sha256\" || checksum_mismatch\n        fi\n\n        ############\n        #
      end of fetch_package.sh\n        ############\n\n\n        # install_package.sh\n
      \       ############\n        # Installs a package and removed the temp directory.\n
      \       #\n        # Inputs:\n        # $download_filename: Name of the file
      to be installed.\n        # $filetype: Type of the file to be installed.\n        #
      $version: The version requested. Used only for warning user if not set.\n        ############\n\n
      \       if test \"x$version\" = \"x\"; then\n          echo\n          echo
      \"WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING\"\n
      \         echo\n          echo \"You are installing an omnibus package without
      a version pin.  If you are installing\"\n          echo \"on production servers
      via an automated process this is DANGEROUS and you will\"\n          echo \"be
      upgraded without warning on new releases, even to new major releases.\"\n          echo
      \"Letting the version float is only appropriate in desktop, test, development
      or\"\n          echo \"CI/CD environments.\"\n          echo\n          echo
      \"WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING\"\n
      \         echo\n        fi\n\n        install_file $filetype \"$download_filename\"\n\n
      \       if test \"x$tmp_dir\" != \"x\"; then\n          rm -r \"$tmp_dir\"\n
      \       fi\n\n        ############\n        # end of install_package.sh\n        ############\n\n
      \       EOL\n        chmod +x /tmp/chef-installer.sh\n        sudo -E /tmp/chef-installer.sh)\n
      \              ubuntu 14.04 x86_64\n               downloading http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/ubuntu/14.04/chefdk_0.16.30-1_amd64.deb\n
      \                to file /tmp/install.sh.1383/chefdk_0.16.30-1_amd64.deb\n               trying
      wget...\n               Comparing checksum with sha256sum...\n               Installing
      chefdk 0.16.30\n               installing with dpkg...\n               Selecting
      previously unselected package chefdk.\n               (Reading database ...
      \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ...
      15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database
      ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database
      ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database
      ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database
      ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database
      ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database
      ... 51172 files and directories currently installed.)\n               Preparing
      to unpack .../chefdk_0.16.30-1_amd64.deb ...\n               Unpacking chefdk
      (0.16.30-1) ...\n               Setting up chefdk (0.16.30-1) ...\n               Thank
      you for installing Chef Development Kit!\n        D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sh -c '\n        sudo_rm=\"sudo
      -E rm\"\n        dirs=\"/tmp/kitchen/clients /tmp/kitchen/cookbooks /tmp/kitchen/data
      /tmp/kitchen/data_bags /tmp/kitchen/encrypted_data_bag_secret /tmp/kitchen/environments
      /tmp/kitchen/roles\"\n        root_path=\"/tmp/kitchen\"\n\n        $sudo_rm
      -rf $dirs\n        mkdir -p $root_path\n        ')\n               Transferring
      files to <docker-default-ubuntu-1404>\n        D      TIMING: scp async upload
      (Kitchen::Transport::Ssh)\n        D      TIMING: scp async upload (Kitchen::Transport::Ssh)
      took (0m7.24s)\n        D      Transfer complete\n        D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sh -c '\n        sudo -E
      /opt/chefdk/bin/chef-client --local-mode --config /tmp/kitchen/client.rb --log_level
      auto --force-formatter --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port
      8889\n        ')\n               Starting Chef Client, version 12.12.15\n               Creating
      a new client identity for docker-default-ubuntu-1404 using the validator key.\n
      \              resolving cookbooks for run list: [\"apt\", \"chef-apt-docker\"]\n
      \              Synchronizing Cookbooks:\n                 - apt (4.0.1)\n                 -
      chef-apt-docker (1.0.0)\n                 - compat_resource (12.10.7)\n               Installing
      Cookbook Gems:\n               Compiling Cookbooks...\n               [2016-07-18T23:55:42+00:00]
      WARN: Chef::Provider::AptRepository already exists!  Cannot create deprecation
      class for LWRP provider apt_repository from cookbook apt\n               [2016-07-18T23:55:42+00:00]
      WARN: AptRepository already exists!  Deprecation class overwrites Custom resource
      apt_repository from cookbook apt\n               Converging 10 resources\n               Recipe:
      apt::default\n                 * file[/var/lib/apt/periodic/update-success-stamp]
      action nothing (skipped due to action :nothing)\n                 * apt_update[periodic]
      action periodic\n                   - update new lists of packages\n                   *
      directory[/var/lib/apt/periodic] action create (up to date)\n                   *
      directory[/etc/apt/apt.conf.d] action create (up to date)\n                   *
      file[/etc/apt/apt.conf.d/15update-stamp] action create_if_missing (up to date)\n
      \                  * execute[apt-get -q update] action run\n                     -
      execute apt-get -q update\n\n                 * execute[apt-get update] action
      nothing (skipped due to action :nothing)\n                 * execute[apt-get
      autoremove] action nothing (skipped due to action :nothing)\n                 *
      execute[apt-get autoclean] action nothing (skipped due to action :nothing)\n
      \                * directory[/var/cache/local] action create\n                   -
      create new directory /var/cache/local\n                   - change mode from
      '' to '0755'\n                   - change owner from '' to 'root'\n                   -
      change group from '' to 'root'\n                 * directory[/var/cache/local/preseeding]
      action create\n                   - create new directory /var/cache/local/preseeding\n
      \                  - change mode from '' to '0755'\n                   - change
      owner from '' to 'root'\n                   - change group from '' to 'root'\n
      \                * template[/etc/apt/apt.conf.d/10recommends] action create\n
      \                  - create new file /etc/apt/apt.conf.d/10recommends\n                   -
      update content in file /etc/apt/apt.conf.d/10recommends from none to f41e1d\n
      \                  --- /etc/apt/apt.conf.d/10recommends  2016-07-18 23:55:56.000457824
      +0000\n                   +++ /etc/apt/apt.conf.d/.chef-10recommends20160718-1515-3zz55e
      \ 2016-07-18 23:55:56.000457824 +0000\n                   @@ -1 +1,4 @@\n                   +#
      Managed by Chef\n                   +APT::Install-Recommends \"1\";\n                   +APT::Install-Suggests
      \"0\";\n                   - change mode from '' to '0644'\n                   -
      change owner from '' to 'root'\n                   - change group from '' to
      'root'\n                 * apt_package[apt-transport-https] action install (up
      to date)\n               Recipe: chef-apt-docker::default\n                 *
      apt_repository[docker] action add\n                   * execute[install-key
      58118E89F3A912897C070ADBF76221572C52609D] action run\n\n                     ================================================================================\n
      \                    Error executing action `run` on resource 'execute[install-key
      58118E89F3A912897C070ADBF76221572C52609D]'\n                     ================================================================================\n\n
      \                    Mixlib::ShellOut::ShellCommandFailed\n                     ------------------------------------\n
      \                    Expected process to exit with [0], but received '2'\n                     ----
      Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D ----\n                     STDOUT:
      Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir
      /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg
      --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D\n                     gpgkeys: key
      58118E89F3A912897C070ADBF76221572C52609D can't be retrieved\n                     STDERR:
      gpg: requesting key 2C52609D from hkp server p80.pool.sks-keyservers.net\n                     gpg:
      no valid OpenPGP data found.\n                     gpg: Total number processed:
      0\n                     ---- End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D ----\n                     Ran apt-key
      adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
      returned 2\n\n                     Cookbook Trace:\n                     ---------------\n
      \                    /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n                     /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n\n                     Resource Declaration:\n                     ---------------------\n
      \                    # In /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb\n\n
      \                    201:         declare_resource(:execute, \"install-key #{key}\")
      do\n                     202:           command cmd\n                     203:
      \          sensitive new_resource.sensitive\n                     204:           not_if
      do\n                     205:             present = extract_fingerprints_from_cmd(\"apt-key
      finger\").any? do |fp|\n                     206:               fp.end_with?
      key.upcase\n                     207:             end\n                     208:
      \            present && key_is_valid?(\"apt-key list\", key.upcase)\n                     209:
      \          end\n                     210:           notifies :run, \"execute[apt-cache
      gencaches]\", :immediately\n                     211:         end\n                     212:\n\n
      \                    Compiled Resource:\n                     ------------------\n
      \                    # Declared in /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb:201:in
      `install_key_from_keyserver'\n\n                     execute(\"install-key 58118E89F3A912897C070ADBF76221572C52609D\")
      do\n                action [:run]\n                retries 0\n                retry_delay
      2\n                default_guard_interpreter :execute\n                command
      \"apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D\"\n
      \               backup 5\n                returns 0\n                declared_type
      :execute\n                cookbook_name \"chef-apt-docker\"\n                not_if
      { #code block }\n                     end\n\n                     Platform:\n
      \                    ---------\n                     x86_64-linux\n\n\n                   ================================================================================\n
      \                  Error executing action `add` on resource 'apt_repository[docker]'\n
      \                  ================================================================================\n\n
      \                  Mixlib::ShellOut::ShellCommandFailed\n                   ------------------------------------\n
      \                  execute[install-key 58118E89F3A912897C070ADBF76221572C52609D]
      (/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb
      line 201) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process
      to exit with [0], but received '2'\n                   ---- Begin output of
      apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
      ----\n                   STDOUT: Executing: gpg --ignore-time-conflict --no-options
      --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model
      always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg
      --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D\n
      \                  gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't
      be retrieved\n                   STDERR: gpg: requesting key 2C52609D from hkp
      server p80.pool.sks-keyservers.net\n                   gpg: no valid OpenPGP
      data found.\n                   gpg: Total number processed: 0\n                   ----
      End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D ----\n                   Ran apt-key
      adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
      returned 2\n\n                   Cookbook Trace:\n                   ---------------\n
      \                  /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n                   /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n\n                   Resource Declaration:\n                   ---------------------\n
      \                  # In /tmp/kitchen/cache/cookbooks/chef-apt-docker/recipes/default.rb\n\n
      \                   20: apt_repository 'docker' do\n                    21:
      \  uri 'https://apt.dockerproject.org/repo'\n                    22:   distribution
      \"#{node['platform']}-#{node['lsb']['codename']}\"\n                    23:
      \  keyserver 'p80.pool.sks-keyservers.net'\n                    24:   components
      node['chef-apt-docker']['components']\n                    25:   key '58118E89F3A912897C070ADBF76221572C52609D'\n
      \                   26: end\n\n                   Compiled Resource:\n                   ------------------\n
      \                  # Declared in /tmp/kitchen/cache/cookbooks/chef-apt-docker/recipes/default.rb:20:in
      `from_file'\n\n                   apt_repository(\"docker\") do\n                     action
      [:add]\n                     retries 0\n                     retry_delay 2\n
      \                    default_guard_interpreter :default\n                     declared_type
      :apt_repository\n                     cookbook_name \"chef-apt-docker\"\n                     recipe_name
      \"default\"\n                     uri \"https://apt.dockerproject.org/repo\"\n
      \                    distribution \"ubuntu-trusty\"\n                     keyserver
      \"p80.pool.sks-keyservers.net\"\n                     components [\"main\"]\n
      \                    key \"58118E89F3A912897C070ADBF76221572C52609D\"\n                     cache_rebuild
      true\n                   end\n\n                   Platform:\n                   ---------\n
      \                  x86_64-linux\n\n               Starting audit phase\n\n               Finished
      in 0.00027 seconds (files took 0.2757 seconds to load)\n               0 examples,
      0 failures\n               Auditing complete\n\n               Running handlers:\n
      \              [2016-07-18T23:55:57+00:00] ERROR: Running exception handlers\n
      \              Running handlers complete\n               [2016-07-18T23:55:57+00:00]
      ERROR: Exception handlers complete\n               Chef Client failed. 5 resources
      updated in 17 seconds\n               [2016-07-18T23:55:57+00:00] ERROR: Failed
      to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json\n
      \              [2016-07-18T23:55:57+00:00] FATAL: Stacktrace dumped to /tmp/kitchen/cache/chef-stacktrace.out\n
      \              [2016-07-18T23:55:57+00:00] FATAL: Please provide the contents
      of the stacktrace.out file if you file a bug report\n               [2016-07-18T23:55:57+00:00]
      ERROR: Found 1 errors, they are stored in the backtrace\n               [2016-07-18T23:55:58+00:00]
      FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully
      (exit code 1)\n        D      Cleaning up local sandbox in /tmp/cheftest/docker-default-ubuntu-1404-sandbox-20160718-27889-16j7fbk\n
      \       D      [SSH] shutting previous connection ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n        D      [SSH] closing
      connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\", :paranoid=>false,
      :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60,
      :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n        D      Converge
      failed on instance <docker-default-ubuntu-1404>.\n        D      ------Exception-------\n
      \       D      Class: Kitchen::InstanceFailure\n        D      Message: Converge
      failed on instance <docker-default-ubuntu-1404>.  Please see .kitchen/logs/docker-default-ubuntu-1404.log
      for more details\n        D      ----------------------\n        D      ------Backtrace-------\n
      \       D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:76:in
      `rescue in call'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:79:in
      `call'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:373:in
      `block in converge_action'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `call'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `synchronize_or_call'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:478:in
      `block in action'\n        D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in
      `measure'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:477:in
      `action'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:369:in
      `converge_action'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:348:in
      `block in transition_to'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `each'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `transition_to'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:138:in
      `converge'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `public_send'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `run_action_in_thread'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:173:in
      `block (2 levels) in run_action'\n        D      ----End Backtrace-----\n        D
      \     ---Nested Exception---\n        D      Class: Kitchen::ActionFailed\n
      \       D      Message: SSH exited (1) for command: [sh -c '\n        sudo -E
      /opt/chefdk/bin/chef-client --local-mode --config /tmp/kitchen/client.rb --log_level
      auto --force-formatter --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port
      8889\n        ']\n        D      ----------------------\n        D      ------Backtrace-------\n
      \       D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:76:in
      `rescue in call'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:79:in
      `call'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:373:in
      `block in converge_action'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `call'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `synchronize_or_call'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:478:in
      `block in action'\n        D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in
      `measure'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:477:in
      `action'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:369:in
      `converge_action'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:348:in
      `block in transition_to'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `each'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `transition_to'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:138:in
      `converge'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `public_send'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `run_action_in_thread'\n        D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:173:in
      `block (2 levels) in run_action'\n        D      ----End Backtrace-----\n        STDERR:
      >>>>>> Converge failed on instance <docker-default-ubuntu-1404>.\n        >>>>>>
      Please see .kitchen/logs/docker-default-ubuntu-1404.log for more details\n        >>>>>>
      ------Exception-------\n        >>>>>> Class: Kitchen::ActionFailed\n        >>>>>>
      Message: SSH exited (1) for command: [sh -c '\n        sudo -E /opt/chefdk/bin/chef-client
      --local-mode --config /tmp/kitchen/client.rb --log_level auto --force-formatter
      --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889\n        ']\n
      \       >>>>>> ----------------------\n        ---- End output of bundle exec
      kitchen converge  -c -l debug ----\n        Ran bundle exec kitchen converge
      \ -c -l debug returned 10\n\n        Resource Declaration:\n        ---------------------\n
      \       # In /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb\n\n
      \        36:       execute \"bundle exec kitchen #{command}#{instances ? \"
      #{instances}\" : \"\"}#{kitchen_options ? \" #{kitchen_options}\" : \"\"}\"
      do\n         37:         cwd kitchen_dir\n         38:         env({\n         39:
      \          \"KITCHEN_DRIVER\" => driver,\n         40:           \"KITCHEN_INSTANCES\"
      => instances,\n         41:           \"KITCHEN_LOCAL_YAML\" => ::File.expand_path(\"../../.kitchen.#{driver}.yml\",
      __FILE__),\n         42:           \"KITCHEN_CHEF_PRODUCT\" => chef_product,\n
      \        43:           \"KITCHEN_CHEF_CHANNEL\" => chef_channel,\n         44:
      \          \"KITCHEN_CHEF_VERSION\" => chef_version,\n         45:           \"ARTIFACTORY_USERNAME\"
      => artifactory_username,\n         46:           \"ARTIFACTORY_PASSWORD\" =>
      artifactory_password\n         47:         }.merge(new_resource.env))\n         48:
      \      end\n         49:     end\n\n        Compiled Resource:\n        ------------------\n
      \       # Declared in /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:36:in
      `block in <class:Kitchen>'\n\n        execute(\"bundle exec kitchen converge
      \ -c -l debug\") do\n          action [:run]\n          retries 0\n          retry_delay
      2\n          default_guard_interpreter :execute\n          command \"bundle
      exec kitchen converge  -c -l debug\"\n          backup 5\n          cwd \"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/docker/\"\n
      \         environment {\"KITCHEN_DRIVER\"=>\"ec2\", \"KITCHEN_INSTANCES\"=>\"\",
      \"KITCHEN_LOCAL_YAML\"=>\"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/.kitchen.ec2.yml\",
      \"KITCHEN_CHEF_PRODUCT\"=>\"chefdk\", \"KITCHEN_CHEF_CHANNEL\"=>\"unstable\",
      \"KITCHEN_CHEF_VERSION\"=>\"0.16.30\", \"ARTIFACTORY_USERNAME\"=>\"chef-web-downloads\",
      \"ARTIFACTORY_PASSWORD\"=>\"fWPxYSB69EiuSpl8*3Dr^kGwf#hxUE6cmjeZRB%H!Cruit7qiKp%toH3nXKStQUg\",
      \"BUNDLE_GEMFILE\"=>\"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/Gemfile\",
      \"KITCHEN_YAML\"=>\"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/.kitchen.docker.yml\"}\n
      \         returns 0\n          declared_type :execute\n          cookbook_name
      \"acceptance-cookbook\"\n        end\n\n        Platform:\n        ---------\n
      \       x86_64-linux\n\n\n      ================================================================================\n
      \     Error executing action `run` on resource 'cookbook_kitchen[converge docker]'\n
      \     ================================================================================\n\n
      \     Mixlib::ShellOut::ShellCommandFailed\n      ------------------------------------\n
      \     execute[bundle exec kitchen converge  -c -l debug] (/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb
      line 36) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process
      to exit with [0], but received '10'\n      ---- Begin output of bundle exec
      kitchen converge  -c -l debug ----\n      STDOUT: -----> Starting Kitchen (v1.9.2)\n
      \     D      Berksfile found at /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/docker/Berksfile,
      loading Berkshelf\n      D      Berkshelf 4.3.5 library loaded\n      ----->
      Creating <docker-default-ubuntu-1404>...\n             If you are not using
      an account that qualifies under the AWS\n      free-tier, you may be charged
      to run these suites. The charge\n      should be minimal, but neither Test Kitchen
      nor its maintainers\n      are responsible for your incurred costs.\n\n      D
      \     platform name ubuntu-14.04 appears to be a standard platform. Searching
      for ubuntu 14.04 ...\n      D      Searching for images matching {:name=>\"ubuntu/images/*/ubuntu-*-14.04-*-server-*\",
      :\"owner-id\"=>\"099720109477\", :architecture=>\"x86_64\", :\"virtualization-type\"=>\"hvm\",
      :\"block-device-mapping.volume-type\"=>\"gp2\", :\"image-type\"=>\"machine\"}
      ...\n      D      Search returned 59 images:\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160714:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-07-15T10:37:25.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160627:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-06-29T15:13:53.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160620:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-06-21T12:07:59.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160602:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-06-03T01:17:21.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160516:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-05-17T09:54:45.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160509.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-05-10T11:55:52.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160406:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-04-06T22:01:48.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160314:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-03-15T08:30:56.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160222:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-02-23T13:53:30.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160217.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-02-18T01:37:46.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160201:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-02-02T12:11:43.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160119:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-01-20T12:15:17.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160114.5:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-01-15T22:11:35.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151218:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-12-20T01:45:49.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151217:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-12-18T09:40:49.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151117:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-11-18T08:17:32.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151105:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-11-06T23:03:53.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151019:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-20T09:04:11.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151015:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-15T20:43:54.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151008:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-09T08:48:14.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151007:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-08T08:57:50.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151005:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-06T09:26:41.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150930:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-01T11:24:14.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150928:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-29T11:13:44.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150924:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-25T13:37:47.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150908:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-09T05:59:15.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150901.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-02T05:15:07.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150814:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-15T08:11:39.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150813:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-14T07:14:42.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150812:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-13T08:50:05.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150810:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-11T11:43:49.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150805:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-06T19:29:13.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150731:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-01T09:17:08.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150727:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-07-28T07:13:51.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150724:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-07-25T05:22:13.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150629:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-30T09:14:39.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150609:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-09T17:42:29.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150608:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-09T03:54:29.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150603:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-04T08:13:50.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150528:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-05-29T10:15:24.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150506:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-05-07T08:14:11.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150417:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-04-17T12:06:11.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150408.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-04-09T08:52:15.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150325:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-03-25T23:56:26.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150305:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-03-05T11:02:56.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150227.2:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-02-28T07:15:31.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150225.2:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-02-26T06:03:04.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150209.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-02-10T05:22:56.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150123:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-01-23T10:57:13.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20141125:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-11-26T01:50:28.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140927:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-30T00:19:14.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140926:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-26T16:05:00.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140924:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-25T14:07:23.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140923:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-23T14:15:33.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140829:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-08-29T18:46:07.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140816:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-08-16T22:57:30.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140813:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-08-14T00:50:31.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140724:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-07-25T08:28:59.000Z\n      D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140607.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-07-23T18:05:49.000Z\n      D      Creating EC2 instance
      in region us-west-2 with properties:\n      D      - instance_type = \"m3.large\"\n
      \     D      - ebs_optimized = false\n      D      - image_id = \"ami-d732f0b7\"\n
      \     D      - key_name = \"jenkins\"\n      D      - subnet_id = \"subnet-19ac017c\"\n
      \     D      - private_ip_address = nil\n      D      - placement = {:availability_zone=>\"us-west-2a\"}\n
      \     D      - security_group_ids = [\"sg-e401eb83\", \"sg-96274af3\"]\n             Instance
      <i-666cd4c9> requested.\n             Polling AWS for existence, attempt 0...\n
      \            Attempting to tag the instance, 0 retries\n             EC2 instance
      <i-666cd4c9> created.\n             Waited 0/300s for instance <i-666cd4c9>
      to become ready.\n             Waited 5/300s for instance <i-666cd4c9> to become
      ready.\n             Waited 10/300s for instance <i-666cd4c9> to become ready.\n
      \            Waited 15/300s for instance <i-666cd4c9> to become ready.\n             Waited
      20/300s for instance <i-666cd4c9> to become ready.\n             EC2 instance
      <i-666cd4c9> ready.\n      D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"]}>\n      D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout:
      Net::SSH::ConnectionTimeout>)\n             Waiting for SSH service on 10.194.14.1:22,
      retrying in 3 seconds\n      D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n      D      [SSH] connection
      failed (#<Errno::ECONNREFUSED: Connection refused - connect(2) for 10.194.14.1:22>)\n
      \            Waiting for SSH service on 10.194.14.1:22, retrying in 3 seconds\n
      \     D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n      D      [SSH] connection
      failed (#<Errno::ECONNREFUSED: Connection refused - connect(2) for 10.194.14.1:22>)\n
      \            Waiting for SSH service on 10.194.14.1:22, retrying in 3 seconds\n
      \     D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n      D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (echo '[SSH] Established')\n
      \            [SSH] Established\n      D      Using sudo_command='sudo -E' for
      ohai hints\n      D      [SSH] reusing existing connection ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n      D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sudo -E mkdir -p /etc/chef/ohai/hints;
      sudo -E touch /etc/chef/ohai/hints/ec2.json)\n      D      ec2:create '10.194.14.1'\n
      \            Finished creating <docker-default-ubuntu-1404> (0m51.84s).\n      ----->
      Converging <docker-default-ubuntu-1404>...\n             Preparing files for
      transfer\n      D      Creating local sandbox in /tmp/cheftest/docker-default-ubuntu-1404-sandbox-20160718-27889-16j7fbk\n
      \            Preparing dna.json\n      D      Creating dna.json from {:chef_acceptance=>\"true\",
      :use_system_chef=>\"true\", :docker=>{:version=>\"1.10.0\"}, :run_list=>[\"recipe[apt]\",
      \"recipe[chef-apt-docker]\"]}\n             Resolving cookbook dependencies
      with Berkshelf 4.3.5...\n      D      Using Berksfile from /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/docker/Berksfile\n
      \            Removing non-cookbook files before transfer\n             Preparing
      validation.pem\n      D      Using a dummy validation.pem\n             Preparing
      client.rb\n      D      Creating client.rb from {:node_name=>\"docker-default-ubuntu-1404\",
      :checksum_path=>\"/tmp/kitchen/checksums\", :file_cache_path=>\"/tmp/kitchen/cache\",
      :file_backup_path=>\"/tmp/kitchen/backup\", :cookbook_path=>[\"/tmp/kitchen/cookbooks\",
      \"/tmp/kitchen/site-cookbooks\"], :data_bag_path=>\"/tmp/kitchen/data_bags\",
      :environment_path=>\"/tmp/kitchen/environments\", :node_path=>\"/tmp/kitchen/nodes\",
      :role_path=>\"/tmp/kitchen/roles\", :client_path=>\"/tmp/kitchen/clients\",
      :user_path=>\"/tmp/kitchen/users\", :validation_key=>\"/tmp/kitchen/validation.pem\",
      :client_key=>\"/tmp/kitchen/client.pem\", :chef_server_url=>\"http://127.0.0.1:8889\",
      :encrypted_data_bag_secret=>\"/tmp/kitchen/encrypted_data_bag_secret\", :audit_mode=>\":enabled\",
      :named_run_list=>{}}\n      D      [SSH] reusing existing connection ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n      D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sudo -E cat > /tmp/chef-installer.sh
      <<\"EOL\"\n      #!/bin/bash\n      #!/bin/sh\n      # WARNING: REQUIRES /bin/sh\n
      \     #\n      # - must run on /bin/sh on solaris 9\n      # - must run on /bin/sh
      on AIX 6.x\n      #\n      # Copyright:: Copyright (c) 2010-2015 Chef Software,
      Inc.\n      # License:: Apache License, Version 2.0\n      #\n      # Licensed
      under the Apache License, Version 2.0 (the \"License\");\n      # you may not
      use this file except in compliance with the License.\n      # You may obtain
      a copy of the License at\n      #\n      #     http://www.apache.org/licenses/LICENSE-2.0\n
      \     #\n      # Unless required by applicable law or agreed to in writing,
      software\n      # distributed under the License is distributed on an \"AS IS\"
      BASIS,\n      # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
      or implied.\n      # See the License for the specific language governing permissions
      and\n      # limitations under the License.\n      #\n\n      # helpers.sh\n
      \     ############\n      # This section has some helper functions to make life
      easier.\n      #\n      # Outputs:\n      # $tmp_dir: secure-ish temp directory
      that can be used during installation.\n      ############\n\n      # Check whether
      a command exists - returns 0 if it does, 1 if it does not\n      exists() {\n
      \       if command -v $1 >/dev/null 2>&1\n        then\n          return 0\n
      \       else\n          return 1\n        fi\n      }\n\n      # Output the
      instructions to report bug about this script\n      report_bug() {\n        echo
      \"Version: $version\"\n        echo \"\"\n        echo \"Please file a Bug Report
      at https://github.com/chef/omnitruck/issues/new\"\n        echo \"Alternatively,
      feel free to open a Support Ticket at https://www.chef.io/support/tickets\"\n
      \       echo \"More Chef support resources can be found at https://www.chef.io/support\"\n
      \       echo \"\"\n        echo \"Please include as many details about the problem
      as possible i.e., how to reproduce\"\n        echo \"the problem (if possible),
      type of the Operating System and its version, etc.,\"\n        echo \"and any
      other relevant details that might help us with troubleshooting.\"\n        echo
      \"\"\n      }\n\n      checksum_mismatch() {\n        echo \"Package checksum
      mismatch!\"\n        report_bug\n        exit 1\n      }\n\n      unable_to_retrieve_package()
      {\n        echo \"Unable to retrieve a valid package!\"\n        report_bug\n
      \       echo \"Metadata URL: $metadata_url\"\n        if test \"x$download_url\"
      != \"x\"; then\n          echo \"Download URL: $download_url\"\n        fi\n
      \       if test \"x$stderr_results\" != \"x\"; then\n          echo \"\\nDEBUG
      OUTPUT FOLLOWS:\\n$stderr_results\"\n        fi\n        exit 1\n      }\n\n
      \     http_404_error() {\n        echo \"Omnitruck artifact does not exist for
      version $version on platform $platform\"\n        echo \"\"\n        echo \"Either
      this means:\"\n        echo \"   - We do not support $platform\"\n        echo
      \"   - We do not have an artifact for $version\"\n        echo \"\"\n        echo
      \"This is often the latter case due to running a prerelease or RC version of
      chef\"\n        echo \"or a gem version which was only pushed to rubygems and
      not omnitruck.\"\n        echo \"\"\n        echo \"You may be able to set your
      knife[:bootstrap_version] to the most recent stable\"\n        echo \"release
      of Chef to fix this problem (or the most recent stable major version number).\"\n
      \       echo \"\"\n        echo \"In order to test the version parameter, adventurous
      users may take the Metadata URL\"\n        echo \"below and modify the '&v=<number>'
      parameter until you successfully get a URL that\"\n        echo \"does not 404
      (e.g. via curl or wget).  You should be able to use '&v=11' or '&v=12'\"\n        echo
      \"succesfully.\"\n        echo \"\"\n        echo \"If you cannot fix this problem
      by setting the bootstrap_version, it probably means\"\n        echo \"that $platform
      is not supported.\"\n        echo \"\"\n        # deliberately do not call report_bug
      to suppress bug report noise.\n        echo \"Metadata URL: $metadata_url\"\n
      \       if test \"x$download_url\" != \"x\"; then\n          echo \"Download
      URL: $download_url\"\n        fi\n        if test \"x$stderr_results\" != \"x\";
      then\n          echo \"\\nDEBUG OUTPUT FOLLOWS:\\n$stderr_results\"\n        fi\n
      \       exit 1\n      }\n\n      capture_tmp_stderr() {\n        # spool up
      /tmp/stderr from all the commands we called\n        if test -f \"$tmp_dir/stderr\";
      then\n          output=`cat $tmp_dir/stderr`\n          stderr_results=\"${stderr_results}\\nSTDERR
      from $1:\\n\\n$output\\n\"\n          rm $tmp_dir/stderr\n        fi\n      }\n\n
      \     # do_wget URL FILENAME\n      do_wget() {\n        echo \"trying wget...\"\n
      \       wget -O \"$2\" \"$1\" 2>$tmp_dir/stderr\n        rc=$?\n        # check
      for 404\n        grep \"ERROR 404\" $tmp_dir/stderr 2>&1 >/dev/null\n        if
      test $? -eq 0; then\n          echo \"ERROR 404\"\n          http_404_error\n
      \       fi\n\n        # check for bad return status or empty output\n        if
      test $rc -ne 0 || test ! -s \"$2\"; then\n          capture_tmp_stderr \"wget\"\n
      \         return 1\n        fi\n\n        return 0\n      }\n\n      # do_curl
      URL FILENAME\n      do_curl() {\n        echo \"trying curl...\"\n        curl
      --retry 5 -sL -D $tmp_dir/stderr \"$1\" > \"$2\"\n        rc=$?\n        # check
      for 404\n        grep \"404 Not Found\" $tmp_dir/stderr 2>&1 >/dev/null\n        if
      test $? -eq 0; then\n          echo \"ERROR 404\"\n          http_404_error\n
      \       fi\n\n        # check for bad return status or empty output\n        if
      test $rc -ne 0 || test ! -s \"$2\"; then\n          capture_tmp_stderr \"curl\"\n
      \         return 1\n        fi\n\n        return 0\n      }\n\n      # do_fetch
      URL FILENAME\n      do_fetch() {\n        echo \"trying fetch...\"\n        fetch
      -o \"$2\" \"$1\" 2>$tmp_dir/stderr\n        # check for bad return status\n
      \       test $? -ne 0 && return 1\n        return 0\n      }\n\n      # do_perl
      URL FILENAME\n      do_perl() {\n        echo \"trying perl...\"\n        perl
      -e 'use LWP::Simple; getprint($ARGV[0]);' \"$1\" > \"$2\" 2>$tmp_dir/stderr\n
      \       rc=$?\n        # check for 404\n        grep \"404 Not Found\" $tmp_dir/stderr
      2>&1 >/dev/null\n        if test $? -eq 0; then\n          echo \"ERROR 404\"\n
      \         http_404_error\n        fi\n\n        # check for bad return status
      or empty output\n        if test $rc -ne 0 || test ! -s \"$2\"; then\n          capture_tmp_stderr
      \"perl\"\n          return 1\n        fi\n\n        return 0\n      }\n\n      #
      do_python URL FILENAME\n      do_python() {\n        echo \"trying python...\"\n
      \       python -c \"import sys,urllib2 ; sys.stdout.write(urllib2.urlopen(sys.argv[1]).read())\"
      \"$1\" > \"$2\" 2>$tmp_dir/stderr\n        rc=$?\n        # check for 404\n
      \       grep \"HTTP Error 404\" $tmp_dir/stderr 2>&1 >/dev/null\n        if
      test $? -eq 0; then\n          echo \"ERROR 404\"\n          http_404_error\n
      \       fi\n\n        # check for bad return status or empty output\n        if
      test $rc -ne 0 || test ! -s \"$2\"; then\n          capture_tmp_stderr \"python\"\n
      \         return 1\n        fi\n        return 0\n      }\n\n      # returns
      0 if checksums match\n      do_checksum() {\n        if exists sha256sum; then\n
      \         echo \"Comparing checksum with sha256sum...\"\n          checksum=`sha256sum
      $1 | awk '{ print $1 }'`\n          return `test \"x$checksum\" = \"x$2\"`\n
      \       elif exists shasum; then\n          echo \"Comparing checksum with shasum...\"\n
      \         checksum=`shasum -a 256 $1 | awk '{ print $1 }'`\n          return
      `test \"x$checksum\" = \"x$2\"`\n        else\n          echo \"WARNING: could
      not find a valid checksum program, pre-install shasum or sha256sum in your O/S
      image to get valdation...\"\n          return 0\n        fi\n      }\n\n      #
      do_download URL FILENAME\n      do_download() {\n        echo \"downloading
      $1\"\n        echo \"  to file $2\"\n\n        url=`echo $1`\n        if test
      \"x$platform\" = \"xsolaris2\"; then\n          if test \"x$platform_version\"
      = \"x5.9\" -o \"x$platform_version\" = \"x5.10\"; then\n            # solaris
      9 lacks openssl, solaris 10 lacks recent enough credentials - your base O/S
      is completely insecure, please upgrade\n            url=`echo $url | sed -e
      's/https/http/'`\n          fi\n        fi\n\n        # we try all of these
      until we get success.\n        # perl, in particular may be present but LWP::Simple
      may not be installed\n\n        if exists wget; then\n          do_wget $url
      $2 && return 0\n        fi\n\n        if exists curl; then\n          do_curl
      $url $2 && return 0\n        fi\n\n        if exists fetch; then\n          do_fetch
      $url $2 && return 0\n        fi\n\n        if exists perl; then\n          do_perl
      $url $2 && return 0\n        fi\n\n        if exists python; then\n          do_python
      $url $2 && return 0\n        fi\n\n        unable_to_retrieve_package\n      }\n\n
      \     # install_file TYPE FILENAME\n      # TYPE is \"rpm\", \"deb\", \"solaris\",
      \"sh\", etc.\n      install_file() {\n        echo \"Installing $project $version\"\n
      \       case \"$1\" in\n          \"rpm\")\n            if test \"x$platform\"
      = \"xnexus\" || test \"x$platform\" = \"xios_xr\"; then\n              echo
      \"installing with yum...\"\n              yum install -yv \"$2\"\n            else\n
      \             echo \"installing with rpm...\"\n              rpm -Uvh --oldpackage
      --replacepkgs \"$2\"\n            fi\n            ;;\n          \"deb\")\n            echo
      \"installing with dpkg...\"\n            dpkg -i \"$2\"\n            ;;\n          \"bff\")\n
      \           echo \"installing with installp...\"\n            installp -aXYgd
      \"$2\" all\n            ;;\n          \"solaris\")\n            echo \"installing
      with pkgadd...\"\n            echo \"conflict=nocheck\" > $tmp_dir/nocheck\n
      \           echo \"action=nocheck\" >> $tmp_dir/nocheck\n            echo \"mail=\"
      >> $tmp_dir/nocheck\n            pkgrm -a $tmp_dir/nocheck -n $project >/dev/null
      2>&1 || true\n            pkgadd -G -n -d \"$2\" -a $tmp_dir/nocheck $project\n
      \           ;;\n          \"pkg\")\n            echo \"installing with installer...\"\n
      \           cd / && /usr/sbin/installer -pkg \"$2\" -target /\n            ;;\n
      \         \"dmg\")\n            echo \"installing dmg file...\"\n            hdiutil
      detach \"/Volumes/chef_software\" >/dev/null 2>&1 || true\n            hdiutil
      attach \"$2\" -mountpoint \"/Volumes/chef_software\"\n            cd / && /usr/sbin/installer
      -pkg `find \"/Volumes/chef_software\" -name \\*.pkg` -target /\n            hdiutil
      detach \"/Volumes/chef_software\"\n            ;;\n          \"sh\" )\n            echo
      \"installing with sh...\"\n            sh \"$2\"\n            ;;\n          *)\n
      \           echo \"Unknown filetype: $1\"\n            report_bug\n            exit
      1\n            ;;\n        esac\n        if test $? -ne 0; then\n          echo
      \"Installation failed\"\n          report_bug\n          exit 1\n        fi\n
      \     }\n\n      if test \"x$TMPDIR\" = \"x\"; then\n        tmp=\"/tmp\"\n
      \     else\n        tmp=$TMPDIR\n      fi\n      # secure-ish temp dir creation
      without having mktemp available (DDoS-able but not expliotable)\n      tmp_dir=\"$tmp/install.sh.$$\"\n
      \     (umask 077 && mkdir $tmp_dir) || exit 1\n\n      ############\n      #
      end of helpers.sh\n      ############\n\n\n      project=chefdk\n      version=0.16.30\n
      \     channel=unstable\n\n\n      # platform_detection.sh\n      ############\n
      \     # This section makes platform detection compatible with omnitruck on the
      system\n      #   it runs.\n      #\n      # Outputs:\n      # $platform: Name
      of the platform.\n      # $platform_version: Version of the platform.\n      #
      $machine: System's architecture.\n      ############\n\n      #\n      # Platform
      and Platform Version detection\n      #\n      # NOTE: This should now match
      ohai platform and platform_version matching.\n      # do not invented new platform
      and platform_version schemas, just make this behave\n      # like what ohai
      returns as platform and platform_version for the server.\n      #\n      # ALSO
      NOTE: Do not mangle platform or platform_version here.  It is less error\n      #
      prone and more future-proof to do that in the server, and then all omnitruck
      clients\n      # will 'inherit' the changes (install.sh is not the only client
      of the omnitruck\n      # endpoint out there).\n      #\n\n      machine=`uname
      -m`\n      os=`uname -s`\n\n      if test -f \"/etc/lsb-release\" && grep -q
      DISTRIB_ID /etc/lsb-release && ! grep -q wrlinux /etc/lsb-release; then\n        platform=`grep
      DISTRIB_ID /etc/lsb-release | cut -d \"=\" -f 2 | tr '[A-Z]' '[a-z]'`\n        platform_version=`grep
      DISTRIB_RELEASE /etc/lsb-release | cut -d \"=\" -f 2`\n      elif test -f \"/etc/debian_version\";
      then\n        platform=\"debian\"\n        platform_version=`cat /etc/debian_version`\n
      \     elif test -f \"/etc/redhat-release\"; then\n        platform=`sed 's/^\\(.\\+\\)
      release.*/\\1/' /etc/redhat-release | tr '[A-Z]' '[a-z]'`\n        platform_version=`sed
      's/^.\\+ release \\([.0-9]\\+\\).*/\\1/' /etc/redhat-release`\n\n        # If
      /etc/redhat-release exists, we act like RHEL by default\n        if test \"$platform\"
      = \"fedora\"; then\n          # FIXME: stop remapping fedora to el\n          #
      FIXME: remove client side platform_version mangling and hard coded yolo\n          #
      Change platform version for use below.\n          platform_version=\"6.0\"\n
      \       fi\n\n        if test \"$platform\" = \"xenserver\"; then\n          #
      Current XenServer 6.2 is based on CentOS 5, platform is not reset to \"el\"
      server should hanlde response\n          platform=\"xenserver\"\n        else\n
      \         # FIXME: use \"redhat\"\n          platform=\"el\"\n        fi\n\n
      \     elif test -f \"/etc/system-release\"; then\n        platform=`sed 's/^\\(.\\+\\)
      release.\\+/\\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`\n        platform_version=`sed
      's/^.\\+ release \\([.0-9]\\+\\).*/\\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`\n
      \       # amazon is built off of fedora, so act like RHEL\n        if test \"$platform\"
      = \"amazon linux ami\"; then\n          # FIXME: remove client side platform_version
      mangling and hard coded yolo, and remapping to deprecated \"el\"\n          platform=\"el\"\n
      \         platform_version=\"6.0\"\n        fi\n      # Apple OS X\n      elif
      test -f \"/usr/bin/sw_vers\"; then\n        platform=\"mac_os_x\"\n        #
      Matching the tab-space with sed is error-prone\n        platform_version=`sw_vers
      | awk '/^ProductVersion:/ { print $2 }' | cut -d. -f1,2`\n\n        # x86_64
      Apple hardware often runs 32-bit kernels (see OHAI-63)\n        x86_64=`sysctl
      -n hw.optional.x86_64`\n        if test $x86_64 -eq 1; then\n          machine=\"x86_64\"\n
      \       fi\n      elif test -f \"/etc/release\"; then\n        machine=`/usr/bin/uname
      -p`\n        if grep -q SmartOS /etc/release; then\n          platform=\"smartos\"\n
      \         platform_version=`grep ^Image /etc/product | awk '{ print $3 }'`\n
      \       else\n          platform=\"solaris2\"\n          platform_version=`/usr/bin/uname
      -r`\n        fi\n      elif test -f \"/etc/SuSE-release\"; then\n        if
      grep -q 'Enterprise' /etc/SuSE-release;\n        then\n            platform=\"sles\"\n
      \           platform_version=`awk '/^VERSION/ {V = $3}; /^PATCHLEVEL/ {P = $3};
      END {print V \".\" P}' /etc/SuSE-release`\n        else\n            platform=\"suse\"\n
      \           platform_version=`awk '/^VERSION =/ { print $3 }' /etc/SuSE-release`\n
      \       fi\n      elif test \"x$os\" = \"xFreeBSD\"; then\n        platform=\"freebsd\"\n
      \       platform_version=`uname -r | sed 's/-.*//'`\n      elif test \"x$os\"
      = \"xAIX\"; then\n        platform=\"aix\"\n        platform_version=\"`uname
      -v`.`uname -r`\"\n        machine=\"powerpc\"\n      elif test -f \"/etc/os-release\";
      then\n        . /etc/os-release\n        if test \"x$CISCO_RELEASE_INFO\" !=
      \"x\"; then\n          . $CISCO_RELEASE_INFO\n        fi\n\n        platform=$ID\n
      \       platform_version=$VERSION\n      fi\n\n      if test \"x$platform\"
      = \"x\"; then\n        echo \"Unable to determine platform version!\"\n        report_bug\n
      \       exit 1\n      fi\n\n      #\n      # NOTE: platform manging in the install.sh
      is DEPRECATED\n      #\n      # - install.sh should be true to ohai and should
      not remap\n      #   platform or platform versions.\n      #\n      # - remapping
      platform and mangling platform version numbers is\n      #   now the complete
      responsibility of the server-side endpoints\n      #\n\n      major_version=`echo
      $platform_version | cut -d. -f1`\n      case $platform in\n        # FIXME:
      should remove this case statement completely\n        \"el\")\n          # FIXME:
      \ \"el\" is deprecated, should use \"redhat\"\n          platform_version=$major_version\n
      \         ;;\n        \"debian\")\n          if test \"x$major_version\" = \"x5\";
      then\n            # This is here for potential back-compat.\n            # We
      do not have 5 in versions we publish for anymore but we\n            # might
      have it for earlier versions.\n            platform_version=\"6\"\n          else\n
      \           platform_version=$major_version\n          fi\n          ;;\n        \"freebsd\")\n
      \         platform_version=$major_version\n          ;;\n        \"sles\")\n
      \         platform_version=$major_version\n          ;;\n        \"suse\")\n
      \         platform_version=$major_version\n          ;;\n      esac\n\n      #
      normalize the architecture we detected\n      case $machine in\n        \"x86_64\"|\"amd64\"|\"x64\")\n
      \         machine=\"x86_64\"\n          ;;\n        \"i386\"|\"i86pc\"|\"x86\"|\"i686\")\n
      \         machine=\"i386\"\n          ;;\n        \"sparc\"|\"sun4u\"|\"sun4v\")\n
      \         machine=\"sparc\"\n          ;;\n      esac\n\n      if test \"x$platform_version\"
      = \"x\"; then\n        echo \"Unable to determine platform version!\"\n        report_bug\n
      \       exit 1\n      fi\n\n      if test \"x$platform\" = \"xsolaris2\"; then\n
      \       # hack up the path on Solaris to find wget, pkgadd\n        PATH=/usr/sfw/bin:/usr/sbin:$PATH\n
      \       export PATH\n      fi\n\n      echo \"$platform $platform_version $machine\"\n\n
      \     ############\n      # end of platform_detection.sh\n      ############\n\n\n
      \     # artifactory_urls.sh\n      ############\n      # This section sets up
      the information for a build to be installed from artifactory\n      #  then
      uses $platform, $platform_version and $machine to select the correct\n      #
      \ version.\n      #\n      # Inputs:\n      # $platform:\n      # $platform_version:\n
      \     # $machine:\n      #\n      # Outputs:\n      # $download_url:\n      #
      $sha256:\n      ############\n\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/mac_os_x/10.9/x86_64\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/mac_os_x/10.9/chefdk-0.16.30-1.dmg\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 4d4b8adb26f90b572e11b7779dc5528b3de3f25033aa62d1cb64f059f04b566b\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/mac_os_x/10.10/x86_64\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/mac_os_x/10.10/chefdk-0.16.30-1.dmg\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 4d4b8adb26f90b572e11b7779dc5528b3de3f25033aa62d1cb64f059f04b566b\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/mac_os_x/10.11/x86_64\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/mac_os_x/10.11/chefdk-0.16.30-1.dmg\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 4d4b8adb26f90b572e11b7779dc5528b3de3f25033aa62d1cb64f059f04b566b\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/el/7/x86_64\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/el/7/chefdk-0.16.30-1.el7.x86_64.rpm\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 7d1aad0a56c33ef381565f29a9fd0dfaf535417b8bfa0d861f9677e0859df099\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/windows/2008r2/i386\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/windows/2008r2/chefdk-0.16.30-1-x86.msi\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 491074e24b0db0d42dd7b1ca998d7c7c80a18ff9e9b35b50c1c87409e9b851bc\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/windows/2012/i386\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/windows/2012/chefdk-0.16.30-1-x86.msi\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 491074e24b0db0d42dd7b1ca998d7c7c80a18ff9e9b35b50c1c87409e9b851bc\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/ubuntu/12.04/x86_64\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/ubuntu/12.04/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 9e4b9a102e8616169ee38c8cdceb8bfb1cf97d2b4323859ea91c805a044c7523\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/ubuntu/14.04/x86_64\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/ubuntu/14.04/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 9e4b9a102e8616169ee38c8cdceb8bfb1cf97d2b4323859ea91c805a044c7523\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/windows/2012r2/i386\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/windows/2012r2/chefdk-0.16.30-1-x86.msi\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 491074e24b0db0d42dd7b1ca998d7c7c80a18ff9e9b35b50c1c87409e9b851bc\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/el/6/x86_64\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/el/6/chefdk-0.16.30-1.el6.x86_64.rpm\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 d04a13de502ec9278dd4887c5b484536cb8e2293808d32d929adbe3670ac58c4\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/debian/6/x86_64\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/debian/6/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 91f6a25372e69e58d1dfc0370c5e381e834594bb36cfd3f0dc073872707d46f1\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/debian/7/x86_64\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/debian/7/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 91f6a25372e69e58d1dfc0370c5e381e834594bb36cfd3f0dc073872707d46f1\"
      >> \"$artifact_info_dir/artifact_info\"\n\n        artifact_info_dir=\"$tmp_dir/artifact_info/debian/8/x86_64\"\n
      \       mkdir -p $artifact_info_dir\n        touch \"$artifact_info_dir/artifact_info\"\n
      \       echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/debian/8/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n        echo \"sha256 91f6a25372e69e58d1dfc0370c5e381e834594bb36cfd3f0dc073872707d46f1\"
      >> \"$artifact_info_dir/artifact_info\"\n\n\n      artifact_info_for_platform=\"$tmp_dir/artifact_info/$platform/$platform_version/$machine/artifact_info\"\n\n
      \     download_url=`awk '$1 == \"url\" { print $2 }' \"$artifact_info_for_platform\"`\n
      \     sha256=`awk '$1 == \"sha256\" { print $2 }' \"$artifact_info_for_platform\"`\n\n\n
      \     # fetch_package.sh\n      ############\n      # This section fetchs a
      package from $download_url and verifies its metadata.\n      #\n      # Inputs:\n
      \     # $download_url:\n      # $tmp_dir:\n      # Optional Inputs:\n      #
      $cmdline_filename: Name of the package downloaded on local disk.\n      # $cmdline_dl_dir:
      Name of the directory downloaded package will be saved to on local disk.\n      #\n
      \     # Outputs:\n      # $download_filename: Name of the downloaded file on
      local disk.\n      # $filetype: Type of the file downloaded.\n      ############\n\n
      \     filename=`echo $download_url | sed -e 's/^.*\\///'`\n      filetype=`echo
      $filename | sed -e 's/^.*\\.//'`\n\n      # use either $tmp_dir, the provided
      directory (-d) or the provided filename (-f)\n      if test \"x$cmdline_filename\"
      != \"x\"; then\n        download_filename=\"$cmdline_filename\"\n      elif
      test \"x$cmdline_dl_dir\" != \"x\"; then\n        download_filename=\"$cmdline_dl_dir/$filename\"\n
      \     else\n        download_filename=\"$tmp_dir/$filename\"\n      fi\n\n      #
      ensure the parent directory where to download the installer always exists\n
      \     download_dir=`dirname $download_filename`\n      (umask 077 && mkdir -p
      $download_dir) || exit 1\n\n      # check if we have that file locally available
      and if so verify the checksum\n      cached_file_available=\"false\"\n      if
      test -f $download_filename; then\n        echo \"$download_filename already
      exists, verifiying checksum...\"\n        if do_checksum \"$download_filename\"
      \"$sha256\"; then\n          echo \"checksum compare succeeded, using existing
      file!\"\n          cached_file_available=\"true\"\n        else\n          echo
      \"checksum mismatch, downloading latest version of the file\"\n        fi\n
      \     fi\n\n      # download if no local version of the file available\n      if
      test \"x$cached_file_available\" != \"xtrue\"; then\n        do_download \"$download_url\"
      \ \"$download_filename\"\n        do_checksum \"$download_filename\" \"$sha256\"
      || checksum_mismatch\n      fi\n\n      ############\n      # end of fetch_package.sh\n
      \     ############\n\n\n      # install_package.sh\n      ############\n      #
      Installs a package and removed the temp directory.\n      #\n      # Inputs:\n
      \     # $download_filename: Name of the file to be installed.\n      # $filetype:
      Type of the file to be installed.\n      # $version: The version requested.
      Used only for warning user if not set.\n      ############\n\n      if test
      \"x$version\" = \"x\"; then\n        echo\n        echo \"WARNING WARNING WARNING
      WARNING WARNING WARNING WARNING WARNING WARNING\"\n        echo\n        echo
      \"You are installing an omnibus package without a version pin.  If you are installing\"\n
      \       echo \"on production servers via an automated process this is DANGEROUS
      and you will\"\n        echo \"be upgraded without warning on new releases,
      even to new major releases.\"\n        echo \"Letting the version float is only
      appropriate in desktop, test, development or\"\n        echo \"CI/CD environments.\"\n
      \       echo\n        echo \"WARNING WARNING WARNING WARNING WARNING WARNING
      WARNING WARNING WARNING\"\n        echo\n      fi\n\n      install_file $filetype
      \"$download_filename\"\n\n      if test \"x$tmp_dir\" != \"x\"; then\n        rm
      -r \"$tmp_dir\"\n      fi\n\n      ############\n      # end of install_package.sh\n
      \     ############\n\n      EOL\n      chmod +x /tmp/chef-installer.sh\n      sudo
      -E /tmp/chef-installer.sh)\n             ubuntu 14.04 x86_64\n             downloading
      http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/ubuntu/14.04/chefdk_0.16.30-1_amd64.deb\n
      \              to file /tmp/install.sh.1383/chefdk_0.16.30-1_amd64.deb\n             trying
      wget...\n             Comparing checksum with sha256sum...\n             Installing
      chefdk 0.16.30\n             installing with dpkg...\n             Selecting
      previously unselected package chefdk.\n             (Reading database ... \r(Reading
      database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading
      database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading
      database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading
      database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading
      database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading
      database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading
      database ... 95%\r(Reading database ... 100%\r(Reading database ... 51172 files
      and directories currently installed.)\n             Preparing to unpack .../chefdk_0.16.30-1_amd64.deb
      ...\n             Unpacking chefdk (0.16.30-1) ...\n             Setting up
      chefdk (0.16.30-1) ...\n             Thank you for installing Chef Development
      Kit!\n      D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sh -c '\n      sudo_rm=\"sudo
      -E rm\"\n      dirs=\"/tmp/kitchen/clients /tmp/kitchen/cookbooks /tmp/kitchen/data
      /tmp/kitchen/data_bags /tmp/kitchen/encrypted_data_bag_secret /tmp/kitchen/environments
      /tmp/kitchen/roles\"\n      root_path=\"/tmp/kitchen\"\n\n      $sudo_rm -rf
      $dirs\n      mkdir -p $root_path\n      ')\n             Transferring files
      to <docker-default-ubuntu-1404>\n      D      TIMING: scp async upload (Kitchen::Transport::Ssh)\n
      \     D      TIMING: scp async upload (Kitchen::Transport::Ssh) took (0m7.24s)\n
      \     D      Transfer complete\n      D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sh -c '\n      sudo -E
      /opt/chefdk/bin/chef-client --local-mode --config /tmp/kitchen/client.rb --log_level
      auto --force-formatter --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port
      8889\n      ')\n             Starting Chef Client, version 12.12.15\n             Creating
      a new client identity for docker-default-ubuntu-1404 using the validator key.\n
      \            resolving cookbooks for run list: [\"apt\", \"chef-apt-docker\"]\n
      \            Synchronizing Cookbooks:\n               - apt (4.0.1)\n               -
      chef-apt-docker (1.0.0)\n               - compat_resource (12.10.7)\n             Installing
      Cookbook Gems:\n             Compiling Cookbooks...\n             [2016-07-18T23:55:42+00:00]
      WARN: Chef::Provider::AptRepository already exists!  Cannot create deprecation
      class for LWRP provider apt_repository from cookbook apt\n             [2016-07-18T23:55:42+00:00]
      WARN: AptRepository already exists!  Deprecation class overwrites Custom resource
      apt_repository from cookbook apt\n             Converging 10 resources\n             Recipe:
      apt::default\n               * file[/var/lib/apt/periodic/update-success-stamp]
      action nothing (skipped due to action :nothing)\n               * apt_update[periodic]
      action periodic\n                 - update new lists of packages\n                 *
      directory[/var/lib/apt/periodic] action create (up to date)\n                 *
      directory[/etc/apt/apt.conf.d] action create (up to date)\n                 *
      file[/etc/apt/apt.conf.d/15update-stamp] action create_if_missing (up to date)\n
      \                * execute[apt-get -q update] action run\n                   -
      execute apt-get -q update\n\n               * execute[apt-get update] action
      nothing (skipped due to action :nothing)\n               * execute[apt-get autoremove]
      action nothing (skipped due to action :nothing)\n               * execute[apt-get
      autoclean] action nothing (skipped due to action :nothing)\n               *
      directory[/var/cache/local] action create\n                 - create new directory
      /var/cache/local\n                 - change mode from '' to '0755'\n                 -
      change owner from '' to 'root'\n                 - change group from '' to 'root'\n
      \              * directory[/var/cache/local/preseeding] action create\n                 -
      create new directory /var/cache/local/preseeding\n                 - change
      mode from '' to '0755'\n                 - change owner from '' to 'root'\n
      \                - change group from '' to 'root'\n               * template[/etc/apt/apt.conf.d/10recommends]
      action create\n                 - create new file /etc/apt/apt.conf.d/10recommends\n
      \                - update content in file /etc/apt/apt.conf.d/10recommends from
      none to f41e1d\n                 --- /etc/apt/apt.conf.d/10recommends  2016-07-18
      23:55:56.000457824 +0000\n                 +++ /etc/apt/apt.conf.d/.chef-10recommends20160718-1515-3zz55e
      \ 2016-07-18 23:55:56.000457824 +0000\n                 @@ -1 +1,4 @@\n                 +#
      Managed by Chef\n                 +APT::Install-Recommends \"1\";\n                 +APT::Install-Suggests
      \"0\";\n                 - change mode from '' to '0644'\n                 -
      change owner from '' to 'root'\n                 - change group from '' to 'root'\n
      \              * apt_package[apt-transport-https] action install (up to date)\n
      \            Recipe: chef-apt-docker::default\n               * apt_repository[docker]
      action add\n                 * execute[install-key 58118E89F3A912897C070ADBF76221572C52609D]
      action run\n\n                   ================================================================================\n
      \                  Error executing action `run` on resource 'execute[install-key
      58118E89F3A912897C070ADBF76221572C52609D]'\n                   ================================================================================\n\n
      \                  Mixlib::ShellOut::ShellCommandFailed\n                   ------------------------------------\n
      \                  Expected process to exit with [0], but received '2'\n                   ----
      Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D ----\n                   STDOUT: Executing:
      gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK
      --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg
      --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D\n                   gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D
      can't be retrieved\n                   STDERR: gpg: requesting key 2C52609D
      from hkp server p80.pool.sks-keyservers.net\n                   gpg: no valid
      OpenPGP data found.\n                   gpg: Total number processed: 0\n                   ----
      End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D ----\n                   Ran apt-key
      adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
      returned 2\n\n                   Cookbook Trace:\n                   ---------------\n
      \                  /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n                   /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n\n                   Resource Declaration:\n                   ---------------------\n
      \                  # In /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb\n\n
      \                  201:         declare_resource(:execute, \"install-key #{key}\")
      do\n                   202:           command cmd\n                   203:           sensitive
      new_resource.sensitive\n                   204:           not_if do\n                   205:
      \            present = extract_fingerprints_from_cmd(\"apt-key finger\").any?
      do |fp|\n                   206:               fp.end_with? key.upcase\n                   207:
      \            end\n                   208:             present && key_is_valid?(\"apt-key
      list\", key.upcase)\n                   209:           end\n                   210:
      \          notifies :run, \"execute[apt-cache gencaches]\", :immediately\n                   211:
      \        end\n                   212:\n\n                   Compiled Resource:\n
      \                  ------------------\n                   # Declared in /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb:201:in
      `install_key_from_keyserver'\n\n                   execute(\"install-key 58118E89F3A912897C070ADBF76221572C52609D\")
      do\n              action [:run]\n              retries 0\n              retry_delay
      2\n              default_guard_interpreter :execute\n              command \"apt-key
      adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D\"\n
      \             backup 5\n              returns 0\n              declared_type
      :execute\n              cookbook_name \"chef-apt-docker\"\n              not_if
      { #code block }\n                   end\n\n                   Platform:\n                   ---------\n
      \                  x86_64-linux\n\n\n                 ================================================================================\n
      \                Error executing action `add` on resource 'apt_repository[docker]'\n
      \                ================================================================================\n\n
      \                Mixlib::ShellOut::ShellCommandFailed\n                 ------------------------------------\n
      \                execute[install-key 58118E89F3A912897C070ADBF76221572C52609D]
      (/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb
      line 201) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process
      to exit with [0], but received '2'\n                 ---- Begin output of apt-key
      adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
      ----\n                 STDOUT: Executing: gpg --ignore-time-conflict --no-options
      --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model
      always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg
      --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D\n
      \                gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't
      be retrieved\n                 STDERR: gpg: requesting key 2C52609D from hkp
      server p80.pool.sks-keyservers.net\n                 gpg: no valid OpenPGP data
      found.\n                 gpg: Total number processed: 0\n                 ----
      End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D ----\n                 Ran apt-key
      adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
      returned 2\n\n                 Cookbook Trace:\n                 ---------------\n
      \                /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n                 /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n\n                 Resource Declaration:\n                 ---------------------\n
      \                # In /tmp/kitchen/cache/cookbooks/chef-apt-docker/recipes/default.rb\n\n
      \                 20: apt_repository 'docker' do\n                  21:   uri
      'https://apt.dockerproject.org/repo'\n                  22:   distribution \"#{node['platform']}-#{node['lsb']['codename']}\"\n
      \                 23:   keyserver 'p80.pool.sks-keyservers.net'\n                  24:
      \  components node['chef-apt-docker']['components']\n                  25:   key
      '58118E89F3A912897C070ADBF76221572C52609D'\n                  26: end\n\n                 Compiled
      Resource:\n                 ------------------\n                 # Declared
      in /tmp/kitchen/cache/cookbooks/chef-apt-docker/recipes/default.rb:20:in `from_file'\n\n
      \                apt_repository(\"docker\") do\n                   action [:add]\n
      \                  retries 0\n                   retry_delay 2\n                   default_guard_interpreter
      :default\n                   declared_type :apt_repository\n                   cookbook_name
      \"chef-apt-docker\"\n                   recipe_name \"default\"\n                   uri
      \"https://apt.dockerproject.org/repo\"\n                   distribution \"ubuntu-trusty\"\n
      \                  keyserver \"p80.pool.sks-keyservers.net\"\n                   components
      [\"main\"]\n                   key \"58118E89F3A912897C070ADBF76221572C52609D\"\n
      \                  cache_rebuild true\n                 end\n\n                 Platform:\n
      \                ---------\n                 x86_64-linux\n\n             Starting
      audit phase\n\n             Finished in 0.00027 seconds (files took 0.2757 seconds
      to load)\n             0 examples, 0 failures\n             Auditing complete\n\n
      \            Running handlers:\n             [2016-07-18T23:55:57+00:00] ERROR:
      Running exception handlers\n             Running handlers complete\n             [2016-07-18T23:55:57+00:00]
      ERROR: Exception handlers complete\n             Chef Client failed. 5 resources
      updated in 17 seconds\n             [2016-07-18T23:55:57+00:00] ERROR: Failed
      to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json\n
      \            [2016-07-18T23:55:57+00:00] FATAL: Stacktrace dumped to /tmp/kitchen/cache/chef-stacktrace.out\n
      \            [2016-07-18T23:55:57+00:00] FATAL: Please provide the contents
      of the stacktrace.out file if you file a bug report\n             [2016-07-18T23:55:57+00:00]
      ERROR: Found 1 errors, they are stored in the backtrace\n             [2016-07-18T23:55:58+00:00]
      FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully
      (exit code 1)\n      D      Cleaning up local sandbox in /tmp/cheftest/docker-default-ubuntu-1404-sandbox-20160718-27889-16j7fbk\n
      \     D      [SSH] shutting previous connection ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n      D      [SSH] closing
      connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\", :paranoid=>false,
      :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60,
      :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n      D      Converge failed
      on instance <docker-default-ubuntu-1404>.\n      D      ------Exception-------\n
      \     D      Class: Kitchen::InstanceFailure\n      D      Message: Converge
      failed on instance <docker-default-ubuntu-1404>.  Please see .kitchen/logs/docker-default-ubuntu-1404.log
      for more details\n      D      ----------------------\n      D      ------Backtrace-------\n
      \     D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:76:in
      `rescue in call'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:79:in
      `call'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:373:in
      `block in converge_action'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `call'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `synchronize_or_call'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:478:in
      `block in action'\n      D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in
      `measure'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:477:in
      `action'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:369:in
      `converge_action'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:348:in
      `block in transition_to'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `each'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `transition_to'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:138:in
      `converge'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `public_send'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `run_action_in_thread'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:173:in
      `block (2 levels) in run_action'\n      D      ----End Backtrace-----\n      D
      \     ---Nested Exception---\n      D      Class: Kitchen::ActionFailed\n      D
      \     Message: SSH exited (1) for command: [sh -c '\n      sudo -E /opt/chefdk/bin/chef-client
      --local-mode --config /tmp/kitchen/client.rb --log_level auto --force-formatter
      --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889\n      ']\n
      \     D      ----------------------\n      D      ------Backtrace-------\n      D
      \     /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:76:in
      `rescue in call'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:79:in
      `call'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:373:in
      `block in converge_action'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `call'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `synchronize_or_call'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:478:in
      `block in action'\n      D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in
      `measure'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:477:in
      `action'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:369:in
      `converge_action'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:348:in
      `block in transition_to'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `each'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `transition_to'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:138:in
      `converge'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `public_send'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `run_action_in_thread'\n      D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:173:in
      `block (2 levels) in run_action'\n      D      ----End Backtrace-----\n      STDERR:
      >>>>>> Converge failed on instance <docker-default-ubuntu-1404>.\n      >>>>>>
      Please see .kitchen/logs/docker-default-ubuntu-1404.log for more details\n      >>>>>>
      ------Exception-------\n      >>>>>> Class: Kitchen::ActionFailed\n      >>>>>>
      Message: SSH exited (1) for command: [sh -c '\n      sudo -E /opt/chefdk/bin/chef-client
      --local-mode --config /tmp/kitchen/client.rb --log_level auto --force-formatter
      --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889\n      ']\n
      \     >>>>>> ----------------------\n      ---- End output of bundle exec kitchen
      converge  -c -l debug ----\n      Ran bundle exec kitchen converge  -c -l debug
      returned 10\n\n      Resource Declaration:\n      ---------------------\n      #
      In /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/top_cookbooks.rb\n\n
      \       7:     cookbook_kitchen \"#{command} docker\" do\n        8:     end\n
      \       9:\n\n      Compiled Resource:\n      ------------------\n      # Declared
      in /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/top_cookbooks.rb:7:in
      `block in <class:TopCookbooks>'\n\n      cookbook_kitchen(\"converge docker\")
      do\n        action [:run]\n        updated true\n        updated_by_last_action
      true\n        retries 0\n        retry_delay 2\n        default_guard_interpreter
      :default\n        declared_type :cookbook_kitchen\n        cookbook_name \"acceptance-cookbook\"\n
      \       repository \"https://github.com/chef-cookbooks/docker.git\"\n        test_cookbook
      \"docker\"\n        repository_root \"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/docker\"\n
      \       branch \"master\"\n        command \"converge\"\n        kitchen_options
      \"-c -l debug\"\n        kitchen_dir \"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/docker/\"\n
      \       env {\"BUNDLE_GEMFILE\"=>\"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/Gemfile\",
      \"KITCHEN_YAML\"=>\"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/.kitchen.docker.yml\"}\n
      \     end\n\n      Platform:\n      ---------\n      x86_64-linux\n\n\n    ================================================================================\n
      \   Error executing action `run` on resource 'top_cookbooks[converge]'\n    ================================================================================\n\n
      \   Mixlib::ShellOut::ShellCommandFailed\n    ------------------------------------\n
      \   cookbook_kitchen[converge docker] (/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/top_cookbooks.rb
      line 7) had an error: Mixlib::ShellOut::ShellCommandFailed: execute[bundle exec
      kitchen converge  -c -l debug] (/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb
      line 36) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process
      to exit with [0], but received '10'\n    ---- Begin output of bundle exec kitchen
      converge  -c -l debug ----\n    STDOUT: -----> Starting Kitchen (v1.9.2)\n    D
      \     Berksfile found at /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/docker/Berksfile,
      loading Berkshelf\n    D      Berkshelf 4.3.5 library loaded\n    -----> Creating
      <docker-default-ubuntu-1404>...\n           If you are not using an account
      that qualifies under the AWS\n    free-tier, you may be charged to run these
      suites. The charge\n    should be minimal, but neither Test Kitchen nor its
      maintainers\n    are responsible for your incurred costs.\n\n    D      platform
      name ubuntu-14.04 appears to be a standard platform. Searching for ubuntu 14.04
      ...\n    D      Searching for images matching {:name=>\"ubuntu/images/*/ubuntu-*-14.04-*-server-*\",
      :\"owner-id\"=>\"099720109477\", :architecture=>\"x86_64\", :\"virtualization-type\"=>\"hvm\",
      :\"block-device-mapping.volume-type\"=>\"gp2\", :\"image-type\"=>\"machine\"}
      ...\n    D      Search returned 59 images:\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160714:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-07-15T10:37:25.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160627:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-06-29T15:13:53.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160620:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-06-21T12:07:59.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160602:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-06-03T01:17:21.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160516:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-05-17T09:54:45.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160509.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-05-10T11:55:52.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160406:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-04-06T22:01:48.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160314:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-03-15T08:30:56.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160222:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-02-23T13:53:30.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160217.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-02-18T01:37:46.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160201:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-02-02T12:11:43.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160119:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-01-20T12:15:17.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20160114.5:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2016-01-15T22:11:35.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151218:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-12-20T01:45:49.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151217:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-12-18T09:40:49.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151117:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-11-18T08:17:32.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151105:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-11-06T23:03:53.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151019:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-20T09:04:11.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151015:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-15T20:43:54.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151008:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-09T08:48:14.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151007:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-08T08:57:50.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20151005:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-06T09:26:41.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150930:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-10-01T11:24:14.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150928:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-29T11:13:44.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150924:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-25T13:37:47.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150908:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-09T05:59:15.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150901.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-09-02T05:15:07.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150814:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-15T08:11:39.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150813:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-14T07:14:42.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150812:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-13T08:50:05.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150810:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-11T11:43:49.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150805:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-06T19:29:13.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150731:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-08-01T09:17:08.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150727:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-07-28T07:13:51.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150724:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-07-25T05:22:13.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150629:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-30T09:14:39.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150609:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-09T17:42:29.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150608:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-09T03:54:29.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150603:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-06-04T08:13:50.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150528:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-05-29T10:15:24.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150506:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-05-07T08:14:11.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150417:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-04-17T12:06:11.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150408.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-04-09T08:52:15.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150325:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-03-25T23:56:26.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150305:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-03-05T11:02:56.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150227.2:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-02-28T07:15:31.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150225.2:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-02-26T06:03:04.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150209.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-02-10T05:22:56.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20150123:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2015-01-23T10:57:13.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20141125:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-11-26T01:50:28.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140927:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-30T00:19:14.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140926:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-26T16:05:00.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140924:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-25T14:07:23.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140923:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-09-23T14:15:33.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140829:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-08-29T18:46:07.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140816:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-08-16T22:57:30.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140813:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-08-14T00:50:31.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140724:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-07-25T08:28:59.000Z\n    D      - ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20140607.1:
      Detected ubuntu 14.04 x86_64.  Architecture: x86_64, Virtualization: hvm, Storage:
      ebs gp2, Created: 2014-07-23T18:05:49.000Z\n    D      Creating EC2 instance
      in region us-west-2 with properties:\n    D      - instance_type = \"m3.large\"\n
      \   D      - ebs_optimized = false\n    D      - image_id = \"ami-d732f0b7\"\n
      \   D      - key_name = \"jenkins\"\n    D      - subnet_id = \"subnet-19ac017c\"\n
      \   D      - private_ip_address = nil\n    D      - placement = {:availability_zone=>\"us-west-2a\"}\n
      \   D      - security_group_ids = [\"sg-e401eb83\", \"sg-96274af3\"]\n           Instance
      <i-666cd4c9> requested.\n           Polling AWS for existence, attempt 0...\n
      \          Attempting to tag the instance, 0 retries\n           EC2 instance
      <i-666cd4c9> created.\n           Waited 0/300s for instance <i-666cd4c9> to
      become ready.\n           Waited 5/300s for instance <i-666cd4c9> to become
      ready.\n           Waited 10/300s for instance <i-666cd4c9> to become ready.\n
      \          Waited 15/300s for instance <i-666cd4c9> to become ready.\n           Waited
      20/300s for instance <i-666cd4c9> to become ready.\n           EC2 instance
      <i-666cd4c9> ready.\n    D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"]}>\n    D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout:
      Net::SSH::ConnectionTimeout>)\n           Waiting for SSH service on 10.194.14.1:22,
      retrying in 3 seconds\n    D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n    D      [SSH] connection
      failed (#<Errno::ECONNREFUSED: Connection refused - connect(2) for 10.194.14.1:22>)\n
      \          Waiting for SSH service on 10.194.14.1:22, retrying in 3 seconds\n
      \   D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n    D      [SSH] connection
      failed (#<Errno::ECONNREFUSED: Connection refused - connect(2) for 10.194.14.1:22>)\n
      \          Waiting for SSH service on 10.194.14.1:22, retrying in 3 seconds\n
      \   D      [SSH] opening connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n    D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (echo '[SSH] Established')\n
      \          [SSH] Established\n    D      Using sudo_command='sudo -E' for ohai
      hints\n    D      [SSH] reusing existing connection ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n    D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sudo -E mkdir -p /etc/chef/ohai/hints;
      sudo -E touch /etc/chef/ohai/hints/ec2.json)\n    D      ec2:create '10.194.14.1'\n
      \          Finished creating <docker-default-ubuntu-1404> (0m51.84s).\n    ----->
      Converging <docker-default-ubuntu-1404>...\n           Preparing files for transfer\n
      \   D      Creating local sandbox in /tmp/cheftest/docker-default-ubuntu-1404-sandbox-20160718-27889-16j7fbk\n
      \          Preparing dna.json\n    D      Creating dna.json from {:chef_acceptance=>\"true\",
      :use_system_chef=>\"true\", :docker=>{:version=>\"1.10.0\"}, :run_list=>[\"recipe[apt]\",
      \"recipe[chef-apt-docker]\"]}\n           Resolving cookbook dependencies with
      Berkshelf 4.3.5...\n    D      Using Berksfile from /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/docker/Berksfile\n
      \          Removing non-cookbook files before transfer\n           Preparing
      validation.pem\n    D      Using a dummy validation.pem\n           Preparing
      client.rb\n    D      Creating client.rb from {:node_name=>\"docker-default-ubuntu-1404\",
      :checksum_path=>\"/tmp/kitchen/checksums\", :file_cache_path=>\"/tmp/kitchen/cache\",
      :file_backup_path=>\"/tmp/kitchen/backup\", :cookbook_path=>[\"/tmp/kitchen/cookbooks\",
      \"/tmp/kitchen/site-cookbooks\"], :data_bag_path=>\"/tmp/kitchen/data_bags\",
      :environment_path=>\"/tmp/kitchen/environments\", :node_path=>\"/tmp/kitchen/nodes\",
      :role_path=>\"/tmp/kitchen/roles\", :client_path=>\"/tmp/kitchen/clients\",
      :user_path=>\"/tmp/kitchen/users\", :validation_key=>\"/tmp/kitchen/validation.pem\",
      :client_key=>\"/tmp/kitchen/client.pem\", :chef_server_url=>\"http://127.0.0.1:8889\",
      :encrypted_data_bag_secret=>\"/tmp/kitchen/encrypted_data_bag_secret\", :audit_mode=>\":enabled\",
      :named_run_list=>{}}\n    D      [SSH] reusing existing connection ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n    D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sudo -E cat > /tmp/chef-installer.sh
      <<\"EOL\"\n    #!/bin/bash\n    #!/bin/sh\n    # WARNING: REQUIRES /bin/sh\n
      \   #\n    # - must run on /bin/sh on solaris 9\n    # - must run on /bin/sh
      on AIX 6.x\n    #\n    # Copyright:: Copyright (c) 2010-2015 Chef Software,
      Inc.\n    # License:: Apache License, Version 2.0\n    #\n    # Licensed under
      the Apache License, Version 2.0 (the \"License\");\n    # you may not use this
      file except in compliance with the License.\n    # You may obtain a copy of
      the License at\n    #\n    #     http://www.apache.org/licenses/LICENSE-2.0\n
      \   #\n    # Unless required by applicable law or agreed to in writing, software\n
      \   # distributed under the License is distributed on an \"AS IS\" BASIS,\n
      \   # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
      \   # See the License for the specific language governing permissions and\n
      \   # limitations under the License.\n    #\n\n    # helpers.sh\n    ############\n
      \   # This section has some helper functions to make life easier.\n    #\n    #
      Outputs:\n    # $tmp_dir: secure-ish temp directory that can be used during
      installation.\n    ############\n\n    # Check whether a command exists - returns
      0 if it does, 1 if it does not\n    exists() {\n      if command -v $1 >/dev/null
      2>&1\n      then\n        return 0\n      else\n        return 1\n      fi\n
      \   }\n\n    # Output the instructions to report bug about this script\n    report_bug()
      {\n      echo \"Version: $version\"\n      echo \"\"\n      echo \"Please file
      a Bug Report at https://github.com/chef/omnitruck/issues/new\"\n      echo \"Alternatively,
      feel free to open a Support Ticket at https://www.chef.io/support/tickets\"\n
      \     echo \"More Chef support resources can be found at https://www.chef.io/support\"\n
      \     echo \"\"\n      echo \"Please include as many details about the problem
      as possible i.e., how to reproduce\"\n      echo \"the problem (if possible),
      type of the Operating System and its version, etc.,\"\n      echo \"and any
      other relevant details that might help us with troubleshooting.\"\n      echo
      \"\"\n    }\n\n    checksum_mismatch() {\n      echo \"Package checksum mismatch!\"\n
      \     report_bug\n      exit 1\n    }\n\n    unable_to_retrieve_package() {\n
      \     echo \"Unable to retrieve a valid package!\"\n      report_bug\n      echo
      \"Metadata URL: $metadata_url\"\n      if test \"x$download_url\" != \"x\";
      then\n        echo \"Download URL: $download_url\"\n      fi\n      if test
      \"x$stderr_results\" != \"x\"; then\n        echo \"\\nDEBUG OUTPUT FOLLOWS:\\n$stderr_results\"\n
      \     fi\n      exit 1\n    }\n\n    http_404_error() {\n      echo \"Omnitruck
      artifact does not exist for version $version on platform $platform\"\n      echo
      \"\"\n      echo \"Either this means:\"\n      echo \"   - We do not support
      $platform\"\n      echo \"   - We do not have an artifact for $version\"\n      echo
      \"\"\n      echo \"This is often the latter case due to running a prerelease
      or RC version of chef\"\n      echo \"or a gem version which was only pushed
      to rubygems and not omnitruck.\"\n      echo \"\"\n      echo \"You may be able
      to set your knife[:bootstrap_version] to the most recent stable\"\n      echo
      \"release of Chef to fix this problem (or the most recent stable major version
      number).\"\n      echo \"\"\n      echo \"In order to test the version parameter,
      adventurous users may take the Metadata URL\"\n      echo \"below and modify
      the '&v=<number>' parameter until you successfully get a URL that\"\n      echo
      \"does not 404 (e.g. via curl or wget).  You should be able to use '&v=11' or
      '&v=12'\"\n      echo \"succesfully.\"\n      echo \"\"\n      echo \"If you
      cannot fix this problem by setting the bootstrap_version, it probably means\"\n
      \     echo \"that $platform is not supported.\"\n      echo \"\"\n      # deliberately
      do not call report_bug to suppress bug report noise.\n      echo \"Metadata
      URL: $metadata_url\"\n      if test \"x$download_url\" != \"x\"; then\n        echo
      \"Download URL: $download_url\"\n      fi\n      if test \"x$stderr_results\"
      != \"x\"; then\n        echo \"\\nDEBUG OUTPUT FOLLOWS:\\n$stderr_results\"\n
      \     fi\n      exit 1\n    }\n\n    capture_tmp_stderr() {\n      # spool up
      /tmp/stderr from all the commands we called\n      if test -f \"$tmp_dir/stderr\";
      then\n        output=`cat $tmp_dir/stderr`\n        stderr_results=\"${stderr_results}\\nSTDERR
      from $1:\\n\\n$output\\n\"\n        rm $tmp_dir/stderr\n      fi\n    }\n\n
      \   # do_wget URL FILENAME\n    do_wget() {\n      echo \"trying wget...\"\n
      \     wget -O \"$2\" \"$1\" 2>$tmp_dir/stderr\n      rc=$?\n      # check for
      404\n      grep \"ERROR 404\" $tmp_dir/stderr 2>&1 >/dev/null\n      if test
      $? -eq 0; then\n        echo \"ERROR 404\"\n        http_404_error\n      fi\n\n
      \     # check for bad return status or empty output\n      if test $rc -ne 0
      || test ! -s \"$2\"; then\n        capture_tmp_stderr \"wget\"\n        return
      1\n      fi\n\n      return 0\n    }\n\n    # do_curl URL FILENAME\n    do_curl()
      {\n      echo \"trying curl...\"\n      curl --retry 5 -sL -D $tmp_dir/stderr
      \"$1\" > \"$2\"\n      rc=$?\n      # check for 404\n      grep \"404 Not Found\"
      $tmp_dir/stderr 2>&1 >/dev/null\n      if test $? -eq 0; then\n        echo
      \"ERROR 404\"\n        http_404_error\n      fi\n\n      # check for bad return
      status or empty output\n      if test $rc -ne 0 || test ! -s \"$2\"; then\n
      \       capture_tmp_stderr \"curl\"\n        return 1\n      fi\n\n      return
      0\n    }\n\n    # do_fetch URL FILENAME\n    do_fetch() {\n      echo \"trying
      fetch...\"\n      fetch -o \"$2\" \"$1\" 2>$tmp_dir/stderr\n      # check for
      bad return status\n      test $? -ne 0 && return 1\n      return 0\n    }\n\n
      \   # do_perl URL FILENAME\n    do_perl() {\n      echo \"trying perl...\"\n
      \     perl -e 'use LWP::Simple; getprint($ARGV[0]);' \"$1\" > \"$2\" 2>$tmp_dir/stderr\n
      \     rc=$?\n      # check for 404\n      grep \"404 Not Found\" $tmp_dir/stderr
      2>&1 >/dev/null\n      if test $? -eq 0; then\n        echo \"ERROR 404\"\n
      \       http_404_error\n      fi\n\n      # check for bad return status or empty
      output\n      if test $rc -ne 0 || test ! -s \"$2\"; then\n        capture_tmp_stderr
      \"perl\"\n        return 1\n      fi\n\n      return 0\n    }\n\n    # do_python
      URL FILENAME\n    do_python() {\n      echo \"trying python...\"\n      python
      -c \"import sys,urllib2 ; sys.stdout.write(urllib2.urlopen(sys.argv[1]).read())\"
      \"$1\" > \"$2\" 2>$tmp_dir/stderr\n      rc=$?\n      # check for 404\n      grep
      \"HTTP Error 404\" $tmp_dir/stderr 2>&1 >/dev/null\n      if test $? -eq 0;
      then\n        echo \"ERROR 404\"\n        http_404_error\n      fi\n\n      #
      check for bad return status or empty output\n      if test $rc -ne 0 || test
      ! -s \"$2\"; then\n        capture_tmp_stderr \"python\"\n        return 1\n
      \     fi\n      return 0\n    }\n\n    # returns 0 if checksums match\n    do_checksum()
      {\n      if exists sha256sum; then\n        echo \"Comparing checksum with sha256sum...\"\n
      \       checksum=`sha256sum $1 | awk '{ print $1 }'`\n        return `test \"x$checksum\"
      = \"x$2\"`\n      elif exists shasum; then\n        echo \"Comparing checksum
      with shasum...\"\n        checksum=`shasum -a 256 $1 | awk '{ print $1 }'`\n
      \       return `test \"x$checksum\" = \"x$2\"`\n      else\n        echo \"WARNING:
      could not find a valid checksum program, pre-install shasum or sha256sum in
      your O/S image to get valdation...\"\n        return 0\n      fi\n    }\n\n
      \   # do_download URL FILENAME\n    do_download() {\n      echo \"downloading
      $1\"\n      echo \"  to file $2\"\n\n      url=`echo $1`\n      if test \"x$platform\"
      = \"xsolaris2\"; then\n        if test \"x$platform_version\" = \"x5.9\" -o
      \"x$platform_version\" = \"x5.10\"; then\n          # solaris 9 lacks openssl,
      solaris 10 lacks recent enough credentials - your base O/S is completely insecure,
      please upgrade\n          url=`echo $url | sed -e 's/https/http/'`\n        fi\n
      \     fi\n\n      # we try all of these until we get success.\n      # perl,
      in particular may be present but LWP::Simple may not be installed\n\n      if
      exists wget; then\n        do_wget $url $2 && return 0\n      fi\n\n      if
      exists curl; then\n        do_curl $url $2 && return 0\n      fi\n\n      if
      exists fetch; then\n        do_fetch $url $2 && return 0\n      fi\n\n      if
      exists perl; then\n        do_perl $url $2 && return 0\n      fi\n\n      if
      exists python; then\n        do_python $url $2 && return 0\n      fi\n\n      unable_to_retrieve_package\n
      \   }\n\n    # install_file TYPE FILENAME\n    # TYPE is \"rpm\", \"deb\", \"solaris\",
      \"sh\", etc.\n    install_file() {\n      echo \"Installing $project $version\"\n
      \     case \"$1\" in\n        \"rpm\")\n          if test \"x$platform\" = \"xnexus\"
      || test \"x$platform\" = \"xios_xr\"; then\n            echo \"installing with
      yum...\"\n            yum install -yv \"$2\"\n          else\n            echo
      \"installing with rpm...\"\n            rpm -Uvh --oldpackage --replacepkgs
      \"$2\"\n          fi\n          ;;\n        \"deb\")\n          echo \"installing
      with dpkg...\"\n          dpkg -i \"$2\"\n          ;;\n        \"bff\")\n          echo
      \"installing with installp...\"\n          installp -aXYgd \"$2\" all\n          ;;\n
      \       \"solaris\")\n          echo \"installing with pkgadd...\"\n          echo
      \"conflict=nocheck\" > $tmp_dir/nocheck\n          echo \"action=nocheck\" >>
      $tmp_dir/nocheck\n          echo \"mail=\" >> $tmp_dir/nocheck\n          pkgrm
      -a $tmp_dir/nocheck -n $project >/dev/null 2>&1 || true\n          pkgadd -G
      -n -d \"$2\" -a $tmp_dir/nocheck $project\n          ;;\n        \"pkg\")\n
      \         echo \"installing with installer...\"\n          cd / && /usr/sbin/installer
      -pkg \"$2\" -target /\n          ;;\n        \"dmg\")\n          echo \"installing
      dmg file...\"\n          hdiutil detach \"/Volumes/chef_software\" >/dev/null
      2>&1 || true\n          hdiutil attach \"$2\" -mountpoint \"/Volumes/chef_software\"\n
      \         cd / && /usr/sbin/installer -pkg `find \"/Volumes/chef_software\"
      -name \\*.pkg` -target /\n          hdiutil detach \"/Volumes/chef_software\"\n
      \         ;;\n        \"sh\" )\n          echo \"installing with sh...\"\n          sh
      \"$2\"\n          ;;\n        *)\n          echo \"Unknown filetype: $1\"\n
      \         report_bug\n          exit 1\n          ;;\n      esac\n      if test
      $? -ne 0; then\n        echo \"Installation failed\"\n        report_bug\n        exit
      1\n      fi\n    }\n\n    if test \"x$TMPDIR\" = \"x\"; then\n      tmp=\"/tmp\"\n
      \   else\n      tmp=$TMPDIR\n    fi\n    # secure-ish temp dir creation without
      having mktemp available (DDoS-able but not expliotable)\n    tmp_dir=\"$tmp/install.sh.$$\"\n
      \   (umask 077 && mkdir $tmp_dir) || exit 1\n\n    ############\n    # end of
      helpers.sh\n    ############\n\n\n    project=chefdk\n    version=0.16.30\n
      \   channel=unstable\n\n\n    # platform_detection.sh\n    ############\n    #
      This section makes platform detection compatible with omnitruck on the system\n
      \   #   it runs.\n    #\n    # Outputs:\n    # $platform: Name of the platform.\n
      \   # $platform_version: Version of the platform.\n    # $machine: System's
      architecture.\n    ############\n\n    #\n    # Platform and Platform Version
      detection\n    #\n    # NOTE: This should now match ohai platform and platform_version
      matching.\n    # do not invented new platform and platform_version schemas,
      just make this behave\n    # like what ohai returns as platform and platform_version
      for the server.\n    #\n    # ALSO NOTE: Do not mangle platform or platform_version
      here.  It is less error\n    # prone and more future-proof to do that in the
      server, and then all omnitruck clients\n    # will 'inherit' the changes (install.sh
      is not the only client of the omnitruck\n    # endpoint out there).\n    #\n\n
      \   machine=`uname -m`\n    os=`uname -s`\n\n    if test -f \"/etc/lsb-release\"
      && grep -q DISTRIB_ID /etc/lsb-release && ! grep -q wrlinux /etc/lsb-release;
      then\n      platform=`grep DISTRIB_ID /etc/lsb-release | cut -d \"=\" -f 2 |
      tr '[A-Z]' '[a-z]'`\n      platform_version=`grep DISTRIB_RELEASE /etc/lsb-release
      | cut -d \"=\" -f 2`\n    elif test -f \"/etc/debian_version\"; then\n      platform=\"debian\"\n
      \     platform_version=`cat /etc/debian_version`\n    elif test -f \"/etc/redhat-release\";
      then\n      platform=`sed 's/^\\(.\\+\\) release.*/\\1/' /etc/redhat-release
      | tr '[A-Z]' '[a-z]'`\n      platform_version=`sed 's/^.\\+ release \\([.0-9]\\+\\).*/\\1/'
      /etc/redhat-release`\n\n      # If /etc/redhat-release exists, we act like RHEL
      by default\n      if test \"$platform\" = \"fedora\"; then\n        # FIXME:
      stop remapping fedora to el\n        # FIXME: remove client side platform_version
      mangling and hard coded yolo\n        # Change platform version for use below.\n
      \       platform_version=\"6.0\"\n      fi\n\n      if test \"$platform\" =
      \"xenserver\"; then\n        # Current XenServer 6.2 is based on CentOS 5, platform
      is not reset to \"el\" server should hanlde response\n        platform=\"xenserver\"\n
      \     else\n        # FIXME: use \"redhat\"\n        platform=\"el\"\n      fi\n\n
      \   elif test -f \"/etc/system-release\"; then\n      platform=`sed 's/^\\(.\\+\\)
      release.\\+/\\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`\n      platform_version=`sed
      's/^.\\+ release \\([.0-9]\\+\\).*/\\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`\n
      \     # amazon is built off of fedora, so act like RHEL\n      if test \"$platform\"
      = \"amazon linux ami\"; then\n        # FIXME: remove client side platform_version
      mangling and hard coded yolo, and remapping to deprecated \"el\"\n        platform=\"el\"\n
      \       platform_version=\"6.0\"\n      fi\n    # Apple OS X\n    elif test
      -f \"/usr/bin/sw_vers\"; then\n      platform=\"mac_os_x\"\n      # Matching
      the tab-space with sed is error-prone\n      platform_version=`sw_vers | awk
      '/^ProductVersion:/ { print $2 }' | cut -d. -f1,2`\n\n      # x86_64 Apple hardware
      often runs 32-bit kernels (see OHAI-63)\n      x86_64=`sysctl -n hw.optional.x86_64`\n
      \     if test $x86_64 -eq 1; then\n        machine=\"x86_64\"\n      fi\n    elif
      test -f \"/etc/release\"; then\n      machine=`/usr/bin/uname -p`\n      if
      grep -q SmartOS /etc/release; then\n        platform=\"smartos\"\n        platform_version=`grep
      ^Image /etc/product | awk '{ print $3 }'`\n      else\n        platform=\"solaris2\"\n
      \       platform_version=`/usr/bin/uname -r`\n      fi\n    elif test -f \"/etc/SuSE-release\";
      then\n      if grep -q 'Enterprise' /etc/SuSE-release;\n      then\n          platform=\"sles\"\n
      \         platform_version=`awk '/^VERSION/ {V = $3}; /^PATCHLEVEL/ {P = $3};
      END {print V \".\" P}' /etc/SuSE-release`\n      else\n          platform=\"suse\"\n
      \         platform_version=`awk '/^VERSION =/ { print $3 }' /etc/SuSE-release`\n
      \     fi\n    elif test \"x$os\" = \"xFreeBSD\"; then\n      platform=\"freebsd\"\n
      \     platform_version=`uname -r | sed 's/-.*//'`\n    elif test \"x$os\" =
      \"xAIX\"; then\n      platform=\"aix\"\n      platform_version=\"`uname -v`.`uname
      -r`\"\n      machine=\"powerpc\"\n    elif test -f \"/etc/os-release\"; then\n
      \     . /etc/os-release\n      if test \"x$CISCO_RELEASE_INFO\" != \"x\"; then\n
      \       . $CISCO_RELEASE_INFO\n      fi\n\n      platform=$ID\n      platform_version=$VERSION\n
      \   fi\n\n    if test \"x$platform\" = \"x\"; then\n      echo \"Unable to determine
      platform version!\"\n      report_bug\n      exit 1\n    fi\n\n    #\n    #
      NOTE: platform manging in the install.sh is DEPRECATED\n    #\n    # - install.sh
      should be true to ohai and should not remap\n    #   platform or platform versions.\n
      \   #\n    # - remapping platform and mangling platform version numbers is\n
      \   #   now the complete responsibility of the server-side endpoints\n    #\n\n
      \   major_version=`echo $platform_version | cut -d. -f1`\n    case $platform
      in\n      # FIXME: should remove this case statement completely\n      \"el\")\n
      \       # FIXME:  \"el\" is deprecated, should use \"redhat\"\n        platform_version=$major_version\n
      \       ;;\n      \"debian\")\n        if test \"x$major_version\" = \"x5\";
      then\n          # This is here for potential back-compat.\n          # We do
      not have 5 in versions we publish for anymore but we\n          # might have
      it for earlier versions.\n          platform_version=\"6\"\n        else\n          platform_version=$major_version\n
      \       fi\n        ;;\n      \"freebsd\")\n        platform_version=$major_version\n
      \       ;;\n      \"sles\")\n        platform_version=$major_version\n        ;;\n
      \     \"suse\")\n        platform_version=$major_version\n        ;;\n    esac\n\n
      \   # normalize the architecture we detected\n    case $machine in\n      \"x86_64\"|\"amd64\"|\"x64\")\n
      \       machine=\"x86_64\"\n        ;;\n      \"i386\"|\"i86pc\"|\"x86\"|\"i686\")\n
      \       machine=\"i386\"\n        ;;\n      \"sparc\"|\"sun4u\"|\"sun4v\")\n
      \       machine=\"sparc\"\n        ;;\n    esac\n\n    if test \"x$platform_version\"
      = \"x\"; then\n      echo \"Unable to determine platform version!\"\n      report_bug\n
      \     exit 1\n    fi\n\n    if test \"x$platform\" = \"xsolaris2\"; then\n      #
      hack up the path on Solaris to find wget, pkgadd\n      PATH=/usr/sfw/bin:/usr/sbin:$PATH\n
      \     export PATH\n    fi\n\n    echo \"$platform $platform_version $machine\"\n\n
      \   ############\n    # end of platform_detection.sh\n    ############\n\n\n
      \   # artifactory_urls.sh\n    ############\n    # This section sets up the
      information for a build to be installed from artifactory\n    #  then uses $platform,
      $platform_version and $machine to select the correct\n    #  version.\n    #\n
      \   # Inputs:\n    # $platform:\n    # $platform_version:\n    # $machine:\n
      \   #\n    # Outputs:\n    # $download_url:\n    # $sha256:\n    ############\n\n\n
      \     artifact_info_dir=\"$tmp_dir/artifact_info/mac_os_x/10.9/x86_64\"\n      mkdir
      -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n      echo
      \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/mac_os_x/10.9/chefdk-0.16.30-1.dmg\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 4d4b8adb26f90b572e11b7779dc5528b3de3f25033aa62d1cb64f059f04b566b\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/mac_os_x/10.10/x86_64\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/mac_os_x/10.10/chefdk-0.16.30-1.dmg\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 4d4b8adb26f90b572e11b7779dc5528b3de3f25033aa62d1cb64f059f04b566b\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/mac_os_x/10.11/x86_64\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/mac_os_x/10.11/chefdk-0.16.30-1.dmg\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 4d4b8adb26f90b572e11b7779dc5528b3de3f25033aa62d1cb64f059f04b566b\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/el/7/x86_64\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/el/7/chefdk-0.16.30-1.el7.x86_64.rpm\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 7d1aad0a56c33ef381565f29a9fd0dfaf535417b8bfa0d861f9677e0859df099\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/windows/2008r2/i386\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/windows/2008r2/chefdk-0.16.30-1-x86.msi\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 491074e24b0db0d42dd7b1ca998d7c7c80a18ff9e9b35b50c1c87409e9b851bc\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/windows/2012/i386\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/windows/2012/chefdk-0.16.30-1-x86.msi\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 491074e24b0db0d42dd7b1ca998d7c7c80a18ff9e9b35b50c1c87409e9b851bc\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/ubuntu/12.04/x86_64\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/ubuntu/12.04/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 9e4b9a102e8616169ee38c8cdceb8bfb1cf97d2b4323859ea91c805a044c7523\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/ubuntu/14.04/x86_64\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/ubuntu/14.04/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 9e4b9a102e8616169ee38c8cdceb8bfb1cf97d2b4323859ea91c805a044c7523\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/windows/2012r2/i386\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/windows/2012r2/chefdk-0.16.30-1-x86.msi\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 491074e24b0db0d42dd7b1ca998d7c7c80a18ff9e9b35b50c1c87409e9b851bc\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/el/6/x86_64\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/el/6/chefdk-0.16.30-1.el6.x86_64.rpm\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 d04a13de502ec9278dd4887c5b484536cb8e2293808d32d929adbe3670ac58c4\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/debian/6/x86_64\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/debian/6/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 91f6a25372e69e58d1dfc0370c5e381e834594bb36cfd3f0dc073872707d46f1\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/debian/7/x86_64\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/debian/7/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 91f6a25372e69e58d1dfc0370c5e381e834594bb36cfd3f0dc073872707d46f1\"
      >> \"$artifact_info_dir/artifact_info\"\n\n      artifact_info_dir=\"$tmp_dir/artifact_info/debian/8/x86_64\"\n
      \     mkdir -p $artifact_info_dir\n      touch \"$artifact_info_dir/artifact_info\"\n
      \     echo \"url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/debian/8/chefdk_0.16.30-1_amd64.deb\"
      >> \"$artifact_info_dir/artifact_info\"\n      echo \"sha256 91f6a25372e69e58d1dfc0370c5e381e834594bb36cfd3f0dc073872707d46f1\"
      >> \"$artifact_info_dir/artifact_info\"\n\n\n    artifact_info_for_platform=\"$tmp_dir/artifact_info/$platform/$platform_version/$machine/artifact_info\"\n\n
      \   download_url=`awk '$1 == \"url\" { print $2 }' \"$artifact_info_for_platform\"`\n
      \   sha256=`awk '$1 == \"sha256\" { print $2 }' \"$artifact_info_for_platform\"`\n\n\n
      \   # fetch_package.sh\n    ############\n    # This section fetchs a package
      from $download_url and verifies its metadata.\n    #\n    # Inputs:\n    # $download_url:\n
      \   # $tmp_dir:\n    # Optional Inputs:\n    # $cmdline_filename: Name of the
      package downloaded on local disk.\n    # $cmdline_dl_dir: Name of the directory
      downloaded package will be saved to on local disk.\n    #\n    # Outputs:\n
      \   # $download_filename: Name of the downloaded file on local disk.\n    #
      $filetype: Type of the file downloaded.\n    ############\n\n    filename=`echo
      $download_url | sed -e 's/^.*\\///'`\n    filetype=`echo $filename | sed -e
      's/^.*\\.//'`\n\n    # use either $tmp_dir, the provided directory (-d) or the
      provided filename (-f)\n    if test \"x$cmdline_filename\" != \"x\"; then\n
      \     download_filename=\"$cmdline_filename\"\n    elif test \"x$cmdline_dl_dir\"
      != \"x\"; then\n      download_filename=\"$cmdline_dl_dir/$filename\"\n    else\n
      \     download_filename=\"$tmp_dir/$filename\"\n    fi\n\n    # ensure the parent
      directory where to download the installer always exists\n    download_dir=`dirname
      $download_filename`\n    (umask 077 && mkdir -p $download_dir) || exit 1\n\n
      \   # check if we have that file locally available and if so verify the checksum\n
      \   cached_file_available=\"false\"\n    if test -f $download_filename; then\n
      \     echo \"$download_filename already exists, verifiying checksum...\"\n      if
      do_checksum \"$download_filename\" \"$sha256\"; then\n        echo \"checksum
      compare succeeded, using existing file!\"\n        cached_file_available=\"true\"\n
      \     else\n        echo \"checksum mismatch, downloading latest version of
      the file\"\n      fi\n    fi\n\n    # download if no local version of the file
      available\n    if test \"x$cached_file_available\" != \"xtrue\"; then\n      do_download
      \"$download_url\"  \"$download_filename\"\n      do_checksum \"$download_filename\"
      \"$sha256\" || checksum_mismatch\n    fi\n\n    ############\n    # end of fetch_package.sh\n
      \   ############\n\n\n    # install_package.sh\n    ############\n    # Installs
      a package and removed the temp directory.\n    #\n    # Inputs:\n    # $download_filename:
      Name of the file to be installed.\n    # $filetype: Type of the file to be installed.\n
      \   # $version: The version requested. Used only for warning user if not set.\n
      \   ############\n\n    if test \"x$version\" = \"x\"; then\n      echo\n      echo
      \"WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING\"\n
      \     echo\n      echo \"You are installing an omnibus package without a version
      pin.  If you are installing\"\n      echo \"on production servers via an automated
      process this is DANGEROUS and you will\"\n      echo \"be upgraded without warning
      on new releases, even to new major releases.\"\n      echo \"Letting the version
      float is only appropriate in desktop, test, development or\"\n      echo \"CI/CD
      environments.\"\n      echo\n      echo \"WARNING WARNING WARNING WARNING WARNING
      WARNING WARNING WARNING WARNING\"\n      echo\n    fi\n\n    install_file $filetype
      \"$download_filename\"\n\n    if test \"x$tmp_dir\" != \"x\"; then\n      rm
      -r \"$tmp_dir\"\n    fi\n\n    ############\n    # end of install_package.sh\n
      \   ############\n\n    EOL\n    chmod +x /tmp/chef-installer.sh\n    sudo -E
      /tmp/chef-installer.sh)\n           ubuntu 14.04 x86_64\n           downloading
      http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.30/ubuntu/14.04/chefdk_0.16.30-1_amd64.deb\n
      \            to file /tmp/install.sh.1383/chefdk_0.16.30-1_amd64.deb\n           trying
      wget...\n           Comparing checksum with sha256sum...\n           Installing
      chefdk 0.16.30\n           installing with dpkg...\n           Selecting previously
      unselected package chefdk.\n           (Reading database ... \r(Reading database
      ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database
      ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database
      ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database
      ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database
      ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database
      ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database
      ... 95%\r(Reading database ... 100%\r(Reading database ... 51172 files and directories
      currently installed.)\n           Preparing to unpack .../chefdk_0.16.30-1_amd64.deb
      ...\n           Unpacking chefdk (0.16.30-1) ...\n           Setting up chefdk
      (0.16.30-1) ...\n           Thank you for installing Chef Development Kit!\n
      \   D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sh -c '\n    sudo_rm=\"sudo
      -E rm\"\n    dirs=\"/tmp/kitchen/clients /tmp/kitchen/cookbooks /tmp/kitchen/data
      /tmp/kitchen/data_bags /tmp/kitchen/encrypted_data_bag_secret /tmp/kitchen/environments
      /tmp/kitchen/roles\"\n    root_path=\"/tmp/kitchen\"\n\n    $sudo_rm -rf $dirs\n
      \   mkdir -p $root_path\n    ')\n           Transferring files to <docker-default-ubuntu-1404>\n
      \   D      TIMING: scp async upload (Kitchen::Transport::Ssh)\n    D      TIMING:
      scp async upload (Kitchen::Transport::Ssh) took (0m7.24s)\n    D      Transfer
      complete\n    D      [SSH] ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}> (sh -c '\n    sudo -E /opt/chefdk/bin/chef-client
      --local-mode --config /tmp/kitchen/client.rb --log_level auto --force-formatter
      --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889\n    ')\n
      \          Starting Chef Client, version 12.12.15\n           Creating a new
      client identity for docker-default-ubuntu-1404 using the validator key.\n           resolving
      cookbooks for run list: [\"apt\", \"chef-apt-docker\"]\n           Synchronizing
      Cookbooks:\n             - apt (4.0.1)\n             - chef-apt-docker (1.0.0)\n
      \            - compat_resource (12.10.7)\n           Installing Cookbook Gems:\n
      \          Compiling Cookbooks...\n           [2016-07-18T23:55:42+00:00] WARN:
      Chef::Provider::AptRepository already exists!  Cannot create deprecation class
      for LWRP provider apt_repository from cookbook apt\n           [2016-07-18T23:55:42+00:00]
      WARN: AptRepository already exists!  Deprecation class overwrites Custom resource
      apt_repository from cookbook apt\n           Converging 10 resources\n           Recipe:
      apt::default\n             * file[/var/lib/apt/periodic/update-success-stamp]
      action nothing (skipped due to action :nothing)\n             * apt_update[periodic]
      action periodic\n               - update new lists of packages\n               *
      directory[/var/lib/apt/periodic] action create (up to date)\n               *
      directory[/etc/apt/apt.conf.d] action create (up to date)\n               *
      file[/etc/apt/apt.conf.d/15update-stamp] action create_if_missing (up to date)\n
      \              * execute[apt-get -q update] action run\n                 - execute
      apt-get -q update\n\n             * execute[apt-get update] action nothing (skipped
      due to action :nothing)\n             * execute[apt-get autoremove] action nothing
      (skipped due to action :nothing)\n             * execute[apt-get autoclean]
      action nothing (skipped due to action :nothing)\n             * directory[/var/cache/local]
      action create\n               - create new directory /var/cache/local\n               -
      change mode from '' to '0755'\n               - change owner from '' to 'root'\n
      \              - change group from '' to 'root'\n             * directory[/var/cache/local/preseeding]
      action create\n               - create new directory /var/cache/local/preseeding\n
      \              - change mode from '' to '0755'\n               - change owner
      from '' to 'root'\n               - change group from '' to 'root'\n             *
      template[/etc/apt/apt.conf.d/10recommends] action create\n               - create
      new file /etc/apt/apt.conf.d/10recommends\n               - update content in
      file /etc/apt/apt.conf.d/10recommends from none to f41e1d\n               ---
      /etc/apt/apt.conf.d/10recommends  2016-07-18 23:55:56.000457824 +0000\n               +++
      /etc/apt/apt.conf.d/.chef-10recommends20160718-1515-3zz55e  2016-07-18 23:55:56.000457824
      +0000\n               @@ -1 +1,4 @@\n               +# Managed by Chef\n               +APT::Install-Recommends
      \"1\";\n               +APT::Install-Suggests \"0\";\n               - change
      mode from '' to '0644'\n               - change owner from '' to 'root'\n               -
      change group from '' to 'root'\n             * apt_package[apt-transport-https]
      action install (up to date)\n           Recipe: chef-apt-docker::default\n             *
      apt_repository[docker] action add\n               * execute[install-key 58118E89F3A912897C070ADBF76221572C52609D]
      action run\n\n                 ================================================================================\n
      \                Error executing action `run` on resource 'execute[install-key
      58118E89F3A912897C070ADBF76221572C52609D]'\n                 ================================================================================\n\n
      \                Mixlib::ShellOut::ShellCommandFailed\n                 ------------------------------------\n
      \                Expected process to exit with [0], but received '2'\n                 ----
      Begin output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D ----\n                 STDOUT: Executing:
      gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK
      --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg
      --primary-keyring /etc/apt/trusted.gpg --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D\n                 gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D
      can't be retrieved\n                 STDERR: gpg: requesting key 2C52609D from
      hkp server p80.pool.sks-keyservers.net\n                 gpg: no valid OpenPGP
      data found.\n                 gpg: Total number processed: 0\n                 ----
      End output of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D ----\n                 Ran apt-key
      adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
      returned 2\n\n                 Cookbook Trace:\n                 ---------------\n
      \                /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n                 /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n\n                 Resource Declaration:\n                 ---------------------\n
      \                # In /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb\n\n
      \                201:         declare_resource(:execute, \"install-key #{key}\")
      do\n                 202:           command cmd\n                 203:           sensitive
      new_resource.sensitive\n                 204:           not_if do\n                 205:
      \            present = extract_fingerprints_from_cmd(\"apt-key finger\").any?
      do |fp|\n                 206:               fp.end_with? key.upcase\n                 207:
      \            end\n                 208:             present && key_is_valid?(\"apt-key
      list\", key.upcase)\n                 209:           end\n                 210:
      \          notifies :run, \"execute[apt-cache gencaches]\", :immediately\n                 211:
      \        end\n                 212:\n\n                 Compiled Resource:\n
      \                ------------------\n                 # Declared in /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb:201:in
      `install_key_from_keyserver'\n\n                 execute(\"install-key 58118E89F3A912897C070ADBF76221572C52609D\")
      do\n            action [:run]\n            retries 0\n            retry_delay
      2\n            default_guard_interpreter :execute\n            command \"apt-key
      adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D\"\n
      \           backup 5\n            returns 0\n            declared_type :execute\n
      \           cookbook_name \"chef-apt-docker\"\n            not_if { #code block
      }\n                 end\n\n                 Platform:\n                 ---------\n
      \                x86_64-linux\n\n\n               ================================================================================\n
      \              Error executing action `add` on resource 'apt_repository[docker]'\n
      \              ================================================================================\n\n
      \              Mixlib::ShellOut::ShellCommandFailed\n               ------------------------------------\n
      \              execute[install-key 58118E89F3A912897C070ADBF76221572C52609D]
      (/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.12.15/lib/chef/provider/apt_repository.rb
      line 201) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process
      to exit with [0], but received '2'\n               ---- Begin output of apt-key
      adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
      ----\n               STDOUT: Executing: gpg --ignore-time-conflict --no-options
      --no-default-keyring --homedir /tmp/tmp.qP57eFqOAK --no-auto-check-trustdb --trust-model
      always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg
      --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D\n
      \              gpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't be
      retrieved\n               STDERR: gpg: requesting key 2C52609D from hkp server
      p80.pool.sks-keyservers.net\n               gpg: no valid OpenPGP data found.\n
      \              gpg: Total number processed: 0\n               ---- End output
      of apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80 58118E89F3A912897C070ADBF76221572C52609D
      ----\n               Ran apt-key adv --recv --keyserver hkp://p80.pool.sks-keyservers.net:80
      58118E89F3A912897C070ADBF76221572C52609D returned 2\n\n               Cookbook
      Trace:\n               ---------------\n               /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n               /tmp/kitchen/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb:41:in
      `run_action'\n\n               Resource Declaration:\n               ---------------------\n
      \              # In /tmp/kitchen/cache/cookbooks/chef-apt-docker/recipes/default.rb\n\n
      \               20: apt_repository 'docker' do\n                21:   uri 'https://apt.dockerproject.org/repo'\n
      \               22:   distribution \"#{node['platform']}-#{node['lsb']['codename']}\"\n
      \               23:   keyserver 'p80.pool.sks-keyservers.net'\n                24:
      \  components node['chef-apt-docker']['components']\n                25:   key
      '58118E89F3A912897C070ADBF76221572C52609D'\n                26: end\n\n               Compiled
      Resource:\n               ------------------\n               # Declared in /tmp/kitchen/cache/cookbooks/chef-apt-docker/recipes/default.rb:20:in
      `from_file'\n\n               apt_repository(\"docker\") do\n                 action
      [:add]\n                 retries 0\n                 retry_delay 2\n                 default_guard_interpreter
      :default\n                 declared_type :apt_repository\n                 cookbook_name
      \"chef-apt-docker\"\n                 recipe_name \"default\"\n                 uri
      \"https://apt.dockerproject.org/repo\"\n                 distribution \"ubuntu-trusty\"\n
      \                keyserver \"p80.pool.sks-keyservers.net\"\n                 components
      [\"main\"]\n                 key \"58118E89F3A912897C070ADBF76221572C52609D\"\n
      \                cache_rebuild true\n               end\n\n               Platform:\n
      \              ---------\n               x86_64-linux\n\n           Starting
      audit phase\n\n           Finished in 0.00027 seconds (files took 0.2757 seconds
      to load)\n           0 examples, 0 failures\n           Auditing complete\n\n
      \          Running handlers:\n           [2016-07-18T23:55:57+00:00] ERROR:
      Running exception handlers\n           Running handlers complete\n           [2016-07-18T23:55:57+00:00]
      ERROR: Exception handlers complete\n           Chef Client failed. 5 resources
      updated in 17 seconds\n           [2016-07-18T23:55:57+00:00] ERROR: Failed
      to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json\n
      \          [2016-07-18T23:55:57+00:00] FATAL: Stacktrace dumped to /tmp/kitchen/cache/chef-stacktrace.out\n
      \          [2016-07-18T23:55:57+00:00] FATAL: Please provide the contents of
      the stacktrace.out file if you file a bug report\n           [2016-07-18T23:55:57+00:00]
      ERROR: Found 1 errors, they are stored in the backtrace\n           [2016-07-18T23:55:58+00:00]
      FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully
      (exit code 1)\n    D      Cleaning up local sandbox in /tmp/cheftest/docker-default-ubuntu-1404-sandbox-20160718-27889-16j7fbk\n
      \   D      [SSH] shutting previous connection ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\",
      :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true,
      :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n    D      [SSH] closing
      connection to ubuntu@10.194.14.1<{:user_known_hosts_file=>\"/dev/null\", :paranoid=>false,
      :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60,
      :timeout=>15, :keys_only=>true, :keys=>[\"/home/jenkins/.ssh/jenkins.pem\"],
      :auth_methods=>[\"publickey\"], :user=>\"ubuntu\"}>\n    D      Converge failed
      on instance <docker-default-ubuntu-1404>.\n    D      ------Exception-------\n
      \   D      Class: Kitchen::InstanceFailure\n    D      Message: Converge failed
      on instance <docker-default-ubuntu-1404>.  Please see .kitchen/logs/docker-default-ubuntu-1404.log
      for more details\n    D      ----------------------\n    D      ------Backtrace-------\n
      \   D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:76:in
      `rescue in call'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:79:in
      `call'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:373:in
      `block in converge_action'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `call'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `synchronize_or_call'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:478:in
      `block in action'\n    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in
      `measure'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:477:in
      `action'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:369:in
      `converge_action'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:348:in
      `block in transition_to'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `each'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `transition_to'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:138:in
      `converge'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `public_send'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `run_action_in_thread'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:173:in
      `block (2 levels) in run_action'\n    D      ----End Backtrace-----\n    D      ---Nested
      Exception---\n    D      Class: Kitchen::ActionFailed\n    D      Message: SSH
      exited (1) for command: [sh -c '\n    sudo -E /opt/chefdk/bin/chef-client --local-mode
      --config /tmp/kitchen/client.rb --log_level auto --force-formatter --no-color
      --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889\n    ']\n    D
      \     ----------------------\n    D      ------Backtrace-------\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:76:in
      `rescue in call'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/provisioner/base.rb:79:in
      `call'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:373:in
      `block in converge_action'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `call'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:513:in
      `synchronize_or_call'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:478:in
      `block in action'\n    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in
      `measure'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:477:in
      `action'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:369:in
      `converge_action'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:348:in
      `block in transition_to'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `each'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:347:in
      `transition_to'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/instance.rb:138:in
      `converge'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `public_send'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:194:in
      `run_action_in_thread'\n    D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.2/lib/kitchen/command.rb:173:in
      `block (2 levels) in run_action'\n    D      ----End Backtrace-----\n    STDERR:
      >>>>>> Converge failed on instance <docker-default-ubuntu-1404>.\n    >>>>>>
      Please see .kitchen/logs/docker-default-ubuntu-1404.log for more details\n    >>>>>>
      ------Exception-------\n    >>>>>> Class: Kitchen::ActionFailed\n    >>>>>>
      Message: SSH exited (1) for command: [sh -c '\n    sudo -E /opt/chefdk/bin/chef-client
      --local-mode --config /tmp/kitchen/client.rb --log_level auto --force-formatter
      --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889\n    ']\n
      \   >>>>>> ----------------------\n    ---- End output of bundle exec kitchen
      converge  -c -l debug ----\n    Ran bundle exec kitchen converge  -c -l debug
      returned 10\n\n    Resource Declaration:\n    ---------------------\n    # In
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb\n\n
      \     1: top_cookbooks \"converge\"\n\n    Compiled Resource:\n    ------------------\n
      \   # Declared in /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb:1:in
      `from_file'\n\n    top_cookbooks(\"converge\") do\n      action [:run]\n      updated
      true\n      updated_by_last_action true\n      retries 0\n      retry_delay
      2\n      default_guard_interpreter :default\n      declared_type :top_cookbooks\n
      \     cookbook_name \"acceptance-cookbook\"\n      recipe_name \"provision\"\n
      \     command \"converge\"\n    end\n\n    Platform:\n    ---------\n    x86_64-linux\n\nStarting
      audit phase\n"
    9947: |2

      Running handlers:
      [2016-07-18T23:55:59+00:00] ERROR: Running exception handlers
      Running handlers complete
      [2016-07-18T23:55:59+00:00] ERROR: Exception handlers complete
      Chef Client failed. 2 resources updated in 02 minutes 01 seconds
      [2016-07-18T23:55:59+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/failed-audit-data.json
      [2016-07-18T23:55:59+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/chef-stacktrace.out
      [2016-07-18T23:55:59+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
      [2016-07-18T23:55:59+00:00] ERROR: Found 1 errors, they are stored in the backtrace
      [2016-07-18T23:55:59+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
      STDERR:
      ---- End output of chef-client -z -c /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/dna.json -o acceptance-cookbook::provision --no-color ----
      Ran chef-client -z -c /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/dna.json -o acceptance-cookbook::provision --no-color returned 1
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:289:in `invalid!'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:276:in `error!'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:53:in `block in run!'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `block in with_clean_env'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:447:in `with_env'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `with_clean_env'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:42:in `run!'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:149:in `run_command'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:116:in `block in run_suite'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `each'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `run_suite'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:76:in `block (2 levels) in start_worker'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `loop'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `block in start_worker'
      CHEF-ACCEPTANCE::[2016-07-18 23:55:59 +0000] --force-destroy specified so attempting to run the destroy recipe
      TOP-COOKBOOKS::DESTROY::[2016-07-18 23:55:59 +0000] Initialized [/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/logs/top-cookbooks/destroy.log] logger...
    10232: |
      CHEF-ACCEPTANCE::[2016-07-18 23:56:48 +0000] | top-cookbooks | Total         | 00:02:53 | Y     |
      CHEF-ACCEPTANCE::[2016-07-18 23:56:48 +0000] | Run           | Total         | 00:02:53 | Y     |
      Build step 'Invoke XShell command' marked build as failure
      Archiving artifacts
      Recording fingerprints
steps:
  total: 4m38s
  before (setup time): 1m43s
  CHEF-ACCEPTANCE:
    total: 2m54s
    TOP-COOKBOOKS::PROVISION: 2m5s
    TOP-COOKBOOKS::DESTROY: 49s
chef_acceptance_timing:
- top-cookbooks:
    provision: 1m52s
    force-destroy: 35s
    Total: 2m53s
  Run:
    Total: 2m53s

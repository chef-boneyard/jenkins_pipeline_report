---
result: FAILURE
failure_category: code
failure_cause: chef_acceptance[top-cookbooks::provision]
failed_in:
  chef_acceptance:
  - top-cookbooks::provision
  step: CHEF-ACCEPTANCE
timestamp: 2016-06-28 02:54:22 UTC
url: http://manhattan.ci.chef.co/job/chefdk-test/architecture=x86_64,platform=acceptance,project=chefdk,role=tester/242/
trigger_url: http://manhattan.ci.chef.co/job/chefdk-trigger-release/110/
duration: 1h23s
logs:
  consoleText:
    11651: |
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]                          Running handlers:
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]                          [2016-06-28T03:54:00+00:00] ERROR: Running exception handlers
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]                          Running handlers complete
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]                          [2016-06-28T03:54:00+00:00] ERROR: Exception handlers complete
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]                          Chef Client failed. 21 resources updated in 05 minutes 52 seconds
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]                          [2016-06-28T03:54:00+00:00] ERROR: Failed to post audit report to server. Saving report to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/failed-audit-data.json
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]                          [2016-06-28T03:54:00+00:00] FATAL: Stacktrace dumped to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/chef-stacktrace.out
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]                          [2016-06-28T03:54:00+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]                          [2016-06-28T03:54:00+00:00] FATAL: Chef::Exceptions::RunFailedWrappingError: Found 1 errors, they are stored in the backtrace
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]                   $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/2.1.0/i386-mingw32/dl.so: warning: already initialized constant DL::RUBY_FREE
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:00 +0000]                   $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/gems/2.1.0/gems/net-ssh-3.2.0/lib/net/ssh/authentication/pageant.rb:16: warning: previous definition of RUBY_FREE was here
    12873: |2
                       * powershell_script[conemu] action run

                         ================================================================================
                         Error executing action `run` on resource 'powershell_script[conemu]'
                         ================================================================================

                         Mixlib::ShellOut::ShellCommandFailed
                         ------------------------------------
                         Expected process to exit with [0], but received '1'
                         ---- Begin output of "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" ----
                         STDOUT: Installing the following packages:
                         conemu
                         By installing you accept licenses for the packages.
                         conemu not installed. The package was not found with the source(s) listed.
                          If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                          Version: ""
                          Source(s): "https://chocolatey.org/api/v2/"

                         Chocolatey installed 0/1 packages. 1 packages failed.
                          See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                         Failures
                          - conemu - conemu not installed. The package was not found with the source(s) list
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:01 +0000] ed.
                          If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
    12967: |
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:01 +0000]
                     Running handlers:
                     [2016-06-28T03:54:00+00:00] ERROR: Running exception handlers
                     Running handlers complete
                     [2016-06-28T03:54:00+00:00] ERROR: Exception handlers complete
                     Chef Client failed. 21 resources updated in 05 minutes 52 seconds
                     [2016-06-28T03:54:00+00:00] ERROR: Failed to post audit report to server. Saving report to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/failed-audit-data.json
                     [2016-06-28T03:54:00+00:00] FATAL: Stacktrace dumped to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/chef-stacktrace.out
                     [2016-06-28T03:54:00+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                     [2016-06-28T03:54:00+00:00] FATAL: Chef::Exceptions::RunFailedWrappingError: Found 1 errors, they are stored in the backtrace
              $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/2.1.0/i386-mingw32/dl.so: warning: already initialized constant DL::RUBY_FREE
              $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/gems/2.1.0/gems/net-ssh-3.2.0/lib/net/ssh/authentication/pageant.rb:16: warning: previous definition of RUBY_FREE was here
    13089: |2

      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:01 +0000]
            ================================================================================
            Error executing action `run` on resource 'cookbook_kitchen[converge winbox]'
            ================================================================================

            Mixlib::ShellOut::ShellCommandFailed
            ------------------------------------
            execute[bundle exec kitchen converge  -c -l debug] (/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb line 36) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '10'
            ---- Begin output of bundle exec kitchen converge  -c -l debug ----
            STDOUT: -----> Starting Kitchen (v1.9.0)
            D      Berksfile found at /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/winbox/Berksfile, loading Berkshelf
            D      Berkshelf 4.3.3 library loaded
            D      winrm requested, loading winrm gem (["~> 1.6"])
            D      winrm is loaded.
            D      winrm-fs requested, loading winrm-fs gem (["~> 0.4.1"])
            D      winrm-fs is loaded.
            -----> Creating <default-windows-2012r2>...
            D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
            D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
            D      Search returned 3 images:
            D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
            D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
            D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.04.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-04-13T01:30:48.000Z
            D      Image for default-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                   Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
            D      No SSH username specified: using default username administrator  for image ami-8d0acfed, which we detected as windows 2012r2rtm x86_64.
                   If you are not using an account that qualifies under the AWS
            free-tier, you may be charged to run these suites. The charge
            should be minimal, but neither Test Kitchen nor its maintainers
            are responsible for your incurred costs.

            D      Creating EC2 instance in region us-west-2 with properties:
            D      - instance_type = "m3.large"
            D      - ebs_optimized = false
            D      - image_id = "ami-8d0acfed"
            D      - key_name = "jenkins"
            D      - subnet_id = "subnet-19ac017c"
            D      - private_ip_address = nil
            D      - placement = {:availability_zone=>"us-west-2a"}
            D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
            D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lu
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:01 +0000] cnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                   Instance <i-b502d11a> requested.
    14207: |2
                     * powershell_script[conemu] action run

                       ================================================================================
                       Error executing action `run` on resource 'powershell_script[conemu]'
                       ================================================================================

                       Mixlib::ShellOut::ShellCommandFailed
                       ------------------------------------
                       Expected process to exit with [0], but received '1'
                       ---- Begin output of "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" ----
                       STDOUT: Installing the following packages:
                       conemu
                       By installing you accept licenses for the packages.
                       conemu not installed. The package was not found with the source(s) listed.
                        If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                        Version: ""
                        Source(s): "https://chocolatey.org/api/v2/"

                       Chocolatey installed 0/1 packages. 1 packages failed.
                        See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                       Failures
                        - conemu - conemu not installed. The package was not found with the source(s) listed.

      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:01 +0000] If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                        Version: ""
    14300: |2

                   Running handlers:
                   [2016-06-28T03:54:00+00:00] ERROR: Running exception handlers
                   Running handlers complete

      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:01 +0000]      [2016-06-28T03:54:00+00:00] ERROR: Exception handlers complete
                   Chef Client failed. 21 resources updated in 05 minutes 52 seconds
                   [2016-06-28T03:54:00+00:00] ERROR: Failed to post audit report to server. Saving report to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/failed-audit-data.json
                   [2016-06-28T03:54:00+00:00] FATAL: Stacktrace dumped to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/chef-stacktrace.out
                   [2016-06-28T03:54:00+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                   [2016-06-28T03:54:00+00:00] FATAL: Chef::Exceptions::RunFailedWrappingError: Found 1 errors, they are stored in the backtrace
            $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/2.1.0/i386-mingw32/dl.so: warning: already initialized constant DL::RUBY_FREE
            $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/gems/2.1.0/gems/net-ssh-3.2.0/lib/net/ssh/authentication/pageant.rb:16: warning: previous definition of RUBY_FREE was here
    14418: |2


          ================================================================================
          Error executing action `run` on resource 'top_cookbooks[converge]'
          ================================================================================

          Mixlib::ShellOut::ShellCommandFailed
          ------------------------------------
          cookbook_kitchen[converge winbox] (/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/top_cookbooks.rb line 32) had an error: Mixlib::ShellOut::ShellCommandFailed: execute[bundle exec kitchen converge  -c -l debug] (/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb line 36) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '10'
          ---- Begin output of bundle exec kitchen converge  -c -l debug ----
          STDOUT: -----> Starting Kitchen (v1.9.0)
          D      Berksfile found at /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/winbox/Berksfile, loading Berkshelf
          D      Berkshelf 4.3.3 library loaded
          D      winrm requested, loading winrm gem (["~> 1.6"])
          D      winrm is loaded.
          D      winrm-fs requested, loading winrm-fs gem (["~> 0.4.1"])
          D      winrm-fs is loaded.
          -----> Creating <default-windows-2012r2>...
          D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
          D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
          D      Search returned 3 images:
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.04.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-04-13T01:30:48.000Z
          D      Image for default-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                 Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
          D      No SSH username specified: using default username administrator  for image ami-8d0acfed, which we detected as windows 2012r2rtm x86_64.
                 If you are not using an account that qualifie
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:01 +0000] s under the AWS
          free-tier, you may be charged to run these suites. The charge
    15535: |2
                   * powershell_script[conemu] action run

                     ================================================================================
                     Error executing action `run` on resource 'powershell_script[conemu]'
                     ================================================================================

                     Mixlib::ShellOut::ShellCommandFailed
                     ------------------------------------
                     Expected process to exit with [0], but received '1'
                     ---- Begin output of "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" ----
                     STDOUT: Installing the following packages:
                     conemu
                     By installing you accept licenses for the packages.
                     conemu not installed. The package was not found with the source(s) listed.
                      If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                      Version: ""
                      Source(s): "https://chocolatey.org/api/v2/"

                     Chocolatey installed 0/1 packages. 1 packages failed.
                      See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                     Failures
                      - conemu - conemu not installed. The package was not found with the source(s) listed.
                      If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                      Version: ""
                      Source(s): "https://chocolatey.org/api/v2/"
                     Installing the following packages:
                     conemu
                     By installing you accept licenses for the packages.
                     conemu not installed. The package was not found with the source(s) listed.
                      If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                      Version: ""
                      Source(s): "https://chocolatey.org/api/v2/"

                     Chocolatey installed 0/1 packages. 1 packages failed.
                      See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                     Failures
                      - conemu - conemu not installed. The package was not found with the so
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:01 +0000] urce(s) listed.
                      If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
    15628: |2

                 Running handlers:
                 [2016-06-28T03:54:00+00:00] ERROR: Running exception handlers
                 Running handlers complete
                 [2016-06-28T03:54:00+00:00] ERROR: Exception handlers complete
                 Chef Client failed. 21 resources updated in 05 minutes 52 seconds
                 [2016-06-28T03:54:00+00:00] ERROR: Failed to post audit report to server. Saving report to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/failed-audit-data.json
                 [2016-06-28T03:54:00+00:00] FATAL: Stacktrace dumped to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/chef-stacktrace.out
                 [2016-06-28T03:54:00+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                 [2016-06-28T03:54:00+00:00] FATAL: Chef::Exceptions::RunFailedWrappingError: Found 1 errors, they are stored in the backtrace
          $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/2.1.0/i386-mingw32/dl.so: warning: already initialized constant DL::RUBY_FREE
          $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/gems/2.1.0/gems/net-ssh-3.2.0/lib/net/ssh/authentication/pageant.rb:16: warning: previous definition of RUBY_FREE was here
    15743: |2

      Running handlers:
      [2016-06-28T03:54:02+00:00] ERROR: Running exception handlers
      Running handlers complete
      [2016-06-28T03:54:02+00:00] ERROR: Exception handlers complete
      Chef Client failed. 23 resources updated in 57 minutes 42 seconds
      [2016-06-28T03:54:02+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/failed-audit-data.json
      [2016-06-28T03:54:02+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/chef-stacktrace.out
      [2016-06-28T03:54:02+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
      [2016-06-28T03:54:02+00:00] ERROR: Found 1 errors, they are stored in the backtrace
      TOP-COOKBOOKS::PROVISION::[2016-06-28 03:54:02 +0000] [2016-06-28T03:54:02+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
      CHEF-ACCEPTANCE::[2016-06-28 03:54:02 +0000] Encountered an error running the recipe provision: Expected process to exit with [0], but received '1'
      ---- Begin output of chef-client -z -c /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/dna.json -o acceptance-cookbook::provision --no-color ----
    26168: |2
                                 * powershell_script[conemu] action run

                                   ================================================================================
                                   Error executing action `run` on resource 'powershell_script[conemu]'
                                   ================================================================================

                                   Mixlib::ShellOut::ShellCommandFailed
                                   ------------------------------------
                                   Expected process to exit with [0], but received '1'
                                   ---- Begin output of "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" ----
                                   STDOUT: Installing the following packages:
                                   conemu
                                   By installing you accept licenses for the packages.
                                   conemu not installed. The package was not found with the source(s) listed.
                                    If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                                    Version: ""
                                    Source(s): "https://chocolatey.org/api/v2/"

                                   Chocolatey installed 0/1 packages. 1 packages failed.
                                    See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                                   Failures
                                    - conemu - conemu not installed. The package was not found with the source(s) listed.
                                    If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                                    Version: ""
                                    Source(s): "https://chocolatey.org/api/v2/"
                                   Installing the following packages:
                                   conemu
                                   By installing you accept licenses for the packages.
                                   conemu not installed. The package was not found with the source(s) listed.
                                    If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                                    Version: ""
                                    Source(s): "https://chocolatey.org/api/v2/"

                                   Chocolatey installed 0/1 packages. 1 packages failed.
                                    See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                                   Failures
                                    - conemu - conemu not installed. The package was not found with the source(s) listed.
                                    If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                                    Version: ""
                                    Source(s): "https://chocolatey.org/api/v2/"
                                   STDERR:
                                   ---- End output of "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" ----
                                   Ran "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" returned 1

                                   Resource Declaration:
                                   ---------------------
                                   # In C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/cookbooks/winbox/recipes/console.rb

                                    27: powershell_script 'conemu' do
                                    28:   code <<-EOH
                                    29: chocolatey install conemu -y
                                    30: if ($LASTEXITCODE -ne 0)
                                    31: {
                                    32:   $LASTEXITCODE = 0
                                    33:   chocolatey install conemu -y
                                    34: }
                                    35: EOH
                                    36:   only_if '(get-wmiobject Win32_MSIResource | Where-Object -Property value -like -Value conemu) -eq $null'
                                    37: end
                                    38:

                                   Compiled Resource:
                                   ------------------
                                   # Declared in C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/cookbooks/winbox/recipes/console.rb:27:in `from_file'

                                   powershell_script("conemu") do
                                     action [:run]
                                     retries 0
                                     retry_delay 2
                                     default_guard_interpreter :powershell_script
                                     command "conemu"
                                     backup 5
                                     returns 0
                                     code "chocolatey install conemu -y\nif ($LASTEXITCODE -ne 0)\n{\n  $LASTEXITCODE = 0\n  chocolatey install conemu -y\n}\n"
                                     interpreter "powershell.exe"
                                     declared_type :powershell_script
                                     cookbook_name "winbox"
                                     recipe_name "console"
                                     only_if "(get-wmiobject Win32_MSIResource | Where-Object -Property value -like -Value conemu) -eq $null"
                                   end

                                   Platform:
                                   ---------
                                   i386-mingw32

                               Starting audit phase
    26260: |2

                               Running handlers:
                               [2016-06-28T03:54:00+00:00] ERROR: Running exception handlers
                               Running handlers complete
                               [2016-06-28T03:54:00+00:00] ERROR: Exception handlers complete
                               Chef Client failed. 21 resources updated in 05 minutes 52 seconds
                               [2016-06-28T03:54:00+00:00] ERROR: Failed to post audit report to server. Saving report to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/failed-audit-data.json
                               [2016-06-28T03:54:00+00:00] FATAL: Stacktrace dumped to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/chef-stacktrace.out
                               [2016-06-28T03:54:00+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                               [2016-06-28T03:54:00+00:00] FATAL: Chef::Exceptions::RunFailedWrappingError: Found 1 errors, they are stored in the backtrace
                        $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/2.1.0/i386-mingw32/dl.so: warning: already initialized constant DL::RUBY_FREE
                        $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/gems/2.1.0/gems/net-ssh-3.2.0/lib/net/ssh/authentication/pageant.rb:16: warning: previous definition of RUBY_FREE was here
    26335: |2
                        D      [WinRM] remote shell 527C3D98-8885-4FD3-8A22-5EAE4548481A closed

              ================================================================================
              Error executing action `run` on resource 'execute[bundle exec kitchen converge  -c -l debug]'
              ================================================================================

              Mixlib::ShellOut::ShellCommandFailed
              ------------------------------------
              Expected process to exit with [0], but received '10'
              ---- Begin output of bundle exec kitchen converge  -c -l debug ----
              STDOUT: -----> Starting Kitchen (v1.9.0)
              D      Berksfile found at /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/winbox/Berksfile, loading Berkshelf
              D      Berkshelf 4.3.3 library loaded
              D      winrm requested, loading winrm gem (["~> 1.6"])
              D      winrm is loaded.
              D      winrm-fs requested, loading winrm-fs gem (["~> 0.4.1"])
              D      winrm-fs is loaded.
              -----> Creating <default-windows-2012r2>...
              D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
              D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
              D      Search returned 3 images:
              D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
              D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
              D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.04.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-04-13T01:30:48.000Z
              D      Image for default-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                     Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
              D      No SSH username specified: using default username administrator  for image ami-8d0acfed, which we detected as windows 2012r2rtm x86_64.
                     If you are not using an account that qualifies under the AWS
              free-tier, you may be charged to run these suites. The charge
              should be minimal, but neither Test Kitchen nor its maintainers
              are responsible for your incurred costs.

              D      Creating EC2 instance in region us-west-2 with properties:
              D      - instance_type = "m3.large"
              D      - ebs_optimized = false
              D      - image_id = "ami-8d0acfed"
              D      - key_name = "jenkins"
              D      - subnet_id = "subnet-19ac017c"
              D      - private_ip_address = nil
              D      - placement = {:availability_zone=>"us-west-2a"}
              D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
              D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                     Instance <i-b502d11a> requested.
                     Polling AWS for existence, attempt 0...
                     Attempting to tag the instance, 0 retries
                     EC2 instance <i-b502d11a> created.
                     Waited 0/300s for instance <i-b502d11a> to become ready.
                     Waited 5/300s for instance <i-b502d11a> to become ready.
                     Waited 10/300s for instance <i-b502d11a> to become ready.
                     Waited 15/300s for instance <i-b502d11a> to become ready.
                     Waited 20/300s for instance <i-b502d11a> to become ready.
                     Waited 25/300s for instance <i-b502d11a> to become ready.
                     Waited 30/300s for instance <i-b502d11a> to become ready.
                     Waited 35/300s for instance <i-b502d11a> to become ready.
                     Waited 40/300s for instance <i-b502d11a> to become ready.
                     Waited 45/300s for instance <i-b502d11a> to become ready.
                     Waited 50/300s for instance <i-b502d11a> to become ready.
                     Waited 55/300s for instance <i-b502d11a> to become ready.
                     Waited 60/300s for instance <i-b502d11a> to become ready.
                     Waited 65/300s for instance <i-b502d11a> to become ready.
                     Waited 70/300s for instance <i-b502d11a> to become ready.
                     Waited 75/300s for instance <i-b502d11a> to become ready.
                     Waited 80/300s for instance <i-b502d11a> to become ready.
                     Waited 85/300s for instance <i-b502d11a> to become ready.
                     Waited 90/300s for instance <i-b502d11a> to become ready.
                     Waited 95/300s for instance <i-b502d11a> to become ready.
                     Waited 100/300s for instance <i-b502d11a> to become ready.
              D      Console output: ---
              2016/06/28 03:45:05Z: EC2ConfigMonitorState: 0
              2016/06/28 03:45:05Z: Windows sysprep configuration complete.
              2016/06/28 03:45:09Z: AMI Origin Version: 2016.06.15
              2016/06/28 03:45:09Z: AMI Origin Name: Windows_Server-2012-R2_RTM-English-64Bit-Base
              2016/06/28 03:45:09Z: OS: Microsoft Windows NT 6.3.9600
              2016/06/28 03:45:09Z: OsVersion: 6.3
              2016/06/28 03:45:09Z: OsProductName: Windows Server 2012 R2 Standard
              2016/06/28 03:45:09Z: OsBuildLabEx: 9600.18292.amd64fre.winblue_ltsb.160330-1744
              2016/06/28 03:45:09Z: Language: en-US
              2016/06/28 03:45:09Z: TimeZone: Coordinated Universal Time
              2016/06/28 03:45:09Z: Offset: UTC 00:00:00
              2016/06/28 03:45:09Z: EC2 Agent: Ec2Config service v3.17.1032
              2016/06/28 03:45:11Z: Message: Waiting for meta-data accessibility...
              2016/06/28 03:45:11Z: Message: Meta-data is now available.
              2016/06/28 03:45:12Z: AMI-ID: ami-8d0acfed
              2016/06/28 03:45:12Z: Instance-ID: i-b502d11a
              2016/06/28 03:45:13Z: Driver: AWS PV Network Device v7.3.2.0
              2016/06/28 03:45:13Z: Driver: AWS PV Storage Host Adapter v7.3.2.0
              2016/06/28 03:45:13Z: Ec2SetPassword: Enabled
              2016/06/28 03:45:13Z: RDPCERTIFICATE-SUBJECTNAME: WIN-BNKEQGJ67NR
              2016/06/28 03:45:13Z: RDPCERTIFICATE-THUMBPRINT: 2E8BF7BD57958ED85A9DE40C8BF35F10E0C6055B
              2016/06/28 03:45:16Z: Username: Administrator
              2016/06/28 03:45:16Z: Password: <Password>
              vnp1wei+6gpf/Jp/BSsKj6kEqjgBifbUU25L2LrVoAXrfC3clMdQx/7PapIDlxl7LcgdgHtrW7wfNpqgRyxjAkGm+Dp3vU90hQ7hSVn3ADvOtt5mgUX383cjQyNXZT525g1ko9BcZKZ3+CBV8TRA62CF0eLa5r0VB9dIP/x6U41MSgql5ZOSSYrglyDlyabZPRgIpaTks7lHifqduiMazKC5HPK6wVBfuiTF7DHY/alBPVcx1eqCKHyDUOg5SBKD5BgI4Kh7lhLeUPrv6cgIv6Sy7KOZi6HUHbfVIrTx4ImCGztxijleWLkL5WbxAaPcBNQE8cSjFTdQqJpTV0npvw==
              </Password>
              2016/06/28 03:45:18Z: Message: Windows is Ready to use

                     Waited 0/300s for instance <i-b502d11a> to fetch windows admin password.
                     Retrieved Windows password for instance <i-b502d11a>.
                     EC2 instance <i-b502d11a> ready.
              D      [WinRM] opening remote shell on http://10.194.8.202:5985/wsman
              D      [WinRM] remote shell 5543ED20-7DD5-4564-8B3C-F44F26F67293 is open on http://10.194.8.202:5985/wsman
              D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (Write-Host '[WinRM] Established
              ')
                     [WinRM] Established

              D      [WinRM] reusing existing connection negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
              D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File)


                         Directory: C:\chef\ohai\hints


                     Mode                LastWriteTime     Length Name
                     ----                -------------     ------ ----
                     -a---         6/28/2016   3:45 AM          0 ec2.json


              D      ec2:create '10.194.8.202'
                     Finished creating <default-windows-2012r2> (2m14.56s).
              -----> Converging <default-windows-2012r2>...
                     Preparing files for transfer
              D      Creating local sandbox in /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa
                     Preparing dna.json
              D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>["recipe[winbox::default]"]}
                     Resolving cookbook dependencies with Berkshelf 4.3.3...
              D      Using Berksfile from /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/winbox/Berksfile
                     Removing non-cookbook files before transfer
                     Preparing validation.pem
              D      Using a dummy validation.pem
                     Preparing client.rb
              D      Creating client.rb from {:node_name=>"default-windows-2012r2", :checksum_path=>"\#{ENV['TEMP']}\\kitchen\\checksums", :file_cache_path=>"\#{ENV['TEMP']}\\kitchen\\cache", :file_backup_path=>"\#{ENV['TEMP']}\\kitchen\\backup", :cookbook_path=>["\#{ENV['TEMP']}\\kitchen\\cookbooks", "\#{ENV['TEMP']}\\kitchen\\site-cookbooks"], :data_bag_path=>"\#{ENV['TEMP']}\\kitchen\\data_bags", :environment_path=>"\#{ENV['TEMP']}\\kitchen\\environments", :node_path=>"\#{ENV['TEMP']}\\kitchen\\nodes", :role_path=>"\#{ENV['TEMP']}\\kitchen\\roles", :client_path=>"\#{ENV['TEMP']}\\kitchen\\clients", :user_path=>"\#{ENV['TEMP']}\\kitchen\\users", :validation_key=>"\#{ENV['TEMP']}\\kitchen\\validation.pem", :client_key=>"\#{ENV['TEMP']}\\kitchen\\client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"\#{ENV['TEMP']}\\kitchen\\encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
              D      [WinRM] reusing existing connection negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
              D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (new-module -name Omnitruck -scriptblock {
              function Get-PlatformVersion {
                switch -regex ((get-wmiobject win32_operatingsystem).version) {
                  '10\.0\.\d+' {$platform_version = '2012r2'}
                  '6\.3\.\d+'  {$platform_version = '2012r2'}
                  '6\.2\.\d+'  {$platform_version = '2012'}
                  '6\.1\.\d+'  {$platform_version = '2008r2'}
                  '6\.0\.\d+'  {$platform_version = '2008'}
                }
                return $platform_version
              }

              function Get-PlatformArchitecture {
                if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                  $architecture = 'x86_64'
                } else {
                  $architecture = 'i386'
                }
                return $architecture
              }

              function New-Uri {
                param ($baseuri, $newuri)

                new-object System.Uri $baseuri, $newuri
              }

              function Get-WebContent {
                param ($uri, $filepath)
                $proxy = New-Object -TypeName System.Net.WebProxy
                $wc = new-object System.Net.WebClient
                $proxy.Address = $env:http_proxy
                $wc.Proxy = $proxy

                try {
                  if ([string]::IsNullOrEmpty($filepath)) {
                    $wc.downloadstring($uri)
                  }
                  else {
                    $wc.downloadfile($uri, $filepath)
                  }
                }
                catch {
                  $exception = $_.Exception
                  Write-Host "There was an error: "
                  do {
                    Write-Host "`t$($exception.message)"
                    $exception = $exception.innerexception
                  } while ($exception)
                  throw "Failed to download from $uri."
                }
              }

              function Test-ProjectPackage {
                [cmdletbinding()]
                param ($Path, $Algorithm = 'SHA256', $Hash)

                if (-not (get-command get-filehash))   {
                  function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                  function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                  function Get-FileHash ($Path, $Algorithm) {
                    $Path = (resolve-path $path).providerpath
                    $hash = @{Algorithm = $Algorithm; Path = $Path}
                    use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                      use ($in = (gi $path).OpenRead()) {
                        $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                      }
                    }
                    new-object PSObject -Property $hash
                  }
                }
                Write-Verbose "Testing the $Algorithm hash for $path."
                $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                Write-Verbose "`tDesired Hash - '$hash'"
                Write-Verbose "`tActual Hash  - '$ActualHash'"
                $Valid = $ActualHash -eq $Hash
                if (-not $Valid) {
                  Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                }
                return $Valid
              }

              function Get-ProjectMetadata {
                <#
                  .SYNOPSIS
                  Get metadata for a Chef Software, Inc. project
                  .DESCRIPTION
                  Get metadata for project
                  .EXAMPLE
                  iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                  Gets the download url and SHA256 checksum for the latest stable release of Chef.
                  .EXAMPLE
                  iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                  Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                #>
                [cmdletbinding()]
                param (
                  # Base url to retrieve metadata from.
                  [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                  [string]
                  # Project to install
                  [string]
                  $project = 'chef',
                  # Version of the application to install
                  # This parameter is optional, if not supplied it will provide the latest version,
                  # and if an iteration number is not specified, it will grab the latest available iteration.
                  # Partial version numbers are also acceptable (using v=11
                  # will grab the latest 11.x client which matches the other flags).
                  [string]
                  $version,
                  # Release channel to install from
                  $channel = 'unstable',
                  # The following legacy switches are just aliases for the current channel
                  [switch]
                  $prerelease,
                  [switch]
                  $nightlies,
                  [validateset('auto', 'i386', 'x86_64')]
                  [string]
                  $architecture = 'auto'
                )

                # PowerShell is only on Windows ATM
                $platform = 'windows'
                Write-Verbose "Platform: $platform"

                $platform_version = Get-PlatformVersion
                Write-Verbose "Platform Version: $platform_version"

                if ($architecture -eq 'auto') {
                  $architecture = Get-PlatformArchitecture
                }

                Write-Verbose "Architecture: $architecture"
                Write-Verbose "Project: $project"


                  $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/mac_os_x/10.9/chefdk-0.16.12-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 f337fa924b29a79686a681e3f24f03d391f57ba3c612b09db3821cb047573ee8" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/mac_os_x/10.10/chefdk-0.16.12-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 f337fa924b29a79686a681e3f24f03d391f57ba3c612b09db3821cb047573ee8" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/mac_os_x/10.11/chefdk-0.16.12-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 f337fa924b29a79686a681e3f24f03d391f57ba3c612b09db3821cb047573ee8" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/el/7/chefdk-0.16.12-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 f81822f72b09d67bff1ebd2752b693a1683e770f10396fbee67556e1b7566844" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/ubuntu/12.04/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 5de5cc0d959920c825440000eb5eef7886e174890b9604e0ab0d331a76ca6f0b" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/ubuntu/14.04/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 5de5cc0d959920c825440000eb5eef7886e174890b9604e0ab0d331a76ca6f0b" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/debian/6/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 897f19ce1539ba79d7111880ba5b7a59028d21a0e69c7d6a35faae476b9efb9a" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/debian/7/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 897f19ce1539ba79d7111880ba5b7a59028d21a0e69c7d6a35faae476b9efb9a" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/debian/8/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 897f19ce1539ba79d7111880ba5b7a59028d21a0e69c7d6a35faae476b9efb9a" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/el/6/chefdk-0.16.12-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 59e6862a4c825037ef58c1341adea73d946491f127445e5522c211ac983262b8" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/windows/2008r2/chefdk-0.16.12-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 24ad3c76028785f8b0f147917029150010d7908cf3795f8b71d4b338e71efff8" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/windows/2012/chefdk-0.16.12-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 24ad3c76028785f8b0f147917029150010d7908cf3795f8b71d4b338e71efff8" | out-file "$artifact_info_dir/artifact_info" -Append

                  $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                  New-Item -ItemType directory -Path $artifact_info_dir -force
                  New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                  "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/windows/2012r2/chefdk-0.16.12-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                  "sha256 24ad3c76028785f8b0f147917029150010d7908cf3795f8b71d4b338e71efff8" | out-file "$artifact_info_dir/artifact_info" -Append


                $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                  foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                Write-Verbose "Project details: "
                foreach ($key in $package_metadata.keys) {
                  Write-Verbose "`t$key = $($package_metadata[$key])"
                }
                $package_metadata
              }

              function Install-Project {
                <#
                  .SYNOPSIS
                  Install a Chef Software, Inc. product
                  .DESCRIPTION
                  Install a Chef Software, Inc. product
                  .EXAMPLE
                  iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                  Installs the latest stable version of Chef.
                  .EXAMPLE
                  iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                  Installs the latest integration build of the Chef Development Kit
                #>
                [cmdletbinding(SupportsShouldProcess=$true)]
                param (
                  # Project to install
                  [string]
                  $project = 'chef',
                  # Release channel to install from
                  [validateset('current', 'stable', 'unstable')]
                  [string]
                  $channel = 'stable',
                  # Version of the application to install
                  # This parameter is optional, if not supplied it will provide the latest version,
                  # and if an iteration number is not specified, it will grab the latest available iteration.
                  # Partial version numbers are also acceptable (using v=11
                  # will grab the latest 11.x client which matches the other flags).
                  [string]
                  $version,
                  # Full path for the downloaded installer.
                  [string]
                  $filename,
                  # Full path to the location to download the installer
                  [string]
                  $download_directory = $env:temp,
                  # The following legacy switches are just aliases for the current channel
                  [switch]
                  $prerelease,
                  [switch]
                  $nightlies,
                  [validateset('auto', 'i386', 'x86_64')]
                  [string]
                  $architecture = 'auto'
                )

                $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                if (-not [string]::IsNullOrEmpty($filename)) {
                  $download_directory = split-path $filename
                  $filename = split-path $filename -leaf
                  if ([string]::IsNullOrEmpty($download_directory)) {
                    $download_directory = $pwd
                  }
                }
                else {
                  $filename = ($package_metadata.url -split '/')[-1]
                }
                Write-Verbose "Download directory: $download_directory"
                Write-Verbose "Filename: $filename"

                if (-not (test-path $download_directory)) {
                  mkdir $download_directory
                }
                $download_directory = (resolve-path $download_directory).providerpath
                $download_destination = join-path $download_directory $filename

                if ((test-path $download_destination) -and
                  (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                  Write-Verbose "Found existing valid installer at $download_destination."
                }
                else {
                  if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                    Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                    Get-WebContent $package_metadata.url -filepath $download_destination
                  }
                }

                if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                  if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                    Write-Host "Installing $project from $download_destination"
                    $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                    $p.WaitForExit()
                    if ($p.ExitCode -ne 0) {
                      throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                    }
                  }
                  else {
                    throw "Failed to validate the downloaded installer for $project."
                  }
                }
              }
              set-alias install -value Install-Project
              export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

              }

              install -project chefdk -version 0.16.12 -channel unstable -architecture i386
              )
              D      creating hash for file $env:TEMP/default-windows-2012r2-long_script.ps1
              D      Running check_files.ps1
              D      @{
              D        "0a865588a80b701c316a564bcff56c63" = @{
              D          "target" = "$env:TEMP/default-windows-2012r2-long_script.ps1";
              D          "src_basename" = "default-windows-2012r2-long_script.ps1";
              D          "dst" = "$env:TEMP/default-windows-2012r2-long_script.ps1"
              D        }
              D      }
              D      [WinRM] opening new shell since the current one failed
              D      [WinRM] opening remote shell on http://10.194.8.202:5985/wsman
              D      [WinRM] remote shell 527C3D98-8885-4FD3-8A22-5EAE4548481A is open on http://10.194.8.202:5985/wsman
              D      Parsing CSV Response
              D      "chk_exists","src_md5","dst_md5","chk_dirty","verifies","target_is_folder"
              "False","0a865588a80b701c316a564bcff56c63",,"True","False","False"

              D      Uploading /tmp/cheftest/kitchen-long-script20160628-7187-7rpp3o/default-windows-2012r2-long_script.ps1 to encoded tmpfile $env:TEMP\b64-0a865588a80b701c316a564bcff56c63.txt
              D      Finished uploading /tmp/cheftest/kitchen-long-script20160628-7187-7rpp3o/default-windows-2012r2-long_script.ps1 to encoded tmpfile $env:TEMP\b64-0a865588a80b701c316a564bcff56c63.txt (20.44 KB over 3 chunks) in (0m0.30s)
              D      Running decode_files.ps1
              D      @{
              D        "$env:TEMP\b64-0a865588a80b701c316a564bcff56c63.txt" = @{
              D          "dst" = "$env:TEMP/default-windows-2012r2-long_script.ps1"
              D        }
              D      }
              D      Parsing CSV Response
              D      "src_md5","tmpzip","verifies","tmpfile","dst_md5","dst"
              "0a865588a80b701c316a564bcff56c63",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-0a865588a80b701c316a564bcff56c63.txt","0a865588a80b701c316a564bcff56c63","C:\Users\ADMINI~1\AppData\Local\Temp/default-windows-2012r2-long_script.ps1"

              D      Uploaded 1 items dirty_check: (0m0.83s) stream_files: (0m0.30s) decode: (0m0.96s)

                     ModuleType Version    Name                                ExportedCommands
                     ---------- -------    ----                                ----------------
                     Script     0.0        Omnitruck                           {Get-ProjectMetada...
                     Installing chefdk from C:\Users\ADMINI~1\AppData\Local\Temp\chefdk-0.16.12-1-x86.msi
              D      [WinRM] retrying receive request after timeout


              D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> ($dirs = @("$env:TEMP\kitchen\clients", "$env:TEMP\kitchen\cookbooks", "$env:TEMP\kitchen\data", "$env:TEMP\kitchen\data_bags", "$env:TEMP\kitchen\encrypted_data_bag_secret", "$env:TEMP\kitchen\environments", "$env:TEMP\kitchen\roles")
              $root_path = "$env:TEMP\kitchen"

              Function Delete-AllDirs($dirs) {
                $dirs | ForEach-Object {
                  if (Test-Path ($path = Unresolve-Path $_)) { Remove-Item $path -Recurse -Force }
                }
              }

              Function Unresolve-Path($p) {
                if ($p -eq $null) { return $null }
                else { return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($p) }
              }

              Function Make-RootPath($p) {
                $p = Unresolve-Path $p
                if (-Not (Test-Path $p)) { New-Item $p -ItemType directory | Out-Null }
              }

              Delete-AllDirs $dirs
              Make-RootPath $root_path
              )
                     Transferring files to <default-windows-2012r2>
              D      creating hash for file $env:TEMP\kitchen
              D      creating hash for file $env:TEMP\kitchen
              D      creating hash for directory $env:TEMP\kitchen
              D      Populating files
              D      === All files added.
              D      creating hash for file $env:TEMP\kitchen
              D      creating hash for directory $env:TEMP\kitchen
              D      Populating files
              D      +++ Adding build-essential/README.md
              D      +++ Adding build-essential/attributes/default.rb
              D      +++ Adding build-essential/libraries/matchers.rb
              D      +++ Adding build-essential/libraries/xcode_command_line_tools.rb
              D      +++ Adding build-essential/metadata.json
              D      +++ Adding build-essential/recipes/_windows.rb
              D      +++ Adding build-essential/recipes/default.rb
              D      +++ Adding build-essential/resources/build_essential.rb
              D      +++ Adding chef_handler/README.md
              D      +++ Adding chef_handler/attributes/default.rb
              D      +++ Adding chef_handler/files/default/handlers/README
              D      +++ Adding chef_handler/libraries/helpers.rb
              D      +++ Adding chef_handler/libraries/matchers.rb
              D      +++ Adding chef_handler/metadata.json
              D      +++ Adding chef_handler/providers/default.rb
              D      +++ Adding chef_handler/recipes/default.rb
              D      +++ Adding chef_handler/recipes/json_file.rb
              D      +++ Adding chef_handler/resources/default.rb
              D      +++ Adding compat_resource/README.md
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/constants.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/delayed_evaluator.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/dsl/core.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/dsl/declare_resource.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/dsl/recipe.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/lazy_module_include.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/notifying_block.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/params_validate.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/powershell_out.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/properties.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/property.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/provider/noop.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/provider.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/resource/action_class.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/resource.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/resource_builder.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/mixin/properties.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/exceptions.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/log.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/mixin/params_validate.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/property.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/provider.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/recipe.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource/lwrp_base.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_builder.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_collection/resource_list.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_collection/resource_set.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_collection.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/run_context.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/property.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/recipe.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/resource/lwrp_base.rb
              D      +++ Adding compat_resource/files/lib/chef_compat/resource.rb
              D      +++ Adding compat_resource/files/lib/compat_resource/gemspec.rb
              D      +++ Adding compat_resource/files/lib/compat_resource/version.rb
              D      +++ Adding compat_resource/files/lib/compat_resource.rb
              D      +++ Adding compat_resource/files/spec/cookbook_spec.rb
              D      +++ Adding compat_resource/files/spec/data/Gemfile
              D      +++ Adding compat_resource/files/spec/data/Gemfile.lock
              D      +++ Adding compat_resource/files/spec/data/config.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/metadata.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/providers/resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/recipes/default.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/resources/resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/future/libraries/future_custom_resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/future/libraries/super_properties.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/future/metadata.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/future/recipes/declare_resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/future/resources/resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/future/resources/super_resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/libraries/normal_hwrp.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/metadata.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/providers/resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/resources/resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/libraries/normal_hwrp.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/metadata.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/providers/resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/recipes/declare_resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/resources/resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/notifications/metadata.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/notifications/recipes/default.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/notifications/resources/resource.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/test/metadata.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/test/recipes/default.rb
              D      +++ Adding compat_resource/files/spec/data/cookbooks/test/recipes/test.rb
              D      +++ Adding compat_resource/files/spec/data/nodes/ettores-mbp.lan.json
              D      +++ Adding compat_resource/files/spec/spec_helper.rb
              D      +++ Adding compat_resource/libraries/autoload.rb
              D      +++ Adding compat_resource/metadata.json
              D      +++ Adding dmg/README.md
              D      +++ Adding dmg/attributes/default.rb
              D      +++ Adding dmg/libraries/matchers.rb
              D      +++ Adding dmg/metadata.json
              D      +++ Adding dmg/providers/package.rb
              D      +++ Adding dmg/recipes/default.rb
              D      +++ Adding dmg/resources/package.rb
              D      +++ Adding git/README.md
              D      +++ Adding git/attributes/default.rb
              D      +++ Adding git/libraries/helpers.rb
              D      +++ Adding git/libraries/matchers.rb
              D      +++ Adding git/libraries/provider_git_client.rb
              D      +++ Adding git/libraries/provider_git_client_osx.rb
              D      +++ Adding git/libraries/provider_git_client_package.rb
              D      +++ Adding git/libraries/provider_git_client_source.rb
              D      +++ Adding git/libraries/provider_git_client_windows.rb
              D      +++ Adding git/libraries/provider_git_service.rb
              D      +++ Adding git/libraries/provider_git_service_xinetd.rb
              D      +++ Adding git/libraries/resource_git_client.rb
              D      +++ Adding git/libraries/resource_git_service.rb
              D      +++ Adding git/libraries/z_provider_mapping.rb
              D      +++ Adding git/metadata.json
              D      +++ Adding git/providers/config.rb
              D      +++ Adding git/recipes/default.rb
              D      +++ Adding git/recipes/package.rb
              D      +++ Adding git/recipes/server.rb
              D      +++ Adding git/recipes/source.rb
              D      +++ Adding git/recipes/windows.rb
              D      +++ Adding git/resources/config.rb
              D      +++ Adding git/templates/default/git-xinetd.d.erb
              D      +++ Adding git/templates/default/sv-git-daemon-log-run.erb
              D      +++ Adding git/templates/default/sv-git-daemon-run.erb
              D      +++ Adding mingw/README.md
              D      +++ Adding mingw/files/default/bash.bat
              D      +++ Adding mingw/files/default/custom-upgrade.sh
              D      +++ Adding mingw/files/default/pthread.h
              D      +++ Adding mingw/files/default/time.h
              D      +++ Adding mingw/libraries/_helper.rb
              D      +++ Adding mingw/metadata.json
              D      +++ Adding mingw/recipes/default.rb
              D      +++ Adding mingw/resources/get.rb
              D      +++ Adding mingw/resources/msys2_package.rb
              D      +++ Adding mingw/resources/tdm_gcc.rb
              D      +++ Adding seven_zip/README.md
              D      +++ Adding seven_zip/attributes/default.rb
              D      +++ Adding seven_zip/metadata.json
              D      +++ Adding seven_zip/providers/archive.rb
              D      +++ Adding seven_zip/recipes/default.rb
              D      +++ Adding seven_zip/resources/archive.rb
              D      +++ Adding winbox/README.md
              D      +++ Adding winbox/attributes/debugger_install_path.rb
              D      +++ Adding winbox/attributes/editor.rb
              D      +++ Adding winbox/files/default/ConEmu.xml
              D      +++ Adding winbox/files/default/chef-dk.ico
              D      +++ Adding winbox/files/default/get-help-full.ps1
              D      +++ Adding winbox/files/default/install.ps1
              D      +++ Adding winbox/files/default/set-location-docs.ps1
              D      +++ Adding winbox/files/default/start-chefdk.ps1
              D      +++ Adding winbox/files/default/vscode-keybindings.json
              D      +++ Adding winbox/files/default/vscode-settings.json
              D      +++ Adding winbox/files/default/winbox-ps-profile.ps1
              D      +++ Adding winbox/libraries/executable_finder.rb
              D      +++ Adding winbox/libraries/git_information.rb
              D      +++ Adding winbox/metadata.json
              D      +++ Adding winbox/recipes/chefdk.rb
              D      +++ Adding winbox/recipes/chefdk_shortcut.rb
              D      +++ Adding winbox/recipes/chocolatey_install.rb
              D      +++ Adding winbox/recipes/console.rb
              D      +++ Adding winbox/recipes/debugger.rb
              D      +++ Adding winbox/recipes/default.rb
              D      +++ Adding winbox/recipes/editor.rb
              D      +++ Adding winbox/recipes/powershell_dev.rb
              D      +++ Adding winbox/recipes/readline.rb
              D      +++ Adding winbox/recipes/vscode_emacs.rb
              D      +++ Adding windows/README.md
              D      +++ Adding windows/attributes/default.rb
              D      +++ Adding windows/files/default/handlers/windows_reboot_handler.rb
              D      +++ Adding windows/libraries/feature_base.rb
              D      +++ Adding windows/libraries/matchers.rb
              D      +++ Adding windows/libraries/powershell_helper.rb
              D      +++ Adding windows/libraries/powershell_out.rb
              D      +++ Adding windows/libraries/registry_helper.rb
              D      +++ Adding windows/libraries/version.rb
              D      +++ Adding windows/libraries/windows_architecture_helper.rb
              D      +++ Adding windows/libraries/windows_helper.rb
              D      +++ Adding windows/libraries/windows_package.rb
              D      +++ Adding windows/libraries/windows_privileged.rb
              D      +++ Adding windows/libraries/wmi_helper.rb
              D      +++ Adding windows/metadata.json
              D      +++ Adding windows/providers/auto_run.rb
              D      +++ Adding windows/providers/batch.rb
              D      +++ Adding windows/providers/certificate.rb
              D      +++ Adding windows/providers/certificate_binding.rb
              D      +++ Adding windows/providers/feature_dism.rb
              D      +++ Adding windows/providers/feature_powershell.rb
              D      +++ Adding windows/providers/feature_servermanagercmd.rb
              D      +++ Adding windows/providers/font.rb
              D      +++ Adding windows/providers/http_acl.rb
              D      +++ Adding windows/providers/pagefile.rb
              D      +++ Adding windows/providers/path.rb
              D      +++ Adding windows/providers/printer.rb
              D      +++ Adding windows/providers/printer_port.rb
              D      +++ Adding windows/providers/reboot.rb
              D      +++ Adding windows/providers/registry.rb
              D      +++ Adding windows/providers/shortcut.rb
              D      +++ Adding windows/providers/task.rb
              D      +++ Adding windows/providers/zipfile.rb
              D      +++ Adding windows/recipes/default.rb
              D      +++ Adding windows/recipes/reboot_handler.rb
              D      +++ Adding windows/resources/auto_run.rb
              D      +++ Adding windows/resources/batch.rb
              D      +++ Adding windows/resources/certificate.rb
              D      +++ Adding windows/resources/certificate_binding.rb
              D      +++ Adding windows/resources/feature.rb
              D      +++ Adding windows/resources/font.rb
              D      +++ Adding windows/resources/http_acl.rb
              D      +++ Adding windows/resources/pagefile.rb
              D      +++ Adding windows/resources/path.rb
              D      +++ Adding windows/resources/printer.rb
              D      +++ Adding windows/resources/printer_port.rb
              D      +++ Adding windows/resources/reboot.rb
              D      +++ Adding windows/resources/registry.rb
              D      +++ Adding windows/resources/shortcut.rb
              D      +++ Adding windows/resources/task.rb
              D      +++ Adding windows/resources/zipfile.rb
              D      +++ Adding yum/README.md
              D      +++ Adding yum/attributes/main.rb
              D      +++ Adding yum/libraries/matchers.rb
              D      +++ Adding yum/metadata.json
              D      +++ Adding yum/providers/globalconfig.rb
              D      +++ Adding yum/providers/repository.rb
              D      +++ Adding yum/recipes/default.rb
              D      +++ Adding yum/recipes/dnf_yum_compat.rb
              D      +++ Adding yum/resources/globalconfig.rb
              D      +++ Adding yum/resources/repository.rb
              D      +++ Adding yum/templates/default/main.erb
              D      +++ Adding yum/templates/default/repo.erb
              D      +++ Adding yum-epel/README.md
              D      +++ Adding yum-epel/attributes/default.rb
              D      +++ Adding yum-epel/attributes/epel-debuginfo.rb
              D      +++ Adding yum-epel/attributes/epel-source.rb
              D      +++ Adding yum-epel/attributes/epel-testing-debuginfo.rb
              D      +++ Adding yum-epel/attributes/epel-testing-source.rb
              D      +++ Adding yum-epel/attributes/epel-testing.rb
              D      +++ Adding yum-epel/attributes/epel.rb
              D      +++ Adding yum-epel/metadata.json
              D      +++ Adding yum-epel/recipes/default.rb
              D      === All files added.
              D      Running check_files.ps1
              D      @{
              D        "a86f70dc25c9c07f2959adeb0ed8a08c" = @{
              D          "target" = "$env:TEMP\kitchen";
              D          "src_basename" = "dna.json";
              D          "dst" = "$env:TEMP\kitchen"
              D        };
              D        "b8a32ad42457120c47ccf2013d837e5d" = @{
              D          "target" = "$env:TEMP\kitchen";
              D          "src_basename" = "client.rb";
              D          "dst" = "$env:TEMP\kitchen"
              D        };
              D        "76cdb2bad9582d23c1f6f4d868218d6c" = @{
              D          "target" = "$env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip";
              D          "src_basename" = "cache";
              D          "dst" = "$env:TEMP\kitchen\cache"
              D        };
              D        "49abb94825cb80b9a9cd59e5f76daf4a" = @{
              D          "target" = "$env:TEMP\kitchen";
              D          "src_basename" = "validation.pem";
              D          "dst" = "$env:TEMP\kitchen"
              D        };
              D        "d0bf03fad6068e40918d8e94b5bac0ab" = @{
              D          "target" = "$env:TEMP\winrm-upload\tmpzip-d0bf03fad6068e40918d8e94b5bac0ab.zip";
              D          "src_basename" = "cookbooks";
              D          "dst" = "$env:TEMP\kitchen\cookbooks"
              D        }
              D      }
              D      Parsing CSV Response
              D      "chk_exists","src_md5","dst_md5","chk_dirty","verifies","target_is_folder"
              "False","a86f70dc25c9c07f2959adeb0ed8a08c",,"True","False","True"
              "False","76cdb2bad9582d23c1f6f4d868218d6c",,"True","False","False"
              "False","49abb94825cb80b9a9cd59e5f76daf4a",,"True","False","True"
              "False","d0bf03fad6068e40918d8e94b5bac0ab",,"True","False","False"
              "False","b8a32ad42457120c47ccf2013d837e5d",,"True","False","True"

              D      Uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/dna.json to encoded tmpfile $env:TEMP\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt
              D      Finished uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/dna.json to encoded tmpfile $env:TEMP\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt (0.12 KB over 1 chunks) in (0m0.07s)
              D      Uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/client.rb to encoded tmpfile $env:TEMP\b64-b8a32ad42457120c47ccf2013d837e5d.txt
              D      Finished uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/client.rb to encoded tmpfile $env:TEMP\b64-b8a32ad42457120c47ccf2013d837e5d.txt (1.104 KB over 1 chunks) in (0m0.10s)
              D      Uploading /tmp/cheftest/tmpzip-20160628-7187-ukt16c.zip to encoded tmpfile $env:TEMP\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt
              D      Finished uploading /tmp/cheftest/tmpzip-20160628-7187-ukt16c.zip to encoded tmpfile $env:TEMP\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt (0.028 KB over 1 chunks) in (0m0.07s)
              D      Uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/validation.pem to encoded tmpfile $env:TEMP\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt
              D      Finished uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/validation.pem to encoded tmpfile $env:TEMP\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt (2.236 KB over 1 chunks) in (0m0.11s)
              D      Uploading /tmp/cheftest/tmpzip-20160628-7187-1risqp3.zip to encoded tmpfile $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt
              D      Wrote chunk 25 for $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt
              D      Wrote chunk 50 for $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt
              D      Finished uploading /tmp/cheftest/tmpzip-20160628-7187-1risqp3.zip to encoded tmpfile $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt (430.176 KB over 54 chunks) in (0m4.53s)
              D      Running decode_files.ps1
              D      @{
              D        "$env:TEMP\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt" = @{
              D          "dst" = "$env:TEMP\kitchen/dna.json"
              D        };
              D        "$env:TEMP\b64-b8a32ad42457120c47ccf2013d837e5d.txt" = @{
              D          "dst" = "$env:TEMP\kitchen/client.rb"
              D        };
              D        "$env:TEMP\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt" = @{
              D          "dst" = "$env:TEMP\kitchen\cache";
              D          "tmpzip" = "$env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip"
              D        };
              D        "$env:TEMP\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt" = @{
              D          "dst" = "$env:TEMP\kitchen/validation.pem"
              D        };
              D        "$env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt" = @{
              D          "dst" = "$env:TEMP\kitchen\cookbooks";
              D          "tmpzip" = "$env:TEMP\winrm-upload\tmpzip-d0bf03fad6068e40918d8e94b5bac0ab.zip"
              D        }
              D      }
              D      Parsing CSV Response
              D      "src_md5","tmpzip","verifies","tmpfile","dst_md5","dst"
              "76cdb2bad9582d23c1f6f4d868218d6c","C:\Users\ADMINI~1\AppData\Local\Temp\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip","True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt","76cdb2bad9582d23c1f6f4d868218d6c","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache"
              "a86f70dc25c9c07f2959adeb0ed8a08c",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt","a86f70dc25c9c07f2959adeb0ed8a08c","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen/dna.json"
              "d0bf03fad6068e40918d8e94b5bac0ab","C:\Users\ADMINI~1\AppData\Local\Temp\winrm-upload\tmpzip-d0bf03fad6068e40918d8e94b5bac0ab.zip","True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt","d0bf03fad6068e40918d8e94b5bac0ab","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cookbooks"
              "49abb94825cb80b9a9cd59e5f76daf4a",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt","49abb94825cb80b9a9cd59e5f76daf4a","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen/validation.pem"
              "b8a32ad42457120c47ccf2013d837e5d",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-b8a32ad42457120c47ccf2013d837e5d.txt","b8a32ad42457120c47ccf2013d837e5d","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen/client.rb"

              D      Cleaned up src_zip /tmp/cheftest/tmpzip-20160628-7187-ukt16c.zip
              D      Cleaned up src_zip /tmp/cheftest/tmpzip-20160628-7187-1risqp3.zip
              D      Uploaded 5 items dirty_check: (0m1.42s) stream_files: (0m4.90s) decode: (0m2.74s)
              D      Transfer complete
              D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> ($env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine")

              & $env:systemdrive\opscode\chefdk\bin\chef-client.bat --local-mode --config $env:TEMP\kitchen\client.rb --log_level auto --force-formatter --no-color --json-attributes $env:TEMP\kitchen\dna.json --chef-zero-port 8889)
                     Starting Chef Client, version 12.11.18
                     Creating a new client identity for default-windows-2012r2 using the validator key.
                     resolving cookbooks for run list: ["winbox::default"]
                     Synchronizing Cookbooks:
                       - winbox (0.9.105)
                       - git (4.5.0)
                       - windows (1.44.0)
                       - build-essential (6.0.0)
                       - dmg (2.4.0)
                       - yum-epel (0.7.0)
                       - chef_handler (1.4.0)
                       - seven_zip (2.0.1)
                       - mingw (1.2.2)
                       - compat_resource (12.10.6)
                       - yum (3.11.0)
                     Installing Cookbook Gems:
                     Compiling Cookbooks...
                     Converging 25 resources
                     Recipe: git::windows
                       * git_client[default] action install[2016-06-28T03:48:59+00:00] WARN: Please use the package resource available in Chef Client 12.6.
                     windows_package will be removed in the next major version release
                     of the Windows cookbook.


                         * windows_package[Git version 2.8.1] action install
                         Recipe: <Dynamically Defined Resource>
                           * remote_file[C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\package\Git-2.8.1-64-bit.exe] action create
                      - create new file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\package\Git-2.8.1-64-bit.exe
                      - update content in file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\package\Git-2.8.1-64-bit.exe from none to 5e5283
                      (file sizes exceed 10000000 bytes, diff output suppressed)
                           - install version latest of package Git version 2.8.1
                         * ruby_block[Add Git Path] action nothing (skipped due to action :nothing)
                         * windows_path[C:\Program Files\Git\Cmd] action add
                           * env[path] action modify

                           * ruby_block[fix ruby ENV['PATH']] action run
                      - execute the ruby block fix ruby ENV['PATH']
                           * ruby_block[fix ruby ENV['PATH']] action nothing (skipped due to action :nothing)

                         * ruby_block[Add Git Path] action create
                           - execute the ruby block Add Git Path

                     Recipe: winbox::chocolatey_install
                       * windows_path[update_path_for_system] action add
                         * env[path] action modify

                         * ruby_block[fix ruby ENV['PATH']] action run
                           - execute the ruby block fix ruby ENV['PATH']
                         * ruby_block[fix ruby ENV['PATH']] action nothing (skipped due to action :nothing)

                       * ruby_block[add_chocolatey_path] action run (skipped due to not_if)
                       * powershell_script[chocolatey_install] action run
                         - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-8eqjua.ps1"
                     Recipe: winbox::powershell_dev
                       * powershell_script[ExecutionPolicyUnrestricted] action run (skipped due to only_if)
                       * powershell_script[ExecutionPolicyUnrestrictedX86] action run
                         - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-l26d7f.ps1"
                       * cookbook_file[C:\Users\Administrator/winbox-ps-profile.ps1] action create_if_missing
                         - create new file C:\Users\Administrator/winbox-ps-profile.ps1
                         - update content in file C:\Users\Administrator/winbox-ps-profile.ps1 from none to 19a092
                         --- C:\Users\Administrator/winbox-ps-profile.ps1  2016-06-28 03:49:31.000000000 +0000
                         +++ C:\Users\Administrator/chef-winbox-ps-profile.ps120160628-3976-rbpfl4  2016-06-28 03:49:31.000000000 +0000
                         @@ -1 +1,89 @@
                         +# WinBox PowerShell profile
                         +#
                         +# Copyright 2015, Adam Edwards
                         +#
                         +# Licensed under the Apache License, Version 2.0 (the "License");
                         +# you may not use this file except in compliance with the License.
                         +# You may obtain a copy of the License at
                         +#
                         +#     http://www.apache.org/licenses/LICENSE-2.0
                         +#
                         +# Unless required by applicable law or agreed to in writing, software
                         +# distributed under the License is distributed on an "AS IS" BASIS,
                         +# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                         +# See the License for the specific language governing permissions and
                         +# limitations under the License.
                         +
                         +# Enable readline support
                         +import-module psreadline
                         +Set-PSReadlineOption -EditMode Emacs
                         +
                         +# Enable posh-git support
                         +if ((get-module -listavailable 'posh-git') -ne $null)
                         +{
                         +    import-module posh-git
                         +}
                         +
                         +# Get the username and whether we're elevated for display
                         +# in the title and prompt
                         +$identity = [Security.Principal.WindowsIdentity]::GetCurrent()
                         +$principal = [Security.Principal.WindowsPrincipal] $identity
                         +$titleprefix = ""
                         +if (test-path variable:/PSDebugContext)
                         +{
                         +    $titleprefix = 'Debug: '
                         +}
                         +else
                         +{
                         +    if ($principal.IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator"))
                         +    {
                         +        $titleprefix = "Administrator: "
                         +    }
                         +}
                         +
                         +#
                         +# The title will look like one of the following:
                         +#
                         +#   myusername@myhost
                         +#   Administrator: myusername@myhost
                         +#
                         +(get-host).ui.rawui.windowtitle = "$titleprefix$($env:username)@$($env:computername)"
                         +
                         +#
                         +# Set a useful two-line prompt that uses color for readability and status.
                         +# The format is 'host: lastexitcode: currentdirectory `newline `username >'.
                         +#
                         +# Here's example output:
                         +#
                         +#   myhost (0x00000001) c:\windows\system32\drivers\etc
                         +#   myuser >
                         +#
                         +function prompt
                         +{
                         +    $lasterror = $?
                         +    $lastexit = $lastexitcode
                         +    if ($lastexit -eq $null) { $lastexit = 0 }
                         +    $errorcolor = 'green'
                         +    $exitcolor = 'green'
                         +    if (! $lasterror) { $errorcolor = 'red' }
                         +    if ($lastexit -ne 0) { $exitcolor = 'red' }
                         +
                         +    write-host -nonewline -foregroundcolor $errorcolor '% '
                         +    write-host -nonewline -foregroundcolor darkyellow "$env:computername "
                         +    write-host -nonewline -foregroundcolor gray "("
                         +    write-host -nonewline -foregroundcolor $exitcolor "0x$(($lastexit).ToString("X8"))"
                         +    write-host -nonewline -foregroundcolor gray ")"
                         +    if ( get-command write-vcsstatus) { Write-VcsStatus }
                         +    write-host -foregroundcolor cyan " $($executionContext.SessionState.Path.CurrentLocation)"
                         +    write-host -nonewline -foregroundcolor darkyellow "$env:username"
                         +    "$('>' * ($nestedPromptLevel + 1)) "
                         +}
                         +
                         +# Make the man alias show full help by default
                         +. ~\get-help-full.ps1
                         +set-alias -option allscope man get-help-full
                         +
                         +# Useful shortcut to get to Documents folder
                         +. ~\set-location-docs.ps1
                         +new-alias docs set-location-docs
                       * cookbook_file[C:\Users\Administrator/get-help-full.ps1] action create
                         - create new file C:\Users\Administrator/get-help-full.ps1
                         - update content in file C:\Users\Administrator/get-help-full.ps1 from none to 7edc66
                         --- C:\Users\Administrator/get-help-full.ps1  2016-06-28 03:49:31.000000000 +0000
                         +++ C:\Users\Administrator/chef-get-help-full.ps120160628-3976-ioa2km  2016-06-28 03:49:31.000000000 +0000
                         @@ -1 +1,30 @@
                         +#
                         +# Copyright 2015, Adam Edwards
                         +#
                         +# Licensed under the Apache License, Version 2.0 (the "License");
                         +# you may not use this file except in compliance with the License.
                         +# You may obtain a copy of the License at
                         +#
                         +#     http://www.apache.org/licenses/LICENSE-2.0
                         +#
                         +# Unless required by applicable law or agreed to in writing, software
                         +# distributed under the License is distributed on an "AS IS" BASIS,
                         +# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                         +# See the License for the specific language governing permissions and
                         +# limitations under the License.
                         +
                         +# Shows help page with full help, rather than the
                         +# abbreviated help which is the default for get-help
                         +function get-help-full
                         +{
                         +    try
                         +    {
                         +        get-help @args -full | out-host -paging
                         +    }
                         +    catch [System.Management.Automation.HaltCommandException]
                         +    {
                         +        # Do nothing if the user chooses 'q'
                         +    }
                         +}
                         +
                       * cookbook_file[C:\Users\Administrator/set-location-docs.ps1] action create
                         - create new file C:\Users\Administrator/set-location-docs.ps1
                         - update content in file C:\Users\Administrator/set-location-docs.ps1 from none to 3e28a0
                         --- C:\Users\Administrator/set-location-docs.ps1  2016-06-28 03:49:31.000000000 +0000
                         +++ C:\Users\Administrator/chef-set-location-docs.ps120160628-3976-10q0aeg  2016-06-28 03:49:31.000000000 +0000
                         @@ -1 +1,31 @@
                         +# Documents directory shortcut
                         +#
                         +# Copyright 2015, Adam Edwards
                         +#
                         +# Licensed under the Apache License, Version 2.0 (the "License");
                         +# you may not use this file except in compliance with the License.
                         +# You may obtain a copy of the License at
                         +#
                         +#     http://www.apache.org/licenses/LICENSE-2.0
                         +#
                         +# Unless required by applicable law or agreed to in writing, software
                         +# distributed under the License is distributed on an "AS IS" BASIS,
                         +# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                         +# See the License for the specific language governing permissions and
                         +# limitations under the License.
                         +
                         +# Set the current directory to the location of the
                         +# Documents directory, and also set up an environment
                         +# variables called DOCS.
                         +function set-location-docs
                         +{
                         +
                         +    if ($env:DOCS -eq $null)
                         +    {
                         +        $myDocsPath = [environment]::GetFolderPath("MyDocuments")
                         +        $env:DOCS = $myDocsPath
                         +    }
                         +
                         +    pushd $env:DOCS
                         +}
                       * directory[C:/Users/Administrator/Documents/WindowsPowerShell] action create (up to date)
                       * powershell_script[C:\Users\Administrator\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1] action run (skipped due to not_if)
                     Recipe: winbox::readline
                       * remote_file[C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\psreadline.zip] action create
                         - create new file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\psreadline.zip
                         - update content in file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\psreadline.zip from none to 68577a
                         (new content is binary, diff output suppressed)
                       * powershell_script[install_module] action run
                         - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-5awo7s.ps1"
                     Recipe: winbox::editor
                       * directory[C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode] action create
                         - create new directory C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode
                       * remote_file[C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode/vscodesetup.exe] action create
                         - create new file C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode/vscodesetup.exe
                         - update content in file C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode/vscodesetup.exe from none to 3ae51c
                         (file sizes exceed 10000000 bytes, diff output suppressed)
                       * powershell_script[install vscode] action run
                         - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-11cuxbk.ps1"
                       * env[EDITOR] action create

                     Recipe: winbox::console
                       * cookbook_file[C:\Program Files/conemu/ConEmu.xml] action nothing (skipped due to action :nothing)
              D      [WinRM] retrying receive request after timeout
              D      [WinRM] retrying receive request after timeout
              D      [WinRM] retrying receive request after timeout
              D      [WinRM] retrying receive request after timeout
                       * powershell_script[conemu] action run

                         ================================================================================
                         Error executing action `run` on resource 'powershell_script[conemu]'
                         ================================================================================

                         Mixlib::ShellOut::ShellCommandFailed
                         ------------------------------------
                         Expected process to exit with [0], but received '1'
                         ---- Begin output of "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" ----
                         STDOUT: Installing the following packages:
                         conemu
                         By installing you accept licenses for the packages.
                         conemu not installed. The package was not found with the source(s) listed.
                          If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                          Version: ""
                          Source(s): "https://chocolatey.org/api/v2/"

                         Chocolatey installed 0/1 packages. 1 packages failed.
                          See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                         Failures
                          - conemu - conemu not installed. The package was not found with the source(s) listed.
                          If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                          Version: ""
                          Source(s): "https://chocolatey.org/api/v2/"
                         Installing the following packages:
                         conemu
                         By installing you accept licenses for the packages.
                         conemu not installed. The package was not found with the source(s) listed.
                          If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                          Version: ""
                          Source(s): "https://chocolatey.org/api/v2/"

                         Chocolatey installed 0/1 packages. 1 packages failed.
                          See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                         Failures
                          - conemu - conemu not installed. The package was not found with the source(s) listed.
                          If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                          Version: ""
                          Source(s): "https://chocolatey.org/api/v2/"
                         STDERR:
                         ---- End output of "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" ----
                         Ran "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" returned 1

                         Resource Declaration:
                         ---------------------
                         # In C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/cookbooks/winbox/recipes/console.rb

                          27: powershell_script 'conemu' do
                          28:   code <<-EOH
                          29: chocolatey install conemu -y
                          30: if ($LASTEXITCODE -ne 0)
                          31: {
                          32:   $LASTEXITCODE = 0
                          33:   chocolatey install conemu -y
                          34: }
                          35: EOH
                          36:   only_if '(get-wmiobject Win32_MSIResource | Where-Object -Property value -like -Value conemu) -eq $null'
                          37: end
                          38:

                         Compiled Resource:
                         ------------------
                         # Declared in C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/cookbooks/winbox/recipes/console.rb:27:in `from_file'

                         powershell_script("conemu") do
                           action [:run]
                           retries 0
                           retry_delay 2
                           default_guard_interpreter :powershell_script
                           command "conemu"
                           backup 5
                           returns 0
                           code "chocolatey install conemu -y\nif ($LASTEXITCODE -ne 0)\n{\n  $LASTEXITCODE = 0\n  chocolatey install conemu -y\n}\n"
                           interpreter "powershell.exe"
                           declared_type :powershell_script
                           cookbook_name "winbox"
                           recipe_name "console"
                           only_if "(get-wmiobject Win32_MSIResource | Where-Object -Property value -like -Value conemu) -eq $null"
                         end

                         Platform:
                         ---------
                         i386-mingw32

                     Starting audit phase

                     Finished in 0 seconds (files took 0.68318 seconds to load)
                     0 examples, 0 failures
                     Auditing complete

                     Running handlers:
                     [2016-06-28T03:54:00+00:00] ERROR: Running exception handlers
                     Running handlers complete
                     [2016-06-28T03:54:00+00:00] ERROR: Exception handlers complete
                     Chef Client failed. 21 resources updated in 05 minutes 52 seconds
                     [2016-06-28T03:54:00+00:00] ERROR: Failed to post audit report to server. Saving report to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/failed-audit-data.json
                     [2016-06-28T03:54:00+00:00] FATAL: Stacktrace dumped to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/chef-stacktrace.out
                     [2016-06-28T03:54:00+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                     [2016-06-28T03:54:00+00:00] FATAL: Chef::Exceptions::RunFailedWrappingError: Found 1 errors, they are stored in the backtrace
              $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/2.1.0/i386-mingw32/dl.so: warning: already initialized constant DL::RUBY_FREE
              $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/gems/2.1.0/gems/net-ssh-3.2.0/lib/net/ssh/authentication/pageant.rb:16: warning: previous definition of RUBY_FREE was here
              $$$$$$ DL is deprecated, please use Fiddle
              D      Cleaning up local sandbox in /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa
              D      Converge failed on instance <default-windows-2012r2>.
              D      ------Exception-------
              D      Class: Kitchen::InstanceFailure
              D      Message: Converge failed on instance <default-windows-2012r2>.  Please see .kitchen/logs/default-windows-2012r2.log for more details
              D      ----------------------
              D      ------Backtrace-------
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:76:in `rescue in call'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:79:in `call'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:373:in `block in converge_action'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `call'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `synchronize_or_call'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:478:in `block in action'
              D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:477:in `action'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:369:in `converge_action'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:348:in `block in transition_to'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `each'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `transition_to'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:138:in `converge'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `public_send'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `run_action_in_thread'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
              D      ----End Backtrace-----
              D      ---Nested Exception---
              D      Class: Kitchen::ActionFailed
              D      Message: WinRM exited (1) for command: [$env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine")

              & $env:systemdrive\opscode\chefdk\bin\chef-client.bat --local-mode --config $env:TEMP\kitchen\client.rb --log_level auto --force-formatter --no-color --json-attributes $env:TEMP\kitchen\dna.json --chef-zero-port 8889]
              D      ----------------------
              D      ------Backtrace-------
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:76:in `rescue in call'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:79:in `call'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:373:in `block in converge_action'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `call'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `synchronize_or_call'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:478:in `block in action'
              D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:477:in `action'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:369:in `converge_action'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:348:in `block in transition_to'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `each'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `transition_to'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:138:in `converge'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `public_send'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `run_action_in_thread'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
              D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
              D      ----End Backtrace-----
              D      [WinRM] closing remote shell 5543ED20-7DD5-4564-8B3C-F44F26F67293 on http://10.194.8.202:5985/wsman
              D      [WinRM] closing remote shell 527C3D98-8885-4FD3-8A22-5EAE4548481A on http://10.194.8.202:5985/wsman
              D      [WinRM] remote shell 527C3D98-8885-4FD3-8A22-5EAE4548481A closed
              STDERR: >>>>>> Converge failed on instance <default-windows-2012r2>.
              >>>>>> Please see .kitchen/logs/default-windows-2012r2.log for more details
              >>>>>> ------Exception-------
              >>>>>> Class: Kitchen::ActionFailed
              >>>>>> Message: WinRM exited (1) for command: [$env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine")

              & $env:systemdrive\opscode\chefdk\bin\chef-client.bat --local-mode --config $env:TEMP\kitchen\client.rb --log_level auto --force-formatter --no-color --json-attributes $env:TEMP\kitchen\dna.json --chef-zero-port 8889]
              >>>>>> ----------------------
              ---- End output of bundle exec kitchen converge  -c -l debug ----
              Ran bundle exec kitchen converge  -c -l debug returned 10

              Resource Declaration:
              ---------------------
              # In /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb

               36:       execute "bundle exec kitchen #{command}#{instances ? " #{instances}" : ""}#{kitchen_options ? " #{kitchen_options}" : ""}" do
               37:         cwd kitchen_dir
               38:         env({
               39:           "KITCHEN_DRIVER" => driver,
               40:           "KITCHEN_INSTANCES" => instances,
               41:           "KITCHEN_LOCAL_YAML" => ::File.expand_path("../../.kitchen.#{driver}.yml", __FILE__),
               42:           "KITCHEN_CHEF_PRODUCT" => chef_product,
               43:           "KITCHEN_CHEF_CHANNEL" => chef_channel,
               44:           "KITCHEN_CHEF_VERSION" => chef_version,
               45:           "ARTIFACTORY_USERNAME" => artifactory_username,
               46:           "ARTIFACTORY_PASSWORD" => artifactory_password
               47:         }.merge(new_resource.env))
               48:       end
               49:     end

              Compiled Resource:
              ------------------
              # Declared in /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:36:in `block in <class:Kitchen>'

              execute("bundle exec kitchen converge  -c -l debug") do
                action [:run]
                retries 0
                retry_delay 2
                default_guard_interpreter :execute
                command "bundle exec kitchen converge  -c -l debug"
                backup 5
                cwd "/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/winbox/"
                environment {"KITCHEN_DRIVER"=>"ec2", "KITCHEN_INSTANCES"=>"", "KITCHEN_LOCAL_YAML"=>"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/.kitchen.ec2.yml", "KITCHEN_CHEF_PRODUCT"=>"chefdk", "KITCHEN_CHEF_CHANNEL"=>"unstable", "KITCHEN_CHEF_VERSION"=>"0.16.12", "ARTIFACTORY_USERNAME"=>"chef-web-downloads", "ARTIFACTORY_PASSWORD"=>"fWPxYSB69EiuSpl8*3Dr^kGwf#hxUE6cmjeZRB%H!Cruit7qiKp%toH3nXKStQUg", "BUNDLE_GEMFILE"=>"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/Gemfile", "KITCHEN_YAML"=>"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/.kitchen.winbox.yml"}
                returns 0
                declared_type :execute
                cookbook_name "acceptance-cookbook"
              end

              Platform:
              ---------
              x86_64-linux


            ================================================================================
            Error executing action `run` on resource 'cookbook_kitchen[converge winbox]'
            ================================================================================

            Mixlib::ShellOut::ShellCommandFailed
            ------------------------------------
            execute[bundle exec kitchen converge  -c -l debug] (/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb line 36) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '10'
            ---- Begin output of bundle exec kitchen converge  -c -l debug ----
            STDOUT: -----> Starting Kitchen (v1.9.0)
            D      Berksfile found at /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/winbox/Berksfile, loading Berkshelf
            D      Berkshelf 4.3.3 library loaded
            D      winrm requested, loading winrm gem (["~> 1.6"])
            D      winrm is loaded.
            D      winrm-fs requested, loading winrm-fs gem (["~> 0.4.1"])
            D      winrm-fs is loaded.
            -----> Creating <default-windows-2012r2>...
            D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
            D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
            D      Search returned 3 images:
            D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
            D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
            D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.04.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-04-13T01:30:48.000Z
            D      Image for default-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                   Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
            D      No SSH username specified: using default username administrator  for image ami-8d0acfed, which we detected as windows 2012r2rtm x86_64.
                   If you are not using an account that qualifies under the AWS
            free-tier, you may be charged to run these suites. The charge
            should be minimal, but neither Test Kitchen nor its maintainers
            are responsible for your incurred costs.

            D      Creating EC2 instance in region us-west-2 with properties:
            D      - instance_type = "m3.large"
            D      - ebs_optimized = false
            D      - image_id = "ami-8d0acfed"
            D      - key_name = "jenkins"
            D      - subnet_id = "subnet-19ac017c"
            D      - private_ip_address = nil
            D      - placement = {:availability_zone=>"us-west-2a"}
            D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
            D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                   Instance <i-b502d11a> requested.
                   Polling AWS for existence, attempt 0...
                   Attempting to tag the instance, 0 retries
                   EC2 instance <i-b502d11a> created.
                   Waited 0/300s for instance <i-b502d11a> to become ready.
                   Waited 5/300s for instance <i-b502d11a> to become ready.
                   Waited 10/300s for instance <i-b502d11a> to become ready.
                   Waited 15/300s for instance <i-b502d11a> to become ready.
                   Waited 20/300s for instance <i-b502d11a> to become ready.
                   Waited 25/300s for instance <i-b502d11a> to become ready.
                   Waited 30/300s for instance <i-b502d11a> to become ready.
                   Waited 35/300s for instance <i-b502d11a> to become ready.
                   Waited 40/300s for instance <i-b502d11a> to become ready.
                   Waited 45/300s for instance <i-b502d11a> to become ready.
                   Waited 50/300s for instance <i-b502d11a> to become ready.
                   Waited 55/300s for instance <i-b502d11a> to become ready.
                   Waited 60/300s for instance <i-b502d11a> to become ready.
                   Waited 65/300s for instance <i-b502d11a> to become ready.
                   Waited 70/300s for instance <i-b502d11a> to become ready.
                   Waited 75/300s for instance <i-b502d11a> to become ready.
                   Waited 80/300s for instance <i-b502d11a> to become ready.
                   Waited 85/300s for instance <i-b502d11a> to become ready.
                   Waited 90/300s for instance <i-b502d11a> to become ready.
                   Waited 95/300s for instance <i-b502d11a> to become ready.
                   Waited 100/300s for instance <i-b502d11a> to become ready.
            D      Console output: ---
            2016/06/28 03:45:05Z: EC2ConfigMonitorState: 0
            2016/06/28 03:45:05Z: Windows sysprep configuration complete.
            2016/06/28 03:45:09Z: AMI Origin Version: 2016.06.15
            2016/06/28 03:45:09Z: AMI Origin Name: Windows_Server-2012-R2_RTM-English-64Bit-Base
            2016/06/28 03:45:09Z: OS: Microsoft Windows NT 6.3.9600
            2016/06/28 03:45:09Z: OsVersion: 6.3
            2016/06/28 03:45:09Z: OsProductName: Windows Server 2012 R2 Standard
            2016/06/28 03:45:09Z: OsBuildLabEx: 9600.18292.amd64fre.winblue_ltsb.160330-1744
            2016/06/28 03:45:09Z: Language: en-US
            2016/06/28 03:45:09Z: TimeZone: Coordinated Universal Time
            2016/06/28 03:45:09Z: Offset: UTC 00:00:00
            2016/06/28 03:45:09Z: EC2 Agent: Ec2Config service v3.17.1032
            2016/06/28 03:45:11Z: Message: Waiting for meta-data accessibility...
            2016/06/28 03:45:11Z: Message: Meta-data is now available.
            2016/06/28 03:45:12Z: AMI-ID: ami-8d0acfed
            2016/06/28 03:45:12Z: Instance-ID: i-b502d11a
            2016/06/28 03:45:13Z: Driver: AWS PV Network Device v7.3.2.0
            2016/06/28 03:45:13Z: Driver: AWS PV Storage Host Adapter v7.3.2.0
            2016/06/28 03:45:13Z: Ec2SetPassword: Enabled
            2016/06/28 03:45:13Z: RDPCERTIFICATE-SUBJECTNAME: WIN-BNKEQGJ67NR
            2016/06/28 03:45:13Z: RDPCERTIFICATE-THUMBPRINT: 2E8BF7BD57958ED85A9DE40C8BF35F10E0C6055B
            2016/06/28 03:45:16Z: Username: Administrator
            2016/06/28 03:45:16Z: Password: <Password>
            vnp1wei+6gpf/Jp/BSsKj6kEqjgBifbUU25L2LrVoAXrfC3clMdQx/7PapIDlxl7LcgdgHtrW7wfNpqgRyxjAkGm+Dp3vU90hQ7hSVn3ADvOtt5mgUX383cjQyNXZT525g1ko9BcZKZ3+CBV8TRA62CF0eLa5r0VB9dIP/x6U41MSgql5ZOSSYrglyDlyabZPRgIpaTks7lHifqduiMazKC5HPK6wVBfuiTF7DHY/alBPVcx1eqCKHyDUOg5SBKD5BgI4Kh7lhLeUPrv6cgIv6Sy7KOZi6HUHbfVIrTx4ImCGztxijleWLkL5WbxAaPcBNQE8cSjFTdQqJpTV0npvw==
            </Password>
            2016/06/28 03:45:18Z: Message: Windows is Ready to use

                   Waited 0/300s for instance <i-b502d11a> to fetch windows admin password.
                   Retrieved Windows password for instance <i-b502d11a>.
                   EC2 instance <i-b502d11a> ready.
            D      [WinRM] opening remote shell on http://10.194.8.202:5985/wsman
            D      [WinRM] remote shell 5543ED20-7DD5-4564-8B3C-F44F26F67293 is open on http://10.194.8.202:5985/wsman
            D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (Write-Host '[WinRM] Established
            ')
                   [WinRM] Established

            D      [WinRM] reusing existing connection negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
            D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File)


                       Directory: C:\chef\ohai\hints


                   Mode                LastWriteTime     Length Name
                   ----                -------------     ------ ----
                   -a---         6/28/2016   3:45 AM          0 ec2.json


            D      ec2:create '10.194.8.202'
                   Finished creating <default-windows-2012r2> (2m14.56s).
            -----> Converging <default-windows-2012r2>...
                   Preparing files for transfer
            D      Creating local sandbox in /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa
                   Preparing dna.json
            D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>["recipe[winbox::default]"]}
                   Resolving cookbook dependencies with Berkshelf 4.3.3...
            D      Using Berksfile from /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/winbox/Berksfile
                   Removing non-cookbook files before transfer
                   Preparing validation.pem
            D      Using a dummy validation.pem
                   Preparing client.rb
            D      Creating client.rb from {:node_name=>"default-windows-2012r2", :checksum_path=>"\#{ENV['TEMP']}\\kitchen\\checksums", :file_cache_path=>"\#{ENV['TEMP']}\\kitchen\\cache", :file_backup_path=>"\#{ENV['TEMP']}\\kitchen\\backup", :cookbook_path=>["\#{ENV['TEMP']}\\kitchen\\cookbooks", "\#{ENV['TEMP']}\\kitchen\\site-cookbooks"], :data_bag_path=>"\#{ENV['TEMP']}\\kitchen\\data_bags", :environment_path=>"\#{ENV['TEMP']}\\kitchen\\environments", :node_path=>"\#{ENV['TEMP']}\\kitchen\\nodes", :role_path=>"\#{ENV['TEMP']}\\kitchen\\roles", :client_path=>"\#{ENV['TEMP']}\\kitchen\\clients", :user_path=>"\#{ENV['TEMP']}\\kitchen\\users", :validation_key=>"\#{ENV['TEMP']}\\kitchen\\validation.pem", :client_key=>"\#{ENV['TEMP']}\\kitchen\\client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"\#{ENV['TEMP']}\\kitchen\\encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
            D      [WinRM] reusing existing connection negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
            D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (new-module -name Omnitruck -scriptblock {
            function Get-PlatformVersion {
              switch -regex ((get-wmiobject win32_operatingsystem).version) {
                '10\.0\.\d+' {$platform_version = '2012r2'}
                '6\.3\.\d+'  {$platform_version = '2012r2'}
                '6\.2\.\d+'  {$platform_version = '2012'}
                '6\.1\.\d+'  {$platform_version = '2008r2'}
                '6\.0\.\d+'  {$platform_version = '2008'}
              }
              return $platform_version
            }

            function Get-PlatformArchitecture {
              if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                $architecture = 'x86_64'
              } else {
                $architecture = 'i386'
              }
              return $architecture
            }

            function New-Uri {
              param ($baseuri, $newuri)

              new-object System.Uri $baseuri, $newuri
            }

            function Get-WebContent {
              param ($uri, $filepath)
              $proxy = New-Object -TypeName System.Net.WebProxy
              $wc = new-object System.Net.WebClient
              $proxy.Address = $env:http_proxy
              $wc.Proxy = $proxy

              try {
                if ([string]::IsNullOrEmpty($filepath)) {
                  $wc.downloadstring($uri)
                }
                else {
                  $wc.downloadfile($uri, $filepath)
                }
              }
              catch {
                $exception = $_.Exception
                Write-Host "There was an error: "
                do {
                  Write-Host "`t$($exception.message)"
                  $exception = $exception.innerexception
                } while ($exception)
                throw "Failed to download from $uri."
              }
            }

            function Test-ProjectPackage {
              [cmdletbinding()]
              param ($Path, $Algorithm = 'SHA256', $Hash)

              if (-not (get-command get-filehash))   {
                function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                function Get-FileHash ($Path, $Algorithm) {
                  $Path = (resolve-path $path).providerpath
                  $hash = @{Algorithm = $Algorithm; Path = $Path}
                  use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                    use ($in = (gi $path).OpenRead()) {
                      $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                    }
                  }
                  new-object PSObject -Property $hash
                }
              }
              Write-Verbose "Testing the $Algorithm hash for $path."
              $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
              Write-Verbose "`tDesired Hash - '$hash'"
              Write-Verbose "`tActual Hash  - '$ActualHash'"
              $Valid = $ActualHash -eq $Hash
              if (-not $Valid) {
                Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
              }
              return $Valid
            }

            function Get-ProjectMetadata {
              <#
                .SYNOPSIS
                Get metadata for a Chef Software, Inc. project
                .DESCRIPTION
                Get metadata for project
                .EXAMPLE
                iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                Gets the download url and SHA256 checksum for the latest stable release of Chef.
                .EXAMPLE
                iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
              #>
              [cmdletbinding()]
              param (
                # Base url to retrieve metadata from.
                [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                [string]
                # Project to install
                [string]
                $project = 'chef',
                # Version of the application to install
                # This parameter is optional, if not supplied it will provide the latest version,
                # and if an iteration number is not specified, it will grab the latest available iteration.
                # Partial version numbers are also acceptable (using v=11
                # will grab the latest 11.x client which matches the other flags).
                [string]
                $version,
                # Release channel to install from
                $channel = 'unstable',
                # The following legacy switches are just aliases for the current channel
                [switch]
                $prerelease,
                [switch]
                $nightlies,
                [validateset('auto', 'i386', 'x86_64')]
                [string]
                $architecture = 'auto'
              )

              # PowerShell is only on Windows ATM
              $platform = 'windows'
              Write-Verbose "Platform: $platform"

              $platform_version = Get-PlatformVersion
              Write-Verbose "Platform Version: $platform_version"

              if ($architecture -eq 'auto') {
                $architecture = Get-PlatformArchitecture
              }

              Write-Verbose "Architecture: $architecture"
              Write-Verbose "Project: $project"


                $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/mac_os_x/10.9/chefdk-0.16.12-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                "sha256 f337fa924b29a79686a681e3f24f03d391f57ba3c612b09db3821cb047573ee8" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/mac_os_x/10.10/chefdk-0.16.12-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                "sha256 f337fa924b29a79686a681e3f24f03d391f57ba3c612b09db3821cb047573ee8" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/mac_os_x/10.11/chefdk-0.16.12-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                "sha256 f337fa924b29a79686a681e3f24f03d391f57ba3c612b09db3821cb047573ee8" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/el/7/chefdk-0.16.12-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                "sha256 f81822f72b09d67bff1ebd2752b693a1683e770f10396fbee67556e1b7566844" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/ubuntu/12.04/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                "sha256 5de5cc0d959920c825440000eb5eef7886e174890b9604e0ab0d331a76ca6f0b" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/ubuntu/14.04/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                "sha256 5de5cc0d959920c825440000eb5eef7886e174890b9604e0ab0d331a76ca6f0b" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/debian/6/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                "sha256 897f19ce1539ba79d7111880ba5b7a59028d21a0e69c7d6a35faae476b9efb9a" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/debian/7/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                "sha256 897f19ce1539ba79d7111880ba5b7a59028d21a0e69c7d6a35faae476b9efb9a" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/debian/8/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                "sha256 897f19ce1539ba79d7111880ba5b7a59028d21a0e69c7d6a35faae476b9efb9a" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/el/6/chefdk-0.16.12-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                "sha256 59e6862a4c825037ef58c1341adea73d946491f127445e5522c211ac983262b8" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/windows/2008r2/chefdk-0.16.12-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                "sha256 24ad3c76028785f8b0f147917029150010d7908cf3795f8b71d4b338e71efff8" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/windows/2012/chefdk-0.16.12-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                "sha256 24ad3c76028785f8b0f147917029150010d7908cf3795f8b71d4b338e71efff8" | out-file "$artifact_info_dir/artifact_info" -Append

                $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                New-Item -ItemType directory -Path $artifact_info_dir -force
                New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/windows/2012r2/chefdk-0.16.12-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                "sha256 24ad3c76028785f8b0f147917029150010d7908cf3795f8b71d4b338e71efff8" | out-file "$artifact_info_dir/artifact_info" -Append


              $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

              $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

              Write-Verbose "Project details: "
              foreach ($key in $package_metadata.keys) {
                Write-Verbose "`t$key = $($package_metadata[$key])"
              }
              $package_metadata
            }

            function Install-Project {
              <#
                .SYNOPSIS
                Install a Chef Software, Inc. product
                .DESCRIPTION
                Install a Chef Software, Inc. product
                .EXAMPLE
                iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                Installs the latest stable version of Chef.
                .EXAMPLE
                iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                Installs the latest integration build of the Chef Development Kit
              #>
              [cmdletbinding(SupportsShouldProcess=$true)]
              param (
                # Project to install
                [string]
                $project = 'chef',
                # Release channel to install from
                [validateset('current', 'stable', 'unstable')]
                [string]
                $channel = 'stable',
                # Version of the application to install
                # This parameter is optional, if not supplied it will provide the latest version,
                # and if an iteration number is not specified, it will grab the latest available iteration.
                # Partial version numbers are also acceptable (using v=11
                # will grab the latest 11.x client which matches the other flags).
                [string]
                $version,
                # Full path for the downloaded installer.
                [string]
                $filename,
                # Full path to the location to download the installer
                [string]
                $download_directory = $env:temp,
                # The following legacy switches are just aliases for the current channel
                [switch]
                $prerelease,
                [switch]
                $nightlies,
                [validateset('auto', 'i386', 'x86_64')]
                [string]
                $architecture = 'auto'
              )

              $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

              if (-not [string]::IsNullOrEmpty($filename)) {
                $download_directory = split-path $filename
                $filename = split-path $filename -leaf
                if ([string]::IsNullOrEmpty($download_directory)) {
                  $download_directory = $pwd
                }
              }
              else {
                $filename = ($package_metadata.url -split '/')[-1]
              }
              Write-Verbose "Download directory: $download_directory"
              Write-Verbose "Filename: $filename"

              if (-not (test-path $download_directory)) {
                mkdir $download_directory
              }
              $download_directory = (resolve-path $download_directory).providerpath
              $download_destination = join-path $download_directory $filename

              if ((test-path $download_destination) -and
                (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                Write-Verbose "Found existing valid installer at $download_destination."
              }
              else {
                if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                  Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                  Get-WebContent $package_metadata.url -filepath $download_destination
                }
              }

              if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                  Write-Host "Installing $project from $download_destination"
                  $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                  $p.WaitForExit()
                  if ($p.ExitCode -ne 0) {
                    throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                  }
                }
                else {
                  throw "Failed to validate the downloaded installer for $project."
                }
              }
            }
            set-alias install -value Install-Project
            export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

            }

            install -project chefdk -version 0.16.12 -channel unstable -architecture i386
            )
            D      creating hash for file $env:TEMP/default-windows-2012r2-long_script.ps1
            D      Running check_files.ps1
            D      @{
            D        "0a865588a80b701c316a564bcff56c63" = @{
            D          "target" = "$env:TEMP/default-windows-2012r2-long_script.ps1";
            D          "src_basename" = "default-windows-2012r2-long_script.ps1";
            D          "dst" = "$env:TEMP/default-windows-2012r2-long_script.ps1"
            D        }
            D      }
            D      [WinRM] opening new shell since the current one failed
            D      [WinRM] opening remote shell on http://10.194.8.202:5985/wsman
            D      [WinRM] remote shell 527C3D98-8885-4FD3-8A22-5EAE4548481A is open on http://10.194.8.202:5985/wsman
            D      Parsing CSV Response
            D      "chk_exists","src_md5","dst_md5","chk_dirty","verifies","target_is_folder"
            "False","0a865588a80b701c316a564bcff56c63",,"True","False","False"

            D      Uploading /tmp/cheftest/kitchen-long-script20160628-7187-7rpp3o/default-windows-2012r2-long_script.ps1 to encoded tmpfile $env:TEMP\b64-0a865588a80b701c316a564bcff56c63.txt
            D      Finished uploading /tmp/cheftest/kitchen-long-script20160628-7187-7rpp3o/default-windows-2012r2-long_script.ps1 to encoded tmpfile $env:TEMP\b64-0a865588a80b701c316a564bcff56c63.txt (20.44 KB over 3 chunks) in (0m0.30s)
            D      Running decode_files.ps1
            D      @{
            D        "$env:TEMP\b64-0a865588a80b701c316a564bcff56c63.txt" = @{
            D          "dst" = "$env:TEMP/default-windows-2012r2-long_script.ps1"
            D        }
            D      }
            D      Parsing CSV Response
            D      "src_md5","tmpzip","verifies","tmpfile","dst_md5","dst"
            "0a865588a80b701c316a564bcff56c63",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-0a865588a80b701c316a564bcff56c63.txt","0a865588a80b701c316a564bcff56c63","C:\Users\ADMINI~1\AppData\Local\Temp/default-windows-2012r2-long_script.ps1"

            D      Uploaded 1 items dirty_check: (0m0.83s) stream_files: (0m0.30s) decode: (0m0.96s)

                   ModuleType Version    Name                                ExportedCommands
                   ---------- -------    ----                                ----------------
                   Script     0.0        Omnitruck                           {Get-ProjectMetada...
                   Installing chefdk from C:\Users\ADMINI~1\AppData\Local\Temp\chefdk-0.16.12-1-x86.msi
            D      [WinRM] retrying receive request after timeout


            D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> ($dirs = @("$env:TEMP\kitchen\clients", "$env:TEMP\kitchen\cookbooks", "$env:TEMP\kitchen\data", "$env:TEMP\kitchen\data_bags", "$env:TEMP\kitchen\encrypted_data_bag_secret", "$env:TEMP\kitchen\environments", "$env:TEMP\kitchen\roles")
            $root_path = "$env:TEMP\kitchen"

            Function Delete-AllDirs($dirs) {
              $dirs | ForEach-Object {
                if (Test-Path ($path = Unresolve-Path $_)) { Remove-Item $path -Recurse -Force }
              }
            }

            Function Unresolve-Path($p) {
              if ($p -eq $null) { return $null }
              else { return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($p) }
            }

            Function Make-RootPath($p) {
              $p = Unresolve-Path $p
              if (-Not (Test-Path $p)) { New-Item $p -ItemType directory | Out-Null }
            }

            Delete-AllDirs $dirs
            Make-RootPath $root_path
            )
                   Transferring files to <default-windows-2012r2>
            D      creating hash for file $env:TEMP\kitchen
            D      creating hash for file $env:TEMP\kitchen
            D      creating hash for directory $env:TEMP\kitchen
            D      Populating files
            D      === All files added.
            D      creating hash for file $env:TEMP\kitchen
            D      creating hash for directory $env:TEMP\kitchen
            D      Populating files
            D      +++ Adding build-essential/README.md
            D      +++ Adding build-essential/attributes/default.rb
            D      +++ Adding build-essential/libraries/matchers.rb
            D      +++ Adding build-essential/libraries/xcode_command_line_tools.rb
            D      +++ Adding build-essential/metadata.json
            D      +++ Adding build-essential/recipes/_windows.rb
            D      +++ Adding build-essential/recipes/default.rb
            D      +++ Adding build-essential/resources/build_essential.rb
            D      +++ Adding chef_handler/README.md
            D      +++ Adding chef_handler/attributes/default.rb
            D      +++ Adding chef_handler/files/default/handlers/README
            D      +++ Adding chef_handler/libraries/helpers.rb
            D      +++ Adding chef_handler/libraries/matchers.rb
            D      +++ Adding chef_handler/metadata.json
            D      +++ Adding chef_handler/providers/default.rb
            D      +++ Adding chef_handler/recipes/default.rb
            D      +++ Adding chef_handler/recipes/json_file.rb
            D      +++ Adding chef_handler/resources/default.rb
            D      +++ Adding compat_resource/README.md
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/constants.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/delayed_evaluator.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/dsl/core.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/dsl/declare_resource.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/dsl/recipe.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/lazy_module_include.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/notifying_block.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/params_validate.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/powershell_out.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/properties.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/property.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/provider/noop.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/provider.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/resource/action_class.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/resource.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/resource_builder.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/mixin/properties.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/exceptions.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/log.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/mixin/params_validate.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/property.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/provider.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/recipe.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource/lwrp_base.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_builder.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_collection/resource_list.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_collection/resource_set.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_collection.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/run_context.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/property.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/recipe.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/resource/lwrp_base.rb
            D      +++ Adding compat_resource/files/lib/chef_compat/resource.rb
            D      +++ Adding compat_resource/files/lib/compat_resource/gemspec.rb
            D      +++ Adding compat_resource/files/lib/compat_resource/version.rb
            D      +++ Adding compat_resource/files/lib/compat_resource.rb
            D      +++ Adding compat_resource/files/spec/cookbook_spec.rb
            D      +++ Adding compat_resource/files/spec/data/Gemfile
            D      +++ Adding compat_resource/files/spec/data/Gemfile.lock
            D      +++ Adding compat_resource/files/spec/data/config.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/metadata.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/providers/resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/recipes/default.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/resources/resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/future/libraries/future_custom_resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/future/libraries/super_properties.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/future/metadata.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/future/recipes/declare_resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/future/resources/resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/future/resources/super_resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/libraries/normal_hwrp.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/metadata.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/providers/resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/resources/resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/libraries/normal_hwrp.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/metadata.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/providers/resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/recipes/declare_resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/resources/resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/notifications/metadata.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/notifications/recipes/default.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/notifications/resources/resource.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/test/metadata.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/test/recipes/default.rb
            D      +++ Adding compat_resource/files/spec/data/cookbooks/test/recipes/test.rb
            D      +++ Adding compat_resource/files/spec/data/nodes/ettores-mbp.lan.json
            D      +++ Adding compat_resource/files/spec/spec_helper.rb
            D      +++ Adding compat_resource/libraries/autoload.rb
            D      +++ Adding compat_resource/metadata.json
            D      +++ Adding dmg/README.md
            D      +++ Adding dmg/attributes/default.rb
            D      +++ Adding dmg/libraries/matchers.rb
            D      +++ Adding dmg/metadata.json
            D      +++ Adding dmg/providers/package.rb
            D      +++ Adding dmg/recipes/default.rb
            D      +++ Adding dmg/resources/package.rb
            D      +++ Adding git/README.md
            D      +++ Adding git/attributes/default.rb
            D      +++ Adding git/libraries/helpers.rb
            D      +++ Adding git/libraries/matchers.rb
            D      +++ Adding git/libraries/provider_git_client.rb
            D      +++ Adding git/libraries/provider_git_client_osx.rb
            D      +++ Adding git/libraries/provider_git_client_package.rb
            D      +++ Adding git/libraries/provider_git_client_source.rb
            D      +++ Adding git/libraries/provider_git_client_windows.rb
            D      +++ Adding git/libraries/provider_git_service.rb
            D      +++ Adding git/libraries/provider_git_service_xinetd.rb
            D      +++ Adding git/libraries/resource_git_client.rb
            D      +++ Adding git/libraries/resource_git_service.rb
            D      +++ Adding git/libraries/z_provider_mapping.rb
            D      +++ Adding git/metadata.json
            D      +++ Adding git/providers/config.rb
            D      +++ Adding git/recipes/default.rb
            D      +++ Adding git/recipes/package.rb
            D      +++ Adding git/recipes/server.rb
            D      +++ Adding git/recipes/source.rb
            D      +++ Adding git/recipes/windows.rb
            D      +++ Adding git/resources/config.rb
            D      +++ Adding git/templates/default/git-xinetd.d.erb
            D      +++ Adding git/templates/default/sv-git-daemon-log-run.erb
            D      +++ Adding git/templates/default/sv-git-daemon-run.erb
            D      +++ Adding mingw/README.md
            D      +++ Adding mingw/files/default/bash.bat
            D      +++ Adding mingw/files/default/custom-upgrade.sh
            D      +++ Adding mingw/files/default/pthread.h
            D      +++ Adding mingw/files/default/time.h
            D      +++ Adding mingw/libraries/_helper.rb
            D      +++ Adding mingw/metadata.json
            D      +++ Adding mingw/recipes/default.rb
            D      +++ Adding mingw/resources/get.rb
            D      +++ Adding mingw/resources/msys2_package.rb
            D      +++ Adding mingw/resources/tdm_gcc.rb
            D      +++ Adding seven_zip/README.md
            D      +++ Adding seven_zip/attributes/default.rb
            D      +++ Adding seven_zip/metadata.json
            D      +++ Adding seven_zip/providers/archive.rb
            D      +++ Adding seven_zip/recipes/default.rb
            D      +++ Adding seven_zip/resources/archive.rb
            D      +++ Adding winbox/README.md
            D      +++ Adding winbox/attributes/debugger_install_path.rb
            D      +++ Adding winbox/attributes/editor.rb
            D      +++ Adding winbox/files/default/ConEmu.xml
            D      +++ Adding winbox/files/default/chef-dk.ico
            D      +++ Adding winbox/files/default/get-help-full.ps1
            D      +++ Adding winbox/files/default/install.ps1
            D      +++ Adding winbox/files/default/set-location-docs.ps1
            D      +++ Adding winbox/files/default/start-chefdk.ps1
            D      +++ Adding winbox/files/default/vscode-keybindings.json
            D      +++ Adding winbox/files/default/vscode-settings.json
            D      +++ Adding winbox/files/default/winbox-ps-profile.ps1
            D      +++ Adding winbox/libraries/executable_finder.rb
            D      +++ Adding winbox/libraries/git_information.rb
            D      +++ Adding winbox/metadata.json
            D      +++ Adding winbox/recipes/chefdk.rb
            D      +++ Adding winbox/recipes/chefdk_shortcut.rb
            D      +++ Adding winbox/recipes/chocolatey_install.rb
            D      +++ Adding winbox/recipes/console.rb
            D      +++ Adding winbox/recipes/debugger.rb
            D      +++ Adding winbox/recipes/default.rb
            D      +++ Adding winbox/recipes/editor.rb
            D      +++ Adding winbox/recipes/powershell_dev.rb
            D      +++ Adding winbox/recipes/readline.rb
            D      +++ Adding winbox/recipes/vscode_emacs.rb
            D      +++ Adding windows/README.md
            D      +++ Adding windows/attributes/default.rb
            D      +++ Adding windows/files/default/handlers/windows_reboot_handler.rb
            D      +++ Adding windows/libraries/feature_base.rb
            D      +++ Adding windows/libraries/matchers.rb
            D      +++ Adding windows/libraries/powershell_helper.rb
            D      +++ Adding windows/libraries/powershell_out.rb
            D      +++ Adding windows/libraries/registry_helper.rb
            D      +++ Adding windows/libraries/version.rb
            D      +++ Adding windows/libraries/windows_architecture_helper.rb
            D      +++ Adding windows/libraries/windows_helper.rb
            D      +++ Adding windows/libraries/windows_package.rb
            D      +++ Adding windows/libraries/windows_privileged.rb
            D      +++ Adding windows/libraries/wmi_helper.rb
            D      +++ Adding windows/metadata.json
            D      +++ Adding windows/providers/auto_run.rb
            D      +++ Adding windows/providers/batch.rb
            D      +++ Adding windows/providers/certificate.rb
            D      +++ Adding windows/providers/certificate_binding.rb
            D      +++ Adding windows/providers/feature_dism.rb
            D      +++ Adding windows/providers/feature_powershell.rb
            D      +++ Adding windows/providers/feature_servermanagercmd.rb
            D      +++ Adding windows/providers/font.rb
            D      +++ Adding windows/providers/http_acl.rb
            D      +++ Adding windows/providers/pagefile.rb
            D      +++ Adding windows/providers/path.rb
            D      +++ Adding windows/providers/printer.rb
            D      +++ Adding windows/providers/printer_port.rb
            D      +++ Adding windows/providers/reboot.rb
            D      +++ Adding windows/providers/registry.rb
            D      +++ Adding windows/providers/shortcut.rb
            D      +++ Adding windows/providers/task.rb
            D      +++ Adding windows/providers/zipfile.rb
            D      +++ Adding windows/recipes/default.rb
            D      +++ Adding windows/recipes/reboot_handler.rb
            D      +++ Adding windows/resources/auto_run.rb
            D      +++ Adding windows/resources/batch.rb
            D      +++ Adding windows/resources/certificate.rb
            D      +++ Adding windows/resources/certificate_binding.rb
            D      +++ Adding windows/resources/feature.rb
            D      +++ Adding windows/resources/font.rb
            D      +++ Adding windows/resources/http_acl.rb
            D      +++ Adding windows/resources/pagefile.rb
            D      +++ Adding windows/resources/path.rb
            D      +++ Adding windows/resources/printer.rb
            D      +++ Adding windows/resources/printer_port.rb
            D      +++ Adding windows/resources/reboot.rb
            D      +++ Adding windows/resources/registry.rb
            D      +++ Adding windows/resources/shortcut.rb
            D      +++ Adding windows/resources/task.rb
            D      +++ Adding windows/resources/zipfile.rb
            D      +++ Adding yum/README.md
            D      +++ Adding yum/attributes/main.rb
            D      +++ Adding yum/libraries/matchers.rb
            D      +++ Adding yum/metadata.json
            D      +++ Adding yum/providers/globalconfig.rb
            D      +++ Adding yum/providers/repository.rb
            D      +++ Adding yum/recipes/default.rb
            D      +++ Adding yum/recipes/dnf_yum_compat.rb
            D      +++ Adding yum/resources/globalconfig.rb
            D      +++ Adding yum/resources/repository.rb
            D      +++ Adding yum/templates/default/main.erb
            D      +++ Adding yum/templates/default/repo.erb
            D      +++ Adding yum-epel/README.md
            D      +++ Adding yum-epel/attributes/default.rb
            D      +++ Adding yum-epel/attributes/epel-debuginfo.rb
            D      +++ Adding yum-epel/attributes/epel-source.rb
            D      +++ Adding yum-epel/attributes/epel-testing-debuginfo.rb
            D      +++ Adding yum-epel/attributes/epel-testing-source.rb
            D      +++ Adding yum-epel/attributes/epel-testing.rb
            D      +++ Adding yum-epel/attributes/epel.rb
            D      +++ Adding yum-epel/metadata.json
            D      +++ Adding yum-epel/recipes/default.rb
            D      === All files added.
            D      Running check_files.ps1
            D      @{
            D        "a86f70dc25c9c07f2959adeb0ed8a08c" = @{
            D          "target" = "$env:TEMP\kitchen";
            D          "src_basename" = "dna.json";
            D          "dst" = "$env:TEMP\kitchen"
            D        };
            D        "b8a32ad42457120c47ccf2013d837e5d" = @{
            D          "target" = "$env:TEMP\kitchen";
            D          "src_basename" = "client.rb";
            D          "dst" = "$env:TEMP\kitchen"
            D        };
            D        "76cdb2bad9582d23c1f6f4d868218d6c" = @{
            D          "target" = "$env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip";
            D          "src_basename" = "cache";
            D          "dst" = "$env:TEMP\kitchen\cache"
            D        };
            D        "49abb94825cb80b9a9cd59e5f76daf4a" = @{
            D          "target" = "$env:TEMP\kitchen";
            D          "src_basename" = "validation.pem";
            D          "dst" = "$env:TEMP\kitchen"
            D        };
            D        "d0bf03fad6068e40918d8e94b5bac0ab" = @{
            D          "target" = "$env:TEMP\winrm-upload\tmpzip-d0bf03fad6068e40918d8e94b5bac0ab.zip";
            D          "src_basename" = "cookbooks";
            D          "dst" = "$env:TEMP\kitchen\cookbooks"
            D        }
            D      }
            D      Parsing CSV Response
            D      "chk_exists","src_md5","dst_md5","chk_dirty","verifies","target_is_folder"
            "False","a86f70dc25c9c07f2959adeb0ed8a08c",,"True","False","True"
            "False","76cdb2bad9582d23c1f6f4d868218d6c",,"True","False","False"
            "False","49abb94825cb80b9a9cd59e5f76daf4a",,"True","False","True"
            "False","d0bf03fad6068e40918d8e94b5bac0ab",,"True","False","False"
            "False","b8a32ad42457120c47ccf2013d837e5d",,"True","False","True"

            D      Uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/dna.json to encoded tmpfile $env:TEMP\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt
            D      Finished uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/dna.json to encoded tmpfile $env:TEMP\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt (0.12 KB over 1 chunks) in (0m0.07s)
            D      Uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/client.rb to encoded tmpfile $env:TEMP\b64-b8a32ad42457120c47ccf2013d837e5d.txt
            D      Finished uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/client.rb to encoded tmpfile $env:TEMP\b64-b8a32ad42457120c47ccf2013d837e5d.txt (1.104 KB over 1 chunks) in (0m0.10s)
            D      Uploading /tmp/cheftest/tmpzip-20160628-7187-ukt16c.zip to encoded tmpfile $env:TEMP\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt
            D      Finished uploading /tmp/cheftest/tmpzip-20160628-7187-ukt16c.zip to encoded tmpfile $env:TEMP\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt (0.028 KB over 1 chunks) in (0m0.07s)
            D      Uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/validation.pem to encoded tmpfile $env:TEMP\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt
            D      Finished uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/validation.pem to encoded tmpfile $env:TEMP\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt (2.236 KB over 1 chunks) in (0m0.11s)
            D      Uploading /tmp/cheftest/tmpzip-20160628-7187-1risqp3.zip to encoded tmpfile $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt
            D      Wrote chunk 25 for $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt
            D      Wrote chunk 50 for $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt
            D      Finished uploading /tmp/cheftest/tmpzip-20160628-7187-1risqp3.zip to encoded tmpfile $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt (430.176 KB over 54 chunks) in (0m4.53s)
            D      Running decode_files.ps1
            D      @{
            D        "$env:TEMP\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt" = @{
            D          "dst" = "$env:TEMP\kitchen/dna.json"
            D        };
            D        "$env:TEMP\b64-b8a32ad42457120c47ccf2013d837e5d.txt" = @{
            D          "dst" = "$env:TEMP\kitchen/client.rb"
            D        };
            D        "$env:TEMP\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt" = @{
            D          "dst" = "$env:TEMP\kitchen\cache";
            D          "tmpzip" = "$env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip"
            D        };
            D        "$env:TEMP\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt" = @{
            D          "dst" = "$env:TEMP\kitchen/validation.pem"
            D        };
            D        "$env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt" = @{
            D          "dst" = "$env:TEMP\kitchen\cookbooks";
            D          "tmpzip" = "$env:TEMP\winrm-upload\tmpzip-d0bf03fad6068e40918d8e94b5bac0ab.zip"
            D        }
            D      }
            D      Parsing CSV Response
            D      "src_md5","tmpzip","verifies","tmpfile","dst_md5","dst"
            "76cdb2bad9582d23c1f6f4d868218d6c","C:\Users\ADMINI~1\AppData\Local\Temp\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip","True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt","76cdb2bad9582d23c1f6f4d868218d6c","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache"
            "a86f70dc25c9c07f2959adeb0ed8a08c",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt","a86f70dc25c9c07f2959adeb0ed8a08c","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen/dna.json"
            "d0bf03fad6068e40918d8e94b5bac0ab","C:\Users\ADMINI~1\AppData\Local\Temp\winrm-upload\tmpzip-d0bf03fad6068e40918d8e94b5bac0ab.zip","True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt","d0bf03fad6068e40918d8e94b5bac0ab","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cookbooks"
            "49abb94825cb80b9a9cd59e5f76daf4a",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt","49abb94825cb80b9a9cd59e5f76daf4a","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen/validation.pem"
            "b8a32ad42457120c47ccf2013d837e5d",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-b8a32ad42457120c47ccf2013d837e5d.txt","b8a32ad42457120c47ccf2013d837e5d","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen/client.rb"

            D      Cleaned up src_zip /tmp/cheftest/tmpzip-20160628-7187-ukt16c.zip
            D      Cleaned up src_zip /tmp/cheftest/tmpzip-20160628-7187-1risqp3.zip
            D      Uploaded 5 items dirty_check: (0m1.42s) stream_files: (0m4.90s) decode: (0m2.74s)
            D      Transfer complete
            D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> ($env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine")

            & $env:systemdrive\opscode\chefdk\bin\chef-client.bat --local-mode --config $env:TEMP\kitchen\client.rb --log_level auto --force-formatter --no-color --json-attributes $env:TEMP\kitchen\dna.json --chef-zero-port 8889)
                   Starting Chef Client, version 12.11.18
                   Creating a new client identity for default-windows-2012r2 using the validator key.
                   resolving cookbooks for run list: ["winbox::default"]
                   Synchronizing Cookbooks:
                     - winbox (0.9.105)
                     - git (4.5.0)
                     - windows (1.44.0)
                     - build-essential (6.0.0)
                     - dmg (2.4.0)
                     - yum-epel (0.7.0)
                     - chef_handler (1.4.0)
                     - seven_zip (2.0.1)
                     - mingw (1.2.2)
                     - compat_resource (12.10.6)
                     - yum (3.11.0)
                   Installing Cookbook Gems:
                   Compiling Cookbooks...
                   Converging 25 resources
                   Recipe: git::windows
                     * git_client[default] action install[2016-06-28T03:48:59+00:00] WARN: Please use the package resource available in Chef Client 12.6.
                   windows_package will be removed in the next major version release
                   of the Windows cookbook.


                       * windows_package[Git version 2.8.1] action install
                       Recipe: <Dynamically Defined Resource>
                         * remote_file[C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\package\Git-2.8.1-64-bit.exe] action create
                    - create new file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\package\Git-2.8.1-64-bit.exe
                    - update content in file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\package\Git-2.8.1-64-bit.exe from none to 5e5283
                    (file sizes exceed 10000000 bytes, diff output suppressed)
                         - install version latest of package Git version 2.8.1
                       * ruby_block[Add Git Path] action nothing (skipped due to action :nothing)
                       * windows_path[C:\Program Files\Git\Cmd] action add
                         * env[path] action modify

                         * ruby_block[fix ruby ENV['PATH']] action run
                    - execute the ruby block fix ruby ENV['PATH']
                         * ruby_block[fix ruby ENV['PATH']] action nothing (skipped due to action :nothing)

                       * ruby_block[Add Git Path] action create
                         - execute the ruby block Add Git Path

                   Recipe: winbox::chocolatey_install
                     * windows_path[update_path_for_system] action add
                       * env[path] action modify

                       * ruby_block[fix ruby ENV['PATH']] action run
                         - execute the ruby block fix ruby ENV['PATH']
                       * ruby_block[fix ruby ENV['PATH']] action nothing (skipped due to action :nothing)

                     * ruby_block[add_chocolatey_path] action run (skipped due to not_if)
                     * powershell_script[chocolatey_install] action run
                       - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-8eqjua.ps1"
                   Recipe: winbox::powershell_dev
                     * powershell_script[ExecutionPolicyUnrestricted] action run (skipped due to only_if)
                     * powershell_script[ExecutionPolicyUnrestrictedX86] action run
                       - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-l26d7f.ps1"
                     * cookbook_file[C:\Users\Administrator/winbox-ps-profile.ps1] action create_if_missing
                       - create new file C:\Users\Administrator/winbox-ps-profile.ps1
                       - update content in file C:\Users\Administrator/winbox-ps-profile.ps1 from none to 19a092
                       --- C:\Users\Administrator/winbox-ps-profile.ps1  2016-06-28 03:49:31.000000000 +0000
                       +++ C:\Users\Administrator/chef-winbox-ps-profile.ps120160628-3976-rbpfl4  2016-06-28 03:49:31.000000000 +0000
                       @@ -1 +1,89 @@
                       +# WinBox PowerShell profile
                       +#
                       +# Copyright 2015, Adam Edwards
                       +#
                       +# Licensed under the Apache License, Version 2.0 (the "License");
                       +# you may not use this file except in compliance with the License.
                       +# You may obtain a copy of the License at
                       +#
                       +#     http://www.apache.org/licenses/LICENSE-2.0
                       +#
                       +# Unless required by applicable law or agreed to in writing, software
                       +# distributed under the License is distributed on an "AS IS" BASIS,
                       +# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                       +# See the License for the specific language governing permissions and
                       +# limitations under the License.
                       +
                       +# Enable readline support
                       +import-module psreadline
                       +Set-PSReadlineOption -EditMode Emacs
                       +
                       +# Enable posh-git support
                       +if ((get-module -listavailable 'posh-git') -ne $null)
                       +{
                       +    import-module posh-git
                       +}
                       +
                       +# Get the username and whether we're elevated for display
                       +# in the title and prompt
                       +$identity = [Security.Principal.WindowsIdentity]::GetCurrent()
                       +$principal = [Security.Principal.WindowsPrincipal] $identity
                       +$titleprefix = ""
                       +if (test-path variable:/PSDebugContext)
                       +{
                       +    $titleprefix = 'Debug: '
                       +}
                       +else
                       +{
                       +    if ($principal.IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator"))
                       +    {
                       +        $titleprefix = "Administrator: "
                       +    }
                       +}
                       +
                       +#
                       +# The title will look like one of the following:
                       +#
                       +#   myusername@myhost
                       +#   Administrator: myusername@myhost
                       +#
                       +(get-host).ui.rawui.windowtitle = "$titleprefix$($env:username)@$($env:computername)"
                       +
                       +#
                       +# Set a useful two-line prompt that uses color for readability and status.
                       +# The format is 'host: lastexitcode: currentdirectory `newline `username >'.
                       +#
                       +# Here's example output:
                       +#
                       +#   myhost (0x00000001) c:\windows\system32\drivers\etc
                       +#   myuser >
                       +#
                       +function prompt
                       +{
                       +    $lasterror = $?
                       +    $lastexit = $lastexitcode
                       +    if ($lastexit -eq $null) { $lastexit = 0 }
                       +    $errorcolor = 'green'
                       +    $exitcolor = 'green'
                       +    if (! $lasterror) { $errorcolor = 'red' }
                       +    if ($lastexit -ne 0) { $exitcolor = 'red' }
                       +
                       +    write-host -nonewline -foregroundcolor $errorcolor '% '
                       +    write-host -nonewline -foregroundcolor darkyellow "$env:computername "
                       +    write-host -nonewline -foregroundcolor gray "("
                       +    write-host -nonewline -foregroundcolor $exitcolor "0x$(($lastexit).ToString("X8"))"
                       +    write-host -nonewline -foregroundcolor gray ")"
                       +    if ( get-command write-vcsstatus) { Write-VcsStatus }
                       +    write-host -foregroundcolor cyan " $($executionContext.SessionState.Path.CurrentLocation)"
                       +    write-host -nonewline -foregroundcolor darkyellow "$env:username"
                       +    "$('>' * ($nestedPromptLevel + 1)) "
                       +}
                       +
                       +# Make the man alias show full help by default
                       +. ~\get-help-full.ps1
                       +set-alias -option allscope man get-help-full
                       +
                       +# Useful shortcut to get to Documents folder
                       +. ~\set-location-docs.ps1
                       +new-alias docs set-location-docs
                     * cookbook_file[C:\Users\Administrator/get-help-full.ps1] action create
                       - create new file C:\Users\Administrator/get-help-full.ps1
                       - update content in file C:\Users\Administrator/get-help-full.ps1 from none to 7edc66
                       --- C:\Users\Administrator/get-help-full.ps1  2016-06-28 03:49:31.000000000 +0000
                       +++ C:\Users\Administrator/chef-get-help-full.ps120160628-3976-ioa2km  2016-06-28 03:49:31.000000000 +0000
                       @@ -1 +1,30 @@
                       +#
                       +# Copyright 2015, Adam Edwards
                       +#
                       +# Licensed under the Apache License, Version 2.0 (the "License");
                       +# you may not use this file except in compliance with the License.
                       +# You may obtain a copy of the License at
                       +#
                       +#     http://www.apache.org/licenses/LICENSE-2.0
                       +#
                       +# Unless required by applicable law or agreed to in writing, software
                       +# distributed under the License is distributed on an "AS IS" BASIS,
                       +# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                       +# See the License for the specific language governing permissions and
                       +# limitations under the License.
                       +
                       +# Shows help page with full help, rather than the
                       +# abbreviated help which is the default for get-help
                       +function get-help-full
                       +{
                       +    try
                       +    {
                       +        get-help @args -full | out-host -paging
                       +    }
                       +    catch [System.Management.Automation.HaltCommandException]
                       +    {
                       +        # Do nothing if the user chooses 'q'
                       +    }
                       +}
                       +
                     * cookbook_file[C:\Users\Administrator/set-location-docs.ps1] action create
                       - create new file C:\Users\Administrator/set-location-docs.ps1
                       - update content in file C:\Users\Administrator/set-location-docs.ps1 from none to 3e28a0
                       --- C:\Users\Administrator/set-location-docs.ps1  2016-06-28 03:49:31.000000000 +0000
                       +++ C:\Users\Administrator/chef-set-location-docs.ps120160628-3976-10q0aeg  2016-06-28 03:49:31.000000000 +0000
                       @@ -1 +1,31 @@
                       +# Documents directory shortcut
                       +#
                       +# Copyright 2015, Adam Edwards
                       +#
                       +# Licensed under the Apache License, Version 2.0 (the "License");
                       +# you may not use this file except in compliance with the License.
                       +# You may obtain a copy of the License at
                       +#
                       +#     http://www.apache.org/licenses/LICENSE-2.0
                       +#
                       +# Unless required by applicable law or agreed to in writing, software
                       +# distributed under the License is distributed on an "AS IS" BASIS,
                       +# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                       +# See the License for the specific language governing permissions and
                       +# limitations under the License.
                       +
                       +# Set the current directory to the location of the
                       +# Documents directory, and also set up an environment
                       +# variables called DOCS.
                       +function set-location-docs
                       +{
                       +
                       +    if ($env:DOCS -eq $null)
                       +    {
                       +        $myDocsPath = [environment]::GetFolderPath("MyDocuments")
                       +        $env:DOCS = $myDocsPath
                       +    }
                       +
                       +    pushd $env:DOCS
                       +}
                     * directory[C:/Users/Administrator/Documents/WindowsPowerShell] action create (up to date)
                     * powershell_script[C:\Users\Administrator\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1] action run (skipped due to not_if)
                   Recipe: winbox::readline
                     * remote_file[C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\psreadline.zip] action create
                       - create new file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\psreadline.zip
                       - update content in file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\psreadline.zip from none to 68577a
                       (new content is binary, diff output suppressed)
                     * powershell_script[install_module] action run
                       - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-5awo7s.ps1"
                   Recipe: winbox::editor
                     * directory[C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode] action create
                       - create new directory C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode
                     * remote_file[C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode/vscodesetup.exe] action create
                       - create new file C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode/vscodesetup.exe
                       - update content in file C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode/vscodesetup.exe from none to 3ae51c
                       (file sizes exceed 10000000 bytes, diff output suppressed)
                     * powershell_script[install vscode] action run
                       - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-11cuxbk.ps1"
                     * env[EDITOR] action create

                   Recipe: winbox::console
                     * cookbook_file[C:\Program Files/conemu/ConEmu.xml] action nothing (skipped due to action :nothing)
            D      [WinRM] retrying receive request after timeout
            D      [WinRM] retrying receive request after timeout
            D      [WinRM] retrying receive request after timeout
            D      [WinRM] retrying receive request after timeout
                     * powershell_script[conemu] action run

                       ================================================================================
                       Error executing action `run` on resource 'powershell_script[conemu]'
                       ================================================================================

                       Mixlib::ShellOut::ShellCommandFailed
                       ------------------------------------
                       Expected process to exit with [0], but received '1'
                       ---- Begin output of "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" ----
                       STDOUT: Installing the following packages:
                       conemu
                       By installing you accept licenses for the packages.
                       conemu not installed. The package was not found with the source(s) listed.
                        If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                        Version: ""
                        Source(s): "https://chocolatey.org/api/v2/"

                       Chocolatey installed 0/1 packages. 1 packages failed.
                        See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                       Failures
                        - conemu - conemu not installed. The package was not found with the source(s) listed.
                        If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                        Version: ""
                        Source(s): "https://chocolatey.org/api/v2/"
                       Installing the following packages:
                       conemu
                       By installing you accept licenses for the packages.
                       conemu not installed. The package was not found with the source(s) listed.
                        If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                        Version: ""
                        Source(s): "https://chocolatey.org/api/v2/"

                       Chocolatey installed 0/1 packages. 1 packages failed.
                        See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                       Failures
                        - conemu - conemu not installed. The package was not found with the source(s) listed.
                        If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                        Version: ""
                        Source(s): "https://chocolatey.org/api/v2/"
                       STDERR:
                       ---- End output of "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" ----
                       Ran "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" returned 1

                       Resource Declaration:
                       ---------------------
                       # In C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/cookbooks/winbox/recipes/console.rb

                        27: powershell_script 'conemu' do
                        28:   code <<-EOH
                        29: chocolatey install conemu -y
                        30: if ($LASTEXITCODE -ne 0)
                        31: {
                        32:   $LASTEXITCODE = 0
                        33:   chocolatey install conemu -y
                        34: }
                        35: EOH
                        36:   only_if '(get-wmiobject Win32_MSIResource | Where-Object -Property value -like -Value conemu) -eq $null'
                        37: end
                        38:

                       Compiled Resource:
                       ------------------
                       # Declared in C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/cookbooks/winbox/recipes/console.rb:27:in `from_file'

                       powershell_script("conemu") do
                         action [:run]
                         retries 0
                         retry_delay 2
                         default_guard_interpreter :powershell_script
                         command "conemu"
                         backup 5
                         returns 0
                         code "chocolatey install conemu -y\nif ($LASTEXITCODE -ne 0)\n{\n  $LASTEXITCODE = 0\n  chocolatey install conemu -y\n}\n"
                         interpreter "powershell.exe"
                         declared_type :powershell_script
                         cookbook_name "winbox"
                         recipe_name "console"
                         only_if "(get-wmiobject Win32_MSIResource | Where-Object -Property value -like -Value conemu) -eq $null"
                       end

                       Platform:
                       ---------
                       i386-mingw32

                   Starting audit phase

                   Finished in 0 seconds (files took 0.68318 seconds to load)
                   0 examples, 0 failures
                   Auditing complete

                   Running handlers:
                   [2016-06-28T03:54:00+00:00] ERROR: Running exception handlers
                   Running handlers complete
                   [2016-06-28T03:54:00+00:00] ERROR: Exception handlers complete
                   Chef Client failed. 21 resources updated in 05 minutes 52 seconds
                   [2016-06-28T03:54:00+00:00] ERROR: Failed to post audit report to server. Saving report to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/failed-audit-data.json
                   [2016-06-28T03:54:00+00:00] FATAL: Stacktrace dumped to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/chef-stacktrace.out
                   [2016-06-28T03:54:00+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                   [2016-06-28T03:54:00+00:00] FATAL: Chef::Exceptions::RunFailedWrappingError: Found 1 errors, they are stored in the backtrace
            $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/2.1.0/i386-mingw32/dl.so: warning: already initialized constant DL::RUBY_FREE
            $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/gems/2.1.0/gems/net-ssh-3.2.0/lib/net/ssh/authentication/pageant.rb:16: warning: previous definition of RUBY_FREE was here
            $$$$$$ DL is deprecated, please use Fiddle
            D      Cleaning up local sandbox in /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa
            D      Converge failed on instance <default-windows-2012r2>.
            D      ------Exception-------
            D      Class: Kitchen::InstanceFailure
            D      Message: Converge failed on instance <default-windows-2012r2>.  Please see .kitchen/logs/default-windows-2012r2.log for more details
            D      ----------------------
            D      ------Backtrace-------
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:76:in `rescue in call'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:79:in `call'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:373:in `block in converge_action'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `call'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `synchronize_or_call'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:478:in `block in action'
            D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:477:in `action'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:369:in `converge_action'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:348:in `block in transition_to'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `each'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `transition_to'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:138:in `converge'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `public_send'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `run_action_in_thread'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
            D      ----End Backtrace-----
            D      ---Nested Exception---
            D      Class: Kitchen::ActionFailed
            D      Message: WinRM exited (1) for command: [$env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine")

            & $env:systemdrive\opscode\chefdk\bin\chef-client.bat --local-mode --config $env:TEMP\kitchen\client.rb --log_level auto --force-formatter --no-color --json-attributes $env:TEMP\kitchen\dna.json --chef-zero-port 8889]
            D      ----------------------
            D      ------Backtrace-------
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:76:in `rescue in call'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:79:in `call'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:373:in `block in converge_action'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `call'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `synchronize_or_call'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:478:in `block in action'
            D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:477:in `action'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:369:in `converge_action'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:348:in `block in transition_to'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `each'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `transition_to'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:138:in `converge'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `public_send'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `run_action_in_thread'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
            D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
            D      ----End Backtrace-----
            D      [WinRM] closing remote shell 5543ED20-7DD5-4564-8B3C-F44F26F67293 on http://10.194.8.202:5985/wsman
            D      [WinRM] closing remote shell 527C3D98-8885-4FD3-8A22-5EAE4548481A on http://10.194.8.202:5985/wsman
            D      [WinRM] remote shell 527C3D98-8885-4FD3-8A22-5EAE4548481A closed
            STDERR: >>>>>> Converge failed on instance <default-windows-2012r2>.
            >>>>>> Please see .kitchen/logs/default-windows-2012r2.log for more details
            >>>>>> ------Exception-------
            >>>>>> Class: Kitchen::ActionFailed
            >>>>>> Message: WinRM exited (1) for command: [$env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine")

            & $env:systemdrive\opscode\chefdk\bin\chef-client.bat --local-mode --config $env:TEMP\kitchen\client.rb --log_level auto --force-formatter --no-color --json-attributes $env:TEMP\kitchen\dna.json --chef-zero-port 8889]
            >>>>>> ----------------------
            ---- End output of bundle exec kitchen converge  -c -l debug ----
            Ran bundle exec kitchen converge  -c -l debug returned 10

            Resource Declaration:
            ---------------------
            # In /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/top_cookbooks.rb

             32:     cookbook_kitchen "#{command} winbox" do
             33:       repository "adamedx/winbox"
             34:     end
             35:

            Compiled Resource:
            ------------------
            # Declared in /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/top_cookbooks.rb:32:in `block in <class:TopCookbooks>'

            cookbook_kitchen("converge winbox") do
              action [:run]
              updated true
              updated_by_last_action true
              retries 0
              retry_delay 2
              default_guard_interpreter :default
              declared_type :cookbook_kitchen
              cookbook_name "acceptance-cookbook"
              repository "https://github.com/adamedx/winbox.git"
              test_cookbook "winbox"
              repository_root "/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/winbox"
              branch "master"
              command "converge"
              kitchen_options "-c -l debug"
              kitchen_dir "/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/winbox/"
              env {"BUNDLE_GEMFILE"=>"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/Gemfile", "KITCHEN_YAML"=>"/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/.kitchen.winbox.yml"}
            end

            Platform:
            ---------
            x86_64-linux


          ================================================================================
          Error executing action `run` on resource 'top_cookbooks[converge]'
          ================================================================================

          Mixlib::ShellOut::ShellCommandFailed
          ------------------------------------
          cookbook_kitchen[converge winbox] (/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/top_cookbooks.rb line 32) had an error: Mixlib::ShellOut::ShellCommandFailed: execute[bundle exec kitchen converge  -c -l debug] (/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb line 36) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '10'
          ---- Begin output of bundle exec kitchen converge  -c -l debug ----
          STDOUT: -----> Starting Kitchen (v1.9.0)
          D      Berksfile found at /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/winbox/Berksfile, loading Berkshelf
          D      Berkshelf 4.3.3 library loaded
          D      winrm requested, loading winrm gem (["~> 1.6"])
          D      winrm is loaded.
          D      winrm-fs requested, loading winrm-fs gem (["~> 0.4.1"])
          D      winrm-fs is loaded.
          -----> Creating <default-windows-2012r2>...
          D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
          D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
          D      Search returned 3 images:
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.04.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-04-13T01:30:48.000Z
          D      Image for default-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                 Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
          D      No SSH username specified: using default username administrator  for image ami-8d0acfed, which we detected as windows 2012r2rtm x86_64.
                 If you are not using an account that qualifies under the AWS
          free-tier, you may be charged to run these suites. The charge
          should be minimal, but neither Test Kitchen nor its maintainers
          are responsible for your incurred costs.

          D      Creating EC2 instance in region us-west-2 with properties:
          D      - instance_type = "m3.large"
          D      - ebs_optimized = false
          D      - image_id = "ami-8d0acfed"
          D      - key_name = "jenkins"
          D      - subnet_id = "subnet-19ac017c"
          D      - private_ip_address = nil
          D      - placement = {:availability_zone=>"us-west-2a"}
          D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
          D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                 Instance <i-b502d11a> requested.
                 Polling AWS for existence, attempt 0...
                 Attempting to tag the instance, 0 retries
                 EC2 instance <i-b502d11a> created.
                 Waited 0/300s for instance <i-b502d11a> to become ready.
                 Waited 5/300s for instance <i-b502d11a> to become ready.
                 Waited 10/300s for instance <i-b502d11a> to become ready.
                 Waited 15/300s for instance <i-b502d11a> to become ready.
                 Waited 20/300s for instance <i-b502d11a> to become ready.
                 Waited 25/300s for instance <i-b502d11a> to become ready.
                 Waited 30/300s for instance <i-b502d11a> to become ready.
                 Waited 35/300s for instance <i-b502d11a> to become ready.
                 Waited 40/300s for instance <i-b502d11a> to become ready.
                 Waited 45/300s for instance <i-b502d11a> to become ready.
                 Waited 50/300s for instance <i-b502d11a> to become ready.
                 Waited 55/300s for instance <i-b502d11a> to become ready.
                 Waited 60/300s for instance <i-b502d11a> to become ready.
                 Waited 65/300s for instance <i-b502d11a> to become ready.
                 Waited 70/300s for instance <i-b502d11a> to become ready.
                 Waited 75/300s for instance <i-b502d11a> to become ready.
                 Waited 80/300s for instance <i-b502d11a> to become ready.
                 Waited 85/300s for instance <i-b502d11a> to become ready.
                 Waited 90/300s for instance <i-b502d11a> to become ready.
                 Waited 95/300s for instance <i-b502d11a> to become ready.
                 Waited 100/300s for instance <i-b502d11a> to become ready.
          D      Console output: ---
          2016/06/28 03:45:05Z: EC2ConfigMonitorState: 0
          2016/06/28 03:45:05Z: Windows sysprep configuration complete.
          2016/06/28 03:45:09Z: AMI Origin Version: 2016.06.15
          2016/06/28 03:45:09Z: AMI Origin Name: Windows_Server-2012-R2_RTM-English-64Bit-Base
          2016/06/28 03:45:09Z: OS: Microsoft Windows NT 6.3.9600
          2016/06/28 03:45:09Z: OsVersion: 6.3
          2016/06/28 03:45:09Z: OsProductName: Windows Server 2012 R2 Standard
          2016/06/28 03:45:09Z: OsBuildLabEx: 9600.18292.amd64fre.winblue_ltsb.160330-1744
          2016/06/28 03:45:09Z: Language: en-US
          2016/06/28 03:45:09Z: TimeZone: Coordinated Universal Time
          2016/06/28 03:45:09Z: Offset: UTC 00:00:00
          2016/06/28 03:45:09Z: EC2 Agent: Ec2Config service v3.17.1032
          2016/06/28 03:45:11Z: Message: Waiting for meta-data accessibility...
          2016/06/28 03:45:11Z: Message: Meta-data is now available.
          2016/06/28 03:45:12Z: AMI-ID: ami-8d0acfed
          2016/06/28 03:45:12Z: Instance-ID: i-b502d11a
          2016/06/28 03:45:13Z: Driver: AWS PV Network Device v7.3.2.0
          2016/06/28 03:45:13Z: Driver: AWS PV Storage Host Adapter v7.3.2.0
          2016/06/28 03:45:13Z: Ec2SetPassword: Enabled
          2016/06/28 03:45:13Z: RDPCERTIFICATE-SUBJECTNAME: WIN-BNKEQGJ67NR
          2016/06/28 03:45:13Z: RDPCERTIFICATE-THUMBPRINT: 2E8BF7BD57958ED85A9DE40C8BF35F10E0C6055B
          2016/06/28 03:45:16Z: Username: Administrator
          2016/06/28 03:45:16Z: Password: <Password>
          vnp1wei+6gpf/Jp/BSsKj6kEqjgBifbUU25L2LrVoAXrfC3clMdQx/7PapIDlxl7LcgdgHtrW7wfNpqgRyxjAkGm+Dp3vU90hQ7hSVn3ADvOtt5mgUX383cjQyNXZT525g1ko9BcZKZ3+CBV8TRA62CF0eLa5r0VB9dIP/x6U41MSgql5ZOSSYrglyDlyabZPRgIpaTks7lHifqduiMazKC5HPK6wVBfuiTF7DHY/alBPVcx1eqCKHyDUOg5SBKD5BgI4Kh7lhLeUPrv6cgIv6Sy7KOZi6HUHbfVIrTx4ImCGztxijleWLkL5WbxAaPcBNQE8cSjFTdQqJpTV0npvw==
          </Password>
          2016/06/28 03:45:18Z: Message: Windows is Ready to use

                 Waited 0/300s for instance <i-b502d11a> to fetch windows admin password.
                 Retrieved Windows password for instance <i-b502d11a>.
                 EC2 instance <i-b502d11a> ready.
          D      [WinRM] opening remote shell on http://10.194.8.202:5985/wsman
          D      [WinRM] remote shell 5543ED20-7DD5-4564-8B3C-F44F26F67293 is open on http://10.194.8.202:5985/wsman
          D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (Write-Host '[WinRM] Established
          ')
                 [WinRM] Established

          D      [WinRM] reusing existing connection negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
          D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File)


                     Directory: C:\chef\ohai\hints


                 Mode                LastWriteTime     Length Name
                 ----                -------------     ------ ----
                 -a---         6/28/2016   3:45 AM          0 ec2.json


          D      ec2:create '10.194.8.202'
                 Finished creating <default-windows-2012r2> (2m14.56s).
          -----> Converging <default-windows-2012r2>...
                 Preparing files for transfer
          D      Creating local sandbox in /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa
                 Preparing dna.json
          D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>["recipe[winbox::default]"]}
                 Resolving cookbook dependencies with Berkshelf 4.3.3...
          D      Using Berksfile from /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/top-cookbooks/test_run/winbox/Berksfile
                 Removing non-cookbook files before transfer
                 Preparing validation.pem
          D      Using a dummy validation.pem
                 Preparing client.rb
          D      Creating client.rb from {:node_name=>"default-windows-2012r2", :checksum_path=>"\#{ENV['TEMP']}\\kitchen\\checksums", :file_cache_path=>"\#{ENV['TEMP']}\\kitchen\\cache", :file_backup_path=>"\#{ENV['TEMP']}\\kitchen\\backup", :cookbook_path=>["\#{ENV['TEMP']}\\kitchen\\cookbooks", "\#{ENV['TEMP']}\\kitchen\\site-cookbooks"], :data_bag_path=>"\#{ENV['TEMP']}\\kitchen\\data_bags", :environment_path=>"\#{ENV['TEMP']}\\kitchen\\environments", :node_path=>"\#{ENV['TEMP']}\\kitchen\\nodes", :role_path=>"\#{ENV['TEMP']}\\kitchen\\roles", :client_path=>"\#{ENV['TEMP']}\\kitchen\\clients", :user_path=>"\#{ENV['TEMP']}\\kitchen\\users", :validation_key=>"\#{ENV['TEMP']}\\kitchen\\validation.pem", :client_key=>"\#{ENV['TEMP']}\\kitchen\\client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"\#{ENV['TEMP']}\\kitchen\\encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
          D      [WinRM] reusing existing connection negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
          D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (new-module -name Omnitruck -scriptblock {
          function Get-PlatformVersion {
            switch -regex ((get-wmiobject win32_operatingsystem).version) {
              '10\.0\.\d+' {$platform_version = '2012r2'}
              '6\.3\.\d+'  {$platform_version = '2012r2'}
              '6\.2\.\d+'  {$platform_version = '2012'}
              '6\.1\.\d+'  {$platform_version = '2008r2'}
              '6\.0\.\d+'  {$platform_version = '2008'}
            }
            return $platform_version
          }

          function Get-PlatformArchitecture {
            if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
              $architecture = 'x86_64'
            } else {
              $architecture = 'i386'
            }
            return $architecture
          }

          function New-Uri {
            param ($baseuri, $newuri)

            new-object System.Uri $baseuri, $newuri
          }

          function Get-WebContent {
            param ($uri, $filepath)
            $proxy = New-Object -TypeName System.Net.WebProxy
            $wc = new-object System.Net.WebClient
            $proxy.Address = $env:http_proxy
            $wc.Proxy = $proxy

            try {
              if ([string]::IsNullOrEmpty($filepath)) {
                $wc.downloadstring($uri)
              }
              else {
                $wc.downloadfile($uri, $filepath)
              }
            }
            catch {
              $exception = $_.Exception
              Write-Host "There was an error: "
              do {
                Write-Host "`t$($exception.message)"
                $exception = $exception.innerexception
              } while ($exception)
              throw "Failed to download from $uri."
            }
          }

          function Test-ProjectPackage {
            [cmdletbinding()]
            param ($Path, $Algorithm = 'SHA256', $Hash)

            if (-not (get-command get-filehash))   {
              function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
              function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
              function Get-FileHash ($Path, $Algorithm) {
                $Path = (resolve-path $path).providerpath
                $hash = @{Algorithm = $Algorithm; Path = $Path}
                use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                  use ($in = (gi $path).OpenRead()) {
                    $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                  }
                }
                new-object PSObject -Property $hash
              }
            }
            Write-Verbose "Testing the $Algorithm hash for $path."
            $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
            Write-Verbose "`tDesired Hash - '$hash'"
            Write-Verbose "`tActual Hash  - '$ActualHash'"
            $Valid = $ActualHash -eq $Hash
            if (-not $Valid) {
              Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
            }
            return $Valid
          }

          function Get-ProjectMetadata {
            <#
              .SYNOPSIS
              Get metadata for a Chef Software, Inc. project
              .DESCRIPTION
              Get metadata for project
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

              Gets the download url and SHA256 checksum for the latest stable release of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

              Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
            #>
            [cmdletbinding()]
            param (
              # Base url to retrieve metadata from.
              [uri]$base_server_uri = 'https://omnitruck.chef.io/',
              [string]
              # Project to install
              [string]
              $project = 'chef',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Release channel to install from
              $channel = 'unstable',
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            # PowerShell is only on Windows ATM
            $platform = 'windows'
            Write-Verbose "Platform: $platform"

            $platform_version = Get-PlatformVersion
            Write-Verbose "Platform Version: $platform_version"

            if ($architecture -eq 'auto') {
              $architecture = Get-PlatformArchitecture
            }

            Write-Verbose "Architecture: $architecture"
            Write-Verbose "Project: $project"


              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/mac_os_x/10.9/chefdk-0.16.12-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 f337fa924b29a79686a681e3f24f03d391f57ba3c612b09db3821cb047573ee8" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/mac_os_x/10.10/chefdk-0.16.12-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 f337fa924b29a79686a681e3f24f03d391f57ba3c612b09db3821cb047573ee8" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/mac_os_x/10.11/chefdk-0.16.12-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 f337fa924b29a79686a681e3f24f03d391f57ba3c612b09db3821cb047573ee8" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/el/7/chefdk-0.16.12-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 f81822f72b09d67bff1ebd2752b693a1683e770f10396fbee67556e1b7566844" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/ubuntu/12.04/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 5de5cc0d959920c825440000eb5eef7886e174890b9604e0ab0d331a76ca6f0b" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/ubuntu/14.04/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 5de5cc0d959920c825440000eb5eef7886e174890b9604e0ab0d331a76ca6f0b" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/debian/6/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 897f19ce1539ba79d7111880ba5b7a59028d21a0e69c7d6a35faae476b9efb9a" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/debian/7/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 897f19ce1539ba79d7111880ba5b7a59028d21a0e69c7d6a35faae476b9efb9a" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/debian/8/chefdk_0.16.12-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 897f19ce1539ba79d7111880ba5b7a59028d21a0e69c7d6a35faae476b9efb9a" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/el/6/chefdk-0.16.12-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 59e6862a4c825037ef58c1341adea73d946491f127445e5522c211ac983262b8" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/windows/2008r2/chefdk-0.16.12-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 24ad3c76028785f8b0f147917029150010d7908cf3795f8b71d4b338e71efff8" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/windows/2012/chefdk-0.16.12-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 24ad3c76028785f8b0f147917029150010d7908cf3795f8b71d4b338e71efff8" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co/omnibus-unstable-local/com/getchef/chefdk/0.16.12/windows/2012r2/chefdk-0.16.12-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 24ad3c76028785f8b0f147917029150010d7908cf3795f8b71d4b338e71efff8" | out-file "$artifact_info_dir/artifact_info" -Append


            $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

            $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
              foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

            Write-Verbose "Project details: "
            foreach ($key in $package_metadata.keys) {
              Write-Verbose "`t$key = $($package_metadata[$key])"
            }
            $package_metadata
          }

          function Install-Project {
            <#
              .SYNOPSIS
              Install a Chef Software, Inc. product
              .DESCRIPTION
              Install a Chef Software, Inc. product
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

              Installs the latest stable version of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

              Installs the latest integration build of the Chef Development Kit
            #>
            [cmdletbinding(SupportsShouldProcess=$true)]
            param (
              # Project to install
              [string]
              $project = 'chef',
              # Release channel to install from
              [validateset('current', 'stable', 'unstable')]
              [string]
              $channel = 'stable',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Full path for the downloaded installer.
              [string]
              $filename,
              # Full path to the location to download the installer
              [string]
              $download_directory = $env:temp,
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

            if (-not [string]::IsNullOrEmpty($filename)) {
              $download_directory = split-path $filename
              $filename = split-path $filename -leaf
              if ([string]::IsNullOrEmpty($download_directory)) {
                $download_directory = $pwd
              }
            }
            else {
              $filename = ($package_metadata.url -split '/')[-1]
            }
            Write-Verbose "Download directory: $download_directory"
            Write-Verbose "Filename: $filename"

            if (-not (test-path $download_directory)) {
              mkdir $download_directory
            }
            $download_directory = (resolve-path $download_directory).providerpath
            $download_destination = join-path $download_directory $filename

            if ((test-path $download_destination) -and
              (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
              Write-Verbose "Found existing valid installer at $download_destination."
            }
            else {
              if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                Get-WebContent $package_metadata.url -filepath $download_destination
              }
            }

            if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
              if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                Write-Host "Installing $project from $download_destination"
                $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                $p.WaitForExit()
                if ($p.ExitCode -ne 0) {
                  throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                }
              }
              else {
                throw "Failed to validate the downloaded installer for $project."
              }
            }
          }
          set-alias install -value Install-Project
          export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

          }

          install -project chefdk -version 0.16.12 -channel unstable -architecture i386
          )
          D      creating hash for file $env:TEMP/default-windows-2012r2-long_script.ps1
          D      Running check_files.ps1
          D      @{
          D        "0a865588a80b701c316a564bcff56c63" = @{
          D          "target" = "$env:TEMP/default-windows-2012r2-long_script.ps1";
          D          "src_basename" = "default-windows-2012r2-long_script.ps1";
          D          "dst" = "$env:TEMP/default-windows-2012r2-long_script.ps1"
          D        }
          D      }
          D      [WinRM] opening new shell since the current one failed
          D      [WinRM] opening remote shell on http://10.194.8.202:5985/wsman
          D      [WinRM] remote shell 527C3D98-8885-4FD3-8A22-5EAE4548481A is open on http://10.194.8.202:5985/wsman
          D      Parsing CSV Response
          D      "chk_exists","src_md5","dst_md5","chk_dirty","verifies","target_is_folder"
          "False","0a865588a80b701c316a564bcff56c63",,"True","False","False"

          D      Uploading /tmp/cheftest/kitchen-long-script20160628-7187-7rpp3o/default-windows-2012r2-long_script.ps1 to encoded tmpfile $env:TEMP\b64-0a865588a80b701c316a564bcff56c63.txt
          D      Finished uploading /tmp/cheftest/kitchen-long-script20160628-7187-7rpp3o/default-windows-2012r2-long_script.ps1 to encoded tmpfile $env:TEMP\b64-0a865588a80b701c316a564bcff56c63.txt (20.44 KB over 3 chunks) in (0m0.30s)
          D      Running decode_files.ps1
          D      @{
          D        "$env:TEMP\b64-0a865588a80b701c316a564bcff56c63.txt" = @{
          D          "dst" = "$env:TEMP/default-windows-2012r2-long_script.ps1"
          D        }
          D      }
          D      Parsing CSV Response
          D      "src_md5","tmpzip","verifies","tmpfile","dst_md5","dst"
          "0a865588a80b701c316a564bcff56c63",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-0a865588a80b701c316a564bcff56c63.txt","0a865588a80b701c316a564bcff56c63","C:\Users\ADMINI~1\AppData\Local\Temp/default-windows-2012r2-long_script.ps1"

          D      Uploaded 1 items dirty_check: (0m0.83s) stream_files: (0m0.30s) decode: (0m0.96s)

                 ModuleType Version    Name                                ExportedCommands
                 ---------- -------    ----                                ----------------
                 Script     0.0        Omnitruck                           {Get-ProjectMetada...
                 Installing chefdk from C:\Users\ADMINI~1\AppData\Local\Temp\chefdk-0.16.12-1-x86.msi
          D      [WinRM] retrying receive request after timeout


          D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> ($dirs = @("$env:TEMP\kitchen\clients", "$env:TEMP\kitchen\cookbooks", "$env:TEMP\kitchen\data", "$env:TEMP\kitchen\data_bags", "$env:TEMP\kitchen\encrypted_data_bag_secret", "$env:TEMP\kitchen\environments", "$env:TEMP\kitchen\roles")
          $root_path = "$env:TEMP\kitchen"

          Function Delete-AllDirs($dirs) {
            $dirs | ForEach-Object {
              if (Test-Path ($path = Unresolve-Path $_)) { Remove-Item $path -Recurse -Force }
            }
          }

          Function Unresolve-Path($p) {
            if ($p -eq $null) { return $null }
            else { return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($p) }
          }

          Function Make-RootPath($p) {
            $p = Unresolve-Path $p
            if (-Not (Test-Path $p)) { New-Item $p -ItemType directory | Out-Null }
          }

          Delete-AllDirs $dirs
          Make-RootPath $root_path
          )
                 Transferring files to <default-windows-2012r2>
          D      creating hash for file $env:TEMP\kitchen
          D      creating hash for file $env:TEMP\kitchen
          D      creating hash for directory $env:TEMP\kitchen
          D      Populating files
          D      === All files added.
          D      creating hash for file $env:TEMP\kitchen
          D      creating hash for directory $env:TEMP\kitchen
          D      Populating files
          D      +++ Adding build-essential/README.md
          D      +++ Adding build-essential/attributes/default.rb
          D      +++ Adding build-essential/libraries/matchers.rb
          D      +++ Adding build-essential/libraries/xcode_command_line_tools.rb
          D      +++ Adding build-essential/metadata.json
          D      +++ Adding build-essential/recipes/_windows.rb
          D      +++ Adding build-essential/recipes/default.rb
          D      +++ Adding build-essential/resources/build_essential.rb
          D      +++ Adding chef_handler/README.md
          D      +++ Adding chef_handler/attributes/default.rb
          D      +++ Adding chef_handler/files/default/handlers/README
          D      +++ Adding chef_handler/libraries/helpers.rb
          D      +++ Adding chef_handler/libraries/matchers.rb
          D      +++ Adding chef_handler/metadata.json
          D      +++ Adding chef_handler/providers/default.rb
          D      +++ Adding chef_handler/recipes/default.rb
          D      +++ Adding chef_handler/recipes/json_file.rb
          D      +++ Adding chef_handler/resources/default.rb
          D      +++ Adding compat_resource/README.md
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/constants.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/delayed_evaluator.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/dsl/core.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/dsl/declare_resource.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/dsl/recipe.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/lazy_module_include.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/notifying_block.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/params_validate.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/powershell_out.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/mixin/properties.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/property.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/provider/noop.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/provider.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/resource/action_class.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/resource.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef/chef/resource_builder.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/copied_from_chef.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/mixin/properties.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/exceptions.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/log.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/mixin/params_validate.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/property.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/provider.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/recipe.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource/lwrp_base.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_builder.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_collection/resource_list.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_collection/resource_set.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/resource_collection.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/run_context.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef/runner.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches/chef.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/monkeypatches.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/property.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/recipe.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/resource/lwrp_base.rb
          D      +++ Adding compat_resource/files/lib/chef_compat/resource.rb
          D      +++ Adding compat_resource/files/lib/compat_resource/gemspec.rb
          D      +++ Adding compat_resource/files/lib/compat_resource/version.rb
          D      +++ Adding compat_resource/files/lib/compat_resource.rb
          D      +++ Adding compat_resource/files/spec/cookbook_spec.rb
          D      +++ Adding compat_resource/files/spec/data/Gemfile
          D      +++ Adding compat_resource/files/spec/data/Gemfile.lock
          D      +++ Adding compat_resource/files/spec/data/config.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/metadata.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/providers/resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/recipes/default.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/cloning/resources/resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/future/libraries/future_custom_resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/future/libraries/super_properties.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/future/metadata.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/future/recipes/declare_resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/future/resources/resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/future/resources/super_resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/libraries/normal_hwrp.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/metadata.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/providers/resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/hybrid/resources/resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/libraries/normal_hwrp.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/metadata.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/providers/resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/recipes/declare_resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/normal/resources/resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/notifications/metadata.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/notifications/recipes/default.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/notifications/resources/resource.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/test/metadata.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/test/recipes/default.rb
          D      +++ Adding compat_resource/files/spec/data/cookbooks/test/recipes/test.rb
          D      +++ Adding compat_resource/files/spec/data/nodes/ettores-mbp.lan.json
          D      +++ Adding compat_resource/files/spec/spec_helper.rb
          D      +++ Adding compat_resource/libraries/autoload.rb
          D      +++ Adding compat_resource/metadata.json
          D      +++ Adding dmg/README.md
          D      +++ Adding dmg/attributes/default.rb
          D      +++ Adding dmg/libraries/matchers.rb
          D      +++ Adding dmg/metadata.json
          D      +++ Adding dmg/providers/package.rb
          D      +++ Adding dmg/recipes/default.rb
          D      +++ Adding dmg/resources/package.rb
          D      +++ Adding git/README.md
          D      +++ Adding git/attributes/default.rb
          D      +++ Adding git/libraries/helpers.rb
          D      +++ Adding git/libraries/matchers.rb
          D      +++ Adding git/libraries/provider_git_client.rb
          D      +++ Adding git/libraries/provider_git_client_osx.rb
          D      +++ Adding git/libraries/provider_git_client_package.rb
          D      +++ Adding git/libraries/provider_git_client_source.rb
          D      +++ Adding git/libraries/provider_git_client_windows.rb
          D      +++ Adding git/libraries/provider_git_service.rb
          D      +++ Adding git/libraries/provider_git_service_xinetd.rb
          D      +++ Adding git/libraries/resource_git_client.rb
          D      +++ Adding git/libraries/resource_git_service.rb
          D      +++ Adding git/libraries/z_provider_mapping.rb
          D      +++ Adding git/metadata.json
          D      +++ Adding git/providers/config.rb
          D      +++ Adding git/recipes/default.rb
          D      +++ Adding git/recipes/package.rb
          D      +++ Adding git/recipes/server.rb
          D      +++ Adding git/recipes/source.rb
          D      +++ Adding git/recipes/windows.rb
          D      +++ Adding git/resources/config.rb
          D      +++ Adding git/templates/default/git-xinetd.d.erb
          D      +++ Adding git/templates/default/sv-git-daemon-log-run.erb
          D      +++ Adding git/templates/default/sv-git-daemon-run.erb
          D      +++ Adding mingw/README.md
          D      +++ Adding mingw/files/default/bash.bat
          D      +++ Adding mingw/files/default/custom-upgrade.sh
          D      +++ Adding mingw/files/default/pthread.h
          D      +++ Adding mingw/files/default/time.h
          D      +++ Adding mingw/libraries/_helper.rb
          D      +++ Adding mingw/metadata.json
          D      +++ Adding mingw/recipes/default.rb
          D      +++ Adding mingw/resources/get.rb
          D      +++ Adding mingw/resources/msys2_package.rb
          D      +++ Adding mingw/resources/tdm_gcc.rb
          D      +++ Adding seven_zip/README.md
          D      +++ Adding seven_zip/attributes/default.rb
          D      +++ Adding seven_zip/metadata.json
          D      +++ Adding seven_zip/providers/archive.rb
          D      +++ Adding seven_zip/recipes/default.rb
          D      +++ Adding seven_zip/resources/archive.rb
          D      +++ Adding winbox/README.md
          D      +++ Adding winbox/attributes/debugger_install_path.rb
          D      +++ Adding winbox/attributes/editor.rb
          D      +++ Adding winbox/files/default/ConEmu.xml
          D      +++ Adding winbox/files/default/chef-dk.ico
          D      +++ Adding winbox/files/default/get-help-full.ps1
          D      +++ Adding winbox/files/default/install.ps1
          D      +++ Adding winbox/files/default/set-location-docs.ps1
          D      +++ Adding winbox/files/default/start-chefdk.ps1
          D      +++ Adding winbox/files/default/vscode-keybindings.json
          D      +++ Adding winbox/files/default/vscode-settings.json
          D      +++ Adding winbox/files/default/winbox-ps-profile.ps1
          D      +++ Adding winbox/libraries/executable_finder.rb
          D      +++ Adding winbox/libraries/git_information.rb
          D      +++ Adding winbox/metadata.json
          D      +++ Adding winbox/recipes/chefdk.rb
          D      +++ Adding winbox/recipes/chefdk_shortcut.rb
          D      +++ Adding winbox/recipes/chocolatey_install.rb
          D      +++ Adding winbox/recipes/console.rb
          D      +++ Adding winbox/recipes/debugger.rb
          D      +++ Adding winbox/recipes/default.rb
          D      +++ Adding winbox/recipes/editor.rb
          D      +++ Adding winbox/recipes/powershell_dev.rb
          D      +++ Adding winbox/recipes/readline.rb
          D      +++ Adding winbox/recipes/vscode_emacs.rb
          D      +++ Adding windows/README.md
          D      +++ Adding windows/attributes/default.rb
          D      +++ Adding windows/files/default/handlers/windows_reboot_handler.rb
          D      +++ Adding windows/libraries/feature_base.rb
          D      +++ Adding windows/libraries/matchers.rb
          D      +++ Adding windows/libraries/powershell_helper.rb
          D      +++ Adding windows/libraries/powershell_out.rb
          D      +++ Adding windows/libraries/registry_helper.rb
          D      +++ Adding windows/libraries/version.rb
          D      +++ Adding windows/libraries/windows_architecture_helper.rb
          D      +++ Adding windows/libraries/windows_helper.rb
          D      +++ Adding windows/libraries/windows_package.rb
          D      +++ Adding windows/libraries/windows_privileged.rb
          D      +++ Adding windows/libraries/wmi_helper.rb
          D      +++ Adding windows/metadata.json
          D      +++ Adding windows/providers/auto_run.rb
          D      +++ Adding windows/providers/batch.rb
          D      +++ Adding windows/providers/certificate.rb
          D      +++ Adding windows/providers/certificate_binding.rb
          D      +++ Adding windows/providers/feature_dism.rb
          D      +++ Adding windows/providers/feature_powershell.rb
          D      +++ Adding windows/providers/feature_servermanagercmd.rb
          D      +++ Adding windows/providers/font.rb
          D      +++ Adding windows/providers/http_acl.rb
          D      +++ Adding windows/providers/pagefile.rb
          D      +++ Adding windows/providers/path.rb
          D      +++ Adding windows/providers/printer.rb
          D      +++ Adding windows/providers/printer_port.rb
          D      +++ Adding windows/providers/reboot.rb
          D      +++ Adding windows/providers/registry.rb
          D      +++ Adding windows/providers/shortcut.rb
          D      +++ Adding windows/providers/task.rb
          D      +++ Adding windows/providers/zipfile.rb
          D      +++ Adding windows/recipes/default.rb
          D      +++ Adding windows/recipes/reboot_handler.rb
          D      +++ Adding windows/resources/auto_run.rb
          D      +++ Adding windows/resources/batch.rb
          D      +++ Adding windows/resources/certificate.rb
          D      +++ Adding windows/resources/certificate_binding.rb
          D      +++ Adding windows/resources/feature.rb
          D      +++ Adding windows/resources/font.rb
          D      +++ Adding windows/resources/http_acl.rb
          D      +++ Adding windows/resources/pagefile.rb
          D      +++ Adding windows/resources/path.rb
          D      +++ Adding windows/resources/printer.rb
          D      +++ Adding windows/resources/printer_port.rb
          D      +++ Adding windows/resources/reboot.rb
          D      +++ Adding windows/resources/registry.rb
          D      +++ Adding windows/resources/shortcut.rb
          D      +++ Adding windows/resources/task.rb
          D      +++ Adding windows/resources/zipfile.rb
          D      +++ Adding yum/README.md
          D      +++ Adding yum/attributes/main.rb
          D      +++ Adding yum/libraries/matchers.rb
          D      +++ Adding yum/metadata.json
          D      +++ Adding yum/providers/globalconfig.rb
          D      +++ Adding yum/providers/repository.rb
          D      +++ Adding yum/recipes/default.rb
          D      +++ Adding yum/recipes/dnf_yum_compat.rb
          D      +++ Adding yum/resources/globalconfig.rb
          D      +++ Adding yum/resources/repository.rb
          D      +++ Adding yum/templates/default/main.erb
          D      +++ Adding yum/templates/default/repo.erb
          D      +++ Adding yum-epel/README.md
          D      +++ Adding yum-epel/attributes/default.rb
          D      +++ Adding yum-epel/attributes/epel-debuginfo.rb
          D      +++ Adding yum-epel/attributes/epel-source.rb
          D      +++ Adding yum-epel/attributes/epel-testing-debuginfo.rb
          D      +++ Adding yum-epel/attributes/epel-testing-source.rb
          D      +++ Adding yum-epel/attributes/epel-testing.rb
          D      +++ Adding yum-epel/attributes/epel.rb
          D      +++ Adding yum-epel/metadata.json
          D      +++ Adding yum-epel/recipes/default.rb
          D      === All files added.
          D      Running check_files.ps1
          D      @{
          D        "a86f70dc25c9c07f2959adeb0ed8a08c" = @{
          D          "target" = "$env:TEMP\kitchen";
          D          "src_basename" = "dna.json";
          D          "dst" = "$env:TEMP\kitchen"
          D        };
          D        "b8a32ad42457120c47ccf2013d837e5d" = @{
          D          "target" = "$env:TEMP\kitchen";
          D          "src_basename" = "client.rb";
          D          "dst" = "$env:TEMP\kitchen"
          D        };
          D        "76cdb2bad9582d23c1f6f4d868218d6c" = @{
          D          "target" = "$env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip";
          D          "src_basename" = "cache";
          D          "dst" = "$env:TEMP\kitchen\cache"
          D        };
          D        "49abb94825cb80b9a9cd59e5f76daf4a" = @{
          D          "target" = "$env:TEMP\kitchen";
          D          "src_basename" = "validation.pem";
          D          "dst" = "$env:TEMP\kitchen"
          D        };
          D        "d0bf03fad6068e40918d8e94b5bac0ab" = @{
          D          "target" = "$env:TEMP\winrm-upload\tmpzip-d0bf03fad6068e40918d8e94b5bac0ab.zip";
          D          "src_basename" = "cookbooks";
          D          "dst" = "$env:TEMP\kitchen\cookbooks"
          D        }
          D      }
          D      Parsing CSV Response
          D      "chk_exists","src_md5","dst_md5","chk_dirty","verifies","target_is_folder"
          "False","a86f70dc25c9c07f2959adeb0ed8a08c",,"True","False","True"
          "False","76cdb2bad9582d23c1f6f4d868218d6c",,"True","False","False"
          "False","49abb94825cb80b9a9cd59e5f76daf4a",,"True","False","True"
          "False","d0bf03fad6068e40918d8e94b5bac0ab",,"True","False","False"
          "False","b8a32ad42457120c47ccf2013d837e5d",,"True","False","True"

          D      Uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/dna.json to encoded tmpfile $env:TEMP\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt
          D      Finished uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/dna.json to encoded tmpfile $env:TEMP\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt (0.12 KB over 1 chunks) in (0m0.07s)
          D      Uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/client.rb to encoded tmpfile $env:TEMP\b64-b8a32ad42457120c47ccf2013d837e5d.txt
          D      Finished uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/client.rb to encoded tmpfile $env:TEMP\b64-b8a32ad42457120c47ccf2013d837e5d.txt (1.104 KB over 1 chunks) in (0m0.10s)
          D      Uploading /tmp/cheftest/tmpzip-20160628-7187-ukt16c.zip to encoded tmpfile $env:TEMP\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt
          D      Finished uploading /tmp/cheftest/tmpzip-20160628-7187-ukt16c.zip to encoded tmpfile $env:TEMP\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt (0.028 KB over 1 chunks) in (0m0.07s)
          D      Uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/validation.pem to encoded tmpfile $env:TEMP\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt
          D      Finished uploading /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa/validation.pem to encoded tmpfile $env:TEMP\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt (2.236 KB over 1 chunks) in (0m0.11s)
          D      Uploading /tmp/cheftest/tmpzip-20160628-7187-1risqp3.zip to encoded tmpfile $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt
          D      Wrote chunk 25 for $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt
          D      Wrote chunk 50 for $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt
          D      Finished uploading /tmp/cheftest/tmpzip-20160628-7187-1risqp3.zip to encoded tmpfile $env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt (430.176 KB over 54 chunks) in (0m4.53s)
          D      Running decode_files.ps1
          D      @{
          D        "$env:TEMP\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt" = @{
          D          "dst" = "$env:TEMP\kitchen/dna.json"
          D        };
          D        "$env:TEMP\b64-b8a32ad42457120c47ccf2013d837e5d.txt" = @{
          D          "dst" = "$env:TEMP\kitchen/client.rb"
          D        };
          D        "$env:TEMP\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt" = @{
          D          "dst" = "$env:TEMP\kitchen\cache";
          D          "tmpzip" = "$env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip"
          D        };
          D        "$env:TEMP\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt" = @{
          D          "dst" = "$env:TEMP\kitchen/validation.pem"
          D        };
          D        "$env:TEMP\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt" = @{
          D          "dst" = "$env:TEMP\kitchen\cookbooks";
          D          "tmpzip" = "$env:TEMP\winrm-upload\tmpzip-d0bf03fad6068e40918d8e94b5bac0ab.zip"
          D        }
          D      }
          D      Parsing CSV Response
          D      "src_md5","tmpzip","verifies","tmpfile","dst_md5","dst"
          "76cdb2bad9582d23c1f6f4d868218d6c","C:\Users\ADMINI~1\AppData\Local\Temp\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip","True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-76cdb2bad9582d23c1f6f4d868218d6c.txt","76cdb2bad9582d23c1f6f4d868218d6c","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache"
          "a86f70dc25c9c07f2959adeb0ed8a08c",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-a86f70dc25c9c07f2959adeb0ed8a08c.txt","a86f70dc25c9c07f2959adeb0ed8a08c","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen/dna.json"
          "d0bf03fad6068e40918d8e94b5bac0ab","C:\Users\ADMINI~1\AppData\Local\Temp\winrm-upload\tmpzip-d0bf03fad6068e40918d8e94b5bac0ab.zip","True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-d0bf03fad6068e40918d8e94b5bac0ab.txt","d0bf03fad6068e40918d8e94b5bac0ab","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cookbooks"
          "49abb94825cb80b9a9cd59e5f76daf4a",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-49abb94825cb80b9a9cd59e5f76daf4a.txt","49abb94825cb80b9a9cd59e5f76daf4a","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen/validation.pem"
          "b8a32ad42457120c47ccf2013d837e5d",,"True","C:\Users\ADMINI~1\AppData\Local\Temp\b64-b8a32ad42457120c47ccf2013d837e5d.txt","b8a32ad42457120c47ccf2013d837e5d","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen/client.rb"

          D      Cleaned up src_zip /tmp/cheftest/tmpzip-20160628-7187-ukt16c.zip
          D      Cleaned up src_zip /tmp/cheftest/tmpzip-20160628-7187-1risqp3.zip
          D      Uploaded 5 items dirty_check: (0m1.42s) stream_files: (0m4.90s) decode: (0m2.74s)
          D      Transfer complete
          D      [WinRM] negotiate::http://10.194.8.202:5985/wsman<{:user=>"administrator", :pass=>"Pdg)TZj2!nz", :elevated_username=>"administrator", :elevated_password=>"Pdg)TZj2!nz", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> ($env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine")

          & $env:systemdrive\opscode\chefdk\bin\chef-client.bat --local-mode --config $env:TEMP\kitchen\client.rb --log_level auto --force-formatter --no-color --json-attributes $env:TEMP\kitchen\dna.json --chef-zero-port 8889)
                 Starting Chef Client, version 12.11.18
                 Creating a new client identity for default-windows-2012r2 using the validator key.
                 resolving cookbooks for run list: ["winbox::default"]
                 Synchronizing Cookbooks:
                   - winbox (0.9.105)
                   - git (4.5.0)
                   - windows (1.44.0)
                   - build-essential (6.0.0)
                   - dmg (2.4.0)
                   - yum-epel (0.7.0)
                   - chef_handler (1.4.0)
                   - seven_zip (2.0.1)
                   - mingw (1.2.2)
                   - compat_resource (12.10.6)
                   - yum (3.11.0)
                 Installing Cookbook Gems:
                 Compiling Cookbooks...
                 Converging 25 resources
                 Recipe: git::windows
                   * git_client[default] action install[2016-06-28T03:48:59+00:00] WARN: Please use the package resource available in Chef Client 12.6.
                 windows_package will be removed in the next major version release
                 of the Windows cookbook.


                     * windows_package[Git version 2.8.1] action install
                     Recipe: <Dynamically Defined Resource>
                       * remote_file[C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\package\Git-2.8.1-64-bit.exe] action create
                  - create new file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\package\Git-2.8.1-64-bit.exe
                  - update content in file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\package\Git-2.8.1-64-bit.exe from none to 5e5283
                  (file sizes exceed 10000000 bytes, diff output suppressed)
                       - install version latest of package Git version 2.8.1
                     * ruby_block[Add Git Path] action nothing (skipped due to action :nothing)
                     * windows_path[C:\Program Files\Git\Cmd] action add
                       * env[path] action modify

                       * ruby_block[fix ruby ENV['PATH']] action run
                  - execute the ruby block fix ruby ENV['PATH']
                       * ruby_block[fix ruby ENV['PATH']] action nothing (skipped due to action :nothing)

                     * ruby_block[Add Git Path] action create
                       - execute the ruby block Add Git Path

                 Recipe: winbox::chocolatey_install
                   * windows_path[update_path_for_system] action add
                     * env[path] action modify

                     * ruby_block[fix ruby ENV['PATH']] action run
                       - execute the ruby block fix ruby ENV['PATH']
                     * ruby_block[fix ruby ENV['PATH']] action nothing (skipped due to action :nothing)

                   * ruby_block[add_chocolatey_path] action run (skipped due to not_if)
                   * powershell_script[chocolatey_install] action run
                     - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-8eqjua.ps1"
                 Recipe: winbox::powershell_dev
                   * powershell_script[ExecutionPolicyUnrestricted] action run (skipped due to only_if)
                   * powershell_script[ExecutionPolicyUnrestrictedX86] action run
                     - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-l26d7f.ps1"
                   * cookbook_file[C:\Users\Administrator/winbox-ps-profile.ps1] action create_if_missing
                     - create new file C:\Users\Administrator/winbox-ps-profile.ps1
                     - update content in file C:\Users\Administrator/winbox-ps-profile.ps1 from none to 19a092
                     --- C:\Users\Administrator/winbox-ps-profile.ps1  2016-06-28 03:49:31.000000000 +0000
                     +++ C:\Users\Administrator/chef-winbox-ps-profile.ps120160628-3976-rbpfl4  2016-06-28 03:49:31.000000000 +0000
                     @@ -1 +1,89 @@
                     +# WinBox PowerShell profile
                     +#
                     +# Copyright 2015, Adam Edwards
                     +#
                     +# Licensed under the Apache License, Version 2.0 (the "License");
                     +# you may not use this file except in compliance with the License.
                     +# You may obtain a copy of the License at
                     +#
                     +#     http://www.apache.org/licenses/LICENSE-2.0
                     +#
                     +# Unless required by applicable law or agreed to in writing, software
                     +# distributed under the License is distributed on an "AS IS" BASIS,
                     +# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                     +# See the License for the specific language governing permissions and
                     +# limitations under the License.
                     +
                     +# Enable readline support
                     +import-module psreadline
                     +Set-PSReadlineOption -EditMode Emacs
                     +
                     +# Enable posh-git support
                     +if ((get-module -listavailable 'posh-git') -ne $null)
                     +{
                     +    import-module posh-git
                     +}
                     +
                     +# Get the username and whether we're elevated for display
                     +# in the title and prompt
                     +$identity = [Security.Principal.WindowsIdentity]::GetCurrent()
                     +$principal = [Security.Principal.WindowsPrincipal] $identity
                     +$titleprefix = ""
                     +if (test-path variable:/PSDebugContext)
                     +{
                     +    $titleprefix = 'Debug: '
                     +}
                     +else
                     +{
                     +    if ($principal.IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator"))
                     +    {
                     +        $titleprefix = "Administrator: "
                     +    }
                     +}
                     +
                     +#
                     +# The title will look like one of the following:
                     +#
                     +#   myusername@myhost
                     +#   Administrator: myusername@myhost
                     +#
                     +(get-host).ui.rawui.windowtitle = "$titleprefix$($env:username)@$($env:computername)"
                     +
                     +#
                     +# Set a useful two-line prompt that uses color for readability and status.
                     +# The format is 'host: lastexitcode: currentdirectory `newline `username >'.
                     +#
                     +# Here's example output:
                     +#
                     +#   myhost (0x00000001) c:\windows\system32\drivers\etc
                     +#   myuser >
                     +#
                     +function prompt
                     +{
                     +    $lasterror = $?
                     +    $lastexit = $lastexitcode
                     +    if ($lastexit -eq $null) { $lastexit = 0 }
                     +    $errorcolor = 'green'
                     +    $exitcolor = 'green'
                     +    if (! $lasterror) { $errorcolor = 'red' }
                     +    if ($lastexit -ne 0) { $exitcolor = 'red' }
                     +
                     +    write-host -nonewline -foregroundcolor $errorcolor '% '
                     +    write-host -nonewline -foregroundcolor darkyellow "$env:computername "
                     +    write-host -nonewline -foregroundcolor gray "("
                     +    write-host -nonewline -foregroundcolor $exitcolor "0x$(($lastexit).ToString("X8"))"
                     +    write-host -nonewline -foregroundcolor gray ")"
                     +    if ( get-command write-vcsstatus) { Write-VcsStatus }
                     +    write-host -foregroundcolor cyan " $($executionContext.SessionState.Path.CurrentLocation)"
                     +    write-host -nonewline -foregroundcolor darkyellow "$env:username"
                     +    "$('>' * ($nestedPromptLevel + 1)) "
                     +}
                     +
                     +# Make the man alias show full help by default
                     +. ~\get-help-full.ps1
                     +set-alias -option allscope man get-help-full
                     +
                     +# Useful shortcut to get to Documents folder
                     +. ~\set-location-docs.ps1
                     +new-alias docs set-location-docs
                   * cookbook_file[C:\Users\Administrator/get-help-full.ps1] action create
                     - create new file C:\Users\Administrator/get-help-full.ps1
                     - update content in file C:\Users\Administrator/get-help-full.ps1 from none to 7edc66
                     --- C:\Users\Administrator/get-help-full.ps1  2016-06-28 03:49:31.000000000 +0000
                     +++ C:\Users\Administrator/chef-get-help-full.ps120160628-3976-ioa2km  2016-06-28 03:49:31.000000000 +0000
                     @@ -1 +1,30 @@
                     +#
                     +# Copyright 2015, Adam Edwards
                     +#
                     +# Licensed under the Apache License, Version 2.0 (the "License");
                     +# you may not use this file except in compliance with the License.
                     +# You may obtain a copy of the License at
                     +#
                     +#     http://www.apache.org/licenses/LICENSE-2.0
                     +#
                     +# Unless required by applicable law or agreed to in writing, software
                     +# distributed under the License is distributed on an "AS IS" BASIS,
                     +# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                     +# See the License for the specific language governing permissions and
                     +# limitations under the License.
                     +
                     +# Shows help page with full help, rather than the
                     +# abbreviated help which is the default for get-help
                     +function get-help-full
                     +{
                     +    try
                     +    {
                     +        get-help @args -full | out-host -paging
                     +    }
                     +    catch [System.Management.Automation.HaltCommandException]
                     +    {
                     +        # Do nothing if the user chooses 'q'
                     +    }
                     +}
                     +
                   * cookbook_file[C:\Users\Administrator/set-location-docs.ps1] action create
                     - create new file C:\Users\Administrator/set-location-docs.ps1
                     - update content in file C:\Users\Administrator/set-location-docs.ps1 from none to 3e28a0
                     --- C:\Users\Administrator/set-location-docs.ps1  2016-06-28 03:49:31.000000000 +0000
                     +++ C:\Users\Administrator/chef-set-location-docs.ps120160628-3976-10q0aeg  2016-06-28 03:49:31.000000000 +0000
                     @@ -1 +1,31 @@
                     +# Documents directory shortcut
                     +#
                     +# Copyright 2015, Adam Edwards
                     +#
                     +# Licensed under the Apache License, Version 2.0 (the "License");
                     +# you may not use this file except in compliance with the License.
                     +# You may obtain a copy of the License at
                     +#
                     +#     http://www.apache.org/licenses/LICENSE-2.0
                     +#
                     +# Unless required by applicable law or agreed to in writing, software
                     +# distributed under the License is distributed on an "AS IS" BASIS,
                     +# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                     +# See the License for the specific language governing permissions and
                     +# limitations under the License.
                     +
                     +# Set the current directory to the location of the
                     +# Documents directory, and also set up an environment
                     +# variables called DOCS.
                     +function set-location-docs
                     +{
                     +
                     +    if ($env:DOCS -eq $null)
                     +    {
                     +        $myDocsPath = [environment]::GetFolderPath("MyDocuments")
                     +        $env:DOCS = $myDocsPath
                     +    }
                     +
                     +    pushd $env:DOCS
                     +}
                   * directory[C:/Users/Administrator/Documents/WindowsPowerShell] action create (up to date)
                   * powershell_script[C:\Users\Administrator\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1] action run (skipped due to not_if)
                 Recipe: winbox::readline
                   * remote_file[C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\psreadline.zip] action create
                     - create new file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\psreadline.zip
                     - update content in file C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache\psreadline.zip from none to 68577a
                     (new content is binary, diff output suppressed)
                   * powershell_script[install_module] action run
                     - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-5awo7s.ps1"
                 Recipe: winbox::editor
                   * directory[C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode] action create
                     - create new directory C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode
                   * remote_file[C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode/vscodesetup.exe] action create
                     - create new file C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode/vscodesetup.exe
                     - update content in file C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/winbox/vscode/vscodesetup.exe from none to 3ae51c
                     (file sizes exceed 10000000 bytes, diff output suppressed)
                   * powershell_script[install vscode] action run
                     - execute "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-11cuxbk.ps1"
                   * env[EDITOR] action create

                 Recipe: winbox::console
                   * cookbook_file[C:\Program Files/conemu/ConEmu.xml] action nothing (skipped due to action :nothing)
          D      [WinRM] retrying receive request after timeout
          D      [WinRM] retrying receive request after timeout
          D      [WinRM] retrying receive request after timeout
          D      [WinRM] retrying receive request after timeout
                   * powershell_script[conemu] action run

                     ================================================================================
                     Error executing action `run` on resource 'powershell_script[conemu]'
                     ================================================================================

                     Mixlib::ShellOut::ShellCommandFailed
                     ------------------------------------
                     Expected process to exit with [0], but received '1'
                     ---- Begin output of "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" ----
                     STDOUT: Installing the following packages:
                     conemu
                     By installing you accept licenses for the packages.
                     conemu not installed. The package was not found with the source(s) listed.
                      If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                      Version: ""
                      Source(s): "https://chocolatey.org/api/v2/"

                     Chocolatey installed 0/1 packages. 1 packages failed.
                      See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                     Failures
                      - conemu - conemu not installed. The package was not found with the source(s) listed.
                      If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                      Version: ""
                      Source(s): "https://chocolatey.org/api/v2/"
                     Installing the following packages:
                     conemu
                     By installing you accept licenses for the packages.
                     conemu not installed. The package was not found with the source(s) listed.
                      If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                      Version: ""
                      Source(s): "https://chocolatey.org/api/v2/"

                     Chocolatey installed 0/1 packages. 1 packages failed.
                      See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).

                     Failures
                      - conemu - conemu not installed. The package was not found with the source(s) listed.
                      If you specified a particular version and are receiving this message, it is possible that the package name exists but the version does not.
                      Version: ""
                      Source(s): "https://chocolatey.org/api/v2/"
                     STDERR:
                     ---- End output of "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" ----
                     Ran "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat None -File "C:/Users/ADMINI~1/AppData/Local/Temp/chef-script20160628-3976-15ojn86.ps1" returned 1

                     Resource Declaration:
                     ---------------------
                     # In C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/cookbooks/winbox/recipes/console.rb

                      27: powershell_script 'conemu' do
                      28:   code <<-EOH
                      29: chocolatey install conemu -y
                      30: if ($LASTEXITCODE -ne 0)
                      31: {
                      32:   $LASTEXITCODE = 0
                      33:   chocolatey install conemu -y
                      34: }
                      35: EOH
                      36:   only_if '(get-wmiobject Win32_MSIResource | Where-Object -Property value -like -Value conemu) -eq $null'
                      37: end
                      38:

                     Compiled Resource:
                     ------------------
                     # Declared in C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/cookbooks/winbox/recipes/console.rb:27:in `from_file'

                     powershell_script("conemu") do
                       action [:run]
                       retries 0
                       retry_delay 2
                       default_guard_interpreter :powershell_script
                       command "conemu"
                       backup 5
                       returns 0
                       code "chocolatey install conemu -y\nif ($LASTEXITCODE -ne 0)\n{\n  $LASTEXITCODE = 0\n  chocolatey install conemu -y\n}\n"
                       interpreter "powershell.exe"
                       declared_type :powershell_script
                       cookbook_name "winbox"
                       recipe_name "console"
                       only_if "(get-wmiobject Win32_MSIResource | Where-Object -Property value -like -Value conemu) -eq $null"
                     end

                     Platform:
                     ---------
                     i386-mingw32

                 Starting audit phase

                 Finished in 0 seconds (files took 0.68318 seconds to load)
                 0 examples, 0 failures
                 Auditing complete

                 Running handlers:
                 [2016-06-28T03:54:00+00:00] ERROR: Running exception handlers
                 Running handlers complete
                 [2016-06-28T03:54:00+00:00] ERROR: Exception handlers complete
                 Chef Client failed. 21 resources updated in 05 minutes 52 seconds
                 [2016-06-28T03:54:00+00:00] ERROR: Failed to post audit report to server. Saving report to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/failed-audit-data.json
                 [2016-06-28T03:54:00+00:00] FATAL: Stacktrace dumped to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/chef-stacktrace.out
                 [2016-06-28T03:54:00+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
                 [2016-06-28T03:54:00+00:00] FATAL: Chef::Exceptions::RunFailedWrappingError: Found 1 errors, they are stored in the backtrace
          $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/2.1.0/i386-mingw32/dl.so: warning: already initialized constant DL::RUBY_FREE
          $$$$$$ C:/opscode/chefdk/embedded/lib/ruby/gems/2.1.0/gems/net-ssh-3.2.0/lib/net/ssh/authentication/pageant.rb:16: warning: previous definition of RUBY_FREE was here
          $$$$$$ DL is deprecated, please use Fiddle
          D      Cleaning up local sandbox in /tmp/cheftest/default-windows-2012r2-sandbox-20160628-7187-j3kxa
          D      Converge failed on instance <default-windows-2012r2>.
          D      ------Exception-------
          D      Class: Kitchen::InstanceFailure
          D      Message: Converge failed on instance <default-windows-2012r2>.  Please see .kitchen/logs/default-windows-2012r2.log for more details
          D      ----------------------
          D      ------Backtrace-------
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:76:in `rescue in call'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:79:in `call'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:373:in `block in converge_action'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `call'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `synchronize_or_call'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:478:in `block in action'
          D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:477:in `action'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:369:in `converge_action'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:348:in `block in transition_to'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `each'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `transition_to'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:138:in `converge'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `public_send'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `run_action_in_thread'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
          D      ----End Backtrace-----
          D      ---Nested Exception---
          D      Class: Kitchen::ActionFailed
          D      Message: WinRM exited (1) for command: [$env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine")

          & $env:systemdrive\opscode\chefdk\bin\chef-client.bat --local-mode --config $env:TEMP\kitchen\client.rb --log_level auto --force-formatter --no-color --json-attributes $env:TEMP\kitchen\dna.json --chef-zero-port 8889]
          D      ----------------------
          D      ------Backtrace-------
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:76:in `rescue in call'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/provisioner/base.rb:79:in `call'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:373:in `block in converge_action'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `call'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:513:in `synchronize_or_call'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:478:in `block in action'
          D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:477:in `action'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:369:in `converge_action'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:348:in `block in transition_to'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `each'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:347:in `transition_to'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/instance.rb:138:in `converge'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `public_send'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:194:in `run_action_in_thread'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/test-kitchen-1.9.0/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
          D      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
          D      ----End Backtrace-----
          D      [WinRM] closing remote shell 5543ED20-7DD5-4564-8B3C-F44F26F67293 on http://10.194.8.202:5985/wsman
          D      [WinRM] closing remote shell 527C3D98-8885-4FD3-8A22-5EAE4548481A on http://10.194.8.202:5985/wsman
          D      [WinRM] remote shell 527C3D98-8885-4FD3-8A22-5EAE4548481A closed
          STDERR: >>>>>> Converge failed on instance <default-windows-2012r2>.
          >>>>>> Please see .kitchen/logs/default-windows-2012r2.log for more details
          >>>>>> ------Exception-------
          >>>>>> Class: Kitchen::ActionFailed
          >>>>>> Message: WinRM exited (1) for command: [$env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine")

          & $env:systemdrive\opscode\chefdk\bin\chef-client.bat --local-mode --config $env:TEMP\kitchen\client.rb --log_level auto --force-formatter --no-color --json-attributes $env:TEMP\kitchen\dna.json --chef-zero-port 8889]
          >>>>>> ----------------------
          ---- End output of bundle exec kitchen converge  -c -l debug ----
          Ran bundle exec kitchen converge  -c -l debug returned 10

          Resource Declaration:
          ---------------------
          # In /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb

            1: top_cookbooks "converge"

          Compiled Resource:
          ------------------
          # Declared in /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb:1:in `from_file'

          top_cookbooks("converge") do
            action [:run]
            updated true
            updated_by_last_action true
            retries 0
            retry_delay 2
            default_guard_interpreter :default
            declared_type :top_cookbooks
            cookbook_name "acceptance-cookbook"
            recipe_name "provision"
            command "converge"
          end

          Platform:
          ---------
          x86_64-linux

      Starting audit phase
    30258: |2

      Running handlers:
      [2016-06-28T03:54:02+00:00] ERROR: Running exception handlers
      Running handlers complete
      [2016-06-28T03:54:02+00:00] ERROR: Exception handlers complete
      Chef Client failed. 23 resources updated in 57 minutes 42 seconds
      [2016-06-28T03:54:02+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/failed-audit-data.json
      [2016-06-28T03:54:02+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/cache/chef-stacktrace.out
      [2016-06-28T03:54:02+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
      [2016-06-28T03:54:02+00:00] ERROR: Found 1 errors, they are stored in the backtrace
      [2016-06-28T03:54:02+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
      STDERR:
      ---- End output of chef-client -z -c /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/dna.json -o acceptance-cookbook::provision --no-color ----
      Ran chef-client -z -c /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/chef/top-cookbooks/provision/dna.json -o acceptance-cookbook::provision --no-color returned 1
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:289:in `invalid!'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:276:in `error!'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:53:in `block in run!'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `block in with_clean_env'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:447:in `with_env'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `with_clean_env'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:42:in `run!'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:149:in `run_command'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:116:in `block in run_suite'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `each'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `run_suite'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:76:in `block (2 levels) in start_worker'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `loop'
      /home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/acceptance-chef/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `block in start_worker'
      CHEF-ACCEPTANCE::[2016-06-28 03:54:02 +0000] --force-destroy specified so attempting to run the destroy recipe
      TOP-COOKBOOKS::DESTROY::[2016-06-28 03:54:02 +0000] Initialized [/home/jenkins/workspace/chefdk-test/architecture/x86_64/platform/acceptance/project/chefdk/role/tester/chef-acceptance-data/chef/logs/top-cookbooks/destroy.log] logger...
    30524: |
      CHEF-ACCEPTANCE::[2016-06-28 03:54:45 +0000] | top-cookbooks | Total         | 00:58:29 | Y     |
      CHEF-ACCEPTANCE::[2016-06-28 03:54:45 +0000] | Run           | Total         | 00:58:29 | Y     |
      Build step 'Invoke XShell command' marked build as failure
      Archiving artifacts
      Recording fingerprints
steps:
  total: 1h23s
  before (setup time): 1m53s
  CHEF-ACCEPTANCE:
    total: 58m29s
    TOP-COOKBOOKS::PROVISION: 57m46s
    TOP-COOKBOOKS::DESTROY: 43s
chef_acceptance_timing:
- top-cookbooks:
    provision: 54m10s
    force-destroy: 29s
    Total: 58m29s
  Run:
    Total: 58m29s

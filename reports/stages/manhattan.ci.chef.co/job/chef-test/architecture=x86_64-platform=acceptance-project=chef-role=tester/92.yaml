---
result: FAILURE
failure_category: code
failure_cause: chef_acceptance[top-cookbooks::provision,top-cookbooks::force-destroy,fips::provision]
failed_in:
  chef_acceptance:
  - top-cookbooks::provision
  - top-cookbooks::force-destroy
  - fips::provision
  step: CHEF-ACCEPTANCE
timestamp: 2016-07-23 19:59:04 UTC
url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=acceptance,project=chef,role=tester/92/
trigger_url: http://manhattan.ci.chef.co/job/chef-trigger-ad_hoc/92/
duration: 7m18s
logs:
  consoleText:
    837: |2
            Cookbook Trace:
            ---------------
            /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `ensure in block in <class:Kitchen>'
            /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `block in <class:Kitchen>'
            /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/cookbook_kitchen.rb:41:in `block in <class:CookbookKitchen>'

            Resource Declaration:
    897: |2
          Cookbook Trace:
          ---------------
          /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `ensure in block in <class:Kitchen>'
          /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `block in <class:Kitchen>'
          /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/cookbook_kitchen.rb:41:in `block in <class:CookbookKitchen>'

          Resource Declaration:
    977: |
      TOP-COOKBOOKS::PROVISION::[2016-07-23 20:00:54 +0000] Running handlers:
      TOP-COOKBOOKS::PROVISION::[2016-07-23 20:00:54 +0000]
      TOP-COOKBOOKS::PROVISION::[2016-07-23 20:00:54 +0000] [2016-07-23T20:00:54+00:00] ERROR: Running exception handlers
      TOP-COOKBOOKS::PROVISION::[2016-07-23 20:00:54 +0000] Running handlers complete
      TOP-COOKBOOKS::PROVISION::[2016-07-23 20:00:54 +0000] [2016-07-23T20:00:54+00:00] ERROR: Exception handlers complete
      Chef Client failed. 0 resources updated in 08 seconds
      TOP-COOKBOOKS::PROVISION::[2016-07-23 20:00:54 +0000] [2016-07-23T20:00:54+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/failed-audit-data.json
      TOP-COOKBOOKS::PROVISION::[2016-07-23 20:00:54 +0000] [2016-07-23T20:00:54+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/chef-stacktrace.out
      TOP-COOKBOOKS::PROVISION::[2016-07-23 20:00:54 +0000] [2016-07-23T20:00:54+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
      TOP-COOKBOOKS::PROVISION::[2016-07-23 20:00:54 +0000] [2016-07-23T20:00:54+00:00] ERROR: Found 1 errors, they are stored in the backtrace
      OMNITRUCK::PROVISION::[2016-07-23 20:00:55 +0000]
      OMNITRUCK::PROVISION::[2016-07-23 20:00:55 +0000] Finished in 0.0003 seconds (files took 1.81 seconds to load)
    997: |
      OMNITRUCK::PROVISION::[2016-07-23 20:00:55 +0000]
      OMNITRUCK::PROVISION::[2016-07-23 20:00:55 +0000] [2016-07-23T20:00:55+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/omnitruck/provision/cache/failed-audit-data.json
      TOP-COOKBOOKS::PROVISION::[2016-07-23 20:00:55 +0000] [2016-07-23T20:00:55+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
      CHEF-ACCEPTANCE::[2016-07-23 20:00:56 +0000] Encountered an error running the recipe provision: Expected process to exit with [0], but received '1'
      ---- Begin output of chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/dna.json -o acceptance-cookbook::provision --no-color ----
    1015: |2
          * cookbook_kitchen[converge docker] action run

            ================================================================================
            Error executing action `run` on resource 'cookbook_kitchen[converge docker]'
            ================================================================================

            RuntimeError
            ------------
            unknown file type: /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/top-cookbooks/test_run/docker/.kitchen/logs/.

            Cookbook Trace:
            ---------------
            /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `ensure in block in <class:Kitchen>'
            /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `block in <class:Kitchen>'
            /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/cookbook_kitchen.rb:41:in `block in <class:CookbookKitchen>'

            Resource Declaration:
            ---------------------
            # In /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/top_cookbooks.rb

              9:     cookbook_kitchen "#{command} docker" do
             10:     end
             11:

            Compiled Resource:
            ------------------
            # Declared in /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/top_cookbooks.rb:9:in `block in <class:TopCookbooks>'

            cookbook_kitchen("converge docker") do
              action [:run]
              retries 0
              retry_delay 2
              default_guard_interpreter :default
              declared_type :cookbook_kitchen
              cookbook_name "acceptance-cookbook"
              repository "https://github.com/chef-cookbooks/docker.git"
              test_cookbook "docker"
              repository_root "/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/top-cookbooks/test_run/docker"
              branch "master"
              chef_product "chef"
              env {"BUNDLE_GEMFILE"=>"/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/Gemfile", "KITCHEN_YAML"=>"/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/top-cookbooks/.kitchen.docker.yml"}
              kitchen_dir "/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/top-cookbooks/test_run/docker/"
              command "converge"
              kitchen_options "-c -l debug"
            end

            Platform:
            ---------
            x86_64-linux


          ================================================================================
          Error executing action `run` on resource 'top_cookbooks[converge]'
          ================================================================================

          RuntimeError
          ------------
          cookbook_kitchen[converge docker] (/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/top_cookbooks.rb line 9) had an error: RuntimeError: unknown file type: /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/top-cookbooks/test_run/docker/.kitchen/logs/.

          Cookbook Trace:
          ---------------
          /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `ensure in block in <class:Kitchen>'
          /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `block in <class:Kitchen>'
          /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/libraries/cookbook_kitchen.rb:41:in `block in <class:CookbookKitchen>'

          Resource Declaration:
          ---------------------
          # In /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb

            1: top_cookbooks "converge"

          Compiled Resource:
          ------------------
          # Declared in /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb:1:in `from_file'

          top_cookbooks("converge") do
            action [:run]
            retries 0
            retry_delay 2
            default_guard_interpreter :default
            declared_type :top_cookbooks
            cookbook_name "acceptance-cookbook"
            recipe_name "provision"
            command "converge"
          end

          Platform:
          ---------
          x86_64-linux

      Starting audit phase
    1110: |2

      Running handlers:
      [2016-07-23T20:00:54+00:00] ERROR: Running exception handlers
      Running handlers complete
      [2016-07-23T20:00:54+00:00] ERROR: Exception handlers complete
      Chef Client failed. 0 resources updated in 08 seconds
      [2016-07-23T20:00:54+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/failed-audit-data.json
      [2016-07-23T20:00:54+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/cache/chef-stacktrace.out
      [2016-07-23T20:00:54+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
      [2016-07-23T20:00:54+00:00] ERROR: Found 1 errors, they are stored in the backtrace
      [2016-07-23T20:00:55+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
      STDERR:
      ---- End output of chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/dna.json -o acceptance-cookbook::provision --no-color ----
      Ran chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/provision/dna.json -o acceptance-cookbook::provision --no-color returned 1
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:289:in `invalid!'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:276:in `error!'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:53:in `block in run!'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `block in with_clean_env'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:447:in `with_env'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `with_clean_env'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:42:in `run!'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:149:in `run_command'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:116:in `block in run_suite'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `each'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `run_suite'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:76:in `block (2 levels) in start_worker'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `loop'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `block in start_worker'
      CHEF-ACCEPTANCE::[2016-07-23 20:00:56 +0000] --force-destroy specified so attempting to run the destroy recipe
      TOP-COOKBOOKS::DESTROY::[2016-07-23 20:00:56 +0000] Initialized [/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/logs/top-cookbooks/destroy.log] logger...
    1193: |2
            Cookbook Trace:
            ---------------
            /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/destroy/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `ensure in block in <class:Kitchen>'
            /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/destroy/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `block in <class:Kitchen>'
            /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/destroy/cache/cookbooks/acceptance-cookbook/libraries/cookbook_kitchen.rb:41:in `block in <class:CookbookKitchen>'

            Resource Declaration:
    1256: |2
          Cookbook Trace:
          ---------------
          /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/destroy/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `ensure in block in <class:Kitchen>'
          /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/destroy/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:58:in `block in <class:Kitchen>'
          /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/destroy/cache/cookbooks/acceptance-cookbook/libraries/cookbook_kitchen.rb:41:in `block in <class:CookbookKitchen>'

          Resource Declaration:
    1294: |
      TOP-COOKBOOKS::DESTROY::[2016-07-23 20:01:09 +0000] Running handlers:
      TOP-COOKBOOKS::DESTROY::[2016-07-23 20:01:09 +0000]
      TOP-COOKBOOKS::DESTROY::[2016-07-23 20:01:09 +0000] [2016-07-23T20:01:09+00:00] ERROR: Running exception handlers
      TOP-COOKBOOKS::DESTROY::[2016-07-23 20:01:09 +0000] Running handlers complete
      TOP-COOKBOOKS::DESTROY::[2016-07-23 20:01:09 +0000] [2016-07-23T20:01:09+00:00] ERROR: Exception handlers complete
      TOP-COOKBOOKS::DESTROY::[2016-07-23 20:01:09 +0000] Chef Client failed. 0 resources updated in 06 seconds
      TOP-COOKBOOKS::DESTROY::[2016-07-23 20:01:09 +0000]
      TOP-COOKBOOKS::DESTROY::[2016-07-23 20:01:09 +0000] [2016-07-23T20:01:09+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/destroy/cache/failed-audit-data.json
      TOP-COOKBOOKS::DESTROY::[2016-07-23 20:01:09 +0000] [2016-07-23T20:01:09+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/top-cookbooks/destroy/cache/chef-stacktrace.out
      [2016-07-23T20:01:09+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
      [2016-07-23T20:01:09+00:00] ERROR: Found 1 errors, they are stored in the backtrace
      OMNITRUCK::VERIFY::[2016-07-23 20:01:09 +0000] [2016-07-23T20:01:09+00:00] WARN: Run List override has been provided.
      OMNITRUCK::VERIFY::[2016-07-23 20:01:09 +0000] [2016-07-23T20:01:09+00:00] WARN: Original Run List: []
    1322: |
      OMNITRUCK::VERIFY::[2016-07-23 20:01:09 +0000] Starting audit phase
      OMNITRUCK::VERIFY::[2016-07-23 20:01:09 +0000]
      TOP-COOKBOOKS::DESTROY::[2016-07-23 20:01:10 +0000] [2016-07-23T20:01:10+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
      WINDOWS-SERVICE::PROVISION::[2016-07-23 20:01:11 +0000] Initialized [/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/logs/windows-service/provision.log] logger...
      OMNITRUCK::VERIFY::[2016-07-23 20:01:13 +0000]
    1852: |
      FIPS::PROVISION::[2016-07-23 20:06:12 +0000]

          ================================================================================
          Error executing action `run` on resource 'kitchen[converge]'
          ================================================================================

          Mixlib::ShellOut::ShellCommandFailed
          ------------------------------------
      FIPS::PROVISION::[2016-07-23 20:06:12 +0000]     Expected process to exit with [0], but received '20'
          ---- Begin output of bundle exec kitchen converge  -c -l debug ----
    7210: |2
          D      Class: Kitchen::ActionFailed
          D      Message: 1 actions failed.
          >>>>>>     Failed to complete #converge action: [[WSMAN ERROR CODE: 2150858843]: <f:WSManFault Code='2150858843' Machine='10.194.14.207' xmlns:f='http://schemas.microsoft.com/wbem/wsman/1/wsmanfault'><f:Message>The request for the Windows Remote Shell with ShellId B3CB91B4-00B5-4896-B5AB-F0D806AFE763 failed because the shell was not found on the server. Possible causes are: the specified ShellId is incorrect or the shell no longer exists on the server. Provide the correct ShellId or create a new shell and retry the operation. </f:Message></f:WSManFault>] on fips-integration-windows-2012r2
          D      ----------------------
          D      ------Backtrace-------
    7248: |2
          D      -Composite Exception--
          D      Class: Kitchen::ActionFailed
          D      Message: Failed to complete #converge action: [[WSMAN ERROR CODE: 2150858843]: <f:WSManFault Code='2150858843' Machine='10.194.14.207' xmlns:f='http://schemas.microsoft.com/wbem/wsman/1/wsmanfault'><f:Message>The request for the Windows Remote Shell with ShellId B3CB91B4-00B5-4896-B5AB-F0D806AFE763 failed be
      FIPS::PROVISION::[2016-07-23 20:06:12 +0000] cause the shell was not found on the server. Possible causes are: the specified ShellId is incorrect or the shell no longer exists on the server. Provide the correct ShellId or create a new shell and retry the operation. </f:Message></f:WSManFault>] on fips-integration-windows-2012r2
          D      ----------------------
    7287: |2
          D      ---Nested Exception---
          D      Class: Kitchen::ActionFailed
          D      Message: Failed to complete #converge action: [[WSMAN ERROR CODE: 2150858843]: <f:WSManFault Code='2150858843' Machine='10.194.14.207' xmlns:f='http://schemas.microsoft.com/wbem/wsman/1/wsmanfault'><f:Message>The request for the Windows Remote Shell with ShellId B3CB91B4-00B5-4896-B5AB-F0D806AFE763 failed because the shell was not found on the server. Possible causes are: the specified ShellId is incorrect or the shell no longer exists on the server. Provide the correct ShellId or create a new shell and retry the operation. </f:Message></f:WSManFault>]
          D      ----------------------
          D      ------Backtrace-------
    7327: |2
          >>>>>> Class: Kitchen::ActionFailed
          >>>>>> Message: 1 actions failed.
          >>>>>>     Failed to complete #converge action: [[WSMAN ERROR CODE: 2150858843]: <f:WSManFault Code='2150858843' Machine='10.194.14.207' xmlns:f='http://schemas.microsoft.com/wbem/wsman/1/wsmanfault'><f:Message>The request for the Windows Remote Shell with ShellId B3CB91B4-00B5-4896-B5AB-F0D806AFE763 failed because the shell was not found on the server. Possible causes are: the specified ShellId is incorrect or the shell no longer exists on the server. Provide the correct ShellId or create a new shell and retry the operation. </f:Message></f:WSManFault>] on fips-integration-windows-2012r2
          >>>>>> ----------------------
          >>>>>> Please see .kitchen/logs/kitchen.log for more details
    7376: |
      FIPS::PROVISION::[2016-07-23 20:06:13 +0000] Running handlers:
      FIPS::PROVISION::[2016-07-23 20:06:13 +0000]
      FIPS::PROVISION::[2016-07-23 20:06:13 +0000] [2016-07-23T20:06:13+00:00] ERROR: Running exception handlers
      FIPS::PROVISION::[2016-07-23 20:06:13 +0000] Running handlers complete
      FIPS::PROVISION::[2016-07-23 20:06:13 +0000] [2016-07-23T20:06:13+00:00] ERROR: Exception handlers complete
      FIPS::PROVISION::[2016-07-23 20:06:13 +0000] Chef Client failed. 0 resources updated in 04 minutes 41 seconds
      [2016-07-23T20:06:13+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/failed-audit-data.json
      [2016-07-23T20:06:13+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/chef-stacktrace.out
      [2016-07-23T20:06:13+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
      [2016-07-23T20:06:13+00:00] ERROR: Found 1 errors, they are stored in the backtrace
      FIPS::PROVISION::[2016-07-23 20:06:13 +0000] [2016-07-23T20:06:13+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
      CHEF-ACCEPTANCE::[2016-07-23 20:06:14 +0000] Encountered an error running the recipe provision: Expected process to exit with [0], but received '1'
      ---- Begin output of chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/dna.json -o acceptance-cookbook::provision --no-color ----
    7402: |2
        * kitchen[converge] action run

          ================================================================================
          Error executing action `run` on resource 'kitchen[converge]'
          ================================================================================

          Mixlib::ShellOut::ShellCommandFailed
          ------------------------------------
          Expected process to exit with [0], but received '20'
          ---- Begin output of bundle exec kitchen converge  -c -l debug ----
          STDOUT: -----> Starting Kitchen (v1.10.2)
          D      winrm requested, loading winrm gem (["~> 2.0"])
          D      winrm is loaded.
          D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
          D      winrm-fs is loaded.
          D      winrm requested, loading winrm gem (["~> 2.0"])
          D      winrm was already loaded.
          D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
          D      winrm-fs was already loaded.
          -----> Creating <fips-unit-functional-windows-2012r2>...
          D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
          -----> Creating <fips-unit-functional-centos-6>...
          D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
          D      platform name centos-6 appears to be a standard platform. Searching for centos 6 ...
          D      Searching for images matching {:name=>"CentOS-6.5-GA-*", :"owner-alias"=>"aws-marketplace", :architecture=>"x86_64", :"virtualization-type"=>"paravirtual", :"block-device-mapping.volume-type"=>"standard", :"image-type"=>"machine"} ...
          -----> Creating <fips-integration-windows-2012r2>...
          D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
          D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
          -----> Creating <fips-integration-centos-6>...
          D      platform name centos-6 appears to be a standard platform. Searching for centos 6 ...
          D      Searching for images matching {:name=>"CentOS-6.5-GA-*", :"owner-alias"=>"aws-marketplace", :architecture=>"x86_64", :"virtualization-type"=>"paravirtual", :"block-device-mapping.volume-type"=>"standard", :"image-type"=>"machine"} ...
          D      Search returned 3 images:
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
          D      Image for fips-integration-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                 Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
          D      No SSH username specified: using default username administrator  for image ami-26e72546, which we detected as windows 2012r2rtm x86_64.
                 If you are not using an account that qualifies under the AWS
          free-tier, you may be charged to run these suites. The charge
          should be minimal, but neither Test Kitchen nor its maintainers
          are responsible for your incurred costs.

          D      Creating EC2 instance in region us-west-2 with properties:
          D      - instance_type = "m3.large"
          D      - ebs_optimized = false
          D      - image_id = "ami-26e72546"
          D      - key_name = "jenkins"
          D      - subnet_id = "subnet-19ac017c"
          D      - private_ip_address = nil
          D      - placement = {:availability_zone=>"us-west-2a"}
          D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
          D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
          D      Search returned 1 images:
          D      - CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2: Detected centos 6.5 x86_64.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
          D      Search returned 1 images:
          D      - CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2: Detected centos 6.5 x86_64.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
          D      Search returned 3 images:
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
          D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
          D      Image for fips-unit-functional-centos-6: CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
                 Detected platform: centos version 6.5 on x86_64. Instance Type: m3.large. Default username: root (default).
          D      No SSH username specified: using default username root  for image ami-b6bdde86, which we detected as centos 6.5 x86_64.
                 If you are not using an account that qualifies under the AWS
          free-tier, you may be charged to run these suites. The charge
          should be minimal, but neither Test Kitchen nor its maintainers
          are responsible for your incurred costs.

          D      Creating EC2 instance in region us-west-2 with properties:
          D      - instance_type = "m3.large"
          D      - ebs_optimized = false
          D      - image_id = "ami-b6bdde86"
          D      - key_name = "jenkins"
          D      - subnet_id = "subnet-19ac017c"
          D      - private_ip_address = nil
          D      - placement = {:availability_zone=>"us-west-2a"}
          D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
          D      Image for fips-integration-centos-6: CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
                 Detected platform: centos version 6.5 on x86_64. Instance Type: m3.large. Default username: root (default).
          D      No SSH username specified: using default username root  for image ami-b6bdde86, which we detected as centos 6.5 x86_64.
                 If you are not using an account that qualifies under the AWS
          free-tier, you may be charged to run these suites. The charge
          should be minimal, but neither Test Kitchen nor its maintainers
          are responsible for your incurred costs.

          D      Creating EC2 instance in region us-west-2 with properties:
          D      - instance_type = "m3.large"
          D      - ebs_optimized = false
          D      - image_id = "ami-b6bdde86"
          D      - key_name = "jenkins"
          D      - subnet_id = "subnet-19ac017c"
          D      - private_ip_address = nil
          D      - placement = {:availability_zone=>"us-west-2a"}
          D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
          D      Image for fips-unit-functional-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                 Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
          D      No SSH username specified: using default username administrator  for image ami-26e72546, which we detected as windows 2012r2rtm x86_64.
                 If you are not using an account that qualifies under the AWS
          free-tier, you may be charged to run these suites. The charge
          should be minimal, but neither Test Kitchen nor its maintainers
          are responsible for your incurred costs.

                 Instance <i-17ed6fb8> requested.
                 Polling AWS for existence, attempt 0...
          D      Creating EC2 instance in region us-west-2 with properties:
          D      - instance_type = "m3.large"
          D      - ebs_optimized = false
          D      - image_id = "ami-26e72546"
          D      - key_name = "jenkins"
          D      - subnet_id = "subnet-19ac017c"
          D      - private_ip_address = nil
          D      - placement = {:availability_zone=>"us-west-2a"}
          D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
          D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                 Attempting to tag the instance, 0 retries
                 EC2 instance <i-17ed6fb8> created.
                 Waited 0/300s for instance <i-17ed6fb8> to become ready.
                 Instance <i-b7f27018> requested.
                 Polling AWS for existence, attempt 0...
                 Instance <i-a8f07207> requested.
                 Polling AWS for existence, attempt 0...
                 Instance <i-d8f07277> requested.
                 Polling AWS for existence, attempt 0...
                 Attempting to tag the instance, 0 retries
                 Attempting to tag the instance, 0 retries
                 Attempting to tag the instance, 0 retries
                 EC2 instance <i-a8f07207> created.
                 Waited 0/300s for instance <i-a8f07207> to become ready.
                 EC2 instance <i-b7f27018> created.
                 Waited 0/300s for instance <i-b7f27018> to become ready.
                 EC2 instance <i-d8f07277> created.
                 Waited 0/300s for instance <i-d8f07277> to become ready.
                 Waited 5/300s for instance <i-17ed6fb8> to become ready.
                 Waited 5/300s for instance <i-a8f07207> to become ready.
                 Waited 5/300s for instance <i-d8f07277> to become ready.
                 Waited 5/300s for instance <i-b7f27018> to become ready.
                 Waited 10/300s for instance <i-17ed6fb8> to become ready.
                 Waited 10/300s for instance <i-a8f07207> to become ready.
                 Waited 10/300s for instance <i-d8f07277> to become ready.
                 Waited 10/300s for instance <i-b7f27018> to become ready.
                 Waited 15/300s for instance <i-17ed6fb8> to become ready.
                 Waited 15/300s for instance <i-a8f07207> to become ready.
                 Waited 15/300s for instance <i-b7f27018> to become ready.
                 Waited 15/300s for instance <i-d8f07277> to become ready.
                 Waited 20/300s for instance <i-17ed6fb8> to become ready.
                 Waited 20/300s for instance <i-a8f07207> to become ready.
                 Waited 20/300s for instance <i-b7f27018> to become ready.
                 Waited 20/300s for instance <i-d8f07277> to become ready.
                 Waited 25/300s for instance <i-17ed6fb8> to become ready.
                 Waited 25/300s for instance <i-b7f27018> to become ready.
                 Waited 25/300s for instance <i-a8f07207> to become ready.
                 Waited 25/300s for instance <i-d8f07277> to become ready.
                 EC2 instance <i-a8f07207> ready.
          D      [SSH] opening connection to root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"]}>
                 EC2 instance <i-d8f07277> ready.
          D      [SSH] opening connection to root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"]}>
                 Waited 30/300s for instance <i-17ed6fb8> to become ready.
                 Waited 30/300s for instance <i-b7f27018> to become ready.
                 Waited 35/300s for instance <i-17ed6fb8> to become ready.
                 Waited 35/300s for instance <i-b7f27018> to become ready.
                 Waited 40/300s for instance <i-17ed6fb8> to become ready.
          D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                 Waiting for SSH service on 10.194.11.242:22, retrying in 3 seconds
          D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                 Waiting for SSH service on 10.194.8.73:22, retrying in 3 seconds
                 Waited 40/300s for instance <i-b7f27018> to become ready.
          D      [SSH] opening connection to root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
          D      [SSH] opening connection to root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                 Waited 45/300s for instance <i-17ed6fb8> to become ready.
                 Waited 45/300s for instance <i-b7f27018> to become ready.
                 Waited 50/300s for instance <i-17ed6fb8> to become ready.
                 Waited 50/300s for instance <i-b7f27018> to become ready.
                 Waited 55/300s for instance <i-17ed6fb8> to become ready.
                 Waited 55/300s for instance <i-b7f27018> to become ready.
          D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                 Waiting for SSH service on 10.194.11.242:22, retrying in 3 seconds
          D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                 Waiting for SSH service on 10.194.8.73:22, retrying in 3 seconds
          D      [SSH] opening connection to root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
          D      [SSH] opening connection to root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                 Waited 60/300s for instance <i-17ed6fb8> to become ready.
                 Waited 60/300s for instance <i-b7f27018> to become ready.
                 Waited 65/300s for instance <i-17ed6fb8> to become ready.
                 Waited 65/300s for instance <i-b7f27018> to become ready.
                 Waited 70/300s for instance <i-17ed6fb8> to become ready.
                 Waited 70/300s for instance <i-b7f27018> to become ready.
          D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                 Waiting for SSH service on 10.194.11.242:22, retrying in 3 seconds
          D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                 Waiting for SSH service on 10.194.8.73:22, retrying in 3 seconds
                 Waited 75/300s for instance <i-17ed6fb8> to become ready.
                 Waited 75/300s for instance <i-b7f27018> to become ready.
          D      [SSH] opening connection to root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
          D      [SSH] opening connection to root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                 Waited 80/300s for instance <i-17ed6fb8> to become ready.
                 Waited 80/300s for instance <i-b7f27018> to become ready.
                 Waited 85/300s for instance <i-17ed6fb8> to become ready.
                 Waited 85/300s for instance <i-b7f27018> to become ready.
                 Waited 90/300s for instance <i-17ed6fb8> to become ready.
                 Waited 90/300s for instance <i-b7f27018> to become ready.
          D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                 Waiting for SSH service on 10.194.11.242:22, retrying in 3 seconds
          D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                 Waiting for SSH service on 10.194.8.73:22, retrying in 3 seconds
          D      [SSH] opening connection to root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
          D      [SSH] opening connection to root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
          D      [SSH] root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (echo '[SSH] Established')
          D      [SSH] root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (echo '[SSH] Established')
                 bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 [SSH] Established
          D      Using sudo_command='sudo -E' for ohai hints
          D      [SSH] reusing existing connection root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
          D      [SSH] root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E mkdir -p /etc/chef/ohai/hints; sudo -E touch /etc/chef/ohai/hints/ec2.json)
                 bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
          D      ec2:create '10.194.11.242'
                 Finished creating <fips-integration-centos-6> (1m44.12s).
          -----> Converging <fips-integration-centos-6>...
                 Preparing files for transfer
          D      Creating local sandbox in /tmp/cheftest/fips-integration-centos-6-sandbox-20160723-30984-25mg7f
                 Preparing dna.json
          D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                 Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                 Removing non-cookbook files before transfer
                 bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 [SSH] Established
          D      Using sudo_command='sudo -E' for ohai hints
          D      [SSH] reusing existing connection root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
          D      [SSH] root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E mkdir -p /etc/chef/ohai/hints; sudo -E touch /etc/chef/ohai/hints/ec2.json)
                 Preparing validation.pem
          D      Using a dummy validation.pem
                 Preparing client.rb
          D      Creating client.rb from {:node_name=>"fips-integration-centos-6", :checksum_path=>"/tmp/kitchen/checksums", :file_cache_path=>"/tmp/kitchen/cache", :file_backup_path=>"/tmp/kitchen/backup", :cookbook_path=>["/tmp/kitchen/cookbooks", "/tmp/kitchen/site-cookbooks"], :data_bag_path=>"/tmp/kitchen/data_bags", :environment_path=>"/tmp/kitchen/environments", :node_path=>"/tmp/kitchen/nodes", :role_path=>"/tmp/kitchen/roles", :client_path=>"/tmp/kitchen/clients", :user_path=>"/tmp/kitchen/users", :validation_key=>"/tmp/kitchen/validation.pem", :client_key=>"/tmp/kitchen/client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"/tmp/kitchen/encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
          D      [SSH] reusing existing connection root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                 bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
          D      ec2:create '10.194.8.73'
                 Finished creating <fips-unit-functional-centos-6> (1m44.25s).
          -----> Converging <fips-unit-functional-centos-6>...
                 Preparing files for transfer
          D      Creating local sandbox in /tmp/cheftest/fips-unit-functional-centos-6-sandbox-20160723-30984-8jysl2
                 Preparing dna.json
          D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                 Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                 Removing non-cookbook files before transfer
                 Preparing validation.pem
          D      Using a dummy validation.pem
                 Preparing client.rb
          D      Creating client.rb from {:node_name=>"fips-unit-functional-centos-6", :checksum_path=>"/tmp/kitchen/checksums", :file_cache_path=>"/tmp/kitchen/cache", :file_backup_path=>"/tmp/kitchen/backup", :cookbook_path=>["/tmp/kitchen/cookbooks", "/tmp/kitchen/site-cookbooks"], :data_bag_path=>"/tmp/kitchen/data_bags", :environment_path=>"/tmp/kitchen/environments", :node_path=>"/tmp/kitchen/nodes", :role_path=>"/tmp/kitchen/roles", :client_path=>"/tmp/kitchen/clients", :user_path=>"/tmp/kitchen/users", :validation_key=>"/tmp/kitchen/validation.pem", :client_key=>"/tmp/kitchen/client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"/tmp/kitchen/encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
          D      [SSH] reusing existing connection root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                 Waited 95/300s for instance <i-17ed6fb8> to become ready.
          D      [SSH] root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E cat > /tmp/chef-installer.sh <<"EOL"
          #!/bin/bash
          #!/bin/sh
          # WARNING: REQUIRES /bin/sh
          #
          # - must run on /bin/sh on solaris 9
          # - must run on /bin/sh on AIX 6.x
          #
          # Copyright:: Copyright (c) 2010-2015 Chef Software, Inc.
          # License:: Apache License, Version 2.0
          #
          # Licensed under the Apache License, Version 2.0 (the "License");
          # you may not use this file except in compliance with the License.
          # You may obtain a copy of the License at
          #
          #     http://www.apache.org/licenses/LICENSE-2.0
          #
          # Unless required by applicable law or agreed to in writing, software
          # distributed under the License is distributed on an "AS IS" BASIS,
          # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
          # See the License for the specific language governing permissions and
          # limitations under the License.
          #

          # helpers.sh
          ############
          # This section has some helper functions to make life easier.
          #
          # Outputs:
          # $tmp_dir: secure-ish temp directory that can be used during installation.
          ############

          # Check whether a command exists - returns 0 if it does, 1 if it does not
          exists() {
            if command -v $1 >/dev/null 2>&1
            then
              return 0
            else
              return 1
            fi
          }

          # Output the instructions to report bug about this script
          report_bug() {
            echo "Version: $version"
            echo ""
            echo "Please file a Bug Report at https://github.com/chef/omnitruck/issues/new"
            echo "Alternatively, feel free to open a Support Ticket at https://www.chef.io/support/tickets"
            echo "More Chef support resources can be found at https://www.chef.io/support"
            echo ""
            echo "Please include as many details about the problem as possible i.e., how to reproduce"
            echo "the problem (if possible), type of the Operating System and its version, etc.,"
            echo "and any other relevant details that might help us with troubleshooting."
            echo ""
          }

          checksum_mismatch() {
            echo "Package checksum mismatch!"
            report_bug
            exit 1
          }

          unable_to_retrieve_package() {
            echo "Unable to retrieve a valid package!"
            report_bug
            echo "Metadata URL: $metadata_url"
            if test "x$download_url" != "x"; then
              echo "Download URL: $download_url"
            fi
            if test "x$stderr_results" != "x"; then
              echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
            fi
            exit 1
          }

          http_404_error() {
            echo "Omnitruck artifact does not exist for version $version on platform $platform"
            echo ""
            echo "Either this means:"
            echo "   - We do not support $platform"
            echo "   - We do not have an artifact for $version"
            echo ""
            echo "This is often the latter case due to running a prerelease or RC version of chef"
            echo "or a gem version which was only pushed to rubygems and not omnitruck."
            echo ""
            echo "You may be able to set your knife[:bootstrap_version] to the most recent stable"
            echo "release of Chef to fix this problem (or the most recent stable major version number)."
            echo ""
            echo "In order to test the version parameter, adventurous users may take the Metadata URL"
            echo "below and modify the '&v=<number>' parameter until you successfully get a URL that"
            echo "does not 404 (e.g. via curl or wget).  You should be able to use '&v=11' or '&v=12'"
            echo "succesfully."
            echo ""
            echo "If you cannot fix this problem by setting the bootstrap_version, it probably means"
            echo "that $platform is not supported."
            echo ""
            # deliberately do not call report_bug to suppress bug report noise.
            echo "Metadata URL: $metadata_url"
            if test "x$download_url" != "x"; then
              echo "Download URL: $download_url"
            fi
            if test "x$stderr_results" != "x"; then
              echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
            fi
            exit 1
          }

          capture_tmp_stderr() {
            # spool up /tmp/stderr from all the commands we called
            if test -f "$tmp_dir/stderr"; then
              output=`cat $tmp_dir/stderr`
              stderr_results="${stderr_results}\nSTDERR from $1:\n\n$output\n"
              rm $tmp_dir/stderr
            fi
          }

          # do_wget URL FILENAME
          do_wget() {
            echo "trying wget..."
            wget -O "$2" "$1" 2>$tmp_dir/stderr
            rc=$?
            # check for 404
            grep "ERROR 404" $tmp_dir/stderr 2>&1 >/dev/null
            if test $? -eq 0; then
              echo "ERROR 404"
              http_404_error
            fi

            # check for bad return status or empty output
            if test $rc -ne 0 || test ! -s "$2"; then
              capture_tmp_stderr "wget"
              return 1
            fi

            return 0
          }

          # do_curl URL FILENAME
          do_curl() {
            echo "trying curl..."
            curl --retry 5 -sL -D $tmp_dir/stderr "$1" > "$2"
            rc=$?
            # check for 404
            grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
            if test $? -eq 0; then
              echo "ERROR 404"
              http_404_error
            fi

            # check for bad return status or empty output
            if test $rc -ne 0 || test ! -s "$2"; then
              capture_tmp_stderr "curl"
              return 1
            fi

            return 0
          }

          # do_fetch URL FILENAME
          do_fetch() {
            echo "trying fetch..."
            fetch -o "$2" "$1" 2>$tmp_dir/stderr
            # check for bad return status
            test $? -ne 0 && return 1
            return 0
          }

          # do_perl URL FILENAME
          do_perl() {
            echo "trying perl..."
            perl -e 'use LWP::Simple; getprint($ARGV[0]);' "$1" > "$2" 2>$tmp_dir/stderr
            rc=$?
            # check for 404
            grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
            if test $? -eq 0; then
              echo "ERROR 404"
              http_404_error
            fi

            # check for bad return status or empty output
            if test $rc -ne 0 || test ! -s "$2"; then
              capture_tmp_stderr "perl"
              return 1
            fi

            return 0
          }

          # do_python URL FILENAME
          do_python() {
            echo "trying python..."
            python -c "import sys,urllib2 ; sys.stdout.write(urllib2.urlopen(sys.argv[1]).read())" "$1" > "$2" 2>$tmp_dir/stderr
            rc=$?
            # check for 404
            grep "HTTP Error 404" $tmp_dir/stderr 2>&1 >/dev/null
            if test $? -eq 0; then
              echo "ERROR 404"
              http_404_error
            fi

            # check for bad return status or empty output
            if test $rc -ne 0 || test ! -s "$2"; then
              capture_tmp_stderr "python"
              return 1
            fi
            return 0
          }

          # returns 0 if checksums match
          do_checksum() {
            if exists sha256sum; then
              echo "Comparing checksum with sha256sum..."
              checksum=`sha256sum $1 | awk '{ print $1 }'`
              return `test "x$checksum" = "x$2"`
            elif exists shasum; then
              echo "Comparing checksum with shasum..."
              checksum=`shasum -a 256 $1 | awk '{ print $1 }'`
              return `test "x$checksum" = "x$2"`
            else
              echo "WARNING: could not find a valid checksum program, pre-install shasum or sha256sum in your O/S image to get valdation..."
              return 0
            fi
          }

          # do_download URL FILENAME
          do_download() {
            echo "downloading $1"
            echo "  to file $2"

            url=`echo $1`
            if test "x$platform" = "xsolaris2"; then
              if test "x$platform_version" = "x5.9" -o "x$platform_version" = "x5.10"; then
                # solaris 9 lacks openssl, solaris 10 lacks recent enough credentials - your base O/S is completely insecure, please upgrade
                url=`echo $url | sed -e 's/https/http/'`
              fi
            fi

            # we try all of these until we get success.
            # perl, in particular may be present but LWP::Simple may not be installed

            if exists wget; then
              do_wget $url $2 && return 0
            fi

            if exists curl; then
              do_curl $url $2 && return 0
            fi

            if exists fetch; then
              do_fetch $url $2 && return 0
            fi

            if exists perl; then
              do_perl $url $2 && return 0
            fi

            if exists python; then
              do_python $url $2 && return 0
            fi

            unable_to_retrieve_package
          }

          # install_file TYPE FILENAME
          # TYPE is "rpm", "deb", "solaris", "sh", etc.
          install_file() {
            echo "Installing $project $version"
            case "$1" in
              "rpm")
                if test "x$platform" = "xnexus" || test "x$platform" = "xios_xr"; then
                  echo "installing with yum..."
                  yum install -yv "$2"
                else
                  echo "installing with rpm..."
                  rpm -Uvh --oldpackage --replacepkgs "$2"
                fi
                ;;
              "deb")
                echo "installing with dpkg..."
                dpkg -i "$2"
                ;;
              "bff")
                echo "installing with installp..."
                installp -aXYgd "$2" all
                ;;
              "solaris")
                echo "installing with pkgadd..."
                echo "conflict=nocheck" > $tmp_dir/nocheck
                echo "action=nocheck" >> $tmp_dir/nocheck
                echo "mail=" >> $tmp_dir/nocheck
                pkgrm -a $tmp_dir/nocheck -n $project >/dev/null 2>&1 || true
                pkgadd -G -n -d "$2" -a $tmp_dir/nocheck $project
                ;;
              "pkg")
                echo "installing with installer..."
                cd / && /usr/sbin/installer -pkg "$2" -target /
                ;;
              "dmg")
                echo "installing dmg file..."
                hdiutil detach "/Volumes/chef_software" >/dev/null 2>&1 || true
                hdiutil attach "$2" -mountpoint "/Volumes/chef_software"
                cd / && /usr/sbin/installer -pkg `find "/Volumes/chef_software" -name \*.pkg` -target /
                hdiutil detach "/Volumes/chef_software"
                ;;
              "sh" )
                echo "installing with sh..."
                sh "$2"
                ;;
              *)
                echo "Unknown filetype: $1"
                report_bug
                exit 1
                ;;
            esac
            if test $? -ne 0; then
              echo "Installation failed"
              report_bug
              exit 1
            fi
          }

          if test "x$TMPDIR" = "x"; then
            tmp="/tmp"
          else
            tmp=$TMPDIR
          fi
          # secure-ish temp dir creation without having mktemp available (DDoS-able but not expliotable)
          tmp_dir="$tmp/install.sh.$$"
          (umask 077 && mkdir $tmp_dir) || exit 1

          ############
          # end of helpers.sh
          ############


          project=chef
          version=12.13.12+20160723192537
          channel=unstable


          # platform_detection.sh
          ############
          # This section makes platform detection compatible with omnitruck on the system
          #   it runs.
          #
          # Outputs:
          # $platform: Name of the platform.
          # $platform_version: Version of the platform.
          # $machine: System's architecture.
          ############

          #
          # Platform and Platform Version detection
          #
          # NOTE: This should now match ohai platform and platform_version matching.
          # do not invented new platform and platform_version schemas, just make this behave
          # like what ohai returns as platform and platform_version for the server.
          #
          # ALSO NOTE: Do not mangle platform or platform_version here.  It is less error
          # prone and more future-proof to do that in the server, and then all omnitruck clients
          # will 'inherit' the changes (install.sh is not the only client of the omnitruck
          # endpoint out there).
          #

          machine=`uname -m`
          os=`uname -s`

          if test -f "/etc/lsb-release" && grep -q DISTRIB_ID /etc/lsb-release && ! grep -q wrlinux /etc/lsb-release; then
            platform=`grep DISTRIB_ID /etc/lsb-release | cut -d "=" -f 2 | tr '[A-Z]' '[a-z]'`
            platform_version=`grep DISTRIB_RELEASE /etc/lsb-release | cut -d "=" -f 2`
          elif test -f "/etc/debian_version"; then
            platform="debian"
            platform_version=`cat /etc/debian_version`
          elif test -f "/etc/redhat-release"; then
            platform=`sed 's/^\(.\+\) release.*/\1/' /etc/redhat-release | tr '[A-Z]' '[a-z]'`
            platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/redhat-release`

            # If /etc/redhat-release exists, we act like RHEL by default
            if test "$platform" = "fedora"; then
              # FIXME: stop remapping fedora to el
              # FIXME: remove client side platform_version mangling and hard coded yolo
              # Change platform version for use below.
              platform_version="6.0"
            fi

            if test "$platform" = "xenserver"; then
              # Current XenServer 6.2 is based on CentOS 5, platform is not reset to "el" server should hanlde response
              platform="xenserver"
            else
              # FIXME: use "redhat"
              platform="el"
            fi

          elif test -f "/etc/system-release"; then
            platform=`sed 's/^\(.\+\) release.\+/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
            platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
            # amazon is built off of fedora, so act like RHEL
            if test "$platform" = "amazon linux ami"; then
              # FIXME: remove client side platform_version mangling and hard coded yolo, and remapping to deprecated "el"
              platform="el"
              platform_version="6.0"
            fi
          # Apple OS X
          elif test -f "/usr/bin/sw_vers"; then
            platform="mac_os_x"
            # Matching the tab-space with sed is error-prone
            platform_version=`sw_vers | awk '/^ProductVersion:/ { print $2 }' | cut -d. -f1,2`

            # x86_64 Apple hardware often runs 32-bit kernels (see OHAI-63)
            x86_64=`sysctl -n hw.optional.x86_64`
            if test $x86_64 -eq 1; then
              machine="x86_64"
            fi
          elif test -f "/etc/release"; then
            machine=`/usr/bin/uname -p`
            if grep -q SmartOS /etc/release; then
              platform="smartos"
              platform_version=`grep ^Image /etc/product | awk '{ print $3 }'`
            else
              platform="solaris2"
              platform_version=`/usr/bin/uname -r`
            fi
          elif test -f "/etc/SuSE-release"; then
            if grep -q 'Enterprise' /etc/SuSE-release;
            then
                platform="sles"
                platform_version=`awk '/^VERSION/ {V = $3}; /^PATCHLEVEL/ {P = $3}; END {print V "." P}' /etc/SuSE-release`
            else
                platform="suse"
                platform_version=`awk '/^VERSION =/ { print $3 }' /etc/SuSE-release`
            fi
          elif test "x$os" = "xFreeBSD"; then
            platform="freebsd"
            platform_version=`uname -r | sed 's/-.*//'`
          elif test "x$os" = "xAIX"; then
            platform="aix"
            platform_version="`uname -v`.`uname -r`"
            machine="powerpc"
          elif test -f "/etc/os-release"; then
            . /etc/os-release
            if test "x$CISCO_RELEASE_INFO" != "x"; then
              . $CISCO_RELEASE_INFO
            fi

            platform=$ID
            platform_version=$VERSION
          fi

          if test "x$platform" = "x"; then
            echo "Unable to determine platform version!"
            report_bug
            exit 1
          fi

          #
          # NOTE: platform manging in the install.sh is DEPRECATED
          #
          # - install.sh should be true to ohai and should not remap
          #   platform or platform versions.
          #
          # - remapping platform and mangling platform version numbers is
          #   now the complete responsibility of the server-side endpoints
          #

          major_version=`echo $platform_version | cut -d. -f1`
          case $platform in
            # FIXME: should remove this case statement completely
            "el")
              # FIXME:  "el" is deprecated, should use "redhat"
              platform_version=$major_version
              ;;
            "debian")
              if test "x$major_version" = "x5"; then
                # This is here for potential back-compat.
                # We do not have 5 in versions we publish for anymore but we
                # might have it for earlier versions.
                platform_version="6"
              else
                platform_version=$major_version
              fi
              ;;
            "freebsd")
              platform_version=$major_version
              ;;
            "sles")
              platform_version=$major_version
              ;;
            "suse")
              platform_version=$major_version
              ;;
          esac

          # normalize the architecture we detected
          case $machine in
            "x86_64"|"amd64"|"x64")
              machine="x86_64"
              ;;
            "i386"|"i86pc"|"x86"|"i686")
              machine="i386"
              ;;
            "sparc"|"sun4u"|"sun4v")
              machine="sparc"
              ;;
          esac

          if test "x$platform_version" = "x"; then
            echo "Unable to determine platform version!"
            report_bug
            exit 1
          fi

          if test "x$platform" = "xsolaris2"; then
            # hack up the path on Solaris to find wget, pkgadd
            PATH=/usr/sfw/bin:/usr/sbin:$PATH
            export PATH
          fi

          echo "$platform $platform_version $machine"

          ############
          # end of platform_detection.sh
          ############


          # artifactory_urls.sh
          ############
          # This section sets up the information for a build to be installed from artifactory
          #  then uses $platform, $platform_version and $machine to select the correct
          #  version.
          #
          # Inputs:
          # $platform:
          # $platform_version:
          # $machine:
          #
          # Outputs:
          # $download_url:
          # $sha256:
          ############


            artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/ppc64le"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_ppc64el.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 6932cbc2f8e10d1cc419b3cb7fe37faac34a6ffde48d476b61952e8008bce6e4" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.9/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.9/chef-12.13.12+20160723192537-1.dmg" >> "$artifact_info_dir/artifact_info"
            echo "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.10/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.10/chef-12.13.12+20160723192537-1.dmg" >> "$artifact_info_dir/artifact_info"
            echo "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.11/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.11/chef-12.13.12+20160723192537-1.dmg" >> "$artifact_info_dir/artifact_info"
            echo "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/ios_xr/6/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ios_xr/6/chef-12.13.12+20160723192537-1.ios_xr6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 ea052ef6ce24d4011a6646c8baaf3cea35a96ae50c41a74e1e739883806523f5" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.i386.sh" >> "$artifact_info_dir/artifact_info"
            echo "sha256 e092cd2b7dadabb4d5adcfedbb9c69c7feb5054bcd4eec09f96c3e5a187e4980" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/6/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_i386.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/7/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_i386.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/8/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_i386.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/nexus/7/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/nexus/7/chef-12.13.12+20160723192537-1.nexus7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 ab5924a4030a6ceb59fa4b6adc0badef93ffac19dedc25d9b4a0371c8e88cd16" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.i386.sh" >> "$artifact_info_dir/artifact_info"
            echo "sha256 2337c9357c6c02c95b452911b6d90bef5f46d38a4834bf1fc7767921b509aeeb" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_i386.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_i386.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
            echo "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/5/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.i386.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 9ca5b61b622b258a6cb4a7f307351e9bf5befba2667363cfa0a9d708dcd5448c" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
            echo "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/6/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.i386.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 2ab9174446289559390e6ffcb3cfec30f8db0af2d7012b55f1d432d529c86741" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 5c018264cf2db515a82c96f38456bc8b0dfca38ddb7a408f16aa64b2dd978011" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64le"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64le.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 9a6712bca35e025223ed27fb40e33d353f164a2131fdd3a304737a7c3dc726e7" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x86.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/amd64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
            echo "sha256 34f6d18d74365dc821e8d951ba595a775a5ae93ab7aa423d388d53825cb971c7" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/5/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 4d3108d25e015571d598d344dfd5b280b5bb5310e40a2fd0642a30b0b3803d3c" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/6/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/7/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/8/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2012/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x86.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/amd64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
            echo "sha256 2aef7e8fc16cc35aec6dcafcd9f64e63aa5af4d1b845a37c7e0aa44b830435d6" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x86.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/6/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 8973f19860d1b7f9111d4fcac2ef3b43d1b817ba7a6a2465a202d87839c1a3dd" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x64.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2012/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x64.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x64.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/aix/6.1/powerpc"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/6.1/chef-12.13.12+20160723192537-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
            echo "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/aix/7.1/powerpc"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/7.1/chef-12.13.12+20160723192537-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
            echo "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/7/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 ab9507cf0bf779a919182cd2559e02d2dd6ca12c7d22ba9cb56717a5757eb0a6" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/sparc"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
            echo "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/sparc"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
            echo "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" >> "$artifact_info_dir/artifact_info"


          artifact_info_for_platform="$tmp_dir/artifact_info/$platform/$platform_version/$machine/artifact_info"

          download_url=`awk '$1 == "url" { print $2 }' "$artifact_info_for_platform"`
          sha256=`awk '$1 == "sha256" { print $2 }' "$artifact_info_for_platform"`


          # fetch_package.sh
          ############
          # This section fetchs a package from $download_url and verifies its metadata.
          #
          # Inputs:
          # $download_url:
          # $tmp_dir:
          # Optional Inputs:
          # $cmdline_filename: Name of the package downloaded on local disk.
          # $cmdline_dl_dir: Name of the directory downloaded package will be saved to on local disk.
          #
          # Outputs:
          # $download_filename: Name of the downloaded file on local disk.
          # $filetype: Type of the file downloaded.
          ############

          filename=`echo $download_url | sed -e 's/^.*\///'`
          filetype=`echo $filename | sed -e 's/^.*\.//'`

          # use either $tmp_dir, the provided directory (-d) or the provided filename (-f)
          if test "x$cmdline_filename" != "x"; then
            download_filename="$cmdline_filename"
          elif test "x$cmdline_dl_dir" != "x"; then
            download_filename="$cmdline_dl_dir/$filename"
          else
            download_filename="$tmp_dir/$filename"
          fi

          # ensure the parent directory where to download the installer always exists
          download_dir=`dirname $download_filename`
          (umask 077 && mkdir -p $download_dir) || exit 1

          # check if we have that file locally available and if so verify the checksum
          cached_file_available="false"
          if test -f $download_filename; then
            echo "$download_filename already exists, verifiying checksum..."
            if do_checksum "$download_filename" "$sha256"; then
              echo "checksum compare succeeded, using existing file!"
              cached_file_available="true"
            else
              echo "checksum mismatch, downloading latest version of the file"
            fi
          fi

          # download if no local version of the file available
          if test "x$cached_file_available" != "xtrue"; then
            do_download "$download_url"  "$download_filename"
            do_checksum "$download_filename" "$sha256" || checksum_mismatch
          fi

          ############
          # end of fetch_package.sh
          ############


          # install_package.sh
          ############
          # Installs a package and removed the temp directory.
          #
          # Inputs:
          # $download_filename: Name of the file to be installed.
          # $filetype: Type of the file to be installed.
          # $version: The version requested. Used only for warning user if not set.
          ############

          if test "x$version" = "x"; then
            echo
            echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
            echo
            echo "You are installing an omnibus package without a version pin.  If you are installing"
            echo "on production servers via an automated process this is DANGEROUS and you will"
            echo "be upgraded without warning on new releases, even to new major releases."
            echo "Letting the version float is only appropriate in desktop, test, development or"
            echo "CI/CD environments."
            echo
            echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
            echo
          fi

          install_file $filetype "$download_filename"

          if test "x$tmp_dir" != "x"; then
            rm -r "$tmp_dir"
          fi

          ############
          # end of install_package.sh
          ############

          EOL
          chmod +x /tmp/chef-installer.sh
          sudo -E /tmp/chef-installer.sh)
          D      [SSH] root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E cat > /tmp/chef-installer.sh <<"EOL"
          #!/bin/bash
          #!/bin/sh
          # WARNING: REQUIRES /bin/sh
          #
          # - must run on /bin/sh on solaris 9
          # - must run on /bin/sh on AIX 6.x
          #
          # Copyright:: Copyright (c) 2010-2015 Chef Software, Inc.
          # License:: Apache License, Version 2.0
          #
          # Licensed under the Apache License, Version 2.0 (the "License");
          # you may not use this file except in compliance with the License.
          # You may obtain a copy of the License at
          #
          #     http://www.apache.org/licenses/LICENSE-2.0
          #
          # Unless required by applicable law or agreed to in writing, software
          # distributed under the License is distributed on an "AS IS" BASIS,
          # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
          # See the License for the specific language governing permissions and
          # limitations under the License.
          #

          # helpers.sh
          ############
          # This section has some helper functions to make life easier.
          #
          # Outputs:
          # $tmp_dir: secure-ish temp directory that can be used during installation.
          ############

          # Check whether a command exists - returns 0 if it does, 1 if it does not
          exists() {
            if command -v $1 >/dev/null 2>&1
            then
              return 0
            else
              return 1
            fi
          }

          # Output the instructions to report bug about this script
          report_bug() {
            echo "Version: $version"
            echo ""
            echo "Please file a Bug Report at https://github.com/chef/omnitruck/issues/new"
            echo "Alternatively, feel free to open a Support Ticket at https://www.chef.io/support/tickets"
            echo "More Chef support resources can be found at https://www.chef.io/support"
            echo ""
            echo "Please include as many details about the problem as possible i.e., how to reproduce"
            echo "the problem (if possible), type of the Operating System and its version, etc.,"
            echo "and any other relevant details that might help us with troubleshooting."
            echo ""
          }

          checksum_mismatch() {
            echo "Package checksum mismatch!"
            report_bug
            exit 1
          }

          unable_to_retrieve_package() {
            echo "Unable to retrieve a valid package!"
            report_bug
            echo "Metadata URL: $metadata_url"
            if test "x$download_url" != "x"; then
              echo "Download URL: $download_url"
            fi
            if test "x$stderr_results" != "x"; then
              echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
            fi
            exit 1
          }

          http_404_error() {
            echo "Omnitruck artifact does not exist for version $version on platform $platform"
            echo ""
            echo "Either this means:"
            echo "   - We do not support $platform"
            echo "   - We do not have an artifact for $version"
            echo ""
            echo "This is often the latter case due to running a prerelease or RC version of chef"
            echo "or a gem version which was only pushed to rubygems and not omnitruck."
            echo ""
            echo "You may be able to set your knife[:bootstrap_version] to the most recent stable"
            echo "release of Chef to fix this problem (or the most recent stable major version number)."
            echo ""
            echo "In order to test the version parameter, adventurous users may take the Metadata URL"
            echo "below and modify the '&v=<number>' parameter until you successfully get a URL that"
            echo "does not 404 (e.g. via curl or wget).  You should be able to use '&v=11' or '&v=12'"
            echo "succesfully."
            echo ""
            echo "If you cannot fix this problem by setting the bootstrap_version, it probably means"
            echo "that $platform is not supported."
            echo ""
            # deliberately do not call report_bug to suppress bug report noise.
            echo "Metadata URL: $metadata_url"
            if test "x$download_url" != "x"; then
              echo "Download URL: $download_url"
            fi
            if test "x$stderr_results" != "x"; then
              echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
            fi
            exit 1
          }

          capture_tmp_stderr() {
            # spool up /tmp/stderr from all the commands we called
            if test -f "$tmp_dir/stderr"; then
              output=`cat $tmp_dir/stderr`
              stderr_results="${st       bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 /bin/bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
          derr_results}\nSTDERR from $1:\n\n$output\n"
              rm $tmp_dir/stderr
            fi
          }

          # do_wget URL FILENAME
          do_wget() {
            echo "trying wget..."
            wget -O "$2" "$1" 2>$tmp_dir/stderr
            rc=$?
            # check for 404
            grep "ERROR 404" $tmp_dir/stderr 2>&1 >/dev/null
            if test $? -eq 0; then
              echo "ERROR 404"
              http_404_error
            fi

            # check for bad return status or empty output
            if test $rc -ne 0 || test ! -s "$2"; then
              capture_tmp_stderr "wget"
              return 1
            fi

            return 0
          }

          # do_curl URL FILENAME
          do_curl() {
            echo "trying curl..."
            curl --retry 5 -sL -D $tmp_dir/stderr "$1" > "$2"
            rc=$?
            # check for 404
            grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
            if test $? -eq 0; then
              echo "ERROR 404"
              http_404_error
            fi

            # check for bad return status or empty output
            if test $rc -ne 0 || test ! -s "$2"; then
              capture_tmp_stderr "curl"
              return 1
            fi

            return 0
          }

          # do_fetch URL FILENAME
          do_fetch() {
            echo "trying fetch..."
            fetch -o "$2" "$1" 2>$tmp_dir/stderr
            # check for bad return status
            test $? -ne 0 && return 1
            return 0
          }

          # do_perl URL FILENAME
          do_perl() {
            echo "trying perl..."
            perl -e 'use LWP::Simple; getprint($ARGV[0]);' "$1" > "$2" 2>$tmp_dir/stderr
            rc=$?
            # check for 404
            grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
            if test $? -eq 0; then
              echo "ERROR 404"
              http_404_error
            fi

            # check for bad return status or empty output
            if test $rc -ne 0 || test ! -s "$2"; then
              capture_tmp_stderr "perl"
              return 1
            fi

            return 0
          }

          # do_python URL FILENAME
          do_python() {
            echo "trying python..."
            python -c "import sys,urllib2 ; sys.stdout.write(urllib2.urlopen(sys.argv[1]).read())" "$1" > "$2" 2>$tmp_dir/stderr
            rc=$?
            # check for 404
            grep "HTTP Error 404" $tmp_dir/stderr 2>&1 >/dev/null
            if test $? -eq 0; then
              echo "ERROR 404"
              http_404_error
            fi

            # check for bad return status or empty output
            if test $rc -ne 0 || test ! -s "$2"; then
              capture_tmp_stderr "python"
              return 1
            fi
            return 0
          }

          # returns 0 if checksums match
          do_checksum() {
            if exists sha256sum; then
              echo "Comparing checksum with sha256sum..."
              checksum=`sha256sum $1 | awk '{ print $1 }'`
              return `test "x$checksum" = "x$2"`
            elif exists shasum; then
              echo "Comparing checksum with shasum..."
              checksum=`shasum -a 256 $1 | awk '{ print $1 }'`
              return `test "x$checksum" = "x$2"`
            else
              echo "WARNING: could not find a valid checksum program, pre-install shasum or sha256sum in your O/S image to get valdation..."
              return 0
            fi
          }

          # do_download URL FILENAME
          do_download() {
            echo "downloading $1"
            echo "  to file $2"

            url=`echo $1`
            if test "x$platform" = "xsolaris2"; then
              if test "x$platform_version" = "x5.9" -o "x$platform_version" = "x5.10"; then
                # solaris 9 lacks openssl, solaris 10 lacks recent enough credentials - your base O/S is completely insecure, please upgrade
                url=`echo $url | sed -e 's/https/http/'`
              fi
            fi

            # we try all of these until we get success.
            # perl, in particular may be present but LWP::Simple may not be installed

            if exists wget; then
              do_wget $url $2 && return 0
            fi

            if exists curl; then
              do_curl $url $2 && return 0
            fi

            if exists fetch; then
              do_fetch $url $2 && return 0
            fi

            if exists perl; then
              do_perl $url $2 && return 0
            fi

            if exists python; then
              do_python $url $2 && return 0
            fi

            unable_to_retrieve_package
          }

          # install_file TYPE FILENAME
          # TYPE is "rpm", "deb", "solaris", "sh", etc.
          install_file() {
            echo "Installing $project $version"
            case "$1" in
              "rpm")
                if test "x$platform" = "xnexus" || test "x$platform" = "xios_xr"; then
                  echo "installing with yum..."
                  yum install -yv "$2"
                else
                  echo "installing with rpm..."
                  rpm -Uvh --oldpackage --replacepkgs "$2"
                fi
                ;;
              "deb")
                echo "installing with dpkg..."
                dpkg -i "$2"
                ;;
              "bff")
                echo "installing with installp..."
                installp -aXYgd "$2" all
                ;;
              "solaris")
                echo "installing with pkgadd..."
                echo "conflict=nocheck" > $tmp_dir/nocheck
                echo "action=nocheck" >> $tmp_dir/nocheck
                echo "mail=" >> $tmp_dir/nocheck
                pkgrm -a $tmp_dir/nocheck -n $project >/dev/null 2>&1 || true
                pkgadd -G -n -d "$2" -a $tmp_dir/nocheck $project
                ;;
              "pkg")
                echo "installing with installer..."
                cd / && /usr/sbin/installer -pkg "$2" -target /
                ;;
              "dmg")
                echo "installing dmg file..."
                hdiutil detach "/Volumes/chef_software" >/dev/null 2>&1 || true
                hdiutil attach "$2" -mountpoint "/Volumes/chef_software"
                cd / && /usr/sbin/installer -pkg `find "/Volumes/chef_software" -name \*.pkg` -target /
                hdiutil detach "/Volumes/chef_software"
                ;;
              "sh" )
                echo "installing with sh..."
                sh "$2"
                ;;
              *)
                echo "Unknown filetype: $1"
                report_bug
                exit 1
                ;;
            esac
            if test $? -ne 0; then
              echo "Installation failed"
              report_bug
              exit 1
            fi
          }

          if test "x$TMPDIR" = "x"; then
            tmp="/tmp"
          else
            tmp=$TMPDIR
          fi
          # secure-ish temp dir creation without having mktemp available (DDoS-able but not expliotable)
          tmp_dir="$tmp/install.sh.$$"
          (umask 077 && mkdir $tmp_dir) || exit 1

          ############
          # end of helpers.sh
          ############


          project=chef
          version=12.13.12+20160723192537
          channel=unstable


          # platform_detection.sh
          ############
          # This section makes platform detection compatible with omnitruck on the system
          #   it runs.
          #
          # Outputs:
          # $platform: Name of the platform.
          # $platform_version: Version of the platform.
          # $machine: System's architecture.
          ############

          #
          # Platform and Platform Version detection
          #
          # NOTE: This should now match ohai platform and platform_version matching.
          # do not invented new platform and platform_version schemas, just make this behave
          # like what ohai returns as platform and platform_version for the server.
          #
          # ALSO NOTE: Do not mangle platform or platform_version here.  It is less error
          # prone and more future-proof to do that in the server, and then all omnitruck clients
          # will 'inherit' the changes (install.sh is not the only client of the omnitruck
          # endpoint out there).
          #

          machine=`uname -m`
          os=`uname -s`

          if test -f "/etc/lsb-release" && grep -q DISTRIB_ID /etc/lsb-release && ! grep -q wrlinux /etc/lsb-release; then
            platform=`grep DISTRIB_ID /etc/lsb-release | cut -d "=" -f 2 | tr '[A-Z]' '[a-z]'`
            platform_version=`grep DISTRIB_RELEASE /etc/lsb-release | cut -d "=" -f 2`
          elif test -f "/etc/debian_version"; then
            platform="debian"
            platform_version=`cat /etc/debian_version`
          elif test -f "/etc/redhat-release"; then
            platform=`sed 's/^\(.\+\) release.*/\1/' /etc/redhat-release | tr '[A-Z]' '[a-z]'`
            platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/redhat-release`

            # If /etc/redhat-release exists, we act like RHEL by default
            if test "$platform" = "fedora"; then
              # FIXME: stop remapping fedora to el
              # FIXME: remove client side platform_version mangling and hard coded yolo
              # Change platform version for use below.
              platform_version="6.0"
            fi

            if test "$platform" = "xenserver"; then
              # Current XenServer 6.2 is based on CentOS 5, platform is not reset to "el" server should hanlde response
              platform="xenserver"
            else
              # FIXME: use "redhat"
              platform="el"
            fi

          elif test -f "/etc/system-release"; then
            platform=`sed 's/^\(.\+\) release.\+/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
            platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
            # amazon is built off of fedora, so act like RHEL
            if test "$platform" = "amazon linux ami"; then
              # FIXME: remove client side platform_version mangling and hard coded yolo, and remapping to deprecated "el"
              platform="el"
              platform_version="6.0"
            fi
          # Apple OS X
          elif test -f "/usr/bin/sw_vers"; then
            platform="mac_os_x"
            # Matching the tab-space with sed is error-prone
            platform_version=`sw_vers | awk '/^ProductVersion:/ { print $2 }' | cut -d. -f1,2`

            # x86_64 Apple hardware often runs 32-bit kernels (see OHAI-63)
            x86_64=`sysctl -n hw.optional.x86_64`
            if test $x86_64 -eq 1; then
              machine="x86_64"
            fi
          elif test -f "/etc/release"; then
            machine=`/usr/bin/uname -p`
            if grep -q SmartOS /etc/release; then
              platform="smartos"
              platform_version=`grep ^Image /etc/product | awk '{ print $3 }'`
            else
              platform="solaris2"
              platform_version=`/usr/bin/uname -r`
            fi
          elif test -f "/etc/SuSE-release"; then
            if grep -q 'Enterprise' /etc/SuSE-release;
            then
                platform="sles"
                platform_version=`awk '/^VERSION/ {V = $3}; /^PATCHLEVEL/ {P = $3}; END {print V "." P}' /etc/SuSE-release`
            else
                platform="suse"
                platform_version=`awk '/^VERSION =/ { print $3 }' /etc/SuSE-release`
            fi
          elif test "x$os" = "xFreeBSD"; then
            platform="freebsd"
            platform_version=`uname -r | sed 's/-.*//'`
          elif test "x$os" = "xAIX"; then
            platform="aix"
            platform_version="`uname -v`.`uname -r`"
            machine="powerpc"
          elif test -f "/etc/os-release"; then
            . /etc/os-release
            if test "x$CISCO_RELEASE_INFO" != "x"; then
              . $CISCO_RELEASE_INFO
            fi

            platform=$ID
            platform_version=$VERSION
          fi

          if test "x$platform" = "x"; then
            echo "Unable to determine platform version!"
            report_bug
            exit 1
          fi

          #
          # NOTE: platform manging in the install.sh is DEPRECATED
          #
          # - install.sh should be true to ohai and should not remap
          #   platform or platform versions.
          #
          # - remapping platform and mangling platform version numbers is
          #   now the complete responsibility of the server-side endpoints
          #

          major_version=`echo $platform_version | cut -d. -f1`
          case $platform in
            # FIXME: should remove this case statement completely
            "el")
              # FIXME:  "el" is deprecated, should use "redhat"
              platform_version=$major_version
              ;;
            "debian")
              if test "x$major_version" = "x5"; then
                # This is here for potential back-compat.
                # We do not have 5 in versions we publish for anymore but we
                # might have it for earlier versions.
                platform_version="6"
              else
                platform_version=$major_version
              fi
              ;;
            "freebsd")
              platform_version=$major_version
              ;;
            "sles")
              platform_version=$major_version
              ;;
            "suse")
              platform_version=$major_version
              ;;
          esac

          # normalize the architecture we detected
          case $machine in
            "x86_64"|"amd64"|"x64")
              machine="x86_64"
              ;;
            "i386"|"i86pc"|"x86"|"i686")
              machine="i386"
              ;;
            "sparc"|"sun4u"|"sun4v")
              machine="sparc"
              ;;
          esac

          if test "x$platform_version" = "x"; then
            echo "Unable to determine platform version!"
            report_bug
            exit 1
          fi

          if test "x$platform" = "xsolaris2"; then
            # hack up the path on Solaris to find wget, pkgadd
            PATH=/usr/sfw/bin:/usr/sbin:$PATH
            export PATH
          fi

          echo "$platform $platform_version $machine"

          ############
          # end of platform_detection.sh
          ############


          # artifactory_urls.sh
          ############
          # This section sets up the information for a build to be installed from artifactory
          #  then uses $platform, $platform_version and $machine to select the correct
          #  version.
          #
          # Inputs:
          # $platform:
          # $platform_version:
          # $machine:
          #
          # Outputs:
          # $download_url:
          # $sha256:
          ############


            artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/ppc64le"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_ppc64el.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 6932cbc2f8e10d1cc419b3cb7fe37faac34a6ffde48d476b61952e8008bce6e4" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.9/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.9/chef-12.13.12+20160723192537-1.dmg" >> "$artifact_info_dir/artifact_info"
            echo "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.10/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.10/chef-12.13.12+20160723192537-1.dmg" >> "$artifact_info_dir/artifact_info"
            echo "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.11/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.11/chef-12.13.12+20160723192537-1.dmg" >> "$artifact_info_dir/artifact_info"
            echo "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/ios_xr/6/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ios_xr/6/chef-12.13.12+20160723192537-1.ios_xr6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 ea052ef6ce24d4011a6646c8baaf3cea35a96ae50c41a74e1e739883806523f5" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.i386.sh" >> "$artifact_info_dir/artifact_info"
            echo "sha256 e092cd2b7dadabb4d5adcfedbb9c69c7feb5054bcd4eec09f96c3e5a187e4980" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/6/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_i386.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/7/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_i386.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/8/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_i386.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/nexus/7/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/nexus/7/chef-12.13.12+20160723192537-1.nexus7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 ab5924a4030a6ceb59fa4b6adc0badef93ffac19dedc25d9b4a0371c8e88cd16" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.i386.sh" >> "$artifact_info_dir/artifact_info"
            echo "sha256 2337c9357c6c02c95b452911b6d90bef5f46d38a4834bf1fc7767921b509aeeb" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_i386.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_i386.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
            echo "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/5/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.i386.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 9ca5b61b622b258a6cb4a7f307351e9bf5befba2667363cfa0a9d708dcd5448c" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
            echo "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/6/i686"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.i386.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 2ab9174446289559390e6ffcb3cfec30f8db0af2d7012b55f1d432d529c86741" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 5c018264cf2db515a82c96f38456bc8b0dfca38ddb7a408f16aa64b2dd978011" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64le"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64le.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 9a6712bca35e025223ed27fb40e33d353f164a2131fdd3a304737a7c3dc726e7" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x86.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/amd64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
            echo "sha256 34f6d18d74365dc821e8d951ba595a775a5ae93ab7aa423d388d53825cb971c7" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/5/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 4d3108d25e015571d598d344dfd5b280b5bb5310e40a2fd0642a30b0b3803d3c" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/6/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/7/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/debian/8/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
            echo "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2012/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x86.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/amd64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
            echo "sha256 2aef7e8fc16cc35aec6dcafcd9f64e63aa5af4d1b845a37c7e0aa44b830435d6" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/i386"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x86.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/6/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 8973f19860d1b7f9111d4fcac2ef3b43d1b817ba7a6a2465a202d87839c1a3dd" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x64.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2012/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x64.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x64.msi" >> "$artifact_info_dir/artifact_info"
            echo "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/aix/6.1/powerpc"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/6.1/chef-12.13.12+20160723192537-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
            echo "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/aix/7.1/powerpc"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/7.1/chef-12.13.12+20160723192537-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
            echo "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/el/7/x86_64"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
            echo "sha256 ab9507cf0bf779a919182cd2559e02d2dd6ca12c7d22ba9cb56717a5757eb0a6" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/sparc"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
            echo "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" >> "$artifact_info_dir/artifact_info"

            artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/sparc"
            mkdir -p $artifact_info_dir
            touch "$artifact_info_dir/artifact_info"
            echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
            echo "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" >> "$artifact_info_dir/artifact_info"


          artifact_info_for_platform="$tmp_dir/artifact_info/$platform/$platform_version/$machine/artifact_info"

          download_url=`awk '$1 == "url" { print $2 }' "$artifact_info_for_platform"`
          sha256=`awk '$1 == "sha256" { print $2 }' "$artifact_info_for_platform"`


          # fetch_package.sh
          ############
          # This section fetchs a package from $download_url and verifies its metadata.
          #
          # Inputs:
          # $download_url:
          # $tmp_dir:
          # Optional Inputs:
          # $cmdline_filename: Name of the package downloaded on local disk.
          # $cmdline_dl_dir: Name of the directory downloaded package will be saved to on local disk.
          #
          # Outputs:
          # $download_filename: Name of the downloaded file on local disk.
          # $filetype: Type of the file downloaded.
          ############

          filename=`echo $download_url | sed -e 's/^.*\///'`
          filetype=`echo $filename | sed -e 's/^.*\.//'`

          # use either $tmp_dir, the provided directory (-d) or the provided filename (-f)
          if test "x$cmdline_filename" != "x"; then
            download_filename="$cmdline_filename"
          elif test "x$cmdline_dl_dir" != "x"; then
            download_filename="$cmdline_dl_dir/$filename"
          else
            download_filename="$tmp_dir/$filename"
          fi

          # ensure the parent directory where to download the installer always exists
          download_dir=`dirname $download_filename`
          (umask 077 && mkdir -p $download_dir) || exit 1

          # check if we have that file locally available and if so verify the checksum
          cached_file_available="false"
          if test -f $download_filename; then
            echo "$download_filename already exists, verifiying checksum..."
            if do_checksum "$download_filename" "$sha256"; then
              echo "checksum compare succeeded, using existing file!"
              cached_file_available="true"
            else
              echo "checksum mismatch, downloading latest version of the file"
            fi
          fi

          # download if no local version of the file available
          if test "x$cached_file_available" != "xtrue"; then
            do_download "$download_url"  "$download_filename"
            do_checksum "$download_filename" "$sha256" || checksum_mismatch
          fi

          ############
          # end of fetch_package.sh
          ############


          # install_package.sh
          ############
          # Installs a package and removed the temp directory.
          #
          # Inputs:
          # $download_filename: Name of the file to be installed.
          # $filetype: Type of the file to be installed.
          # $version: The version requested. Used only for warning user if not set.
          ############

          if test "x$version" = "x"; then
            echo
            echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
            echo
            echo "You are installing an omnibus package without a version pin.  If you are installing"
            echo "on production servers via an automated process this is DANGEROUS and you will"
            echo "be upgraded without warning on new releases, even to new major releases."
            echo "Letting the version float is only appropriate in desktop, test, development or"
            echo "CI/CD environments."
            echo
            echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
            echo
          fi

          install_file $filetype "$download_filename"

          if test "x$tmp_dir" != "x"; then
            rm -r "$tmp_dir"
          fi

          ############
          # end of install_package.sh
          ############

          EOL
          chmod +x /tmp/chef-installer.sh
          sudo -E /tmp/chef-installer.sh)
                 el 6 x86_64
                 bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 /bin/bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 el 6 x86_64
          D      Console output: ---
          2016/07/23 20:03:06Z: EC2ConfigMonitorState: 0
          2016/07/23 20:03:07Z: Windows sysprep configuration complete.
          2016/07/23 20:03:13Z: AMI Origin Version: 2016.07.13
          2016/07/23 20:03:13Z: AMI Origin Name: Windows_Server-2012-R2_RTM-English-64Bit-Base
          2016/07/23 20:03:13Z: OS: Microsoft Windows NT 6.3.9600
          2016/07/23 20:03:13Z: OsVersion: 6.3
          2016/07/23 20:03:13Z: OsProductName: Windows Server 2012 R2 Standard
          2016/07/23 20:03:13Z: OsBuildLabEx: 9600.18289.amd64fre.winblue_ltsb.160328-1315
          2016/07/23 20:03:13Z: Language: en-US
          2016/07/23 20:03:13Z: TimeZone: Coordinated Universal Time
          2016/07/23 20:03:13Z: Offset: UTC 00:00:00
          2016/07/23 20:03:13Z: EC2 Agent: Ec2Config service v3.17.1032
          2016/07/23 20:03:16Z: Message: Waiting for meta-data accessibility...
          2016/07/23 20:03:16Z: Message: Meta-data is now available.
          2016/07/23 20:03:17Z: AMI-ID: ami-26e72546
          2016/07/23 20:03:17Z: Instance-ID: i-17ed6fb8
          2016/07/23 20:03:17Z: Driver: AWS PV Network Device v7.4.2.0
          2016/07/23 20:03:17Z: Driver: AWS PV Storage Host Adapter v7.4.2.0
          2016/07/23 20:03:17Z: Ec2SetPassword: Enabled
          2016/07/23 20:03:18Z: RDPCERTIFICATE-SUBJECTNAME: WIN-MU4RSEFO55P
          2016/07/23 20:03:18Z: RDPCERTIFICATE-THUMBPRINT: A3D8AB370D04DAD6097A324EBF1E936CCE389A46
          2016/07/23 20:03:20Z: Username: Administrator
          2016/07/23 20:03:21Z: Password: <Password>
          EkBjMyQpx67YRje3eha49wPnP9CRoaKJp8YMGOrhiTbt5vFTK/MPZgy7l17yFzd3tvZIoul8hF1RS+f7DtLXdfxCCFHME2g9ObsR4zdKcqCvtnWqLuPoN0RYzYJeMSRXGXzNCs8PngDqZh4233KMxtVWgZrhGkjTgiEszB8PNaJNuuFD5v12PKR4b3/ExXLN3ddmfSYKv9Y/KgAevwqvYxK77rHHG0TgSNSBfocMP+aZ4P2pTVdJ2yp1/p3pwsUobaMB4tp8uyrP1Q5KcENoQTadhdmUvSwYe5+6jn2kEiua8+2QJYyiS3XfIdiLHOmKxZtSbEGNTNsKUWYd+ewuLw==
          </Password>
          2016/07/23 20:03:22Z: Message: Windows is Ready to use

                 Waited 0/300s for instance <i-17ed6fb8> to fetch windows admin password.
                 downloading http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.x86_64.rpm
                   to file /tmp/install.sh.959/chef-12.13.12+20160723192537-1.el6.x86_64.rpm
                 trying curl...
                 downloading http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.x86_64.rpm
                   to file /tmp/install.sh.957/chef-12.13.12+20160723192537-1.el6.x86_64.rpm
                 trying curl...
                 Waited 95/300s for instance <i-b7f27018> to become ready.
                 Retrieved Windows password for instance <i-17ed6fb8>.
                 EC2 instance <i-17ed6fb8> ready.
                 Comparing checksum with sha256sum...
                 Comparing checksum with sha256sum...
          D      Console output: ---
          2016/07/23 20:03:09Z: EC2ConfigMonitorState: 0
          2016/07/23 20:03:09Z: Windows sysprep configuration complete.
          2016/07/23 20:03:13Z: AMI Origin Version: 2016.07.13
          2016/07/23 20:03:13Z: AMI Origin Name: Windows_Server-2012-R2_RTM-English-64Bit-Base
          2016/07/23 20:03:13Z: OS: Microsoft Windows NT 6.3.9600
          2016/07/23 20:03:13Z: OsVersion: 6.3
          2016/07/23 20:03:13Z: OsProductName: Windows Server 2012 R2 Standard
          2016/07/23 20:03:13Z: OsBuildLabEx: 9600.18289.amd64fre.winblue_ltsb.160328-1315
          2016/07/23 20:03:13Z: Language: en-US
          2016/07/23 20:03:13Z: TimeZone: Coordinated Universal Time
          2016/07/23 20:03:13Z: Offset: UTC 00:00:00
          2016/07/23 20:03:13Z: EC2 Agent: Ec2Config service v3.17.1032
          2016/07/23 20:03:15Z: Message: Waiting for meta-data accessibility...
          2016/07/23 20:03:15Z: Message: Meta-data is now available.
          2016/07/23 20:03:16Z: AMI-ID: ami-26e72546
          2016/07/23 20:03:16Z: Instance-ID: i-b7f27018
          2016/07/23 20:03:17Z: Driver: AWS PV Network Device v7.4.2.0
          2016/07/23 20:03:17Z: Driver: AWS PV Storage Host Adapter v7.4.2.0
          2016/07/23 20:03:17Z: Ec2SetPassword: Enabled
          2016/07/23 20:03:17Z: RDPCERTIFICATE-SUBJECTNAME: WIN-1SCD7U6KSV8
          2016/07/23 20:03:17Z: RDPCERTIFICATE-THUMBPRINT: 10598F226480BD88960EE3E15EF66EA525E54FCD
          2016/07/23 20:03:20Z: Username: Administrator
          2016/07/23 20:03:20Z: Password: <Password>
          FUiqNw7jz2esRjS56Mv+9k3WGNSQZjzFtvrc/dar1OciFk5BlqREdA650EgVgZg47rxmUzauWZfyXIDkv+Q6IiUIgqap+ETuvWDBA+dAHdMVq2Z4jXKaNOqYCgL+1rPNpFrVDnFH8kP1JTklPiX43twJBDyv8yvcePJw+1bpbrYjTHEtjbtLMyr8+31YUk1xSFqI+NPkI+JHxjN0L2V6q2zHhjtggNB1vuH0tPSmdSj2yj0L4yzzJORItLrNdduWLTd57jzeXeqkGhEwoYSJ2mOd/hLN576Ve7awB0dkm19arq5Z450ilR6VB97djr9CrTQ92TZlwLVuiMZaq+zcEg==
          </Password>
          2016/07/23 20:03:21Z: Message: Windows is Ready to use

                 Waited 0/300s for instance <i-b7f27018> to fetch windows admin password.
                 Installing chef 12.13.12+20160723192537
                 installing with rpm...
                 warning: /tmp/install.sh.959/chef-12.13.12+20160723192537-1.el6.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID 83ef826a: NOKEY
          D      [WinRM] <{:endpoint=>"http://10.194.14.207:5985/wsman", :user=>"administrator", :password=>"fx;gVH5iv&", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"fx;gVH5iv&", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (Write-Host '[WinRM] Established
          ')
                 Retrieved Windows password for instance <i-b7f27018>.
                 EC2 instance <i-b7f27018> ready.
          D      [WinRM] opening remote shell on http://10.194.14.207:5985/wsman
          D      [WinRM] <{:endpoint=>"http://10.194.8.230:5985/wsman", :user=>"administrator", :password=>"Ep)GS4mK2cs", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"Ep)GS4mK2cs", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (Write-Host '[WinRM] Established
          ')
          D      [WinRM] opening remote shell on http://10.194.8.230:5985/wsman
                 Installing chef 12.13.12+20160723192537
                 installing with rpm...
                 warning: /tmp/install.sh.957/chef-12.13.12+20160723192537-1.el6.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID 83ef826a: NOKEY
                 Preparing...                                                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                 Preparing...                                                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                    1:chef                                                               (  1%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (  3%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (  6%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (  8%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        ( 10%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       ( 13%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      ( 15%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     ( 17%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    ( 19%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   ( 22%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  ( 24%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 ( 26%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                ( 28%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               ( 31%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              ( 33%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             ( 35%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            ( 38%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           ( 40%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          ( 42%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         ( 44%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        ( 47%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       ( 49%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      ( 51%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     ( 53%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    ( 56%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   ( 58%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  ( 60%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 ( 63%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                ( 65%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               ( 67%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              ( 69%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             ( 72%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            ( 74%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           ( 76%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          ( 78%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         ( 81%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        ( 83%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       ( 85%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      ( 88%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     ( 90%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    ( 92%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   ( 94%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  ( 97%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### ( 99%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                    1:chef                                                               (  1%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (  3%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (  6%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (  8%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        ( 10%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       ( 13%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      ( 15%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     ( 17%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    ( 19%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   ( 22%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  ( 24%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 ( 26%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                ( 28%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               ( 31%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              ( 33%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             ( 35%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            ( 38%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           ( 40%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          ( 42%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         ( 44%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        ( 47%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       ( 49%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      ( 51%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     ( 53%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    ( 56%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   ( 58%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  ( 60%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 ( 63%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                ( 65%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               ( 67%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              ( 69%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             ( 72%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            ( 74%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           ( 76%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          ( 78%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         ( 81%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        ( 83%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       ( 85%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      ( 88%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     ( 90%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    ( 92%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   ( 94%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  ( 97%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### ( 99%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                 /bin/sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 Thank you for installing Chef!
          D      [SSH] root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
          sudo_rm="sudo -E rm"
          dirs="/tmp/kitchen/clients /tmp/kitchen/cookbooks /tmp/kitchen/data /tmp/kitchen/data_bags /tmp/kitchen/encrypted_data_bag_secret /tmp/kitchen/environments /tmp/kitchen/roles"
          root_path="/tmp/kitchen"

          $sudo_rm -rf $dirs
          mkdir -p $root_path
          ')
                 bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 Transferring files to <fips-unit-functional-centos-6>
          D      TIMING: scp async upload (Kitchen::Transport::Ssh)
                 /bin/sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
          D      TIMING: scp async upload (Kitchen::Transport::Ssh) took (0m0.12s)
          D      Transfer complete
          D      Attempting to execute command - try 1 of 1.
          D      [SSH] root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
          sudo -E /opt/chef/bin/chef-client --local-mode --config /tmp/kitchen/client.rb --log_level auto --force-formatter --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889
          ')
                 bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 Thank you for installing Chef!
          D      [SSH] root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
          sudo_rm="sudo -E rm"
          dirs="/tmp/kitchen/clients /tmp/kitchen/cookbooks /tmp/kitchen/data /tmp/kitchen/data_bags /tmp/kitchen/encrypted_data_bag_secret /tmp/kitchen/environments /tmp/kitchen/roles"
          root_path="/tmp/kitchen"

          $sudo_rm -rf $dirs
          mkdir -p $root_path
          ')
                 bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 Transferring files to <fips-integration-centos-6>
          D      TIMING: scp async upload (Kitchen::Transport::Ssh)
          D      TIMING: scp async upload (Kitchen::Transport::Ssh) took (0m0.16s)
          D      Transfer complete
          D      Attempting to execute command - try 1 of 1.
          D      [SSH] root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
          sudo -E /opt/chef/bin/chef-client --local-mode --config /tmp/kitchen/client.rb --log_level auto --force-formatter --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889
          ')
                 bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                 Starting Chef Client, version 12.13.12
                 Starting Chef Client, version 12.13.12
                 Creating a new client identity for fips-unit-functional-centos-6 using the validator key.
                 resolving cookbooks for run list: []
                 Synchronizing Cookbooks:
                 Installing Cookbook Gems:
                 Compiling Cookbooks...
                 [2016-07-23T20:03:37+00:00] WARN: Node fips-unit-functional-centos-6 has an empty run list.
                 Converging 0 resources
                 Starting audit phase
                 Creating a new client identity for fips-integration-centos-6 using the validator key.

                 Finished in 0.0003 seconds (files took 0.37226 seconds to load)
                 0 examples, 0 failures
                 Auditing complete

                 Running handlers:
                 Running handlers complete
                 Chef Client finished, 0/0 resources updated in 03 seconds
                 [2016-07-23T20:03:37+00:00] ERROR: Failed to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json
                 resolving cookbooks for run list: []
                 Synchronizing Cookbooks:
                 Installing Cookbook Gems:
                 Compiling Cookbooks...
                 [2016-07-23T20:03:37+00:00] WARN: Node fips-integration-centos-6 has an empty run list.
                 Converging 0 resources
                 Starting audit phase

                 Finished in 0.00035 seconds (files took 0.39255 seconds to load)
                 0 examples, 0 failures
                 Auditing complete

                 Running handlers:
                 Running handlers complete
                 Chef Client finished, 0/0 resources updated in 03 seconds
                 [2016-07-23T20:03:38+00:00] ERROR: Failed to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json
          D      Cleaning up local sandbox in /tmp/cheftest/fips-unit-functional-centos-6-sandbox-20160723-30984-8jysl2
                 Finished converging <fips-unit-functional-centos-6> (0m12.17s).
          D      [SSH] shutting previous connection root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
          D      [SSH] closing connection to root@10.194.8.73<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
          D      Cleaning up local sandbox in /tmp/cheftest/fips-integration-centos-6-sandbox-20160723-30984-25mg7f
                 Finished converging <fips-integration-centos-6> (0m12.67s).
          D      [SSH] shutting previous connection root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
          D      [SSH] closing connection to root@10.194.11.242<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000003272d08 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.2</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000002bab768 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">2.0</Version></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version></LST></Obj></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">6.3.9600.17400</Version></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.2</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000004b15b30 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
          D      [WinRM] remote shell created with shell_id: B3CB91B4-00B5-4896-B5AB-F0D806AFE763
          D      [WinRM] Command created for Write-Host '[WinRM] Established
          ' with id: 69262413-50C7-4BE6-8427-16757A2DACB2
          D      [WinRM] creating command_id: 69262413-50C7-4BE6-8427-16757A2DACB2 on shell_id B3CB91B4-00B5-4896-B5AB-F0D806AFE763
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
                 [WinRM] Established

          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 69262413-50C7-4BE6-8427-16757A2DACB2 on shell_id B3CB91B4-00B5-4896-B5AB-F0D806AFE763
          D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.14.207:5985/wsman", :user=>"administrator", :password=>"fx;gVH5iv&", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"fx;gVH5iv&", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
          D      [WinRM] <{:endpoint=>"http://10.194.14.207:5985/wsman", :user=>"administrator", :password=>"fx;gVH5iv&", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"fx;gVH5iv&", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File)
          D      [WinRM] Command created for New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File with id: 9A547395-7C79-4AAB-898C-D143C3100F5F
          D      [WinRM] creating command_id: 9A547395-7C79-4AAB-898C-D143C3100F5F on shell_id B3CB91B4-00B5-4896-B5AB-F0D806AFE763
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output


                     Directory: C:\chef\ohai\hints


                 Mode                LastWriteTime     Length Name
                 ----                -------------     ------ ----
                 -a---         7/23/2016   8:03 PM          0 ec2.json


          D      [WinRM] cleaning up command_id: 9A547395-7C79-4AAB-898C-D143C3100F5F on shell_id B3CB91B4-00B5-4896-B5AB-F0D806AFE763
          D      ec2:create '10.194.14.207'
                 Finished creating <fips-integration-windows-2012r2> (2m9.99s).
          -----> Converging <fips-integration-windows-2012r2>...
                 Preparing files for transfer
          D      Creating local sandbox in /tmp/cheftest/fips-integration-windows-2012r2-sandbox-20160723-30984-lqqq2o
                 Preparing dna.json
          D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                 Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                 Removing non-cookbook files before transfer
                 Preparing validation.pem
          D      Using a dummy validation.pem
                 Preparing client.rb
          D      Creating client.rb from {:node_name=>"fips-integration-windows-2012r2", :checksum_path=>"\#{ENV['TEMP']}\\kitchen\\checksums", :file_cache_path=>"\#{ENV['TEMP']}\\kitchen\\cache", :file_backup_path=>"\#{ENV['TEMP']}\\kitchen\\backup", :cookbook_path=>["\#{ENV['TEMP']}\\kitchen\\cookbooks", "\#{ENV['TEMP']}\\kitchen\\site-cookbooks"], :data_bag_path=>"\#{ENV['TEMP']}\\kitchen\\data_bags", :environment_path=>"\#{ENV['TEMP']}\\kitchen\\environments", :node_path=>"\#{ENV['TEMP']}\\kitchen\\nodes", :role_path=>"\#{ENV['TEMP']}\\kitchen\\roles", :client_path=>"\#{ENV['TEMP']}\\kitchen\\clients", :user_path=>"\#{ENV['TEMP']}\\kitchen\\users", :validation_key=>"\#{ENV['TEMP']}\\kitchen\\validation.pem", :client_key=>"\#{ENV['TEMP']}\\kitchen\\client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"\#{ENV['TEMP']}\\kitchen\\encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
          D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.14.207:5985/wsman", :user=>"administrator", :password=>"fx;gVH5iv&", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"fx;gVH5iv&", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
          D      [WinRM] <{:endpoint=>"http://10.194.14.207:5985/wsman", :user=>"administrator", :password=>"fx;gVH5iv&", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"fx;gVH5iv&", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (new-module -name Omnitruck -scriptblock {
          function Get-PlatformVersion {
            switch -regex ((get-wmiobject win32_operatingsystem).version) {
              '10\.0\.\d+' {$platform_version = '2012r2'}
              '6\.3\.\d+'  {$platform_version = '2012r2'}
              '6\.2\.\d+'  {$platform_version = '2012'}
              '6\.1\.\d+'  {$platform_version = '2008r2'}
              '6\.0\.\d+'  {$platform_version = '2008'}
            }
            return $platform_version
          }

          function Get-PlatformArchitecture {
            if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
              $architecture = 'x86_64'
            } else {
              $architecture = 'i386'
            }
            return $architecture
          }

          function New-Uri {
            param ($baseuri, $newuri)

            try {
            new-object System.Uri $baseuri, $newuri
            }
            catch [System.Management.Automation.MethodInvocationException]{
              Write-Error "$($_.exception.message)"
              throw $_.exception
            }
          }

          function Get-WebContent {
            param ($uri, $filepath)
            $proxy = New-Object -TypeName System.Net.WebProxy
            $wc = new-object System.Net.WebClient
            $proxy.Address = $env:http_proxy
            $wc.Proxy = $proxy

            try {
              if ([string]::IsNullOrEmpty($filepath)) {
                $wc.downloadstring($uri)
              }
              else {
                $wc.downloadfile($uri, $filepath)
              }
            }
            catch {
              $exception = $_.Exception
              Write-Host "There was an error: "
              do {
                Write-Host "`t$($exception.message)"
                $exception = $exception.innerexception
              } while ($exception)
              throw "Failed to download from $uri."
            }
          }

          function Test-ProjectPackage {
            [cmdletbinding()]
            param ($Path, $Algorithm = 'SHA256', $Hash)

            if (-not (get-command get-filehash))   {
              function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
              function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
              function Get-FileHash ($Path, $Algorithm) {
                $Path = (resolve-path $path).providerpath
                $hash = @{Algorithm = $Algorithm; Path = $Path}
                use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                  use ($in = (gi $path).OpenRead()) {
                    $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                  }
                }
                new-object PSObject -Property $hash
              }
            }
            Write-Verbose "Testing the $Algorithm hash for $path."
            $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
            Write-Verbose "`tDesired Hash - '$hash'"
            Write-Verbose "`tActual Hash  - '$ActualHash'"
            $Valid = $ActualHash -eq $Hash
            if (-not $Valid) {
              Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
            }
            return $Valid
          }

          function Get-ProjectMetadata {
            <#
              .SYNOPSIS
              Get metadata for a Chef Software, Inc. project
              .DESCRIPTION
              Get metadata for project
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

              Gets the download url and SHA256 checksum for the latest stable release of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

              Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
            #>
            [cmdletbinding()]
            param (
              # Base url to retrieve metadata from.
              [uri]$base_server_uri = 'https://omnitruck.chef.io/',
              [string]
              # Project to install
              [string]
              $project = 'chef',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Release channel to install from
              $channel = 'unstable',
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            # PowerShell is only on Windows ATM
            $platform = 'windows'
            Write-Verbose "Platform: $platform"

            $platform_version = Get-PlatformVersion
            Write-Verbose "Platform Version: $platform_version"

            if ($architecture -eq 'auto') {
              $architecture = Get-PlatformArchitecture
            }

            Write-Verbose "Architecture: $architecture"
            Write-Verbose "Project: $project"


              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 6932cbc2f8e10d1cc419b3cb7fe37faac34a6ffde48d476b61952e8008bce6e4" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.9/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.10/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.11/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ios_xr/6/chef-12.13.12+20160723192537-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ea052ef6ce24d4011a6646c8baaf3cea35a96ae50c41a74e1e739883806523f5" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 e092cd2b7dadabb4d5adcfedbb9c69c7feb5054bcd4eec09f96c3e5a187e4980" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/nexus/7/chef-12.13.12+20160723192537-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ab5924a4030a6ceb59fa4b6adc0badef93ffac19dedc25d9b4a0371c8e88cd16" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2337c9357c6c02c95b452911b6d90bef5f46d38a4834bf1fc7767921b509aeeb" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 9ca5b61b622b258a6cb4a7f307351e9bf5befba2667363cfa0a9d708dcd5448c" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2ab9174446289559390e6ffcb3cfec30f8db0af2d7012b55f1d432d529c86741" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 5c018264cf2db515a82c96f38456bc8b0dfca38ddb7a408f16aa64b2dd978011" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 9a6712bca35e025223ed27fb40e33d353f164a2131fdd3a304737a7c3dc726e7" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 34f6d18d74365dc821e8d951ba595a775a5ae93ab7aa423d388d53825cb971c7" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4d3108d25e015571d598d344dfd5b280b5bb5310e40a2fd0642a30b0b3803d3c" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2aef7e8fc16cc35aec6dcafcd9f64e63aa5af4d1b845a37c7e0aa44b830435d6" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8973f19860d1b7f9111d4fcac2ef3b43d1b817ba7a6a2465a202d87839c1a3dd" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/6.1/chef-12.13.12+20160723192537-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
              "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/7.1/chef-12.13.12+20160723192537-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
              "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ab9507cf0bf779a919182cd2559e02d2dd6ca12c7d22ba9cb56717a5757eb0a6" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" | out-file "$artifact_info_dir/artifact_info" -Append


            $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

            $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
              foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

            Write-Verbose "Project details: "
            foreach ($key in $package_metadata.keys) {
              Write-Verbose "`t$key = $($package_metadata[$key])"
            }
            $package_metadata
          }

          function Install-Project {
            <#
              .SYNOPSIS
              Install a Chef Software, Inc. product
              .DESCRIPTION
              Install a Chef Software, Inc. product
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

              Installs the latest stable version of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

              Installs the latest integration build of the Chef Development Kit
            #>
            [cmdletbinding(SupportsShouldProcess=$true)]
            param (
              # Project to install
              [string]
              $project = 'chef',
              # Release channel to install from
              [validateset('current', 'stable', 'unstable')]
              [string]
              $channel = 'stable',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Full path for the downloaded installer.
              [string]
              $filename,
              # Full path to the location to download the installer
              [string]
              $download_directory = $env:temp,
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

            if (-not [string]::IsNullOrEmpty($filename)) {
              $download_directory = split-path $filename
              $filename = split-path $filename -leaf
              if ([string]::IsNullOrEmpty($download_directory)) {
                $download_directory = $pwd
              }
            }
            else {
              $filename = ($package_metadata.url -split '/')[-1]
            }
            Write-Verbose "Download directory: $download_directory"
            Write-Verbose "Filename: $filename"

            if (-not (test-path $download_directory)) {
              mkdir $download_directory
            }
            $download_directory = (resolve-path $download_directory).providerpath
            $download_destination = join-path $download_directory $filename

            if ((test-path $download_destination) -and
              (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
              Write-Verbose "Found existing valid installer at $download_destination."
            }
            else {
              if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                Get-WebContent $package_metadata.url -filepath $download_destination
              }
            }

            if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
              if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                Write-Host "Installing $project from $download_destination"
                $installingProject = $True
                $installAttempts = 0
                while ($installingProject) {
                  $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                  $p.WaitForExit()
                  if ($p.ExitCode -eq 1618) {
                    Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                    continue
                  } elseif ($p.ExitCode -ne 0) {
                    throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                  }
                  $installingProject = $False
                }
              }
              else {
                throw "Failed to validate the downloaded installer for $project."
              }
            }
          }
          set-alias install -value Install-Project
          export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

          }

          install -project chef -version 12.13.12+20160723192537 -channel unstable
          )
          D      [WinRM] Command created for new-module -name Omnitruck -scriptblock {
          function Get-PlatformVersion {
            switch -regex ((get-wmiobject win32_operatingsystem).version) {
              '10\.0\.\d+' {$platform_version = '2012r2'}
              '6\.3\.\d+'  {$platform_version = '2012r2'}
              '6\.2\.\d+'  {$platform_version = '2012'}
              '6\.1\.\d+'  {$platform_version = '2008r2'}
              '6\.0\.\d+'  {$platform_version = '2008'}
            }
            return $platform_version
          }

          function Get-PlatformArchitecture {
            if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
              $architecture = 'x86_64'
            } else {
              $architecture = 'i386'
            }
            return $architecture
          }

          function New-Uri {
            param ($baseuri, $newuri)

            try {
            new-object System.Uri $baseuri, $newuri
            }
            catch [System.Management.Automation.MethodInvocationException]{
              Write-Error "$($_.exception.message)"
              throw $_.exception
            }
          }

          function Get-WebContent {
            param ($uri, $filepath)
            $proxy = New-Object -TypeName System.Net.WebProxy
            $wc = new-object System.Net.WebClient
            $proxy.Address = $env:http_proxy
            $wc.Proxy = $proxy

            try {
              if ([string]::IsNullOrEmpty($filepath)) {
                $wc.downloadstring($uri)
              }
              else {
                $wc.downloadfile($uri, $filepath)
              }
            }
            catch {
              $exception = $_.Exception
              Write-Host "There was an error: "
              do {
                Write-Host "`t$($exception.message)"
                $exception = $exception.innerexception
              } while ($exception)
              throw "Failed to download from $uri."
            }
          }

          function Test-ProjectPackage {
            [cmdletbinding()]
            param ($Path, $Algorithm = 'SHA256', $Hash)

            if (-not (get-command get-filehash))   {
              function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
              function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
              function Get-FileHash ($Path, $Algorithm) {
                $Path = (resolve-path $path).providerpath
                $hash = @{Algorithm = $Algorithm; Path = $Path}
                use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                  use ($in = (gi $path).OpenRead()) {
                    $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                  }
                }
                new-object PSObject -Property $hash
              }
            }
            Write-Verbose "Testing the $Algorithm hash for $path."
            $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
            Write-Verbose "`tDesired Hash - '$hash'"
            Write-Verbose "`tActual Hash  - '$ActualHash'"
            $Valid = $ActualHash -eq $Hash
            if (-not $Valid) {
              Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
            }
            return $Valid
          }

          function Get-ProjectMetadata {
            <#
              .SYNOPSIS
              Get metadata for a Chef Software, Inc. project
              .DESCRIPTION
              Get metadata for project
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

              Gets the download url and SHA256 checksum for the latest stable release of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

              Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
            #>
            [cmdletbinding()]
            param (
              # Base url to retrieve metadata from.
              [uri]$base_server_uri = 'https://omnitruck.chef.io/',
              [string]
              # Project to install
              [string]
              $project = 'chef',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Release channel to install from
              $channel = 'unstable',
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            # PowerShell is only on Windows ATM
            $platform = 'windows'
            Write-Verbose "Platform: $platform"

            $platform_version = Get-PlatformVersion
            Write-Verbose "Platform Version: $platform_version"

            if ($architecture -eq 'auto') {
              $architecture = Get-PlatformArchitecture
            }

            Write-Verbose "Architecture: $architecture"
            Write-Verbose "Project: $project"


              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 6932cbc2f8e10d1cc419b3cb7fe37faac34a6ffde48d476b61952e8008bce6e4" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.9/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.10/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.11/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ios_xr/6/chef-12.13.12+20160723192537-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ea052ef6ce24d4011a6646c8baaf3cea35a96ae50c41a74e1e739883806523f5" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 e092cd2b7dadabb4d5adcfedbb9c69c7feb5054bcd4eec09f96c3e5a187e4980" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/nexus/7/chef-12.13.12+20160723192537-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ab5924a4030a6ceb59fa4b6adc0badef93ffac19dedc25d9b4a0371c8e88cd16" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2337c9357c6c02c95b452911b6d90bef5f46d38a4834bf1fc7767921b509aeeb" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 9ca5b61b622b258a6cb4a7f307351e9bf5befba2667363cfa0a9d708dcd5448c" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2ab9174446289559390e6ffcb3cfec30f8db0af2d7012b55f1d432d529c86741" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 5c018264cf2db515a82c96f38456bc8b0dfca38ddb7a408f16aa64b2dd978011" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 9a6712bca35e025223ed27fb40e33d353f164a2131fdd3a304737a7c3dc726e7" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 34f6d18d74365dc821e8d951ba595a775a5ae93ab7aa423d388d53825cb971c7" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4d3108d25e015571d598d344dfd5b280b5bb5310e40a2fd0642a30b0b3803d3c" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2aef7e8fc16cc35aec6dcafcd9f64e63aa5af4d1b845a37c7e0aa44b830435d6" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8973f19860d1b7f9111d4fcac2ef3b43d1b817ba7a6a2465a202d87839c1a3dd" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/6.1/chef-12.13.12+20160723192537-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
              "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/7.1/chef-12.13.12+20160723192537-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
              "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ab9507cf0bf779a919182cd2559e02d2dd6ca12c7d22ba9cb56717a5757eb0a6" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" | out-file "$artifact_info_dir/artifact_info" -Append


            $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

            $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
              foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

            Write-Verbose "Project details: "
            foreach ($key in $package_metadata.keys) {
              Write-Verbose "`t$key = $($package_metadata[$key])"
            }
            $package_metadata
          }

          function Install-Project {
            <#
              .SYNOPSIS
              Install a Chef Software, Inc. product
              .DESCRIPTION
              Install a Chef Software, Inc. product
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

              Installs the latest stable version of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

              Installs the latest integration build of the Chef Development Kit
            #>
            [cmdletbinding(SupportsShouldProcess=$true)]
            param (
              # Project to install
              [string]
              $project = 'chef',
              # Release channel to install from
              [validateset('current', 'stable', 'unstable')]
              [string]
              $channel = 'stable',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Full path for the downloaded installer.
              [string]
              $filename,
              # Full path to the location to download the installer
              [string]
              $download_directory = $env:temp,
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

            if (-not [string]::IsNullOrEmpty($filename)) {
              $download_directory = split-path $filename
              $filename = split-path $filename -leaf
              if ([string]::IsNullOrEmpty($download_directory)) {
                $download_directory = $pwd
              }
            }
            else {
              $filename = ($package_metadata.url -split '/')[-1]
            }
            Write-Verbose "Download directory: $download_directory"
            Write-Verbose "Filename: $filename"

            if (-not (test-path $download_directory)) {
              mkdir $download_directory
            }
            $download_directory = (resolve-path $download_directory).providerpath
            $download_destination = join-path $download_directory $filename

            if ((test-path $download_destination) -and
              (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
              Write-Verbose "Found existing valid installer at $download_destination."
            }
            else {
              if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                Get-WebContent $package_metadata.url -filepath $download_destination
              }
            }

            if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
              if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                Write-Host "Installing $project from $download_destination"
                $installingProject = $True
                $installAttempts = 0
                while ($installingProject) {
                  $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                  $p.WaitForExit()
                  if ($p.ExitCode -eq 1618) {
                    Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                    continue
                  } elseif ($p.ExitCode -ne 0) {
                    throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                  }
                  $installingProject = $False
                }
              }
              else {
                throw "Failed to validate the downloaded installer for $project."
              }
            }
          }
          set-alias install -value Install-Project
          export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

          }

          install -project chef -version 12.13.12+20160723192537 -channel unstable
           with id: BD5974E4-ADEC-4774-9257-E350B1A7E9B0
          D      [WinRM] creating command_id: BD5974E4-ADEC-4774-9257-E350B1A7E9B0 on shell_id B3CB91B4-00B5-4896-B5AB-F0D806AFE763
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output

                 ModuleType Version    Name                                ExportedCommands
                 ---------- -------    ----                                ----------------
                 Script     0.0        Omnitruck                           {Get-ProjectMetada...
          D      [WinRM] Waiting for output...
          D      [WinRM] Waiting for output...
          D      [WinRM] cleaning up command_id: BD5974E4-ADEC-4774-9257-E350B1A7E9B0 on shell_id B3CB91B4-00B5-4896-B5AB-F0D806AFE763
          D      [WinRM] Processing output
          D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000004606248 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.2</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000000446d260 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">2.0</Version></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version></LST></Obj></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">6.3.9600.17400</Version></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.2</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000000032f8548 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
          D      [WinRM] remote shell created with shell_id: F1D9EB15-C9CB-493D-954B-8DBFA13D40CE
          D      Cleaning up local sandbox in /tmp/cheftest/fips-integration-windows-2012r2-sandbox-20160723-30984-lqqq2o
          D      [WinRM] Command created for Write-Host '[WinRM] Established
          ' with id: 0671FD1E-2BAD-40D7-BE87-84D50A368F52
          D      [WinRM] creating command_id: 0671FD1E-2BAD-40D7-BE87-84D50A368F52 on shell_id F1D9EB15-C9CB-493D-954B-8DBFA13D40CE
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
                 [WinRM] Established

          D      [WinRM] cleaning up command_id: 0671FD1E-2BAD-40D7-BE87-84D50A368F52 on shell_id F1D9EB15-C9CB-493D-954B-8DBFA13D40CE
          D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.8.230:5985/wsman", :user=>"administrator", :password=>"Ep)GS4mK2cs", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"Ep)GS4mK2cs", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
          D      [WinRM] <{:endpoint=>"http://10.194.8.230:5985/wsman", :user=>"administrator", :password=>"Ep)GS4mK2cs", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"Ep)GS4mK2cs", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File)
          D      [WinRM] Command created for New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File with id: 44F65D49-0EE3-4DCD-AC68-F762BAEA5743
          D      [WinRM] creating command_id: 44F65D49-0EE3-4DCD-AC68-F762BAEA5743 on shell_id F1D9EB15-C9CB-493D-954B-8DBFA13D40CE
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output


                     Directory: C:\chef\ohai\hints


                 Mode                LastWriteTime     Length Name
                 ----                -------------     ------ ----
                 -a---         7/23/2016   8:03 PM          0 ec2.json


          D      [WinRM] cleaning up command_id: 44F65D49-0EE3-4DCD-AC68-F762BAEA5743 on shell_id F1D9EB15-C9CB-493D-954B-8DBFA13D40CE
          D      ec2:create '10.194.8.230'
                 Finished creating <fips-unit-functional-windows-2012r2> (2m14.18s).
          -----> Converging <fips-unit-functional-windows-2012r2>...
                 Preparing files for transfer
          D      Creating local sandbox in /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160723-30984-cwcrb
                 Preparing dna.json
          D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                 Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                 Removing non-cookbook files before transfer
                 Preparing validation.pem
          D      Using a dummy validation.pem
                 Preparing client.rb
          D      Creating client.rb from {:node_name=>"fips-unit-functional-windows-2012r2", :checksum_path=>"\#{ENV['TEMP']}\\kitchen\\checksums", :file_cache_path=>"\#{ENV['TEMP']}\\kitchen\\cache", :file_backup_path=>"\#{ENV['TEMP']}\\kitchen\\backup", :cookbook_path=>["\#{ENV['TEMP']}\\kitchen\\cookbooks", "\#{ENV['TEMP']}\\kitchen\\site-cookbooks"], :data_bag_path=>"\#{ENV['TEMP']}\\kitchen\\data_bags", :environment_path=>"\#{ENV['TEMP']}\\kitchen\\environments", :node_path=>"\#{ENV['TEMP']}\\kitchen\\nodes", :role_path=>"\#{ENV['TEMP']}\\kitchen\\roles", :client_path=>"\#{ENV['TEMP']}\\kitchen\\clients", :user_path=>"\#{ENV['TEMP']}\\kitchen\\users", :validation_key=>"\#{ENV['TEMP']}\\kitchen\\validation.pem", :client_key=>"\#{ENV['TEMP']}\\kitchen\\client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"\#{ENV['TEMP']}\\kitchen\\encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
          D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.8.230:5985/wsman", :user=>"administrator", :password=>"Ep)GS4mK2cs", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"Ep)GS4mK2cs", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
          D      [WinRM] <{:endpoint=>"http://10.194.8.230:5985/wsman", :user=>"administrator", :password=>"Ep)GS4mK2cs", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"Ep)GS4mK2cs", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (new-module -name Omnitruck -scriptblock {
          function Get-PlatformVersion {
            switch -regex ((get-wmiobject win32_operatingsystem).version) {
              '10\.0\.\d+' {$platform_version = '2012r2'}
              '6\.3\.\d+'  {$platform_version = '2012r2'}
              '6\.2\.\d+'  {$platform_version = '2012'}
              '6\.1\.\d+'  {$platform_version = '2008r2'}
              '6\.0\.\d+'  {$platform_version = '2008'}
            }
            return $platform_version
          }

          function Get-PlatformArchitecture {
            if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
              $architecture = 'x86_64'
            } else {
              $architecture = 'i386'
            }
            return $architecture
          }

          function New-Uri {
            param ($baseuri, $newuri)

            try {
            new-object System.Uri $baseuri, $newuri
            }
            catch [System.Management.Automation.MethodInvocationException]{
              Write-Error "$($_.exception.message)"
              throw $_.exception
            }
          }

          function Get-WebContent {
            param ($uri, $filepath)
            $proxy = New-Object -TypeName System.Net.WebProxy
            $wc = new-object System.Net.WebClient
            $proxy.Address = $env:http_proxy
            $wc.Proxy = $proxy

            try {
              if ([string]::IsNullOrEmpty($filepath)) {
                $wc.downloadstring($uri)
              }
              else {
                $wc.downloadfile($uri, $filepath)
              }
            }
            catch {
              $exception = $_.Exception
              Write-Host "There was an error: "
              do {
                Write-Host "`t$($exception.message)"
                $exception = $exception.innerexception
              } while ($exception)
              throw "Failed to download from $uri."
            }
          }

          function Test-ProjectPackage {
            [cmdletbinding()]
            param ($Path, $Algorithm = 'SHA256', $Hash)

            if (-not (get-command get-filehash))   {
              function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
              function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
              function Get-FileHash ($Path, $Algorithm) {
                $Path = (resolve-path $path).providerpath
                $hash = @{Algorithm = $Algorithm; Path = $Path}
                use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                  use ($in = (gi $path).OpenRead()) {
                    $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                  }
                }
                new-object PSObject -Property $hash
              }
            }
            Write-Verbose "Testing the $Algorithm hash for $path."
            $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
            Write-Verbose "`tDesired Hash - '$hash'"
            Write-Verbose "`tActual Hash  - '$ActualHash'"
            $Valid = $ActualHash -eq $Hash
            if (-not $Valid) {
              Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
            }
            return $Valid
          }

          function Get-ProjectMetadata {
            <#
              .SYNOPSIS
              Get metadata for a Chef Software, Inc. project
              .DESCRIPTION
              Get metadata for project
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

              Gets the download url and SHA256 checksum for the latest stable release of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

              Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
            #>
            [cmdletbinding()]
            param (
              # Base url to retrieve metadata from.
              [uri]$base_server_uri = 'https://omnitruck.chef.io/',
              [string]
              # Project to install
              [string]
              $project = 'chef',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Release channel to install from
              $channel = 'unstable',
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            # PowerShell is only on Windows ATM
            $platform = 'windows'
            Write-Verbose "Platform: $platform"

            $platform_version = Get-PlatformVersion
            Write-Verbose "Platform Version: $platform_version"

            if ($architecture -eq 'auto') {
              $architecture = Get-PlatformArchitecture
            }

            Write-Verbose "Architecture: $architecture"
            Write-Verbose "Project: $project"


              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 6932cbc2f8e10d1cc419b3cb7fe37faac34a6ffde48d476b61952e8008bce6e4" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.9/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.10/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.11/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ios_xr/6/chef-12.13.12+20160723192537-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ea052ef6ce24d4011a6646c8baaf3cea35a96ae50c41a74e1e739883806523f5" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 e092cd2b7dadabb4d5adcfedbb9c69c7feb5054bcd4eec09f96c3e5a187e4980" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/nexus/7/chef-12.13.12+20160723192537-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ab5924a4030a6ceb59fa4b6adc0badef93ffac19dedc25d9b4a0371c8e88cd16" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2337c9357c6c02c95b452911b6d90bef5f46d38a4834bf1fc7767921b509aeeb" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 9ca5b61b622b258a6cb4a7f307351e9bf5befba2667363cfa0a9d708dcd5448c" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2ab9174446289559390e6ffcb3cfec30f8db0af2d7012b55f1d432d529c86741" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 5c018264cf2db515a82c96f38456bc8b0dfca38ddb7a408f16aa64b2dd978011" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 9a6712bca35e025223ed27fb40e33d353f164a2131fdd3a304737a7c3dc726e7" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 34f6d18d74365dc821e8d951ba595a775a5ae93ab7aa423d388d53825cb971c7" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4d3108d25e015571d598d344dfd5b280b5bb5310e40a2fd0642a30b0b3803d3c" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2aef7e8fc16cc35aec6dcafcd9f64e63aa5af4d1b845a37c7e0aa44b830435d6" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8973f19860d1b7f9111d4fcac2ef3b43d1b817ba7a6a2465a202d87839c1a3dd" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/6.1/chef-12.13.12+20160723192537-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
              "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/7.1/chef-12.13.12+20160723192537-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
              "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ab9507cf0bf779a919182cd2559e02d2dd6ca12c7d22ba9cb56717a5757eb0a6" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" | out-file "$artifact_info_dir/artifact_info" -Append


            $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

            $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
              foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

            Write-Verbose "Project details: "
            foreach ($key in $package_metadata.keys) {
              Write-Verbose "`t$key = $($package_metadata[$key])"
            }
            $package_metadata
          }

          function Install-Project {
            <#
              .SYNOPSIS
              Install a Chef Software, Inc. product
              .DESCRIPTION
              Install a Chef Software, Inc. product
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

              Installs the latest stable version of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

              Installs the latest integration build of the Chef Development Kit
            #>
            [cmdletbinding(SupportsShouldProcess=$true)]
            param (
              # Project to install
              [string]
              $project = 'chef',
              # Release channel to install from
              [validateset('current', 'stable', 'unstable')]
              [string]
              $channel = 'stable',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Full path for the downloaded installer.
              [string]
              $filename,
              # Full path to the location to download the installer
              [string]
              $download_directory = $env:temp,
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

            if (-not [string]::IsNullOrEmpty($filename)) {
              $download_directory = split-path $filename
              $filename = split-path $filename -leaf
              if ([string]::IsNullOrEmpty($download_directory)) {
                $download_directory = $pwd
              }
            }
            else {
              $filename = ($package_metadata.url -split '/')[-1]
            }
            Write-Verbose "Download directory: $download_directory"
            Write-Verbose "Filename: $filename"

            if (-not (test-path $download_directory)) {
              mkdir $download_directory
            }
            $download_directory = (resolve-path $download_directory).providerpath
            $download_destination = join-path $download_directory $filename

            if ((test-path $download_destination) -and
              (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
              Write-Verbose "Found existing valid installer at $download_destination."
            }
            else {
              if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                Get-WebContent $package_metadata.url -filepath $download_destination
              }
            }

            if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
              if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                Write-Host "Installing $project from $download_destination"
                $installingProject = $True
                $installAttempts = 0
                while ($installingProject) {
                  $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                  $p.WaitForExit()
                  if ($p.ExitCode -eq 1618) {
                    Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                    continue
                  } elseif ($p.ExitCode -ne 0) {
                    throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                  }
                  $installingProject = $False
                }
              }
              else {
                throw "Failed to validate the downloaded installer for $project."
              }
            }
          }
          set-alias install -value Install-Project
          export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

          }

          install -project chef -version 12.13.12+20160723192537 -channel unstable
          )
          D      [WinRM] Command created for new-module -name Omnitruck -scriptblock {
          function Get-PlatformVersion {
            switch -regex ((get-wmiobject win32_operatingsystem).version) {
              '10\.0\.\d+' {$platform_version = '2012r2'}
              '6\.3\.\d+'  {$platform_version = '2012r2'}
              '6\.2\.\d+'  {$platform_version = '2012'}
              '6\.1\.\d+'  {$platform_version = '2008r2'}
              '6\.0\.\d+'  {$platform_version = '2008'}
            }
            return $platform_version
          }

          function Get-PlatformArchitecture {
            if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
              $architecture = 'x86_64'
            } else {
              $architecture = 'i386'
            }
            return $architecture
          }

          function New-Uri {
            param ($baseuri, $newuri)

            try {
            new-object System.Uri $baseuri, $newuri
            }
            catch [System.Management.Automation.MethodInvocationException]{
              Write-Error "$($_.exception.message)"
              throw $_.exception
            }
          }

          function Get-WebContent {
            param ($uri, $filepath)
            $proxy = New-Object -TypeName System.Net.WebProxy
            $wc = new-object System.Net.WebClient
            $proxy.Address = $env:http_proxy
            $wc.Proxy = $proxy

            try {
              if ([string]::IsNullOrEmpty($filepath)) {
                $wc.downloadstring($uri)
              }
              else {
                $wc.downloadfile($uri, $filepath)
              }
            }
            catch {
              $exception = $_.Exception
              Write-Host "There was an error: "
              do {
                Write-Host "`t$($exception.message)"
                $exception = $exception.innerexception
              } while ($exception)
              throw "Failed to download from $uri."
            }
          }

          function Test-ProjectPackage {
            [cmdletbinding()]
            param ($Path, $Algorithm = 'SHA256', $Hash)

            if (-not (get-command get-filehash))   {
              function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
              function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
              function Get-FileHash ($Path, $Algorithm) {
                $Path = (resolve-path $path).providerpath
                $hash = @{Algorithm = $Algorithm; Path = $Path}
                use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                  use ($in = (gi $path).OpenRead()) {
                    $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                  }
                }
                new-object PSObject -Property $hash
              }
            }
            Write-Verbose "Testing the $Algorithm hash for $path."
            $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
            Write-Verbose "`tDesired Hash - '$hash'"
            Write-Verbose "`tActual Hash  - '$ActualHash'"
            $Valid = $ActualHash -eq $Hash
            if (-not $Valid) {
              Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
            }
            return $Valid
          }

          function Get-ProjectMetadata {
            <#
              .SYNOPSIS
              Get metadata for a Chef Software, Inc. project
              .DESCRIPTION
              Get metadata for project
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

              Gets the download url and SHA256 checksum for the latest stable release of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

              Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
            #>
            [cmdletbinding()]
            param (
              # Base url to retrieve metadata from.
              [uri]$base_server_uri = 'https://omnitruck.chef.io/',
              [string]
              # Project to install
              [string]
              $project = 'chef',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Release channel to install from
              $channel = 'unstable',
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            # PowerShell is only on Windows ATM
            $platform = 'windows'
            Write-Verbose "Platform: $platform"

            $platform_version = Get-PlatformVersion
            Write-Verbose "Platform Version: $platform_version"

            if ($architecture -eq 'auto') {
              $architecture = Get-PlatformArchitecture
            }

            Write-Verbose "Architecture: $architecture"
            Write-Verbose "Project: $project"


              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 6932cbc2f8e10d1cc419b3cb7fe37faac34a6ffde48d476b61952e8008bce6e4" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.9/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.10/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.11/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ios_xr/6/chef-12.13.12+20160723192537-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ea052ef6ce24d4011a6646c8baaf3cea35a96ae50c41a74e1e739883806523f5" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 e092cd2b7dadabb4d5adcfedbb9c69c7feb5054bcd4eec09f96c3e5a187e4980" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/nexus/7/chef-12.13.12+20160723192537-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ab5924a4030a6ceb59fa4b6adc0badef93ffac19dedc25d9b4a0371c8e88cd16" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2337c9357c6c02c95b452911b6d90bef5f46d38a4834bf1fc7767921b509aeeb" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 9ca5b61b622b258a6cb4a7f307351e9bf5befba2667363cfa0a9d708dcd5448c" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2ab9174446289559390e6ffcb3cfec30f8db0af2d7012b55f1d432d529c86741" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 5c018264cf2db515a82c96f38456bc8b0dfca38ddb7a408f16aa64b2dd978011" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 9a6712bca35e025223ed27fb40e33d353f164a2131fdd3a304737a7c3dc726e7" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 34f6d18d74365dc821e8d951ba595a775a5ae93ab7aa423d388d53825cb971c7" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4d3108d25e015571d598d344dfd5b280b5bb5310e40a2fd0642a30b0b3803d3c" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2aef7e8fc16cc35aec6dcafcd9f64e63aa5af4d1b845a37c7e0aa44b830435d6" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8973f19860d1b7f9111d4fcac2ef3b43d1b817ba7a6a2465a202d87839c1a3dd" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/6.1/chef-12.13.12+20160723192537-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
              "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/7.1/chef-12.13.12+20160723192537-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
              "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ab9507cf0bf779a919182cd2559e02d2dd6ca12c7d22ba9cb56717a5757eb0a6" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" | out-file "$artifact_info_dir/artifact_info" -Append


            $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

            $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
              foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

            Write-Verbose "Project details: "
            foreach ($key in $package_metadata.keys) {
              Write-Verbose "`t$key = $($package_metadata[$key])"
            }
            $package_metadata
          }

          function Install-Project {
            <#
              .SYNOPSIS
              Install a Chef Software, Inc. product
              .DESCRIPTION
              Install a Chef Software, Inc. product
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

              Installs the latest stable version of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

              Installs the latest integration build of the Chef Development Kit
            #>
            [cmdletbinding(SupportsShouldProcess=$true)]
            param (
              # Project to install
              [string]
              $project = 'chef',
              # Release channel to install from
              [validateset('current', 'stable', 'unstable')]
              [string]
              $channel = 'stable',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Full path for the downloaded installer.
              [string]
              $filename,
              # Full path to the location to download the installer
              [string]
              $download_directory = $env:temp,
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

            if (-not [string]::IsNullOrEmpty($filename)) {
              $download_directory = split-path $filename
              $filename = split-path $filename -leaf
              if ([string]::IsNullOrEmpty($download_directory)) {
                $download_directory = $pwd
              }
            }
            else {
              $filename = ($package_metadata.url -split '/')[-1]
            }
            Write-Verbose "Download directory: $download_directory"
            Write-Verbose "Filename: $filename"

            if (-not (test-path $download_directory)) {
              mkdir $download_directory
            }
            $download_directory = (resolve-path $download_directory).providerpath
            $download_destination = join-path $download_directory $filename

            if ((test-path $download_destination) -and
              (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
              Write-Verbose "Found existing valid installer at $download_destination."
            }
            else {
              if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                Get-WebContent $package_metadata.url -filepath $download_destination
              }
            }

            if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
              if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                Write-Host "Installing $project from $download_destination"
                $installingProject = $True
                $installAttempts = 0
                while ($installingProject) {
                  $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                  $p.WaitForExit()
                  if ($p.ExitCode -eq 1618) {
                    Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                    continue
                  } elseif ($p.ExitCode -ne 0) {
                    throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                  }
                  $installingProject = $False
                }
              }
              else {
                throw "Failed to validate the downloaded installer for $project."
              }
            }
          }
          set-alias install -value Install-Project
          export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

          }

          install -project chef -version 12.13.12+20160723192537 -channel unstable
           with id: 6BCC38F8-2DF3-4814-A1B7-2E85DDB4898C
          D      [WinRM] creating command_id: 6BCC38F8-2DF3-4814-A1B7-2E85DDB4898C on shell_id F1D9EB15-C9CB-493D-954B-8DBFA13D40CE
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output

                 ModuleType Version    Name                                ExportedCommands
                 ---------- -------    ----                                ----------------
                 Script     0.0        Omnitruck                           {Get-ProjectMetada...
          D      [WinRM] Waiting for output...
          D      [WinRM] opening new shell since the current one was deleted
          D      [WinRM] opening remote shell on http://10.194.8.230:5985/wsman
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000000048ab840 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.2</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
          D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000000048aa468 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">2.0</Version></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version></LST></Obj></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">6.3.9600.17400</Version></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.2</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000000047ae460 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
          D      [WinRM] remote shell created with shell_id: CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Command created for new-module -name Omnitruck -scriptblock {
          function Get-PlatformVersion {
            switch -regex ((get-wmiobject win32_operatingsystem).version) {
              '10\.0\.\d+' {$platform_version = '2012r2'}
              '6\.3\.\d+'  {$platform_version = '2012r2'}
              '6\.2\.\d+'  {$platform_version = '2012'}
              '6\.1\.\d+'  {$platform_version = '2008r2'}
              '6\.0\.\d+'  {$platform_version = '2008'}
            }
            return $platform_version
          }

          function Get-PlatformArchitecture {
            if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
              $architecture = 'x86_64'
            } else {
              $architecture = 'i386'
            }
            return $architecture
          }

          function New-Uri {
            param ($baseuri, $newuri)

            try {
            new-object System.Uri $baseuri, $newuri
            }
            catch [System.Management.Automation.MethodInvocationException]{
              Write-Error "$($_.exception.message)"
              throw $_.exception
            }
          }

          function Get-WebContent {
            param ($uri, $filepath)
            $proxy = New-Object -TypeName System.Net.WebProxy
            $wc = new-object System.Net.WebClient
            $proxy.Address = $env:http_proxy
            $wc.Proxy = $proxy

            try {
              if ([string]::IsNullOrEmpty($filepath)) {
                $wc.downloadstring($uri)
              }
              else {
                $wc.downloadfile($uri, $filepath)
              }
            }
            catch {
              $exception = $_.Exception
              Write-Host "There was an error: "
              do {
                Write-Host "`t$($exception.message)"
                $exception = $exception.innerexception
              } while ($exception)
              throw "Failed to download from $uri."
            }
          }

          function Test-ProjectPackage {
            [cmdletbinding()]
            param ($Path, $Algorithm = 'SHA256', $Hash)

            if (-not (get-command get-filehash))   {
              function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
              function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
              function Get-FileHash ($Path, $Algorithm) {
                $Path = (resolve-path $path).providerpath
                $hash = @{Algorithm = $Algorithm; Path = $Path}
                use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                  use ($in = (gi $path).OpenRead()) {
                    $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                  }
                }
                new-object PSObject -Property $hash
              }
            }
            Write-Verbose "Testing the $Algorithm hash for $path."
            $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
            Write-Verbose "`tDesired Hash - '$hash'"
            Write-Verbose "`tActual Hash  - '$ActualHash'"
            $Valid = $ActualHash -eq $Hash
            if (-not $Valid) {
              Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
            }
            return $Valid
          }

          function Get-ProjectMetadata {
            <#
              .SYNOPSIS
              Get metadata for a Chef Software, Inc. project
              .DESCRIPTION
              Get metadata for project
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

              Gets the download url and SHA256 checksum for the latest stable release of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

              Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
            #>
            [cmdletbinding()]
            param (
              # Base url to retrieve metadata from.
              [uri]$base_server_uri = 'https://omnitruck.chef.io/',
              [string]
              # Project to install
              [string]
              $project = 'chef',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Release channel to install from
              $channel = 'unstable',
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            # PowerShell is only on Windows ATM
            $platform = 'windows'
            Write-Verbose "Platform: $platform"

            $platform_version = Get-PlatformVersion
            Write-Verbose "Platform Version: $platform_version"

            if ($architecture -eq 'auto') {
              $architecture = Get-PlatformArchitecture
            }

            Write-Verbose "Architecture: $architecture"
            Write-Verbose "Project: $project"


              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 6932cbc2f8e10d1cc419b3cb7fe37faac34a6ffde48d476b61952e8008bce6e4" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.9/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.10/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/mac_os_x/10.11/chef-12.13.12+20160723192537-1.dmg" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8747f1d3dfb5630505c70fa94e7f0a17b2b48f9fa1590ad675a6c986fdd2288f" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ios_xr/6/chef-12.13.12+20160723192537-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ea052ef6ce24d4011a6646c8baaf3cea35a96ae50c41a74e1e739883806523f5" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 e092cd2b7dadabb4d5adcfedbb9c69c7feb5054bcd4eec09f96c3e5a187e4980" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c776e4ab1902ef0951ca1c9794821df535536c4e87302172d28e82c77d86b626" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/nexus/7/chef-12.13.12+20160723192537-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ab5924a4030a6ceb59fa4b6adc0badef93ffac19dedc25d9b4a0371c8e88cd16" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2337c9357c6c02c95b452911b6d90bef5f46d38a4834bf1fc7767921b509aeeb" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3980cff9af45463b8c56147a4c943fec501c6a609a758fb1ba49e248b9babd86" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 9ca5b61b622b258a6cb4a7f307351e9bf5befba2667363cfa0a9d708dcd5448c" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 c2378b071db658415a9e4a53a0f08c2f7526ff4c31f08f6af4f413100b835820" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2ab9174446289559390e6ffcb3cfec30f8db0af2d7012b55f1d432d529c86741" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/12.04/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/ubuntu/14.04/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 cd330832faf26ccefe4e3e93d6f476e0e63d74fdbda55f71c3c4bb776365d30e" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 5c018264cf2db515a82c96f38456bc8b0dfca38ddb7a408f16aa64b2dd978011" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 9a6712bca35e025223ed27fb40e33d353f164a2131fdd3a304737a7c3dc726e7" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/10/chef-12.13.12+20160723192537_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 34f6d18d74365dc821e8d951ba595a775a5ae93ab7aa423d388d53825cb971c7" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/5/chef-12.13.12+20160723192537-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4d3108d25e015571d598d344dfd5b280b5bb5310e40a2fd0642a30b0b3803d3c" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/6/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/7/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/debian/8/chef_12.13.12+20160723192537-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
              "sha256 3d420103c11b49a01579e4eea090ab81478de94d38038c75df0a2132e8d54cef" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/freebsd/9/chef-12.13.12+20160723192537_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
              "sha256 2aef7e8fc16cc35aec6dcafcd9f64e63aa5af4d1b845a37c7e0aa44b830435d6" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 4e5185d74db93287f570ff3c6078817161378031fde501b0b4ccb573dae1d913" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/6/chef-12.13.12+20160723192537-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 8973f19860d1b7f9111d4fcac2ef3b43d1b817ba7a6a2465a202d87839c1a3dd" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2008r2/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/windows/2012r2/chef-client-12.13.12+20160723192537-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
              "sha256 bcc920df8d64ccbab78d691fe44735b519712ec91a131d0300bc74ef5b6a7678" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/6.1/chef-12.13.12+20160723192537-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
              "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/aix/7.1/chef-12.13.12+20160723192537-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
              "sha256 827152a13f80f0c0dd5d1606ddcec278953afe6be95bc7e8c5b490e93291fe60" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/el/7/chef-12.13.12+20160723192537-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
              "sha256 ab9507cf0bf779a919182cd2559e02d2dd6ca12c7d22ba9cb56717a5757eb0a6" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.10/chef-12.13.12+20160723192537-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" | out-file "$artifact_info_dir/artifact_info" -Append

              $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
              New-Item -ItemType directory -Path $artifact_info_dir -force
              New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
              "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.12+20160723192537/solaris2/5.11/chef-12.13.12+20160723192537-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
              "sha256 14fc56f926cdd4550a62a132a733720e49c29151a366d4769eb25615416c8882" | out-file "$artifact_info_dir/artifact_info" -Append


            $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

            $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
              foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

            Write-Verbose "Project details: "
            foreach ($key in $package_metadata.keys) {
              Write-Verbose "`t$key = $($package_metadata[$key])"
            }
            $package_metadata
          }

          function Install-Project {
            <#
              .SYNOPSIS
              Install a Chef Software, Inc. product
              .DESCRIPTION
              Install a Chef Software, Inc. product
              .EXAMPLE
              iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

              Installs the latest stable version of Chef.
              .EXAMPLE
              iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

              Installs the latest integration build of the Chef Development Kit
            #>
            [cmdletbinding(SupportsShouldProcess=$true)]
            param (
              # Project to install
              [string]
              $project = 'chef',
              # Release channel to install from
              [validateset('current', 'stable', 'unstable')]
              [string]
              $channel = 'stable',
              # Version of the application to install
              # This parameter is optional, if not supplied it will provide the latest version,
              # and if an iteration number is not specified, it will grab the latest available iteration.
              # Partial version numbers are also acceptable (using v=11
              # will grab the latest 11.x client which matches the other flags).
              [string]
              $version,
              # Full path for the downloaded installer.
              [string]
              $filename,
              # Full path to the location to download the installer
              [string]
              $download_directory = $env:temp,
              # The following legacy switches are just aliases for the current channel
              [switch]
              $prerelease,
              [switch]
              $nightlies,
              [validateset('auto', 'i386', 'x86_64')]
              [string]
              $architecture = 'auto'
            )

            $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

            if (-not [string]::IsNullOrEmpty($filename)) {
              $download_directory = split-path $filename
              $filename = split-path $filename -leaf
              if ([string]::IsNullOrEmpty($download_directory)) {
                $download_directory = $pwd
              }
            }
            else {
              $filename = ($package_metadata.url -split '/')[-1]
            }
            Write-Verbose "Download directory: $download_directory"
            Write-Verbose "Filename: $filename"

            if (-not (test-path $download_directory)) {
              mkdir $download_directory
            }
            $download_directory = (resolve-path $download_directory).providerpath
            $download_destination = join-path $download_directory $filename

            if ((test-path $download_destination) -and
              (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
              Write-Verbose "Found existing valid installer at $download_destination."
            }
            else {
              if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                Get-WebContent $package_metadata.url -filepath $download_destination
              }
            }

            if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
              if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                Write-Host "Installing $project from $download_destination"
                $installingProject = $True
                $installAttempts = 0
                while ($installingProject) {
                  $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                  $p.WaitForExit()
                  if ($p.ExitCode -eq 1618) {
                    Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                    continue
                  } elseif ($p.ExitCode -ne 0) {
                    throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                  }
                  $installingProject = $False
                }
              }
              else {
                throw "Failed to validate the downloaded installer for $project."
              }
            }
          }
          set-alias install -value Install-Project
          export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

          }

          install -project chef -version 12.13.12+20160723192537 -channel unstable
           with id: 706F4674-EE11-46DC-B419-77FE4D1C4F1F
          D      [WinRM] creating command_id: 706F4674-EE11-46DC-B419-77FE4D1C4F1F on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output

                 ModuleType Version    Name                                ExportedCommands
                 ---------- -------    ----                                ----------------
                 Script     0.0        Omnitruck                           {Get-ProjectMetada...
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
                 Installing chef from C:\Users\ADMINI~1\AppData\Local\Temp\chef-client-12.13.12+20160723192537-1-x64.msi
          D      [WinRM] Waiting for output...
          D      [WinRM] retrying receive request after timeout
          D      [WinRM] Processing output


          D      [WinRM] cleaning up command_id: 706F4674-EE11-46DC-B419-77FE4D1C4F1F on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] <{:endpoint=>"http://10.194.8.230:5985/wsman", :user=>"administrator", :password=>"Ep)GS4mK2cs", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"Ep)GS4mK2cs", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> ($dirs = @("$env:TEMP\kitchen\clients", "$env:TEMP\kitchen\cookbooks", "$env:TEMP\kitchen\data", "$env:TEMP\kitchen\data_bags", "$env:TEMP\kitchen\encrypted_data_bag_secret", "$env:TEMP\kitchen\environments", "$env:TEMP\kitchen\roles")
          $root_path = "$env:TEMP\kitchen"

          Function Delete-AllDirs($dirs) {
            $dirs | ForEach-Object {
              if (Test-Path ($path = Unresolve-Path $_)) { Remove-Item $path -Recurse -Force }
            }
          }

          Function Unresolve-Path($p) {
            if ($p -eq $null) { return $null }
            else { return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($p) }
          }

          Function Make-RootPath($p) {
            $p = Unresolve-Path $p
            if (-Not (Test-Path $p)) { New-Item $p -ItemType directory | Out-Null }
          }

          Delete-AllDirs $dirs
          Make-RootPath $root_path
          )
          D      [WinRM] Command created for $dirs = @("$env:TEMP\kitchen\clients", "$env:TEMP\kitchen\cookbooks", "$env:TEMP\kitchen\data", "$env:TEMP\kitchen\data_bags", "$env:TEMP\kitchen\encrypted_data_bag_secret", "$env:TEMP\kitchen\environments", "$env:TEMP\kitchen\roles")
          $root_path = "$env:TEMP\kitchen"

          Function Delete-AllDirs($dirs) {
            $dirs | ForEach-Object {
              if (Test-Path ($path = Unresolve-Path $_)) { Remove-Item $path -Recurse -Force }
            }
          }

          Function Unresolve-Path($p) {
            if ($p -eq $null) { return $null }
            else { return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($p) }
          }

          Function Make-RootPath($p) {
            $p = Unresolve-Path $p
            if (-Not (Test-Path $p)) { New-Item $p -ItemType directory | Out-Null }
          }

          Delete-AllDirs $dirs
          Make-RootPath $root_path
           with id: 1226D13A-FD29-45CA-A695-E316C0939EC2
          D      [WinRM] creating command_id: 1226D13A-FD29-45CA-A695-E316C0939EC2 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 1226D13A-FD29-45CA-A695-E316C0939EC2 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
                 Transferring files to <fips-unit-functional-windows-2012r2>
          D      creating hash for file $env:TEMP\kitchen
          D      creating hash for file $env:TEMP\kitchen
          D      creating hash for directory $env:TEMP\kitchen
          D      Populating files
          D      === All files added.
          D      creating hash for file $env:TEMP\kitchen
          D      creating hash for directory $env:TEMP\kitchen
          D      Populating files
          D      +++ Adding fips/metadata.rb
          D      === All files added.
          D      Running check_files.ps1
          D      [WinRM] Command created for $hash_file = @{
            "f36538b1f10bf80532dc432fbec25a65" = @{
              "target" = "$env:TEMP\kitchen";
              "src_basename" = "dna.json";
              "dst" = "$env:TEMP\kitchen"
            };
            "5ebc88891c9d6f3514edfa67838c9f58" = @{
              "target" = "$env:TEMP\kitchen";
              "src_basename" = "client.rb";
              "dst" = "$env:TEMP\kitchen"
            };
            "76cdb2bad9582d23c1f6f4d868218d6c" = @{
              "target" = "$env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip";
              "src_basename" = "cache";
              "dst" = "$env:TEMP\kitchen\cache"
            };
            "49abb94825cb80b9a9cd59e5f76daf4a" = @{
              "target" = "$env:TEMP\kitchen";
              "src_basename" = "validation.pem";
              "dst" = "$env:TEMP\kitchen"
            };
            "33968442c0ef69a92763825b33850e28" = @{
              "target" = "$env:TEMP\winrm-upload\tmpzip-33968442c0ef69a92763825b33850e28.zip";
              "src_basename" = "cookbooks";
              "dst" = "$env:TEMP\kitchen\cookbooks"
            }
          }

          Function Cleanup($disposable) {
            if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
              $disposable.Dispose()
            }
          }

          Function Check-Files($h) {
            return $h.GetEnumerator() | ForEach-Object {
              $dst = Unresolve-Path $_.Value.target
              $dst_changed = $false
              if(Test-Path $dst -PathType Container) {
                $dst_changed = $true
                $dst = Join-Path $dst $_.Value.src_basename
              }
              New-Object psobject -Property @{
                chk_exists = ($exists = Test-Path $dst -PathType Leaf)
                src_md5 = ($sMd5 = $_.Key)
                dst_md5 = ($dMd5 = if ($exists) { Get-MD5Sum $dst } else { $null })
                chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
                verifies = if ($dirty -eq $false) { $true } else { $false }
                target_is_folder = $dst_changed
              }
            } | Select-Object -Property chk_exists,src_md5,dst_md5,chk_dirty,verifies,target_is_folder
          }

          Function Get-MD5Sum($src) {
            Try {
              $c = [System.Security.Cryptography.MD5]::Create()
              $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
              return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
            }
            Finally {
              Cleanup $c
              Cleanup $in
            }
          }

          Function Unresolve-Path($path) {
            if ($path -eq $null) {
              return $null
            }
            else {
              return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
            }
          }

          Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation
           with id: A7F4228A-CA8A-454F-87C2-638F301FEDCA
          D      [WinRM] creating command_id: A7F4228A-CA8A-454F-87C2-638F301FEDCA on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: A7F4228A-CA8A-454F-87C2-638F301FEDCA on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      Parsing CSV Response
          D      "chk_exists","src_md5","dst_md5","chk_dirty","verifies","target_is_folder"
          "False","33968442c0ef69a92763825b33850e28",,"True","False","False"
          "False","76cdb2bad9582d23c1f6f4d868218d6c",,"True","False","False"
          "False","f36538b1f10bf80532dc432fbec25a65",,"True","False","True"
          "False","5ebc88891c9d6f3514edfa67838c9f58",,"True","False","True"
          "False","49abb94825cb80b9a9cd59e5f76daf4a",,"True","False","True"

          D      Uploading /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160723-30984-cwcrb/dna.json to $env:TEMP\kitchen/dna.json
          D      [WinRM] Command created for             $parent = Split-Path "$env:TEMP\kitchen/dna.json"
                      if(!(Test-path $parent)) { mkdir $parent | Out-Null}
                      $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                          "$env:TEMP\kitchen/dna.json",
                          [system.io.filemode]::Create,
                          [System.io.FileAccess]::Write,
                          [System.IO.FileShare]::ReadWrite
                      )
           with id: C6FB6077-82BC-4C22-90AB-1DD8F31043BB
          D      [WinRM] creating command_id: C6FB6077-82BC-4C22-90AB-1DD8F31043BB on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: C6FB6077-82BC-4C22-90AB-1DD8F31043BB on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Command created for             $bytes=[Convert]::FromBase64String('eyJjaGVmX2FjY2VwdGFuY2UiOiJ0cnVlIiwidXNlX3N5c3RlbV9jaGVmIjoidHJ1ZSIsInJ1bl9saXN0IjpbXX0=')
                      $fileStream.Write($bytes, 0, $bytes.length)
           with id: 97A1A56E-871A-4AA4-8348-AB643AF674A3
          D      [WinRM] creating command_id: 97A1A56E-871A-4AA4-8348-AB643AF674A3 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 97A1A56E-871A-4AA4-8348-AB643AF674A3 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Command created for $fileStream.Dispose() with id: 93B6F01D-E303-4F95-85B3-FC0E7D532B87
          D      [WinRM] creating command_id: 93B6F01D-E303-4F95-85B3-FC0E7D532B87 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 93B6F01D-E303-4F95-85B3-FC0E7D532B87 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      Finished uploading /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160723-30984-cwcrb/dna.json to $env:TEMP\kitchen/dna.json (0.084 KB over 1 chunks) in (0m0.34s)
          D      Uploading /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160723-30984-cwcrb/client.rb to $env:TEMP\kitchen/client.rb
          D      [WinRM] Command created for             $parent = Split-Path "$env:TEMP\kitchen/client.rb"
                      if(!(Test-path $parent)) { mkdir $parent | Out-Null}
                      $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                          "$env:TEMP\kitchen/client.rb",
                          [system.io.filemode]::Create,
                          [System.io.FileAccess]::Write,
                          [System.IO.FileShare]::ReadWrite
                      )
           with id: 14E1E3F8-C1EC-4D9F-B277-3D37F727AA66
          D      [WinRM] creating command_id: 14E1E3F8-C1EC-4D9F-B277-3D37F727AA66 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 14E1E3F8-C1EC-4D9F-B277-3D37F727AA66 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Command created for             $bytes=[Convert]::FromBase64String('bm9kZV9uYW1lICJmaXBzLXVuaXQtZnVuY3Rpb25hbC13aW5kb3dzLTIwMTJyMiIKY2hlY2tzdW1fcGF0aCAiI3tFTlZbJ1RFTVAnXX1cXGtpdGNoZW5cXGNoZWNrc3VtcyIKZmlsZV9jYWNoZV9wYXRoICIje0VOVlsnVEVNUCddfVxca2l0Y2hlblxcY2FjaGUiCmZpbGVfYmFja3VwX3BhdGggIiN7RU5WWydURU1QJ119XFxraXRjaGVuXFxiYWNrdXAiCmNvb2tib29rX3BhdGggWyIje0VOVlsnVEVNUCddfVxca2l0Y2hlblxcY29va2Jvb2tzIiwgIiN7RU5WWydURU1QJ119XFxraXRjaGVuXFxzaXRlLWNvb2tib29rcyJdCmRhdGFfYmFnX3BhdGggIiN7RU5WWydURU1QJ119XFxraXRjaGVuXFxkYXRhX2JhZ3MiCmVudmlyb25tZW50X3BhdGggIiN7RU5WWydURU1QJ119XFxraXRjaGVuXFxlbnZpcm9ubWVudHMiCm5vZGVfcGF0aCAiI3tFTlZbJ1RFTVAnXX1cXGtpdGNoZW5cXG5vZGVzIgpyb2xlX3BhdGggIiN7RU5WWydURU1QJ119XFxraXRjaGVuXFxyb2xlcyIKY2xpZW50X3BhdGggIiN7RU5WWydURU1QJ119XFxraXRjaGVuXFxjbGllbnRzIgp1c2VyX3BhdGggIiN7RU5WWydURU1QJ119XFxraXRjaGVuXFx1c2VycyIKdmFsaWRhdGlvbl9rZXkgIiN7RU5WWydURU1QJ119XFxraXRjaGVuXFx2YWxpZGF0aW9uLnBlbSIKY2xpZW50X2tleSAiI3tFTlZbJ1RFTVAnXX1cXGtpdGNoZW5cXGNsaWVudC5wZW0iCmNoZWZfc2VydmVyX3VybCAiaHR0cDovLzEyNy4wLjAuMTo4ODg5IgplbmNyeXB0ZWRfZGF0YV9iYWdfc2VjcmV0ICIje0VOVlsnVEVNUCddfVxca2l0Y2hlblxcZW5jcnlwdGVkX2RhdGFfYmFnX3NlY3JldCIKYXVkaXRfbW9kZSA6ZW5hYmxlZApuYW1lZF9ydW5fbGlzdCB7fQ==')
                      $fileStream.Write($bytes, 0, $bytes.length)
           with id: D99DB1EA-3D98-4EBE-8D72-9B14122F9EF4
          D      [WinRM] creating command_id: D99DB1EA-3D98-4EBE-8D72-9B14122F9EF4 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: D99DB1EA-3D98-4EBE-8D72-9B14122F9EF4 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Command created for $fileStream.Dispose() with id: F6B0162F-1475-4670-A337-61D287249514
          D      [WinRM] creating command_id: F6B0162F-1475-4670-A337-61D287249514 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: F6B0162F-1475-4670-A337-61D287249514 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      Finished uploading /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160723-30984-cwcrb/client.rb to $env:TEMP\kitchen/client.rb (1.12 KB over 1 chunks) in (0m0.46s)
          D      Uploading /tmp/cheftest/tmpzip-20160723-30984-5ypvg0.zip to $env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip
          D      [WinRM] Command created for             $parent = Split-Path "$env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip"
                      if(!(Test-path $parent)) { mkdir $parent | Out-Null}
                      $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                          "$env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip",
                          [system.io.filemode]::Create,
                          [System.io.FileAccess]::Write,
                          [System.IO.FileShare]::ReadWrite
                      )
           with id: 27D30967-B4A1-4CF0-817A-73DCFFEC2886
          D      [WinRM] creating command_id: 27D30967-B4A1-4CF0-817A-73DCFFEC2886 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 27D30967-B4A1-4CF0-817A-73DCFFEC2886 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Command created for             $bytes=[Convert]::FromBase64String('UEsFBgAAAAAAAAAAAAAAAAAAAAAAAA==')
                      $fileStream.Write($bytes, 0, $bytes.length)
           with id: 65C2E2F6-5838-460F-936F-DF7C53A49388
          D      [WinRM] creating command_id: 65C2E2F6-5838-460F-936F-DF7C53A49388 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 65C2E2F6-5838-460F-936F-DF7C53A49388 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Command created for $fileStream.Dispose() with id: 034ACA39-7228-477D-99FB-6EAC2F8E496B
          D      [WinRM] creating command_id: 034ACA39-7228-477D-99FB-6EAC2F8E496B on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 034ACA39-7228-477D-99FB-6EAC2F8E496B on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      Finished uploading /tmp/cheftest/tmpzip-20160723-30984-5ypvg0.zip to $env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip (0.028 KB over 1 chunks) in (0m0.52s)
          D      Uploading /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160723-30984-cwcrb/validation.pem to $env:TEMP\kitchen/validation.pem
          D      [WinRM] Command created for             $parent = Split-Path "$env:TEMP\kitchen/validation.pem"
                      if(!(Test-path $parent)) { mkdir $parent | Out-Null}
                      $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                          "$env:TEMP\kitchen/validation.pem",
                          [system.io.filemode]::Create,
                          [System.io.FileAccess]::Write,
                          [System.IO.FileShare]::ReadWrite
                      )
           with id: 9708883F-F334-4E50-8F59-88AC9CF8D539
          D      [WinRM] creating command_id: 9708883F-F334-4E50-8F59-88AC9CF8D539 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 9708883F-F334-4E50-8F59-88AC9CF8D539 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Command created for             $bytes=[Convert]::FromBase64String('LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBMHNPWTl0SHZWdExaNnhtVm1IOGQ4THJSck5jV09YYnJ2dkNyYWkrVDNHdFJ2UlNMCmhrc0xycE9wRDBMOUVITTZOZFRoTkYvZUdBOU9xK1VLQWU2eVhSMGh3c0t1eEtYcVE4U0VtbGhaWjlHaXVnZ0QKQi96WUQzSXRCNlNHcGRrUmU3a1FxVENoUXlySVhxYlJrSnF4b1RYTHllSkRGMHNDeVRkcDNMOElaQ1VXb2RNOApvVjlUbFFCSkhZdEcxZ0xVd0lpOGtjTVZFb0NuMlE4bHRDajAvZnRud2hUdHdPNTJSa1dBMHVZT0xHVmF5SHNMClNDRmZ4K0FDV1BVL29XQ3dXNS9LQnFiM3ZlVHYwYUVnL25oMFFzRnpSTG9UeDZTUkZJNWRUMk5mOGlpSmU0V0MKVUc4V0tFQjJHOFFQbnhzeGZPUFlEQmRUSjRDWEVpMmUrejQxVlFJREFRQUJBb0lCQUFMaHFiVzJLUStHMG5QawpaYWN3RmJpMDFTa0h4OFlCV2pmQ0VwWGhFS1J5MHl0Q25LVzVZTytDRlUyZ0hOV2N2YTcrdWhWOU9nd2FLWGt3CktITGVVSkgxVkFEVnFJNEh0cXcyZzVtWW02QlB2V25Oc2p6cHVBcCtCUitWb0VHa05oajY3cjloYXRNQVFyMEkKaXRUdlNINXJ2ZDJFdW1ZWElIS2Z6MUsxU2VnVWsxdTFFTDFSY016Um1aZTRnRGI2ZU5CczlTZzRpbTR5YlRHNgpwUEl5dEE4dkJRVldoanVBUjJUbSt3WkhpeTBBejZWdTdjMm1TMDdGU1g2Rk80RThTeFdmOGlkYUs5aWpNR1NxCkZ2SVMwNG1yWTZYQ1BVUFVDNHFtMXFObmhEUHBPcjdDcEkyT085OFNxR2FuU3RTNU5GbFNGWGVYUHBNMjgwL3UKZlpVQTBBRUNnWUVBK3g3UVVuZmZEcnQ3TEsyY1g2d2J2bjRtUm5GeGV0N2JKanJmV0lIZitSbTBVUmlrYU5tYQpoMC93TktwS0J3SUgrZUhLL0xzbGd6Y3BscnFQeXRHR0hMT0c5N0d5bzV0R0F6eUxIVVdCbXNOa1Jrc1kyc1BMCnVIcTZwWVdKTmtxaG5XR25JYm1xQ3IwRVdpaDgyeC95NHF4YkpZcFlxWE1yaXQwd1ZmN3lBZ2tDZ1lFQTF0d0kKZ0ZhWHFlc2V0VFBvRUhTUVNnQzhTNEQ1L05rZHJpVVhDWWIwNlJFY3ZvOUlwRk11aU9rVlVZTk41ZDNNRE5UUApJZEJpY2ZtdmZORUx2QnRYRG9tRVVEOGxzMVV1b1RJWFJOR1owVnNaWHU3T0VyWENLMEpLTk55cVJtT3djdllMCkpScUxmbmxlaTVOZG8xbHUyODZ5TDc0YzVyZFRMcy9uSTJwNGUrMENnWUIwNzlabWNMZUlMcm1mQm9GSTgrWS8KZ0pMbVByRnZYQk9FNitsUlY3a3FVRlB0WjZJM3lRenljY0VUWlREdnJueDBXamFpRmF2VVBIMjdXTWpZMDFTMgpUTXRPMElxMU1Qc2JTcmdsTzFhczhNdmpCOWxkRmN2cDdneTRRMFN2NlhUMHlxSi9TK3ZvOERmMG0rSDRVQnBVCmY1bzZFd0JTZC9VUXh3dFpJRTBsc1FLQmdRQ3N3ZmpYOEVnOEtML2xKTnBJT09FM2o0WFhFOXB0a3NtSmwyc0IKanhEblFZb2lNcVZPODA4c2FIVnF1Qy92VHJwZDZ0S3ROcGVoV3dqZVRGdXFJVFdMaThqbW1RK2dOVEtzQzlHbgoxUHhmMkdiNjdQcW5FcHdRR2xuK1RSdGdRNUhCcmRIaVFJaSs1YW0rZ253ODlwRHJqak81clp3aGFuQW82S1BKCjF6Y1BOUUtCZ1FEeEZ1OHY0ZnJEbVJOQ1ZhWlM0ZjFCNndUcmNNcm5pYklEbG56cks5R0c2SHoxVTdkRHY4czgKTmY0VW1lTXpEWGpsUFdaVk92UzUrOUhLSlBkUGo3L29udjhCMm0xOCtsY2dUVERKQmt6YTdSMW1qTDFDamUvWgpLY1ZHc3J5S042Y2pFN3lDRGFzbkE3UjJyVkJWLzdOV2VKVjc3Ym16VDVPLy9yVzR5SWZVSWc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=')
                      $fileStream.Write($bytes, 0, $bytes.length)
           with id: 4B82113D-2E17-4E0D-8C67-BA324B79DCE8
          D      [WinRM] creating command_id: 4B82113D-2E17-4E0D-8C67-BA324B79DCE8 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 4B82113D-2E17-4E0D-8C67-BA324B79DCE8 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Command created for $fileStream.Dispose() with id: 764B5125-AE8F-487F-ADD4-7AC7D304DD16
          D      [WinRM] creating command_id: 764B5125-AE8F-487F-ADD4-7AC7D304DD16 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 764B5125-AE8F-487F-ADD4-7AC7D304DD16 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      Finished uploading /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160723-30984-cwcrb/validation.pem to $env:TEMP\kitchen/validation.pem (2.236 KB over 1 chunks) in (0m0.34s)
          D      Uploading /tmp/cheftest/tmpzip-20160723-30984-1nzoko3.zip to $env:TEMP\winrm-upload\tmpzip-33968442c0ef69a92763825b33850e28.zip
          D      [WinRM] Command created for             $parent = Split-Path "$env:TEMP\winrm-upload\tmpzip-33968442c0ef69a92763825b33850e28.zip"
                      if(!(Test-path $parent)) { mkdir $parent | Out-Null}
                      $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                          "$env:TEMP\winrm-upload\tmpzip-33968442c0ef69a92763825b33850e28.zip",
                          [system.io.filemode]::Create,
                          [System.io.FileAccess]::Write,
                          [System.IO.FileShare]::ReadWrite
                      )
           with id: 392BE3A6-1281-497E-9C82-3F7C02B487D1
          D      [WinRM] creating command_id: 392BE3A6-1281-497E-9C82-3F7C02B487D1 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 392BE3A6-1281-497E-9C82-3F7C02B487D1 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Command created for             $bytes=[Convert]::FromBase64String('UEsDBBQAAAAIAAAAISiZETWIDgAAAAwAAAAQAAAAZmlwcy9tZXRhZGF0YS5yYstLzE1VUErLLChW4gIAUEsBAjQDFAAAAAgAAAAhKJkRNYgOAAAADAAAABAAAAAAAAAAAQAAAKSBAAAAAGZpcHMvbWV0YWRhdGEucmJQSwUGAAAAAAEAAQA+AAAAPAAAAAAA')
                      $fileStream.Write($bytes, 0, $bytes.length)
           with id: B5491CE8-CAE2-4FFC-B5D5-9556F94F0A26
          D      [WinRM] creating command_id: B5491CE8-CAE2-4FFC-B5D5-9556F94F0A26 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: B5491CE8-CAE2-4FFC-B5D5-9556F94F0A26 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Command created for $fileStream.Dispose() with id: 0D71110A-D21D-4585-AF32-0C329307FA11
          D      [WinRM] creating command_id: 0D71110A-D21D-4585-AF32-0C329307FA11 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 0D71110A-D21D-4585-AF32-0C329307FA11 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      Finished uploading /tmp/cheftest/tmpzip-20160723-30984-1nzoko3.zip to $env:TEMP\winrm-upload\tmpzip-33968442c0ef69a92763825b33850e28.zip (0.192 KB over 1 chunks) in (0m0.40s)
          D      Running extract_files.ps1
          D      [WinRM] Command created for trap {
            $e = $_.Exception
            $e.InvocationInfo.ScriptName
            do {
              $e.Message
              $e = $e.InnerException
            } while ($e)
            break
          }

          function folder($path){
            $path | ? {-not (test-path $_)} | % {$null = mkdir $_}
          }

          Function Decode-Files($hash) {
            foreach ($key in $hash.keys) {
              $value = $hash[$key]
              $tzip, $dst = $Value["tmpzip"], $Value["dst"]
              if ($tzip) {Unzip-File $tzip $dst}
              New-Object psobject -Property @{dst=$dst;src_md5=$key;tmpzip=$tzip}
            }
          }

          Function Unzip-File($src, $dst) {
            $unpack = $src -replace '\.zip'
            $dst_parent = Split-Path -Path $dst -Parent
            if(!(Test-Path $dst_parent)) { $dst = $dst_parent }
            folder $unpack, $dst
            try {
              try{
                [IO.Compression.ZipFile]::ExtractToDirectory($src, $unpack)
              }
              catch {
                Add-Type -AssemblyName System.IO.Compression.FileSystem -ErrorAction Stop
                [IO.Compression.ZipFile]::ExtractToDirectory($src, $unpack)
              }
            }
            catch {
              Try {
                $s = New-Object -ComObject Shell.Application
                ($s.NameSpace($unpack)).CopyHere(($s.NameSpace($src)).Items(), 0x610)
              }
              Finally {
                [void][Runtime.Interopservices.Marshal]::ReleaseComObject($s)
              }
            }
            dir $unpack | cp -dest "$dst/" -force -recurse
            rm $unpack -recurse -force
          }

          $hash_file = @{
            "76cdb2bad9582d23c1f6f4d868218d6c" = @{
              "dst" = "$env:TEMP\kitchen\cache";
              "tmpzip" = "$env:TEMP\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip"
            };
            "33968442c0ef69a92763825b33850e28" = @{
              "dst" = "$env:TEMP\kitchen\cookbooks";
              "tmpzip" = "$env:TEMP\winrm-upload\tmpzip-33968442c0ef69a92763825b33850e28.zip"
            }
          }
          Decode-Files $hash_file | ConvertTo-Csv -NoTypeInformation
           with id: 0C13D20C-E670-4C6A-95C1-0182B81C22B1
          D      [WinRM] creating command_id: 0C13D20C-E670-4C6A-95C1-0182B81C22B1 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
          D      [WinRM] cleaning up command_id: 0C13D20C-E670-4C6A-95C1-0182B81C22B1 on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      Parsing CSV Response
          D      "src_md5","tmpzip","dst"
          "33968442c0ef69a92763825b33850e28","C:\Users\ADMINI~1\AppData\Local\Temp\winrm-upload\tmpzip-33968442c0ef69a92763825b33850e28.zip","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cookbooks"
          "76cdb2bad9582d23c1f6f4d868218d6c","C:\Users\ADMINI~1\AppData\Local\Temp\winrm-upload\tmpzip-76cdb2bad9582d23c1f6f4d868218d6c.zip","C:\Users\ADMINI~1\AppData\Local\Temp\kitchen\cache"

          D      Cleaned up src_zip /tmp/cheftest/tmpzip-20160723-30984-5ypvg0.zip
          D      Cleaned up src_zip /tmp/cheftest/tmpzip-20160723-30984-1nzoko3.zip
          D      Uploaded 5 items dirty_check: (0m0.21s) stream_files: (0m2.06s) extract: (0m0.68s)
          D      Transfer complete
          D      Attempting to execute command - try 1 of 1.
          D      [WinRM] <{:endpoint=>"http://10.194.8.230:5985/wsman", :user=>"administrator", :password=>"Ep)GS4mK2cs", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"Ep)GS4mK2cs", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> ($env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine")

          & $env:systemdrive\opscode\chef\bin\chef-client.bat --local-mode --config $env:TEMP\kitchen\client.rb --log_level auto --force-formatter --no-color --json-attributes $env:TEMP\kitchen\dna.json --chef-zero-port 8889 ; exit $LastExitCode)
          D      [WinRM] Command created for $env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine")

          & $env:systemdrive\opscode\chef\bin\chef-client.bat --local-mode --config $env:TEMP\kitchen\client.rb --log_level auto --force-formatter --no-color --json-attributes $env:TEMP\kitchen\dna.json --chef-zero-port 8889 ; exit $LastExitCode with id: 11E0FF69-F7BF-4EF6-AEEC-A4E4404ADABC
          D      [WinRM] creating command_id: 11E0FF69-F7BF-4EF6-AEEC-A4E4404ADABC on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
                 Starting Chef Client, version 12.13.12
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output
                 Creating a new client identity for fips-unit-functional-windows-2012r2 using the validator key.
                 resolving cookbooks for run list: []
                 Synchronizing Cookbooks:
                 Installing Cookbook Gems:
                 Compiling Cookbooks...
                 [2016-07-23T20:06:10+00:00] WARN: Node fips-unit-functional-windows-2012r2 has an empty run list.
                 Converging 0 resources
                 Starting audit phase
          D      [WinRM] Waiting for output...
          D      [WinRM] Processing output

                 Finished in 0 seconds (files took 0.64062 seconds to load)
                 0 examples, 0 failures
                 Auditing complete

                 Running handlers:
                 Running handlers complete
                 Chef Client finished, 0/0 resources updated in 32 seconds
                 [2016-07-23T20:06:11+00:00] ERROR: Failed to post audit report to server. Saving report to C:/Users/ADMINI~1/AppData/Local/Temp/kitchen/cache/failed-audit-data.json
          D      [WinRM] cleaning up command_id: 11E0FF69-F7BF-4EF6-AEEC-A4E4404ADABC on shell_id CF542523-5516-4622-ABC7-318AD80A8CAC
          D      Cleaning up local sandbox in /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160723-30984-cwcrb
                 Finished converging <fips-unit-functional-windows-2012r2> (2m15.07s).
          D      ------Exception-------
          D      Class: Kitchen::ActionFailed
          D      Message: 1 actions failed.
          >>>>>>     Failed to complete #converge action: [[WSMAN ERROR CODE: 2150858843]: <f:WSManFault Code='2150858843' Machine='10.194.14.207' xmlns:f='http://schemas.microsoft.com/wbem/wsman/1/wsmanfault'><f:Message>The request for the Windows Remote Shell with ShellId B3CB91B4-00B5-4896-B5AB-F0D806AFE763 failed because the shell was not found on the server. Possible causes are: the specified ShellId is incorrect or the shell no longer exists on the server. Provide the correct ShellId or create a new shell and retry the operation. </f:Message></f:WSManFault>] on fips-integration-windows-2012r2
          D      ----------------------
          D      ------Backtrace-------
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:187:in `report_errors'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:178:in `run_action'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:39:in `block in call'
          D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:37:in `call'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:56:in `perform'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:184:in `block (2 levels) in <class:CLI>'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/command.rb:27:in `run'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/invocation.rb:126:in `invoke_command'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:325:in `invoke_task'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor.rb:359:in `dispatch'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/base.rb:440:in `start'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `block in <top (required)>'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/errors.rb:174:in `with_friendly_errors'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `<top (required)>'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `load'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `<top (required)>'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `load'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `kernel_load'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:24:in `run'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:304:in `exec'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor.rb:359:in `dispatch'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/base.rb:440:in `start'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:11:in `start'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:27:in `block in <top (required)>'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/friendly_errors.rb:98:in `with_friendly_errors'
          D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:19:in `<top (required)>'
          D      /opt/chefdk/embedded/bin/bundle:22:in `load'
          D      /opt/chefdk/embedded/bin/bundle:22:in `<main>'
          D      ----End Backtrace-----
          D      -Composite Exception--
          D      Class: Kitchen::ActionFailed
          D      Message: Failed to complete #converge action: [[WSMAN ERROR CODE: 2150858843]: <f:WSManFault Code='2150858843' Machine='10.194.14.207' xmlns:f='http://schemas.microsoft.com/wbem/wsman/1/wsmanfault'><f:Message>The request for the Windows Remote Shell with ShellId B3CB91B4-00B5-4896-B5AB-F0D806AFE763 failed because the shell was not found on the server. Possible causes are: the specified ShellId is incorrect or the shell no longer exists on the server. Provide the correct ShellId or create a new shell and retry the operation. </f:Message></f:WSManFault>] on fips-integration-windows-2012r2
          D      ----------------------
          D      ------Backtrace-------
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/http/response_handler.rb:69:in `raise_if_wsman_fault'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/http/response_handler.rb:52:in `raise_if_error'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/http/transport.rb:186:in `send_request'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/http/transport.rb:181:in `send_request'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/shells/base.rb:146:in `cleanup_command'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/shells/base.rb:128:in `ensure in with_command_shell'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/shells/base.rb:128:in `with_command_shell'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/shells/base.rb:75:in `run'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
          D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:138:in `converge'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
          D      ----End Backtrace-----
          D      ---Nested Exception---
          D      Class: Kitchen::ActionFailed
          D      Message: Failed to complete #converge action: [[WSMAN ERROR CODE: 2150858843]: <f:WSManFault Code='2150858843' Machine='10.194.14.207' xmlns:f='http://schemas.microsoft.com/wbem/wsman/1/wsmanfault'><f:Message>The request for the Windows Remote Shell with ShellId B3CB91B4-00B5-4896-B5AB-F0D806AFE763 failed because the shell was not found on the server. Possible causes are: the specified ShellId is incorrect or the shell no longer exists on the server. Provide the correct ShellId or create a new shell and retry the operation. </f:Message></f:WSManFault>]
          D      ----------------------
          D      ------Backtrace-------
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/http/response_handler.rb:69:in `raise_if_wsman_fault'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/http/response_handler.rb:52:in `raise_if_error'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/http/transport.rb:186:in `send_request'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/http/transport.rb:181:in `send_request'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/shells/base.rb:146:in `cleanup_command'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/shells/base.rb:128:in `ensure in with_command_shell'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/shells/base.rb:128:in `with_command_shell'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-0f35bbd96302/lib/winrm/shells/base.rb:75:in `run'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
          D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:138:in `converge'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
          D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
          D      ----End Backtrace-----
          STDERR: >>>>>> ------Exception-------
          >>>>>> Class: Kitchen::ActionFailed
          >>>>>> Message: 1 actions failed.
          >>>>>>     Failed to complete #converge action: [[WSMAN ERROR CODE: 2150858843]: <f:WSManFault Code='2150858843' Machine='10.194.14.207' xmlns:f='http://schemas.microsoft.com/wbem/wsman/1/wsmanfault'><f:Message>The request for the Windows Remote Shell with ShellId B3CB91B4-00B5-4896-B5AB-F0D806AFE763 failed because the shell was not found on the server. Possible causes are: the specified ShellId is incorrect or the shell no longer exists on the server. Provide the correct ShellId or create a new shell and retry the operation. </f:Message></f:WSManFault>] on fips-integration-windows-2012r2
          >>>>>> ----------------------
          >>>>>> Please see .kitchen/logs/kitchen.log for more details
          >>>>>> Also try running `kitchen diagnose --all` for configuration
          ---- End output of bundle exec kitchen converge  -c -l debug ----
          Ran bundle exec kitchen converge  -c -l debug returned 20

          Cookbook Trace:
          ---------------
          /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:52:in `block in <class:Kitchen>'

          Resource Declaration:
          ---------------------
          # In /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb

            1: kitchen "converge"

          Compiled Resource:
          ------------------
          # Declared in /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb:1:in `from_file'

          kitchen("converge") do
            action [:run]
            retries 0
            retry_delay 2
            default_guard_interpreter :default
            declared_type :kitchen
            cookbook_name "acceptance-cookbook"
            recipe_name "provision"
            chef_product "chef"
            kitchen_dir "/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/fips"
            command "converge"
            kitchen_options "-c -l debug"
          end

          Platform:
          ---------
          x86_64-linux

      Starting audit phase
    12780: |2

      Running handlers:
      [2016-07-23T20:06:13+00:00] ERROR: Running exception handlers
      Running handlers complete
      [2016-07-23T20:06:13+00:00] ERROR: Exception handlers complete
      Chef Client failed. 0 resources updated in 04 minutes 41 seconds
      [2016-07-23T20:06:13+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/failed-audit-data.json
      [2016-07-23T20:06:13+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/chef-stacktrace.out
      [2016-07-23T20:06:13+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
      [2016-07-23T20:06:13+00:00] ERROR: Found 1 errors, they are stored in the backtrace
      [2016-07-23T20:06:13+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
      STDERR:
      ---- End output of chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/dna.json -o acceptance-cookbook::provision --no-color ----
      Ran chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/dna.json -o acceptance-cookbook::provision --no-color returned 1
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:289:in `invalid!'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:276:in `error!'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:53:in `block in run!'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `block in with_clean_env'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:447:in `with_env'
      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `with_clean_env'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:42:in `run!'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:149:in `run_command'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:116:in `block in run_suite'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `each'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `run_suite'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:76:in `block (2 levels) in start_worker'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `loop'
      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `block in start_worker'
      CHEF-ACCEPTANCE::[2016-07-23 20:06:14 +0000] --force-destroy specified so attempting to run the destroy recipe
      FIPS::DESTROY::[2016-07-23 20:06:14 +0000] Initialized [/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/logs/fips/destroy.log] logger...
    12877: |
      CHEF-ACCEPTANCE::[2016-07-23 20:06:24 +0000] | fips            | Total         | 00:04:57 | Y     |
      CHEF-ACCEPTANCE::[2016-07-23 20:06:24 +0000] | Run             | Total         | 00:05:45 | Y     |
      Build step 'Invoke XShell command' marked build as failure
      Archiving artifacts
      Recording fingerprints
steps:
  total: 7m18s
  before (setup time): 1m33s
  CHEF-ACCEPTANCE:
    total: 5m46s
    OMNITRUCK::PROVISION: 17s
    TRIVIAL::PROVISION: 1m10s
    TOP-COOKBOOKS::PROVISION: 18s
    TOP-COOKBOOKS::DESTROY: 15s
    OMNITRUCK::VERIFY: 17s
    WINDOWS-SERVICE::PROVISION: 11s
    OMNITRUCK::DESTROY: 12s
    WINDOWS-SERVICE::VERIFY: 11s
    FIPS::PROVISION: 4m48s
    WINDOWS-SERVICE::DESTROY: 12s
    BASICS::PROVISION: 1m41s
    TRIVIAL::VERIFY: 19s
    TRIVIAL::DESTROY: 11s
    DATA-COLLECTOR::PROVISION: 1m11s
    BASICS::VERIFY: 21s
    DATA-COLLECTOR::VERIFY: 38s
    BASICS::DESTROY: 17s
    DATA-COLLECTOR::DESTROY: 2m5s
    FIPS::DESTROY: 10s
chef_acceptance_timing:
- top-cookbooks:
    provision: 9s
    force-destroy: 9s
    Total: 32s
  omnitruck:
    provision: 10s
    verify: 11s
    destroy: 7s
    Total: 47s
  windows-service:
    provision: 7s
    verify: 6s
    destroy: 7s
    Total: 34s
  trivial:
    provision: 42s
    verify: 12s
    destroy: 7s
    Total: 1m40s
  basics:
    provision: 1m23s
    verify: 13s
    destroy: 7s
    Total: 2m12s
  data-collector:
    provision: 1m3s
    verify: 27s
    destroy: 7s
    Total: 1m59s
  fips:
    provision: 4m2s
    force-destroy: 7s
    Total: 4m57s
  Run:
    Total: 5m45s

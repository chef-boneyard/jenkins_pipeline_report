---
result: FAILURE
url: http://manhattan.ci.chef.co/job/chef-trigger-ad_hoc/74/
failure_category: code
failure_cause: 'chef_acceptance[trivial::provision,fips::provision,windows-service::verify]:
  acceptance: chef-test'
timestamp: 2016-07-20 21:27:39 UTC
duration: 7h53m44s
triggered_by: chef-jenkins
active_duration: 1h52m12s
queue_delays: 20s
retry_delays: 6h1m11s
parameters:
  GIT_REF: ksubrama/acceptance
  EXPIRE_CACHE: false
change:
  git_remote: git://github.com/chef/chef.git
  git_commit: 4a02be687b552b6fb7974c9ad4bcb9834318e43c
  project: chef
  version: 12.13.8+20160721014124
stages:
  chef-test:
    result: FAILURE
    failure_category: code
    failure_cause: 'chef_acceptance[trivial::provision,fips::provision,windows-service::verify]:
      acceptance'
    url: http://manhattan.ci.chef.co/job/chef-test/81/
    duration: 3h6m46s
    active_duration: 1h18m40s
    retries: 1
    retry_delay: 1h48m6s
    queue_delay: 10s
    runs:
      acceptance:
        result: FAILURE
        failure_category: code
        failure_cause: chef_acceptance[trivial::provision,fips::provision,windows-service::verify]
        failed_in:
          chef_acceptance:
          - trivial::provision
          - fips::provision
          - windows-service::verify
          step: CHEF-ACCEPTANCE
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=acceptance,project=chef,role=tester/81/
        duration: 46m3s
        logs:
          consoleText:
            1004: |
              TRIVIAL::PROVISION::[2016-07-21 04:07:56 +0000]

                    ================================================================================
                    Error executing action `run` on resource 'ruby_block[copy_kitchen_logs_to_data_path]'
                    ================================================================================

                    Mixlib::ShellOut::ShellCommandFailed
                    ------------------------------------
                    Expected process to exit with [0], but received '20'
                    ---- Begin output of bundle exec kitchen setup  -c -l debug ----
                    STDOUT: -----> Starting Kitchen (v1.10.2)
                    D      winrm requested, loading winrm gem (["~> 2.0"])
                    D      winrm is loaded.
                    D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                    D      winrm-fs is loaded.
                    -----> Creating <chef-current-install-windows-2012r2>...
                    D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
                    D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
                    D      Search returned 3 images:
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
                    D      Image for chef-current-install-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                           Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
                    D      No SSH username specified: using default username administrator  for image ami-26e72546, which we detected as windows 2012r2rtm x86_64.
                           If you are not using an account that qualifies under the AWS
                    free-tier, you may be charged to run these suites. The charge
                    should be minimal, but neither Test Kitchen nor its maintainers
                    are responsible for your incurred costs.

                    D      Creating EC2 instance in region us-west-2 with properties:
                    D      - instance_type = "m3.large"
                    D      - ebs_optimized = false
                    D      - image_id = "ami-26e72546"
                    D      - key_name = "jenkins"
                    D      - subnet_id = "subnet-19ac017c"
                    D      - private_ip_address = nil
                    D      - placement = {:availability_zone=>"us-west-2a"}
                    D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                    D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNY
              TRIVIAL::PROVISION::[2016-07-21 04:07:56 +0000] W5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                           Instance <i-dc8d0a73> requested.
            2192: |2
                    D      Class: Kitchen::ActionFailed
                    D      Message: 1 actions failed.
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                    D      ----------------------
                    D      ------Backtrace-------
            2230: |2
                    D      -Composite Exception--
                    D      Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                    D      ----------------------
                    D      ------Backtrace-------
            2268: |2
                    D      ---Nested Exception---
                    D      Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                    D      ----------------------
                    D      ------Backtrace-------
            2307: |2
                    >>>>>> Class: Kitchen::ActionFailed
                    >>>>>> Message: 1 actions failed.
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                    >>>>>> ----------------------
                    >>>>>> Please see .kitchen/logs/kitchen.log for more details
            2316: |2
                    Cookbook Trace:
                    ---------------
                    /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                    Resource Declaration:
            2369: |2


                  ================================================================================
                  Error executing action `run` on resource 'kitchen[setup]'
                  ================================================================================

                  Mixlib::ShellOut::ShellCommandFailed
                  ------------------------------------
                  ruby_block[copy_kitchen_logs_to_data_path] (/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb line 39) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '20'
                  ---- Begin output of bundle exec kitchen setup  -c -l debug ----
                  STDOUT: -----> Starting Kitchen (v1.10.2)
                  D      winrm requested, loading winrm gem (["~> 2.0"])
                  D      winrm is loaded.
                  D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                  D      winrm-fs is loaded.
                  -----> Creating <chef-current-install-windows-2012r2>...
                  D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
                  D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
                  D      Search returned 3 images:
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
                  D      Image for chef-current-install-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                         Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
                  D      No SSH username specified: using default username administrator  for image ami-26e72546, which we detected as windows 2012r2rtm x86_64.
                         If you are not using an account that qualifies under the AWS
                  free-tier, you may be charged to run these suites. The charge
                  should be minimal, but neither Test Kitchen nor its maintainers
                  are responsible for your incurred costs.

                  D      Creating EC2 instance in region us-west-2 with properties:
                  D      - instance_type = "m3.large"
                  D      - ebs_optimized = false
                  D      - image_id = "ami-26e72546"
                  D      - key_name = "jenkins"
                  D      - subnet_id = "subnet-19ac017c"
                  D      - private_ip_address = nil
                  D      - placement = {:availability_zone=>"us-west-2a"}
                  D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                  D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR
              TRIVIAL::PROVISION::[2016-07-21 04:07:56 +0000] 0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                         Instance <i-dc8d0a73> requested.
            3540: |2
                  D      Class: Kitchen::ActionFailed
                  D      Message: 1 actions failed.
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                  D      ----------------------
                  D      ------Backtrace-------
            3579: |2
                  D      -Composite Exception--
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                  D      ----------------------
                  D      ------Backtrace-------
            3616: |2
                  D      ---Nested Exception---
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                  D      ----------------------
                  D      ------Backtrace-------
            3655: |2
                  >>>>>> Class: Kitchen::ActionFailed
                  >>>>>> Message: 1 actions failed.
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                  >>>>>> ----------------------
                  >>>>>> Please see .kitchen/logs/kitchen.log for more details
            3664: |2
                  Cookbook Trace:
                  ---------------
                  /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                  Resource Declaration:
            3702: |2

              Running handlers:
              [2016-07-21T04:07:57+00:00] ERROR: Running exception handlers
              Running handlers complete
              [2016-07-21T04:07:57+00:00] ERROR: Exception handlers complete
              Chef Client failed. 0 resources updated in 02 minutes 41 seconds
              [2016-07-21T04:07:57+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/failed-audit-data.json
              [2016-07-21T04:07:57+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/chef-stacktrace.out
              [2016-07-21T04:07:57+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
              [2016-07-21T04:07:57+00:00] ERROR: Found 1 errors, they are stored in the backtrace
              TRIVIAL::PROVISION::[2016-07-21 04:07:57 +0000] [2016-07-21T04:07:57+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
              CHEF-ACCEPTANCE::[2016-07-21 04:07:57 +0000] Encountered an error running the recipe provision: Expected process to exit with [0], but received '1'
              ---- Begin output of chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/dna.json -o acceptance-cookbook::provision --no-color ----
            3728: |2
                  * ruby_block[copy_kitchen_logs_to_data_path] action run

                    ================================================================================
                    Error executing action `run` on resource 'ruby_block[copy_kitchen_logs_to_data_path]'
                    ================================================================================

                    Mixlib::ShellOut::ShellCommandFailed
                    ------------------------------------
                    Expected process to exit with [0], but received '20'
                    ---- Begin output of bundle exec kitchen setup  -c -l debug ----
                    STDOUT: -----> Starting Kitchen (v1.10.2)
                    D      winrm requested, loading winrm gem (["~> 2.0"])
                    D      winrm is loaded.
                    D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                    D      winrm-fs is loaded.
                    -----> Creating <chef-current-install-windows-2012r2>...
                    D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
                    D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
                    D      Search returned 3 images:
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
                    D      Image for chef-current-install-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                           Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
                    D      No SSH username specified: using default username administrator  for image ami-26e72546, which we detected as windows 2012r2rtm x86_64.
                           If you are not using an account that qualifies under the AWS
                    free-tier, you may be charged to run these suites. The charge
                    should be minimal, but neither Test Kitchen nor its maintainers
                    are responsible for your incurred costs.

                    D      Creating EC2 instance in region us-west-2 with properties:
                    D      - instance_type = "m3.large"
                    D      - ebs_optimized = false
                    D      - image_id = "ami-26e72546"
                    D      - key_name = "jenkins"
                    D      - subnet_id = "subnet-19ac017c"
                    D      - private_ip_address = nil
                    D      - placement = {:availability_zone=>"us-west-2a"}
                    D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                    D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                           Instance <i-dc8d0a73> requested.
                           Polling AWS for existence, attempt 0...
                           Attempting to tag the instance, 0 retries
                           EC2 instance <i-dc8d0a73> created.
                           Waited 0/300s for instance <i-dc8d0a73> to become ready.
                           Waited 5/300s for instance <i-dc8d0a73> to become ready.
                           Waited 10/300s for instance <i-dc8d0a73> to become ready.
                           Waited 15/300s for instance <i-dc8d0a73> to become ready.
                           Waited 20/300s for instance <i-dc8d0a73> to become ready.
                           Waited 25/300s for instance <i-dc8d0a73> to become ready.
                           Waited 30/300s for instance <i-dc8d0a73> to become ready.
                           Waited 35/300s for instance <i-dc8d0a73> to become ready.
                           Waited 40/300s for instance <i-dc8d0a73> to become ready.
                           Waited 45/300s for instance <i-dc8d0a73> to become ready.
                           Waited 50/300s for instance <i-dc8d0a73> to become ready.
                           Waited 55/300s for instance <i-dc8d0a73> to become ready.
                           Waited 60/300s for instance <i-dc8d0a73> to become ready.
                           Waited 65/300s for instance <i-dc8d0a73> to become ready.
                           Waited 70/300s for instance <i-dc8d0a73> to become ready.
                           Waited 75/300s for instance <i-dc8d0a73> to become ready.
                           Waited 80/300s for instance <i-dc8d0a73> to become ready.
                           Waited 85/300s for instance <i-dc8d0a73> to become ready.
                           Waited 90/300s for instance <i-dc8d0a73> to become ready.
                           Waited 95/300s for instance <i-dc8d0a73> to become ready.
                           Waited 100/300s for instance <i-dc8d0a73> to become ready.
                    D      Console output: ---
                    2016/07/21 04:06:59Z: EC2ConfigMonitorState: 0
                    2016/07/21 04:06:59Z: Windows sysprep configuration complete.
                    2016/07/21 04:07:04Z: AMI Origin Version: 2016.07.13
                    2016/07/21 04:07:04Z: AMI Origin Name: Windows_Server-2012-R2_RTM-English-64Bit-Base
                    2016/07/21 04:07:04Z: OS: Microsoft Windows NT 6.3.9600
                    2016/07/21 04:07:04Z: OsVersion: 6.3
                    2016/07/21 04:07:04Z: OsProductName: Windows Server 2012 R2 Standard
                    2016/07/21 04:07:04Z: OsBuildLabEx: 9600.18289.amd64fre.winblue_ltsb.160328-1315
                    2016/07/21 04:07:04Z: Language: en-US
                    2016/07/21 04:07:04Z: TimeZone: Coordinated Universal Time
                    2016/07/21 04:07:04Z: Offset: UTC 00:00:00
                    2016/07/21 04:07:04Z: EC2 Agent: Ec2Config service v3.17.1032
                    2016/07/21 04:07:07Z: Message: Waiting for meta-data accessibility...
                    2016/07/21 04:07:07Z: Message: Meta-data is now available.
                    2016/07/21 04:07:09Z: AMI-ID: ami-26e72546
                    2016/07/21 04:07:09Z: Instance-ID: i-dc8d0a73
                    2016/07/21 04:07:11Z: Driver: AWS PV Network Device v7.4.2.0
                    2016/07/21 04:07:11Z: Driver: AWS PV Storage Host Adapter v7.4.2.0
                    2016/07/21 04:07:11Z: Ec2SetPassword: Enabled
                    2016/07/21 04:07:12Z: RDPCERTIFICATE-SUBJECTNAME: WIN-LIONCL3F4TN
                    2016/07/21 04:07:12Z: RDPCERTIFICATE-THUMBPRINT: 5386FF34763DAE948E0B66AF225C5E25A0E5ECD3
                    2016/07/21 04:07:15Z: Username: Administrator
                    2016/07/21 04:07:15Z: Password: <Password>
                    RHhyxJjJ1HzQ/lJKiwJ9sJTfj0D9xBjhIFeY4FhE3D/2H0wFgSLJMH/JMFSQoe/95MBbTW6Yk5lpacCcJppFxAIS6uVf9feFJQbtVUNnmH01cshlTZgZrBMAgOI0zdIe7Qkqil83Yq4fS87srBXw42CYuqQBz2MKhXzF+5jEBu4iy+9ZT0i4mFx5o3Hfd+HEObR47p95dnZyPm5R+9BXjWxLLmDc610up9bKN6GM5+ykArY3i6hDSUDAdMH6mu/6Gzrtrgg4mhxeTEyO3aSDfjv6i++ZLqbBIK6iomqIyhbjzgCySpPCx/69pyC/gpQp2/o0tDBX2X80EN8ySHhyFA==
                    </Password>
                    2016/07/21 04:07:16Z: Message: Windows is Ready to use

                           Waited 0/300s for instance <i-dc8d0a73> to fetch windows admin password.
                           Retrieved Windows password for instance <i-dc8d0a73>.
                           EC2 instance <i-dc8d0a73> ready.
                    D      [WinRM] <{:endpoint=>"http://10.194.9.206:5985/wsman", :user=>"administrator", :password=>"N6U=-jRPW-3", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"N6U=-jRPW-3", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (Write-Host '[WinRM] Established
                    ')
                    D      [WinRM] opening remote shell on http://10.194.9.206:5985/wsman
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                    D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x007f0e98597f60 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.2</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                    D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x007f0e9862fea0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">2.0</Version></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version></LST></Obj></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">6.3.9600.17400</Version></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.2</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                    D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x007f0e986d3d70 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                    D      [WinRM] remote shell created with shell_id: 7716CE4B-C1B0-474D-B028-38788FC16460
                    D      [WinRM] Command created for Write-Host '[WinRM] Established
                    ' with id: 42E409CF-65E2-4586-8901-FD1489CBA873
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                           [WinRM] Established

                    D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.9.206:5985/wsman", :user=>"administrator", :password=>"N6U=-jRPW-3", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"N6U=-jRPW-3", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                    D      [WinRM] <{:endpoint=>"http://10.194.9.206:5985/wsman", :user=>"administrator", :password=>"N6U=-jRPW-3", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"N6U=-jRPW-3", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File)
                    D      [WinRM] Command created for New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File with id: 95B70569-282B-4170-AD71-807BA1AE3E86
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output


                               Directory: C:\chef\ohai\hints


                           Mode                LastWriteTime     Length Name
                           ----                -------------     ------ ----
                           -a---         7/21/2016   4:07 AM          0 ec2.json


                    D      ec2:create '10.194.9.206'
                           Finished creating <chef-current-install-windows-2012r2> (2m22.98s).
                    -----> Converging <chef-current-install-windows-2012r2>...
                           Preparing files for transfer
                    D      Creating local sandbox in /tmp/cheftest/chef-current-install-windows-2012r2-sandbox-20160721-19710-ag1ihh
                           Preparing dna.json
                    D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                           Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                           Removing non-cookbook files before transfer
                           Preparing validation.pem
                    D      Using a dummy validation.pem
                           Preparing client.rb
                    D      Creating client.rb from {:node_name=>"chef-current-install-windows-2012r2", :checksum_path=>"\#{ENV['TEMP']}\\kitchen\\checksums", :file_cache_path=>"\#{ENV['TEMP']}\\kitchen\\cache", :file_backup_path=>"\#{ENV['TEMP']}\\kitchen\\backup", :cookbook_path=>["\#{ENV['TEMP']}\\kitchen\\cookbooks", "\#{ENV['TEMP']}\\kitchen\\site-cookbooks"], :data_bag_path=>"\#{ENV['TEMP']}\\kitchen\\data_bags", :environment_path=>"\#{ENV['TEMP']}\\kitchen\\environments", :node_path=>"\#{ENV['TEMP']}\\kitchen\\nodes", :role_path=>"\#{ENV['TEMP']}\\kitchen\\roles", :client_path=>"\#{ENV['TEMP']}\\kitchen\\clients", :user_path=>"\#{ENV['TEMP']}\\kitchen\\users", :validation_key=>"\#{ENV['TEMP']}\\kitchen\\validation.pem", :client_key=>"\#{ENV['TEMP']}\\kitchen\\client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"\#{ENV['TEMP']}\\kitchen\\encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
                    D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.9.206:5985/wsman", :user=>"administrator", :password=>"N6U=-jRPW-3", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"N6U=-jRPW-3", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                    D      [WinRM] <{:endpoint=>"http://10.194.9.206:5985/wsman", :user=>"administrator", :password=>"N6U=-jRPW-3", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"N6U=-jRPW-3", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (new-module -name Omnitruck -scriptblock {
                    function Get-PlatformVersion {
                      switch -regex ((get-wmiobject win32_operatingsystem).version) {
                        '10\.0\.\d+' {$platform_version = '2012r2'}
                        '6\.3\.\d+'  {$platform_version = '2012r2'}
                        '6\.2\.\d+'  {$platform_version = '2012'}
                        '6\.1\.\d+'  {$platform_version = '2008r2'}
                        '6\.0\.\d+'  {$platform_version = '2008'}
                      }
                      return $platform_version
                    }

                    function Get-PlatformArchitecture {
                      if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                        $architecture = 'x86_64'
                      } else {
                        $architecture = 'i386'
                      }
                      return $architecture
                    }

                    function New-Uri {
                      param ($baseuri, $newuri)

                      try {
                      new-object System.Uri $baseuri, $newuri
                      }
                      catch [System.Management.Automation.MethodInvocationException]{
                        Write-Error "$($_.exception.message)"
                        throw $_.exception
                      }
                    }

                    function Get-WebContent {
                      param ($uri, $filepath)
                      $proxy = New-Object -TypeName System.Net.WebProxy
                      $wc = new-object System.Net.WebClient
                      $proxy.Address = $env:http_proxy
                      $wc.Proxy = $proxy

                      try {
                        if ([string]::IsNullOrEmpty($filepath)) {
                          $wc.downloadstring($uri)
                        }
                        else {
                          $wc.downloadfile($uri, $filepath)
                        }
                      }
                      catch {
                        $exception = $_.Exception
                        Write-Host "There was an error: "
                        do {
                          Write-Host "`t$($exception.message)"
                          $exception = $exception.innerexception
                        } while ($exception)
                        throw "Failed to download from $uri."
                      }
                    }

                    function Test-ProjectPackage {
                      [cmdletbinding()]
                      param ($Path, $Algorithm = 'SHA256', $Hash)

                      if (-not (get-command get-filehash))   {
                        function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                        function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                        function Get-FileHash ($Path, $Algorithm) {
                          $Path = (resolve-path $path).providerpath
                          $hash = @{Algorithm = $Algorithm; Path = $Path}
                          use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                            use ($in = (gi $path).OpenRead()) {
                              $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                            }
                          }
                          new-object PSObject -Property $hash
                        }
                      }
                      Write-Verbose "Testing the $Algorithm hash for $path."
                      $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                      Write-Verbose "`tDesired Hash - '$hash'"
                      Write-Verbose "`tActual Hash  - '$ActualHash'"
                      $Valid = $ActualHash -eq $Hash
                      if (-not $Valid) {
                        Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                      }
                      return $Valid
                    }

                    function Get-ProjectMetadata {
                      <#
                        .SYNOPSIS
                        Get metadata for a Chef Software, Inc. project
                        .DESCRIPTION
                        Get metadata for project
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                        Gets the download url and SHA256 checksum for the latest stable release of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                        Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                      #>
                      [cmdletbinding()]
                      param (
                        # Base url to retrieve metadata from.
                        [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                        [string]
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Release channel to install from
                        $channel = 'unstable',
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      # PowerShell is only on Windows ATM
                      $platform = 'windows'
                      Write-Verbose "Platform: $platform"

                      $platform_version = Get-PlatformVersion
                      Write-Verbose "Platform Version: $platform_version"

                      if ($architecture -eq 'auto') {
                        $architecture = Get-PlatformArchitecture
                      }

                      Write-Verbose "Architecture: $architecture"
                      Write-Verbose "Project: $project"


                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                      $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                      $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                        foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                      Write-Verbose "Project details: "
                      foreach ($key in $package_metadata.keys) {
                        Write-Verbose "`t$key = $($package_metadata[$key])"
                      }
                      $package_metadata
                    }

                    function Install-Project {
                      <#
                        .SYNOPSIS
                        Install a Chef Software, Inc. product
                        .DESCRIPTION
                        Install a Chef Software, Inc. product
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                        Installs the latest stable version of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                        Installs the latest integration build of the Chef Development Kit
                      #>
                      [cmdletbinding(SupportsShouldProcess=$true)]
                      param (
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Release channel to install from
                        [validateset('current', 'stable', 'unstable')]
                        [string]
                        $channel = 'stable',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Full path for the downloaded installer.
                        [string]
                        $filename,
                        # Full path to the location to download the installer
                        [string]
                        $download_directory = $env:temp,
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                      if (-not [string]::IsNullOrEmpty($filename)) {
                        $download_directory = split-path $filename
                        $filename = split-path $filename -leaf
                        if ([string]::IsNullOrEmpty($download_directory)) {
                          $download_directory = $pwd
                        }
                      }
                      else {
                        $filename = ($package_metadata.url -split '/')[-1]
                      }
                      Write-Verbose "Download directory: $download_directory"
                      Write-Verbose "Filename: $filename"

                      if (-not (test-path $download_directory)) {
                        mkdir $download_directory
                      }
                      $download_directory = (resolve-path $download_directory).providerpath
                      $download_destination = join-path $download_directory $filename

                      if ((test-path $download_destination) -and
                        (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                        Write-Verbose "Found existing valid installer at $download_destination."
                      }
                      else {
                        if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                          Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                          Get-WebContent $package_metadata.url -filepath $download_destination
                        }
                      }

                      if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                        if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                          Write-Host "Installing $project from $download_destination"
                          $installingProject = $True
                          $installAttempts = 0
                          while ($installingProject) {
                            $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                            $p.WaitForExit()
                            if ($p.ExitCode -eq 1618) {
                              Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                              continue
                            } elseif ($p.ExitCode -ne 0) {
                              throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                            }
                            $installingProject = $False
                          }
                        }
                        else {
                          throw "Failed to validate the downloaded installer for $project."
                        }
                      }
                    }
                    set-alias install -value Install-Project
                    export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                    }

                    install -project chef -version 12.13.8+20160721014124 -channel unstable
                    )
                    D      [WinRM] Command created for new-module -name Omnitruck -scriptblock {
                    function Get-PlatformVersion {
                      switch -regex ((get-wmiobject win32_operatingsystem).version) {
                        '10\.0\.\d+' {$platform_version = '2012r2'}
                        '6\.3\.\d+'  {$platform_version = '2012r2'}
                        '6\.2\.\d+'  {$platform_version = '2012'}
                        '6\.1\.\d+'  {$platform_version = '2008r2'}
                        '6\.0\.\d+'  {$platform_version = '2008'}
                      }
                      return $platform_version
                    }

                    function Get-PlatformArchitecture {
                      if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                        $architecture = 'x86_64'
                      } else {
                        $architecture = 'i386'
                      }
                      return $architecture
                    }

                    function New-Uri {
                      param ($baseuri, $newuri)

                      try {
                      new-object System.Uri $baseuri, $newuri
                      }
                      catch [System.Management.Automation.MethodInvocationException]{
                        Write-Error "$($_.exception.message)"
                        throw $_.exception
                      }
                    }

                    function Get-WebContent {
                      param ($uri, $filepath)
                      $proxy = New-Object -TypeName System.Net.WebProxy
                      $wc = new-object System.Net.WebClient
                      $proxy.Address = $env:http_proxy
                      $wc.Proxy = $proxy

                      try {
                        if ([string]::IsNullOrEmpty($filepath)) {
                          $wc.downloadstring($uri)
                        }
                        else {
                          $wc.downloadfile($uri, $filepath)
                        }
                      }
                      catch {
                        $exception = $_.Exception
                        Write-Host "There was an error: "
                        do {
                          Write-Host "`t$($exception.message)"
                          $exception = $exception.innerexception
                        } while ($exception)
                        throw "Failed to download from $uri."
                      }
                    }

                    function Test-ProjectPackage {
                      [cmdletbinding()]
                      param ($Path, $Algorithm = 'SHA256', $Hash)

                      if (-not (get-command get-filehash))   {
                        function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                        function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                        function Get-FileHash ($Path, $Algorithm) {
                          $Path = (resolve-path $path).providerpath
                          $hash = @{Algorithm = $Algorithm; Path = $Path}
                          use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                            use ($in = (gi $path).OpenRead()) {
                              $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                            }
                          }
                          new-object PSObject -Property $hash
                        }
                      }
                      Write-Verbose "Testing the $Algorithm hash for $path."
                      $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                      Write-Verbose "`tDesired Hash - '$hash'"
                      Write-Verbose "`tActual Hash  - '$ActualHash'"
                      $Valid = $ActualHash -eq $Hash
                      if (-not $Valid) {
                        Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                      }
                      return $Valid
                    }

                    function Get-ProjectMetadata {
                      <#
                        .SYNOPSIS
                        Get metadata for a Chef Software, Inc. project
                        .DESCRIPTION
                        Get metadata for project
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                        Gets the download url and SHA256 checksum for the latest stable release of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                        Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                      #>
                      [cmdletbinding()]
                      param (
                        # Base url to retrieve metadata from.
                        [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                        [string]
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Release channel to install from
                        $channel = 'unstable',
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      # PowerShell is only on Windows ATM
                      $platform = 'windows'
                      Write-Verbose "Platform: $platform"

                      $platform_version = Get-PlatformVersion
                      Write-Verbose "Platform Version: $platform_version"

                      if ($architecture -eq 'auto') {
                        $architecture = Get-PlatformArchitecture
                      }

                      Write-Verbose "Architecture: $architecture"
                      Write-Verbose "Project: $project"


                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                      $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                      $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                        foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                      Write-Verbose "Project details: "
                      foreach ($key in $package_metadata.keys) {
                        Write-Verbose "`t$key = $($package_metadata[$key])"
                      }
                      $package_metadata
                    }

                    function Install-Project {
                      <#
                        .SYNOPSIS
                        Install a Chef Software, Inc. product
                        .DESCRIPTION
                        Install a Chef Software, Inc. product
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                        Installs the latest stable version of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                        Installs the latest integration build of the Chef Development Kit
                      #>
                      [cmdletbinding(SupportsShouldProcess=$true)]
                      param (
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Release channel to install from
                        [validateset('current', 'stable', 'unstable')]
                        [string]
                        $channel = 'stable',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Full path for the downloaded installer.
                        [string]
                        $filename,
                        # Full path to the location to download the installer
                        [string]
                        $download_directory = $env:temp,
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                      if (-not [string]::IsNullOrEmpty($filename)) {
                        $download_directory = split-path $filename
                        $filename = split-path $filename -leaf
                        if ([string]::IsNullOrEmpty($download_directory)) {
                          $download_directory = $pwd
                        }
                      }
                      else {
                        $filename = ($package_metadata.url -split '/')[-1]
                      }
                      Write-Verbose "Download directory: $download_directory"
                      Write-Verbose "Filename: $filename"

                      if (-not (test-path $download_directory)) {
                        mkdir $download_directory
                      }
                      $download_directory = (resolve-path $download_directory).providerpath
                      $download_destination = join-path $download_directory $filename

                      if ((test-path $download_destination) -and
                        (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                        Write-Verbose "Found existing valid installer at $download_destination."
                      }
                      else {
                        if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                          Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                          Get-WebContent $package_metadata.url -filepath $download_destination
                        }
                      }

                      if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                        if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                          Write-Host "Installing $project from $download_destination"
                          $installingProject = $True
                          $installAttempts = 0
                          while ($installingProject) {
                            $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                            $p.WaitForExit()
                            if ($p.ExitCode -eq 1618) {
                              Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                              continue
                            } elseif ($p.ExitCode -ne 0) {
                              throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                            }
                            $installingProject = $False
                          }
                        }
                        else {
                          throw "Failed to validate the downloaded installer for $project."
                        }
                      }
                    }
                    set-alias install -value Install-Project
                    export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                    }

                    install -project chef -version 12.13.8+20160721014124 -channel unstable
                     with id: 35C6F7D8-21D9-4252-8E53-E113AB2B5052
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output

                           ModuleType Version    Name                                ExportedCommands
                           ---------- -------    ----                                ----------------
                           Script     0.0        Omnitruck                           {Get-ProjectMetada...
                    D      [WinRM] Waiting for output...
                    D      Cleaning up local sandbox in /tmp/cheftest/chef-current-install-windows-2012r2-sandbox-20160721-19710-ag1ihh
                    D      ------Exception-------
                    D      Class: Kitchen::ActionFailed
                    D      Message: 1 actions failed.
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                    D      ----------------------
                    D      ------Backtrace-------
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:187:in `report_errors'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:178:in `run_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:39:in `block in call'
                    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:37:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:56:in `perform'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:184:in `block (2 levels) in <class:CLI>'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/command.rb:27:in `run'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/invocation.rb:126:in `invoke_command'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:325:in `invoke_task'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor.rb:359:in `dispatch'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/base.rb:440:in `start'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `block in <top (required)>'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/errors.rb:174:in `with_friendly_errors'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `<top (required)>'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `load'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `<top (required)>'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `load'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `kernel_load'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:24:in `run'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:304:in `exec'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor.rb:359:in `dispatch'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/base.rb:440:in `start'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:11:in `start'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:27:in `block in <top (required)>'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/friendly_errors.rb:98:in `with_friendly_errors'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:19:in `<top (required)>'
                    D      /opt/chefdk/embedded/bin/bundle:22:in `load'
                    D      /opt/chefdk/embedded/bin/bundle:22:in `<main>'
                    D      ----End Backtrace-----
                    D      -Composite Exception--
                    D      Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                    D      ----------------------
                    D      ------Backtrace-------
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:149:in `setup'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                    D      ----End Backtrace-----
                    D      ---Nested Exception---
                    D      Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                    D      ----------------------
                    D      ------Backtrace-------
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:149:in `setup'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                    D      ----End Backtrace-----
                    STDERR: >>>>>> ------Exception-------
                    >>>>>> Class: Kitchen::ActionFailed
                    >>>>>> Message: 1 actions failed.
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                    >>>>>> ----------------------
                    >>>>>> Please see .kitchen/logs/kitchen.log for more details
                    >>>>>> Also try running `kitchen diagnose --all` for configuration
                    ---- End output of bundle exec kitchen setup  -c -l debug ----
                    Ran bundle exec kitchen setup  -c -l debug returned 20

                    Cookbook Trace:
                    ---------------
                    /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                    Resource Declaration:
                    ---------------------
                    # In /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb

                     39:       ruby_block "copy_kitchen_logs_to_data_path" do
                     40:         block do
                     41:           cmd_env = {
                     42:             "KITCHEN_DRIVER" => driver,
                     43:             "KITCHEN_INSTANCES" => instances,
                     44:             "KITCHEN_LOCAL_YAML" => ::File.expand_path("../../.kitchen.#{driver}.yml", __FILE__),
                     45:             "KITCHEN_CHEF_PRODUCT" => chef_product,
                     46:             "KITCHEN_CHEF_CHANNEL" => chef_channel,
                     47:             "KITCHEN_CHEF_VERSION" => chef_version,
                     48:             "ARTIFACTORY_USERNAME" => artifactory_username,
                     49:             "ARTIFACTORY_PASSWORD" => artifactory_password
                     50:           }.merge(new_resource.env)
                     51:           suite = kitchen_dir.split("/").last
                     52:           kitchen_log_path = ENV["WORKSPACE"] ? "#{ENV["WORKSPACE"]}/chef-acceptance-data/logs" : "#{kitchen_dir}/../.acceptance_data/logs/"
                     53:
                     54:           begin
                     55:             shell_out!("bundle exec kitchen #{command}#{instances ? " #{instances}" : ""}#{kitchen_options ? " #{kitchen_options}" : ""}",
                     56:                        env: cmd_env,
                     57:                        cwd: kitchen_dir)
                     58:           ensure
                     59:             FileUtils.mkdir_p("#{kitchen_log_path}/#{suite}/#{command}")
                     60:             FileUtils.cp_r("#{kitchen_dir}/.kitchen/logs/.", "#{kitchen_log_path}/#{suite}/#{command}")
                     61:           end
                     62:         end
                     63:       end

                    Compiled Resource:
                    ------------------
                    # Declared in /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:39:in `block in <class:Kitchen>'

                    ruby_block("copy_kitchen_logs_to_data_path") do
                      action [:run]
                      retries 0
                      retry_delay 2
                      default_guard_interpreter :default
                      block_name "copy_kitchen_logs_to_data_path"
                      declared_type :ruby_block
                      cookbook_name "acceptance-cookbook"
                      block #<Proc:0x0000000541e9c0@/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:40>
                    end

                    Platform:
                    ---------
                    x86_64-linux


                  ================================================================================
                  Error executing action `run` on resource 'kitchen[setup]'
                  ================================================================================

                  Mixlib::ShellOut::ShellCommandFailed
                  ------------------------------------
                  ruby_block[copy_kitchen_logs_to_data_path] (/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb line 39) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '20'
                  ---- Begin output of bundle exec kitchen setup  -c -l debug ----
                  STDOUT: -----> Starting Kitchen (v1.10.2)
                  D      winrm requested, loading winrm gem (["~> 2.0"])
                  D      winrm is loaded.
                  D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                  D      winrm-fs is loaded.
                  -----> Creating <chef-current-install-windows-2012r2>...
                  D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
                  D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
                  D      Search returned 3 images:
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
                  D      Image for chef-current-install-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                         Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
                  D      No SSH username specified: using default username administrator  for image ami-26e72546, which we detected as windows 2012r2rtm x86_64.
                         If you are not using an account that qualifies under the AWS
                  free-tier, you may be charged to run these suites. The charge
                  should be minimal, but neither Test Kitchen nor its maintainers
                  are responsible for your incurred costs.

                  D      Creating EC2 instance in region us-west-2 with properties:
                  D      - instance_type = "m3.large"
                  D      - ebs_optimized = false
                  D      - image_id = "ami-26e72546"
                  D      - key_name = "jenkins"
                  D      - subnet_id = "subnet-19ac017c"
                  D      - private_ip_address = nil
                  D      - placement = {:availability_zone=>"us-west-2a"}
                  D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                  D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                         Instance <i-dc8d0a73> requested.
                         Polling AWS for existence, attempt 0...
                         Attempting to tag the instance, 0 retries
                         EC2 instance <i-dc8d0a73> created.
                         Waited 0/300s for instance <i-dc8d0a73> to become ready.
                         Waited 5/300s for instance <i-dc8d0a73> to become ready.
                         Waited 10/300s for instance <i-dc8d0a73> to become ready.
                         Waited 15/300s for instance <i-dc8d0a73> to become ready.
                         Waited 20/300s for instance <i-dc8d0a73> to become ready.
                         Waited 25/300s for instance <i-dc8d0a73> to become ready.
                         Waited 30/300s for instance <i-dc8d0a73> to become ready.
                         Waited 35/300s for instance <i-dc8d0a73> to become ready.
                         Waited 40/300s for instance <i-dc8d0a73> to become ready.
                         Waited 45/300s for instance <i-dc8d0a73> to become ready.
                         Waited 50/300s for instance <i-dc8d0a73> to become ready.
                         Waited 55/300s for instance <i-dc8d0a73> to become ready.
                         Waited 60/300s for instance <i-dc8d0a73> to become ready.
                         Waited 65/300s for instance <i-dc8d0a73> to become ready.
                         Waited 70/300s for instance <i-dc8d0a73> to become ready.
                         Waited 75/300s for instance <i-dc8d0a73> to become ready.
                         Waited 80/300s for instance <i-dc8d0a73> to become ready.
                         Waited 85/300s for instance <i-dc8d0a73> to become ready.
                         Waited 90/300s for instance <i-dc8d0a73> to become ready.
                         Waited 95/300s for instance <i-dc8d0a73> to become ready.
                         Waited 100/300s for instance <i-dc8d0a73> to become ready.
                  D      Console output: ---
                  2016/07/21 04:06:59Z: EC2ConfigMonitorState: 0
                  2016/07/21 04:06:59Z: Windows sysprep configuration complete.
                  2016/07/21 04:07:04Z: AMI Origin Version: 2016.07.13
                  2016/07/21 04:07:04Z: AMI Origin Name: Windows_Server-2012-R2_RTM-English-64Bit-Base
                  2016/07/21 04:07:04Z: OS: Microsoft Windows NT 6.3.9600
                  2016/07/21 04:07:04Z: OsVersion: 6.3
                  2016/07/21 04:07:04Z: OsProductName: Windows Server 2012 R2 Standard
                  2016/07/21 04:07:04Z: OsBuildLabEx: 9600.18289.amd64fre.winblue_ltsb.160328-1315
                  2016/07/21 04:07:04Z: Language: en-US
                  2016/07/21 04:07:04Z: TimeZone: Coordinated Universal Time
                  2016/07/21 04:07:04Z: Offset: UTC 00:00:00
                  2016/07/21 04:07:04Z: EC2 Agent: Ec2Config service v3.17.1032
                  2016/07/21 04:07:07Z: Message: Waiting for meta-data accessibility...
                  2016/07/21 04:07:07Z: Message: Meta-data is now available.
                  2016/07/21 04:07:09Z: AMI-ID: ami-26e72546
                  2016/07/21 04:07:09Z: Instance-ID: i-dc8d0a73
                  2016/07/21 04:07:11Z: Driver: AWS PV Network Device v7.4.2.0
                  2016/07/21 04:07:11Z: Driver: AWS PV Storage Host Adapter v7.4.2.0
                  2016/07/21 04:07:11Z: Ec2SetPassword: Enabled
                  2016/07/21 04:07:12Z: RDPCERTIFICATE-SUBJECTNAME: WIN-LIONCL3F4TN
                  2016/07/21 04:07:12Z: RDPCERTIFICATE-THUMBPRINT: 5386FF34763DAE948E0B66AF225C5E25A0E5ECD3
                  2016/07/21 04:07:15Z: Username: Administrator
                  2016/07/21 04:07:15Z: Password: <Password>
                  RHhyxJjJ1HzQ/lJKiwJ9sJTfj0D9xBjhIFeY4FhE3D/2H0wFgSLJMH/JMFSQoe/95MBbTW6Yk5lpacCcJppFxAIS6uVf9feFJQbtVUNnmH01cshlTZgZrBMAgOI0zdIe7Qkqil83Yq4fS87srBXw42CYuqQBz2MKhXzF+5jEBu4iy+9ZT0i4mFx5o3Hfd+HEObR47p95dnZyPm5R+9BXjWxLLmDc610up9bKN6GM5+ykArY3i6hDSUDAdMH6mu/6Gzrtrgg4mhxeTEyO3aSDfjv6i++ZLqbBIK6iomqIyhbjzgCySpPCx/69pyC/gpQp2/o0tDBX2X80EN8ySHhyFA==
                  </Password>
                  2016/07/21 04:07:16Z: Message: Windows is Ready to use

                         Waited 0/300s for instance <i-dc8d0a73> to fetch windows admin password.
                         Retrieved Windows password for instance <i-dc8d0a73>.
                         EC2 instance <i-dc8d0a73> ready.
                  D      [WinRM] <{:endpoint=>"http://10.194.9.206:5985/wsman", :user=>"administrator", :password=>"N6U=-jRPW-3", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"N6U=-jRPW-3", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (Write-Host '[WinRM] Established
                  ')
                  D      [WinRM] opening remote shell on http://10.194.9.206:5985/wsman
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                  D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x007f0e98597f60 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.2</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                  D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x007f0e9862fea0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">2.0</Version></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version></LST></Obj></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">6.3.9600.17400</Version></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.2</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                  D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x007f0e986d3d70 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                  D      [WinRM] remote shell created with shell_id: 7716CE4B-C1B0-474D-B028-38788FC16460
                  D      [WinRM] Command created for Write-Host '[WinRM] Established
                  ' with id: 42E409CF-65E2-4586-8901-FD1489CBA873
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                         [WinRM] Established

                  D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.9.206:5985/wsman", :user=>"administrator", :password=>"N6U=-jRPW-3", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"N6U=-jRPW-3", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                  D      [WinRM] <{:endpoint=>"http://10.194.9.206:5985/wsman", :user=>"administrator", :password=>"N6U=-jRPW-3", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"N6U=-jRPW-3", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File)
                  D      [WinRM] Command created for New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File with id: 95B70569-282B-4170-AD71-807BA1AE3E86
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output


                             Directory: C:\chef\ohai\hints


                         Mode                LastWriteTime     Length Name
                         ----                -------------     ------ ----
                         -a---         7/21/2016   4:07 AM          0 ec2.json


                  D      ec2:create '10.194.9.206'
                         Finished creating <chef-current-install-windows-2012r2> (2m22.98s).
                  -----> Converging <chef-current-install-windows-2012r2>...
                         Preparing files for transfer
                  D      Creating local sandbox in /tmp/cheftest/chef-current-install-windows-2012r2-sandbox-20160721-19710-ag1ihh
                         Preparing dna.json
                  D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                         Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                         Removing non-cookbook files before transfer
                         Preparing validation.pem
                  D      Using a dummy validation.pem
                         Preparing client.rb
                  D      Creating client.rb from {:node_name=>"chef-current-install-windows-2012r2", :checksum_path=>"\#{ENV['TEMP']}\\kitchen\\checksums", :file_cache_path=>"\#{ENV['TEMP']}\\kitchen\\cache", :file_backup_path=>"\#{ENV['TEMP']}\\kitchen\\backup", :cookbook_path=>["\#{ENV['TEMP']}\\kitchen\\cookbooks", "\#{ENV['TEMP']}\\kitchen\\site-cookbooks"], :data_bag_path=>"\#{ENV['TEMP']}\\kitchen\\data_bags", :environment_path=>"\#{ENV['TEMP']}\\kitchen\\environments", :node_path=>"\#{ENV['TEMP']}\\kitchen\\nodes", :role_path=>"\#{ENV['TEMP']}\\kitchen\\roles", :client_path=>"\#{ENV['TEMP']}\\kitchen\\clients", :user_path=>"\#{ENV['TEMP']}\\kitchen\\users", :validation_key=>"\#{ENV['TEMP']}\\kitchen\\validation.pem", :client_key=>"\#{ENV['TEMP']}\\kitchen\\client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"\#{ENV['TEMP']}\\kitchen\\encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
                  D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.9.206:5985/wsman", :user=>"administrator", :password=>"N6U=-jRPW-3", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"N6U=-jRPW-3", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                  D      [WinRM] <{:endpoint=>"http://10.194.9.206:5985/wsman", :user=>"administrator", :password=>"N6U=-jRPW-3", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"N6U=-jRPW-3", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (new-module -name Omnitruck -scriptblock {
                  function Get-PlatformVersion {
                    switch -regex ((get-wmiobject win32_operatingsystem).version) {
                      '10\.0\.\d+' {$platform_version = '2012r2'}
                      '6\.3\.\d+'  {$platform_version = '2012r2'}
                      '6\.2\.\d+'  {$platform_version = '2012'}
                      '6\.1\.\d+'  {$platform_version = '2008r2'}
                      '6\.0\.\d+'  {$platform_version = '2008'}
                    }
                    return $platform_version
                  }

                  function Get-PlatformArchitecture {
                    if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                      $architecture = 'x86_64'
                    } else {
                      $architecture = 'i386'
                    }
                    return $architecture
                  }

                  function New-Uri {
                    param ($baseuri, $newuri)

                    try {
                    new-object System.Uri $baseuri, $newuri
                    }
                    catch [System.Management.Automation.MethodInvocationException]{
                      Write-Error "$($_.exception.message)"
                      throw $_.exception
                    }
                  }

                  function Get-WebContent {
                    param ($uri, $filepath)
                    $proxy = New-Object -TypeName System.Net.WebProxy
                    $wc = new-object System.Net.WebClient
                    $proxy.Address = $env:http_proxy
                    $wc.Proxy = $proxy

                    try {
                      if ([string]::IsNullOrEmpty($filepath)) {
                        $wc.downloadstring($uri)
                      }
                      else {
                        $wc.downloadfile($uri, $filepath)
                      }
                    }
                    catch {
                      $exception = $_.Exception
                      Write-Host "There was an error: "
                      do {
                        Write-Host "`t$($exception.message)"
                        $exception = $exception.innerexception
                      } while ($exception)
                      throw "Failed to download from $uri."
                    }
                  }

                  function Test-ProjectPackage {
                    [cmdletbinding()]
                    param ($Path, $Algorithm = 'SHA256', $Hash)

                    if (-not (get-command get-filehash))   {
                      function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                      function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                      function Get-FileHash ($Path, $Algorithm) {
                        $Path = (resolve-path $path).providerpath
                        $hash = @{Algorithm = $Algorithm; Path = $Path}
                        use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                          use ($in = (gi $path).OpenRead()) {
                            $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                          }
                        }
                        new-object PSObject -Property $hash
                      }
                    }
                    Write-Verbose "Testing the $Algorithm hash for $path."
                    $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                    Write-Verbose "`tDesired Hash - '$hash'"
                    Write-Verbose "`tActual Hash  - '$ActualHash'"
                    $Valid = $ActualHash -eq $Hash
                    if (-not $Valid) {
                      Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                    }
                    return $Valid
                  }

                  function Get-ProjectMetadata {
                    <#
                      .SYNOPSIS
                      Get metadata for a Chef Software, Inc. project
                      .DESCRIPTION
                      Get metadata for project
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                      Gets the download url and SHA256 checksum for the latest stable release of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                      Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                    #>
                    [cmdletbinding()]
                    param (
                      # Base url to retrieve metadata from.
                      [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                      [string]
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Release channel to install from
                      $channel = 'unstable',
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    # PowerShell is only on Windows ATM
                    $platform = 'windows'
                    Write-Verbose "Platform: $platform"

                    $platform_version = Get-PlatformVersion
                    Write-Verbose "Platform Version: $platform_version"

                    if ($architecture -eq 'auto') {
                      $architecture = Get-PlatformArchitecture
                    }

                    Write-Verbose "Architecture: $architecture"
                    Write-Verbose "Project: $project"


                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                    $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                    $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                      foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                    Write-Verbose "Project details: "
                    foreach ($key in $package_metadata.keys) {
                      Write-Verbose "`t$key = $($package_metadata[$key])"
                    }
                    $package_metadata
                  }

                  function Install-Project {
                    <#
                      .SYNOPSIS
                      Install a Chef Software, Inc. product
                      .DESCRIPTION
                      Install a Chef Software, Inc. product
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                      Installs the latest stable version of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                      Installs the latest integration build of the Chef Development Kit
                    #>
                    [cmdletbinding(SupportsShouldProcess=$true)]
                    param (
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Release channel to install from
                      [validateset('current', 'stable', 'unstable')]
                      [string]
                      $channel = 'stable',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Full path for the downloaded installer.
                      [string]
                      $filename,
                      # Full path to the location to download the installer
                      [string]
                      $download_directory = $env:temp,
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                    if (-not [string]::IsNullOrEmpty($filename)) {
                      $download_directory = split-path $filename
                      $filename = split-path $filename -leaf
                      if ([string]::IsNullOrEmpty($download_directory)) {
                        $download_directory = $pwd
                      }
                    }
                    else {
                      $filename = ($package_metadata.url -split '/')[-1]
                    }
                    Write-Verbose "Download directory: $download_directory"
                    Write-Verbose "Filename: $filename"

                    if (-not (test-path $download_directory)) {
                      mkdir $download_directory
                    }
                    $download_directory = (resolve-path $download_directory).providerpath
                    $download_destination = join-path $download_directory $filename

                    if ((test-path $download_destination) -and
                      (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                      Write-Verbose "Found existing valid installer at $download_destination."
                    }
                    else {
                      if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                        Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                        Get-WebContent $package_metadata.url -filepath $download_destination
                      }
                    }

                    if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                      if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                        Write-Host "Installing $project from $download_destination"
                        $installingProject = $True
                        $installAttempts = 0
                        while ($installingProject) {
                          $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                          $p.WaitForExit()
                          if ($p.ExitCode -eq 1618) {
                            Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                            continue
                          } elseif ($p.ExitCode -ne 0) {
                            throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                          }
                          $installingProject = $False
                        }
                      }
                      else {
                        throw "Failed to validate the downloaded installer for $project."
                      }
                    }
                  }
                  set-alias install -value Install-Project
                  export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                  }

                  install -project chef -version 12.13.8+20160721014124 -channel unstable
                  )
                  D      [WinRM] Command created for new-module -name Omnitruck -scriptblock {
                  function Get-PlatformVersion {
                    switch -regex ((get-wmiobject win32_operatingsystem).version) {
                      '10\.0\.\d+' {$platform_version = '2012r2'}
                      '6\.3\.\d+'  {$platform_version = '2012r2'}
                      '6\.2\.\d+'  {$platform_version = '2012'}
                      '6\.1\.\d+'  {$platform_version = '2008r2'}
                      '6\.0\.\d+'  {$platform_version = '2008'}
                    }
                    return $platform_version
                  }

                  function Get-PlatformArchitecture {
                    if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                      $architecture = 'x86_64'
                    } else {
                      $architecture = 'i386'
                    }
                    return $architecture
                  }

                  function New-Uri {
                    param ($baseuri, $newuri)

                    try {
                    new-object System.Uri $baseuri, $newuri
                    }
                    catch [System.Management.Automation.MethodInvocationException]{
                      Write-Error "$($_.exception.message)"
                      throw $_.exception
                    }
                  }

                  function Get-WebContent {
                    param ($uri, $filepath)
                    $proxy = New-Object -TypeName System.Net.WebProxy
                    $wc = new-object System.Net.WebClient
                    $proxy.Address = $env:http_proxy
                    $wc.Proxy = $proxy

                    try {
                      if ([string]::IsNullOrEmpty($filepath)) {
                        $wc.downloadstring($uri)
                      }
                      else {
                        $wc.downloadfile($uri, $filepath)
                      }
                    }
                    catch {
                      $exception = $_.Exception
                      Write-Host "There was an error: "
                      do {
                        Write-Host "`t$($exception.message)"
                        $exception = $exception.innerexception
                      } while ($exception)
                      throw "Failed to download from $uri."
                    }
                  }

                  function Test-ProjectPackage {
                    [cmdletbinding()]
                    param ($Path, $Algorithm = 'SHA256', $Hash)

                    if (-not (get-command get-filehash))   {
                      function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                      function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                      function Get-FileHash ($Path, $Algorithm) {
                        $Path = (resolve-path $path).providerpath
                        $hash = @{Algorithm = $Algorithm; Path = $Path}
                        use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                          use ($in = (gi $path).OpenRead()) {
                            $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                          }
                        }
                        new-object PSObject -Property $hash
                      }
                    }
                    Write-Verbose "Testing the $Algorithm hash for $path."
                    $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                    Write-Verbose "`tDesired Hash - '$hash'"
                    Write-Verbose "`tActual Hash  - '$ActualHash'"
                    $Valid = $ActualHash -eq $Hash
                    if (-not $Valid) {
                      Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                    }
                    return $Valid
                  }

                  function Get-ProjectMetadata {
                    <#
                      .SYNOPSIS
                      Get metadata for a Chef Software, Inc. project
                      .DESCRIPTION
                      Get metadata for project
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                      Gets the download url and SHA256 checksum for the latest stable release of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                      Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                    #>
                    [cmdletbinding()]
                    param (
                      # Base url to retrieve metadata from.
                      [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                      [string]
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Release channel to install from
                      $channel = 'unstable',
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    # PowerShell is only on Windows ATM
                    $platform = 'windows'
                    Write-Verbose "Platform: $platform"

                    $platform_version = Get-PlatformVersion
                    Write-Verbose "Platform Version: $platform_version"

                    if ($architecture -eq 'auto') {
                      $architecture = Get-PlatformArchitecture
                    }

                    Write-Verbose "Architecture: $architecture"
                    Write-Verbose "Project: $project"


                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                    $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                    $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                      foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                    Write-Verbose "Project details: "
                    foreach ($key in $package_metadata.keys) {
                      Write-Verbose "`t$key = $($package_metadata[$key])"
                    }
                    $package_metadata
                  }

                  function Install-Project {
                    <#
                      .SYNOPSIS
                      Install a Chef Software, Inc. product
                      .DESCRIPTION
                      Install a Chef Software, Inc. product
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                      Installs the latest stable version of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                      Installs the latest integration build of the Chef Development Kit
                    #>
                    [cmdletbinding(SupportsShouldProcess=$true)]
                    param (
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Release channel to install from
                      [validateset('current', 'stable', 'unstable')]
                      [string]
                      $channel = 'stable',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Full path for the downloaded installer.
                      [string]
                      $filename,
                      # Full path to the location to download the installer
                      [string]
                      $download_directory = $env:temp,
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                    if (-not [string]::IsNullOrEmpty($filename)) {
                      $download_directory = split-path $filename
                      $filename = split-path $filename -leaf
                      if ([string]::IsNullOrEmpty($download_directory)) {
                        $download_directory = $pwd
                      }
                    }
                    else {
                      $filename = ($package_metadata.url -split '/')[-1]
                    }
                    Write-Verbose "Download directory: $download_directory"
                    Write-Verbose "Filename: $filename"

                    if (-not (test-path $download_directory)) {
                      mkdir $download_directory
                    }
                    $download_directory = (resolve-path $download_directory).providerpath
                    $download_destination = join-path $download_directory $filename

                    if ((test-path $download_destination) -and
                      (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                      Write-Verbose "Found existing valid installer at $download_destination."
                    }
                    else {
                      if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                        Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                        Get-WebContent $package_metadata.url -filepath $download_destination
                      }
                    }

                    if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                      if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                        Write-Host "Installing $project from $download_destination"
                        $installingProject = $True
                        $installAttempts = 0
                        while ($installingProject) {
                          $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                          $p.WaitForExit()
                          if ($p.ExitCode -eq 1618) {
                            Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                            continue
                          } elseif ($p.ExitCode -ne 0) {
                            throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                          }
                          $installingProject = $False
                        }
                      }
                      else {
                        throw "Failed to validate the downloaded installer for $project."
                      }
                    }
                  }
                  set-alias install -value Install-Project
                  export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                  }

                  install -project chef -version 12.13.8+20160721014124 -channel unstable
                   with id: 35C6F7D8-21D9-4252-8E53-E113AB2B5052
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output

                         ModuleType Version    Name                                ExportedCommands
                         ---------- -------    ----                                ----------------
                         Script     0.0        Omnitruck                           {Get-ProjectMetada...
                  D      [WinRM] Waiting for output...
                  D      Cleaning up local sandbox in /tmp/cheftest/chef-current-install-windows-2012r2-sandbox-20160721-19710-ag1ihh
                  D      ------Exception-------
                  D      Class: Kitchen::ActionFailed
                  D      Message: 1 actions failed.
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:187:in `report_errors'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:178:in `run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:39:in `block in call'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:37:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:56:in `perform'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:184:in `block (2 levels) in <class:CLI>'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/command.rb:27:in `run'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/invocation.rb:126:in `invoke_command'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:325:in `invoke_task'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor.rb:359:in `dispatch'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/base.rb:440:in `start'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `block in <top (required)>'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/errors.rb:174:in `with_friendly_errors'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `<top (required)>'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `load'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `<top (required)>'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `load'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `kernel_load'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:24:in `run'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:304:in `exec'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor.rb:359:in `dispatch'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/base.rb:440:in `start'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:11:in `start'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:27:in `block in <top (required)>'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/friendly_errors.rb:98:in `with_friendly_errors'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:19:in `<top (required)>'
                  D      /opt/chefdk/embedded/bin/bundle:22:in `load'
                  D      /opt/chefdk/embedded/bin/bundle:22:in `<main>'
                  D      ----End Backtrace-----
                  D      -Composite Exception--
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:149:in `setup'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                  D      ----End Backtrace-----
                  D      ---Nested Exception---
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:149:in `setup'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                  D      ----End Backtrace-----
                  STDERR: >>>>>> ------Exception-------
                  >>>>>> Class: Kitchen::ActionFailed
                  >>>>>> Message: 1 actions failed.
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on chef-current-install-windows-2012r2
                  >>>>>> ----------------------
                  >>>>>> Please see .kitchen/logs/kitchen.log for more details
                  >>>>>> Also try running `kitchen diagnose --all` for configuration
                  ---- End output of bundle exec kitchen setup  -c -l debug ----
                  Ran bundle exec kitchen setup  -c -l debug returned 20

                  Cookbook Trace:
                  ---------------
                  /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                  Resource Declaration:
                  ---------------------
                  # In /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb

                    1: kitchen "setup"

                  Compiled Resource:
                  ------------------
                  # Declared in /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb:1:in `from_file'

                  kitchen("setup") do
                    action [:run]
                    retries 0
                    retry_delay 2
                    default_guard_interpreter :default
                    declared_type :kitchen
                    cookbook_name "acceptance-cookbook"
                    recipe_name "provision"
                    chef_product "chef"
                    kitchen_dir "/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/trivial"
                    command "setup"
                    kitchen_options "-c -l debug"
                  end

                  Platform:
                  ---------
                  x86_64-linux

              Starting audit phase
            6361: |2

              Running handlers:
              [2016-07-21T04:07:57+00:00] ERROR: Running exception handlers
              Running handlers complete
              [2016-07-21T04:07:57+00:00] ERROR: Exception handlers complete
              Chef Client failed. 0 resources updated in 02 minutes 41 seconds
              [2016-07-21T04:07:57+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/failed-audit-data.json
              [2016-07-21T04:07:57+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/cache/chef-stacktrace.out
              [2016-07-21T04:07:57+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
              [2016-07-21T04:07:57+00:00] ERROR: Found 1 errors, they are stored in the backtrace
              [2016-07-21T04:07:57+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
              STDERR:
              ---- End output of chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/dna.json -o acceptance-cookbook::provision --no-color ----
              Ran chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/trivial/provision/dna.json -o acceptance-cookbook::provision --no-color returned 1
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:289:in `invalid!'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:276:in `error!'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:53:in `block in run!'
              /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `block in with_clean_env'
              /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:447:in `with_env'
              /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `with_clean_env'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:42:in `run!'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:149:in `run_command'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:116:in `block in run_suite'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `each'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `run_suite'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:76:in `block (2 levels) in start_worker'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `loop'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `block in start_worker'
              CHEF-ACCEPTANCE::[2016-07-21 04:07:57 +0000] --force-destroy specified so attempting to run the destroy recipe
              TRIVIAL::DESTROY::[2016-07-21 04:07:57 +0000] Initialized [/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/logs/trivial/destroy.log] logger...
            10902: |2
                    D      Class: Kitchen::ActionFailed
                    D      Message: 2 actions failed.
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                    D      ----------------------
                    D      ------Backtrace-------
            10941: |2
                    D      -Composite Exception--
                    D      Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                    D      ----------------------
                    D      ------Backtrace-------
            10979: |2
                    D      ---Nested Exception---
                    D      Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                    D      ----------------------
                    D      ------Backtrace-------
            11017: |2
                    D
              FIPS::PROVISION::[2016-07-21 04:10:40 +0000] Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                    D      ----------------------
                    D      ------Backtrace-------
            11054: |2
                    D      ---Nested Exception---
                    D      Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                    D      ----------------------
                    D      ------Backtrace-------
            11093: |2
                    >>>>>> Class: Kitchen::ActionFailed
                    >>>>>> Message: 2 actions failed.
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                    >>>>>> ----------------------
                    >>>>>> Please see .kitchen/logs/kitchen.log for more details
            11103: |2
                    Cookbook Trace:
                    ---------------
                    /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                    Resource Declaration:
            11156: |2


                  ================================================================================
                  Error executing action `run` on resource 'kitchen[converge]'
                  ================================================================================

                  Mixlib::ShellOut::ShellCommandFailed
                  ------------------------------------
                  ruby_block[copy_kitchen_logs_to_data_path] (/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb line 39) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '20'
                  ---- Begin output of bundle exec kitchen converge  -c -l debug ----
                  STDOUT: -----> Starting Kitchen (v1.10.2)
                  D      winrm requested, loading winrm gem (["~> 2.0"])
                  D      winrm is loaded.
                  D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                  D      winrm-fs is loaded.
                  D      winrm requested, loading winrm gem (["~> 2.0"])
                  D      winrm was already loaded.
                  D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                  D      winrm-fs was already loaded.
                  -----> Creating <fips-unit-functional-windows-2012r2>...
                  D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
                  -----> Creating <fips-unit-functional-centos-6>...
                  D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
                  D      platform name centos-6 appears to be a standard platform. Searching for centos 6 ...
                  D      Searching for images matching {:name=>"CentOS-6.5-GA-*", :"owner-alias"=>"aws-marketplace", :architecture=>"x86_64", :"virtualization-type"=>"paravirtual", :"block-device-mapping.volume-type"=>"standard", :"image-type"=>"machine"} ...
                  -----> Creating <fips-integration-windows-2012r2>...
                  D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
                  D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-map
              FIPS::PROVISION::[2016-07-21 04:10:40 +0000] ping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
                  -----> Creating <fips-integration-centos-6>...
            15520: |2
                  D      Class: Kitchen::ActionFailed
                  D      Message: 2 actions failed.
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                  D      ----------------------
                  D      ------Backtrace-------
            15559: |2
                  D      -Composite Exception--
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                  D      ----------------------
                  D      ------Backtrace-------
            15597: |2
                  D      ---Nested Exception---
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                  D      ----------------------
                  D      ------Backtrace-------
            15635: |2
                  D      -Composite Exception--
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                  D      ----------------------
                  D      ------Backtrace-------
            15672: |2
                  D      ---Nested Exception---
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                  D      ----------------------
                  D      ------Backtrace-------
            15711: |2
                  >>>>>> Class: Kitchen::ActionFailed
                  >>>>>> Message: 2 actions failed.
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                  >>>>>> ----------------------
                  >>>>>> Please see .kitchen/logs/kitchen.log for more details
            15721: |2
                  Cookbook Trace:
                  ---------------
                  /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                  Resource Declaration:
            15764: |
              FIPS::PROVISION::[2016-07-21 04:10:42 +0000] Running handlers:
              FIPS::PROVISION::[2016-07-21 04:10:42 +0000]
              FIPS::PROVISION::[2016-07-21 04:10:42 +0000] [2016-07-21T04:10:42+00:00] ERROR: Running exception handlers
              FIPS::PROVISION::[2016-07-21 04:10:42 +0000] Running handlers complete
              FIPS::PROVISION::[2016-07-21 04:10:42 +0000] [2016-07-21T04:10:42+00:00] ERROR: Exception handlers complete
              FIPS::PROVISION::[2016-07-21 04:10:42 +0000] Chef Client failed. 0 resources updated in 02 minutes 30 seconds
              FIPS::PROVISION::[2016-07-21 04:10:42 +0000]
              FIPS::PROVISION::[2016-07-21 04:10:42 +0000] [2016-07-21T04:10:42+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/failed-audit-data.json
              FIPS::PROVISION::[2016-07-21 04:10:42 +0000] [2016-07-21T04:10:42+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/chef-stacktrace.out
              FIPS::PROVISION::[2016-07-21 04:10:42 +0000] [2016-07-21T04:10:42+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
              FIPS::PROVISION::[2016-07-21 04:10:42 +0000] [2016-07-21T04:10:42+00:00] ERROR: Found 1 errors, they are stored in the backtrace
              FIPS::PROVISION::[2016-07-21 04:10:43 +0000] [2016-07-21T04:10:43+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
              CHEF-ACCEPTANCE::[2016-07-21 04:10:44 +0000] Encountered an error running the recipe provision: Expected process to exit with [0], but received '1'
              ---- Begin output of chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/dna.json -o acceptance-cookbook::provision --no-color ----
            15791: |2
                  * ruby_block[copy_kitchen_logs_to_data_path] action run

                    ================================================================================
                    Error executing action `run` on resource 'ruby_block[copy_kitchen_logs_to_data_path]'
                    ================================================================================

                    Mixlib::ShellOut::ShellCommandFailed
                    ------------------------------------
                    Expected process to exit with [0], but received '20'
                    ---- Begin output of bundle exec kitchen converge  -c -l debug ----
                    STDOUT: -----> Starting Kitchen (v1.10.2)
                    D      winrm requested, loading winrm gem (["~> 2.0"])
                    D      winrm is loaded.
                    D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                    D      winrm-fs is loaded.
                    D      winrm requested, loading winrm gem (["~> 2.0"])
                    D      winrm was already loaded.
                    D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                    D      winrm-fs was already loaded.
                    -----> Creating <fips-unit-functional-windows-2012r2>...
                    D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
                    -----> Creating <fips-unit-functional-centos-6>...
                    D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
                    D      platform name centos-6 appears to be a standard platform. Searching for centos 6 ...
                    D      Searching for images matching {:name=>"CentOS-6.5-GA-*", :"owner-alias"=>"aws-marketplace", :architecture=>"x86_64", :"virtualization-type"=>"paravirtual", :"block-device-mapping.volume-type"=>"standard", :"image-type"=>"machine"} ...
                    -----> Creating <fips-integration-windows-2012r2>...
                    D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
                    D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
                    -----> Creating <fips-integration-centos-6>...
                    D      platform name centos-6 appears to be a standard platform. Searching for centos 6 ...
                    D      Searching for images matching {:name=>"CentOS-6.5-GA-*", :"owner-alias"=>"aws-marketplace", :architecture=>"x86_64", :"virtualization-type"=>"paravirtual", :"block-device-mapping.volume-type"=>"standard", :"image-type"=>"machine"} ...
                    D      Search returned 1 images:
                    D      - CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2: Detected centos 6.5 x86_64.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
                    D      Search returned 1 images:
                    D      - CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2: Detected centos 6.5 x86_64.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
                    D      Image for fips-integration-centos-6: CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
                           Detected platform: centos version 6.5 on x86_64. Instance Type: m3.large. Default username: root (default).
                    D      No SSH username specified: using default username root  for image ami-b6bdde86, which we detected as centos 6.5 x86_64.
                           If you are not using an account that qualifies under the AWS
                    free-tier, you may be charged to run these suites. The charge
                    should be minimal, but neither Test Kitchen nor its maintainers
                    are responsible for your incurred costs.

                    D      Creating EC2 instance in region us-west-2 with properties:
                    D      - instance_type = "m3.large"
                    D      - ebs_optimized = false
                    D      - image_id = "ami-b6bdde86"
                    D      - key_name = "jenkins"
                    D      - subnet_id = "subnet-19ac017c"
                    D      - private_ip_address = nil
                    D      - placement = {:availability_zone=>"us-west-2a"}
                    D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                    D      Image for fips-unit-functional-centos-6: CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
                           Detected platform: centos version 6.5 on x86_64. Instance Type: m3.large. Default username: root (default).
                    D      No SSH username specified: using default username root  for image ami-b6bdde86, which we detected as centos 6.5 x86_64.
                           If you are not using an account that qualifies under the AWS
                    free-tier, you may be charged to run these suites. The charge
                    should be minimal, but neither Test Kitchen nor its maintainers
                    are responsible for your incurred costs.

                    D      Creating EC2 instance in region us-west-2 with properties:
                    D      - instance_type = "m3.large"
                    D      - ebs_optimized = false
                    D      - image_id = "ami-b6bdde86"
                    D      - key_name = "jenkins"
                    D      - subnet_id = "subnet-19ac017c"
                    D      - private_ip_address = nil
                    D      - placement = {:availability_zone=>"us-west-2a"}
                    D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                    D      Search returned 3 images:
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
                    D      Image for fips-unit-functional-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                           Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
                    D      No SSH username specified: using default username administrator  for image ami-26e72546, which we detected as windows 2012r2rtm x86_64.
                           If you are not using an account that qualifies under the AWS
                    free-tier, you may be charged to run these suites. The charge
                    should be minimal, but neither Test Kitchen nor its maintainers
                    are responsible for your incurred costs.

                    D      Creating EC2 instance in region us-west-2 with properties:
                    D      - instance_type = "m3.large"
                    D      - ebs_optimized = false
                    D      - image_id = "ami-26e72546"
                    D      - key_name = "jenkins"
                    D      - subnet_id = "subnet-19ac017c"
                    D      - private_ip_address = nil
                    D      - placement = {:availability_zone=>"us-west-2a"}
                    D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                    D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                    D      Search returned 3 images:
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                    D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
                    D      Image for fips-integration-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                           Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
                    D      No SSH username specified: using default username administrator  for image ami-26e72546, which we detected as windows 2012r2rtm x86_64.
                           If you are not using an account that qualifies under the AWS
                    free-tier, you may be charged to run these suites. The charge
                    should be minimal, but neither Test Kitchen nor its maintainers
                    are responsible for your incurred costs.

                    D      Creating EC2 instance in region us-west-2 with properties:
                    D      - instance_type = "m3.large"
                    D      - ebs_optimized = false
                    D      - image_id = "ami-26e72546"
                    D      - key_name = "jenkins"
                    D      - subnet_id = "subnet-19ac017c"
                    D      - private_ip_address = nil
                    D      - placement = {:availability_zone=>"us-west-2a"}
                    D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                    D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                           Instance <i-a68c0b09> requested.
                           Polling AWS for existence, attempt 0...
                           Instance <i-9e8d0a31> requested.
                           Polling AWS for existence, attempt 0...
                           Instance <i-998d0a36> requested.
                           Polling AWS for existence, attempt 0...
                           Attempting to tag the instance, 0 retries
                           Attempting to tag the instance, 0 retries
                           Attempting to tag the instance, 0 retries
                           EC2 instance <i-9e8d0a31> created.
                           Waited 0/300s for instance <i-9e8d0a31> to become ready.
                           EC2 instance <i-998d0a36> created.
                           Waited 0/300s for instance <i-998d0a36> to become ready.
                           EC2 instance <i-a68c0b09> created.
                           Waited 0/300s for instance <i-a68c0b09> to become ready.
                           Instance <i-a38c0b0c> requested.
                           Polling AWS for existence, attempt 0...
                           Attempting to tag the instance, 0 retries
                           EC2 instance <i-a38c0b0c> created.
                           Waited 0/300s for instance <i-a38c0b0c> to become ready.
                           Waited 5/300s for instance <i-998d0a36> to become ready.
                           Waited 5/300s for instance <i-9e8d0a31> to become ready.
                           Waited 5/300s for instance <i-a68c0b09> to become ready.
                           Waited 5/300s for instance <i-a38c0b0c> to become ready.
                           Waited 10/300s for instance <i-9e8d0a31> to become ready.
                           Waited 10/300s for instance <i-998d0a36> to become ready.
                           Waited 10/300s for instance <i-a68c0b09> to become ready.
                           Waited 10/300s for instance <i-a38c0b0c> to become ready.
                           Waited 15/300s for instance <i-9e8d0a31> to become ready.
                           Waited 15/300s for instance <i-998d0a36> to become ready.
                           Waited 15/300s for instance <i-a68c0b09> to become ready.
                           Waited 15/300s for instance <i-a38c0b0c> to become ready.
                           Waited 20/300s for instance <i-998d0a36> to become ready.
                           Waited 20/300s for instance <i-9e8d0a31> to become ready.
                           Waited 20/300s for instance <i-a68c0b09> to become ready.
                           Waited 20/300s for instance <i-a38c0b0c> to become ready.
                           Waited 25/300s for instance <i-998d0a36> to become ready.
                           Waited 25/300s for instance <i-9e8d0a31> to become ready.
                           Waited 25/300s for instance <i-a68c0b09> to become ready.
                           EC2 instance <i-9e8d0a31> ready.
                    D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"]}>
                           EC2 instance <i-a68c0b09> ready.
                    D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"]}>
                           Waited 25/300s for instance <i-a38c0b0c> to become ready.
                           Waited 30/300s for instance <i-998d0a36> to become ready.
                           Waited 30/300s for instance <i-a38c0b0c> to become ready.
                           Waited 35/300s for instance <i-998d0a36> to become ready.
                           Waited 35/300s for instance <i-a38c0b0c> to become ready.
                    D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                           Waiting for SSH service on 10.194.9.186:22, retrying in 3 seconds
                    D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                           Waiting for SSH service on 10.194.8.37:22, retrying in 3 seconds
                           Waited 40/300s for instance <i-998d0a36> to become ready.
                           Waited 40/300s for instance <i-a38c0b0c> to become ready.
                    D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                           Waited 45/300s for instance <i-998d0a36> to become ready.
                           Waited 45/300s for instance <i-a38c0b0c> to become ready.
                           Waited 50/300s for instance <i-998d0a36> to become ready.
                           Waited 50/300s for instance <i-a38c0b0c> to become ready.
                           Waited 55/300s for instance <i-998d0a36> to become ready.
                           Waited 55/300s for instance <i-a38c0b0c> to become ready.
                    D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                           Waiting for SSH service on 10.194.9.186:22, retrying in 3 seconds
                    D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                           Waiting for SSH service on 10.194.8.37:22, retrying in 3 seconds
                    D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                           Waited 60/300s for instance <i-998d0a36> to become ready.
                           Waited 60/300s for instance <i-a38c0b0c> to become ready.
                           Waited 65/300s for instance <i-998d0a36> to become ready.
                           Waited 65/300s for instance <i-a38c0b0c> to become ready.
                           Waited 70/300s for instance <i-998d0a36> to become ready.
                           Waited 70/300s for instance <i-a38c0b0c> to become ready.
                    D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                           Waiting for SSH service on 10.194.9.186:22, retrying in 3 seconds
                    D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                           Waiting for SSH service on 10.194.8.37:22, retrying in 3 seconds
                           Waited 75/300s for instance <i-998d0a36> to become ready.
                           Waited 75/300s for instance <i-a38c0b0c> to become ready.
                    D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                           Waited 80/300s for instance <i-998d0a36> to become ready.
                           Waited 80/300s for instance <i-a38c0b0c> to become ready.
                    D      [SSH] connection failed (#<Errno::ECONNREFUSED: Connection refused - connect(2) for 10.194.8.37:22>)
                           Waiting for SSH service on 10.194.8.37:22, retrying in 3 seconds
                           Waited 85/300s for instance <i-998d0a36> to become ready.
                           Waited 85/300s for instance <i-a38c0b0c> to become ready.
                    D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] connection failed (#<Net::SSH::AuthenticationFailed: Authentication failed for user root@10.194.8.37>)
                           Waiting for SSH service on 10.194.8.37:22, retrying in 3 seconds
                    D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (echo '[SSH] Established')
                           bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           [SSH] Established
                    D      Using sudo_command='sudo -E' for ohai hints
                    D      [SSH] reusing existing connection root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E mkdir -p /etc/chef/ohai/hints; sudo -E touch /etc/chef/ohai/hints/ec2.json)
                           bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           Waited 90/300s for instance <i-998d0a36> to become ready.
                    D      ec2:create '10.194.8.37'
                           Finished creating <fips-unit-functional-centos-6> (1m37.17s).
                    -----> Converging <fips-unit-functional-centos-6>...
                           Preparing files for transfer
                    D      Creating local sandbox in /tmp/cheftest/fips-unit-functional-centos-6-sandbox-20160721-21168-kwydkn
                           Preparing dna.json
                    D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                           Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                           Removing non-cookbook files before transfer
                           Preparing validation.pem
                    D      Using a dummy validation.pem
                           Preparing client.rb
                    D      Creating client.rb from {:node_name=>"fips-unit-functional-centos-6", :checksum_path=>"/tmp/kitchen/checksums", :file_cache_path=>"/tmp/kitchen/cache", :file_backup_path=>"/tmp/kitchen/backup", :cookbook_path=>["/tmp/kitchen/cookbooks", "/tmp/kitchen/site-cookbooks"], :data_bag_path=>"/tmp/kitchen/data_bags", :environment_path=>"/tmp/kitchen/environments", :node_path=>"/tmp/kitchen/nodes", :role_path=>"/tmp/kitchen/roles", :client_path=>"/tmp/kitchen/clients", :user_path=>"/tmp/kitchen/users", :validation_key=>"/tmp/kitchen/validation.pem", :client_key=>"/tmp/kitchen/client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"/tmp/kitchen/encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
                    D      [SSH] reusing existing connection root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E cat > /tmp/chef-installer.sh <<"EOL"
                    #!/bin/bash
                    #!/bin/sh
                    # WARNING: REQUIRES /bin/sh
                    #
                    # - must run on /bin/sh on solaris 9
                    # - must run on /bin/sh on AIX 6.x
                    #
                    # Copyright:: Copyright (c) 2010-2015 Chef Software, Inc.
                    # License:: Apache License, Version 2.0
                    #
                    # Licensed under the Apache License, Version 2.0 (the "License");
                    # you may not use this file except in compliance with the License.
                    # You may obtain a copy of the License at
                    #
                    #     http://www.apache.org/licenses/LICENSE-2.0
                    #
                    # Unless required by applicable law or agreed to in writing, software
                    # distributed under the License is distributed on an "AS IS" BASIS,
                    # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                    # See the License for the specific language governing permissions and
                    # limitations under the License.
                    #

                    # helpers.sh
                    ############
                    # This section has some helper functions to make life easier.
                    #
                    # Outputs:
                    # $tmp_dir: secure-ish temp directory that can be used during installation.
                    ############

                    # Check whether a command exists - returns 0 if it does, 1 if it does not
                    exists() {
                      if command -v $1 >/dev/null 2>&1
                      then
                        return 0
                      else
                        return 1
                      fi
                    }

                    # Output the instructions to report bug about this script
                    report_bug() {
                      echo "Version: $version"
                      echo ""
                      echo "Please file a Bug Report at https://github.com/chef/omnitruck/issues/new"
                      echo "Alternatively, feel free to open a Support Ticket at https://www.chef.io/support/tickets"
                      echo "More Chef support resources can be found at https://www.chef.io/support"
                      echo ""
                      echo "Please include as many details about the problem as possible i.e., how to reproduce"
                      echo "the problem (if possible), type of the Operating System and its version, etc.,"
                      echo "and any other relevant details that might help us with troubleshooting."
                      echo ""
                    }

                    checksum_mismatch() {
                      echo "Package checksum mismatch!"
                      report_bug
                      exit 1
                    }

                    unable_to_retrieve_package() {
                      echo "Unable to retrieve a valid package!"
                      report_bug
                      echo "Metadata URL: $metadata_url"
                      if test "x$download_url" != "x"; then
                        echo "Download URL: $download_url"
                      fi
                      if test "x$stderr_results" != "x"; then
                        echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
                      fi
                      exit 1
                    }

                    http_404_error() {
                      echo "Omnitruck artifact does not exist for version $version on platform $platform"
                      echo ""
                      echo "Either this means:"
                      echo "   - We do not support $platform"
                      echo "   - We do not have an artifact for $version"
                      echo ""
                      echo "This is often the latter case due to running a prerelease or RC version of chef"
                      echo "or a gem version which was only pushed to rubygems and not omnitruck."
                      echo ""
                      echo "You may be able to set your knife[:bootstrap_version] to the most recent stable"
                      echo "release of Chef to fix this problem (or the most recent stable major version number)."
                      echo ""
                      echo "In order to test the version parameter, adventurous users may take the Metadata URL"
                      echo "below and modify the '&v=<number>' parameter until you successfully get a URL that"
                      echo "does not 404 (e.g. via curl or wget).  You should be able to use '&v=11' or '&v=12'"
                      echo "succesfully."
                      echo ""
                      echo "If you cannot fix this problem by setting the bootstrap_version, it probably means"
                      echo "that $platform is not supported."
                      echo ""
                      # deliberately do not call report_bug to suppress bug report noise.
                      echo "Metadata URL: $metadata_url"
                      if test "x$download_url" != "x"; then
                        echo "Download URL: $download_url"
                      fi
                      if test "x$stderr_results" != "x"; then
                        echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
                      fi
                      exit 1
                    }

                    capture_tmp_stderr() {
                      # spool up /tmp/stderr from all the commands we called
                      if test -f "$tmp_dir/stderr"; then
                        output=`cat $tmp_dir/stderr`
                        stderr_results="${stderr_results}\nSTDERR from $1:\n\n$output\n"
                        rm $tmp_dir/stderr
                      fi
                    }

                    # do_wget URL FILENAME
                    do_wget() {
                      echo "trying wget..."
                      wget -O "$2" "$1" 2>$tmp_dir/stderr
                      rc=$?
                      # check for 404
                      grep "ERROR 404" $tmp_dir/stderr 2>&1 >/dev/null
                      if test $? -eq 0; then
                        echo "ERROR 404"
                        http_404_error
                      fi

                      # check for bad return status or empty output
                      if test $rc -ne 0 || test ! -s "$2"; then
                        capture_tmp_stderr "wget"
                        return 1
                      fi

                      return 0
                    }

                    # do_curl URL FILENAME
                    do_curl() {
                      echo "trying curl..."
                      curl --retry 5 -sL -D $tmp_dir/stderr "$1" > "$2"
                      rc=$?
                      # check for 404
                      grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
                      if test $? -eq 0; then
                        echo "ERROR 404"
                        http_404_error
                      fi

                      # check for bad return status or empty output
                      if test $rc -ne 0 || test ! -s "$2"; then
                        capture_tmp_stderr "curl"
                        return 1
                      fi

                      return 0
                    }

                    # do_fetch URL FILENAME
                    do_fetch() {
                      echo "trying fetch..."
                      fetch -o "$2" "$1" 2>$tmp_dir/stderr
                      # check for bad return status
                      test $? -ne 0 && return 1
                      return 0
                    }

                    # do_perl URL FILENAME
                    do_perl() {
                      echo "trying perl..."
                      perl -e 'use LWP::Simple; getprint($ARGV[0]);' "$1" > "$2" 2>$tmp_dir/stderr
                      rc=$?
                      # check for 404
                      grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
                      if test $? -eq 0; then
                        echo "ERROR 404"
                        http_404_error
                      fi

                      # check for bad return status or empty output
                      if test $rc -ne 0 || test ! -s "$2"; then
                        capture_tmp_stderr "perl"
                        return 1
                      fi

                      return 0
                    }

                    # do_python URL FILENAME
                    do_python() {
                      echo "trying python..."
                      python -c "import sys,urllib2 ; sys.stdout.write(urllib2.urlopen(sys.argv[1]).read())" "$1" > "$2" 2>$tmp_dir/stderr
                      rc=$?
                      # check for 404
                      grep "HTTP Error 404" $tmp_dir/stderr 2>&1 >/dev/null
                      if test $? -eq 0; then
                        echo "ERROR 404"
                        http_404_error
                      fi

                      # check for bad return status or empty output
                      if test $rc -ne 0 || test ! -s "$2"; then
                        capture_tmp_stderr "python"
                        return 1
                      fi
                      return 0
                    }

                    # returns 0 if checksums match
                    do_checksum() {
                      if exists sha256sum; then
                        echo "Comparing checksum with sha256sum..."
                        checksum=`sha256sum $1 | awk '{ print $1 }'`
                        return `test "x$checksum" = "x$2"`
                      elif exists shasum; then
                        echo "Comparing checksum with shasum..."
                        checksum=`shasum -a 256 $1 | awk '{ print $1 }'`
                        return `test "x$checksum" = "x$2"`
                      else
                        echo "WARNING: could not find a valid checksum program, pre-install shasum or sha256sum in your O/S image to get valdation..."
                        return 0
                      fi
                    }

                    # do_download URL FILENAME
                    do_download() {
                      echo "downloading $1"
                      echo "  to file $2"

                      url=`echo $1`
                      if test "x$platform" = "xsolaris2"; then
                        if test "x$platform_version" = "x5.9" -o "x$platform_version" = "x5.10"; then
                          # solaris 9 lacks openssl, solaris 10 lacks recent enough credentials - your base O/S is completely insecure, please upgrade
                          url=`echo $url | sed -e 's/https/http/'`
                        fi
                      fi

                      # we try all of these until we get success.
                      # perl, in particular may be present but LWP::Simple may not be installed

                      if exists wget; then
                        do_wget $url $2 && return 0
                      fi

                      if exists curl; then
                        do_curl $url $2 && return 0
                      fi

                      if exists fetch; then
                        do_fetch $url $2 && return 0
                      fi

                      if exists perl; then
                        do_perl $url $2 && return 0
                      fi

                      if exists python; then
                        do_python $url $2 && return 0
                      fi

                      unable_to_retrieve_package
                    }

                    # install_file TYPE FILENAME
                    # TYPE is "rpm", "deb", "solaris", "sh", etc.
                    install_file() {
                      echo "Installing $project $version"
                      case "$1" in
                        "rpm")
                          if test "x$platform" = "xnexus" || test "x$platform" = "xios_xr"; then
                            echo "installing with yum..."
                            yum install -yv "$2"
                          else
                            echo "installing with rpm..."
                            rpm -Uvh --oldpackage --replacepkgs "$2"
                          fi
                          ;;
                        "deb")
                          echo "installing with dpkg..."
                          dpkg -i "$2"
                          ;;
                        "bff")
                          echo "installing with installp..."
                          installp -aXYgd "$2" all
                          ;;
                        "solaris")
                          echo "installing with pkgadd..."
                          echo "conflict=nocheck" > $tmp_dir/nocheck
                          echo "action=nocheck" >> $tmp_dir/nocheck
                          echo "mail=" >> $tmp_dir/nocheck
                          pkgrm -a $tmp_dir/nocheck -n $project >/dev/null 2>&1 || true
                          pkgadd -G -n -d "$2" -a $tmp_dir/nocheck $project
                          ;;
                        "pkg")
                          echo "installing with installer..."
                          cd / && /usr/sbin/installer -pkg "$2" -target /
                          ;;
                        "dmg")
                          echo "installing dmg file..."
                          hdiutil detach "/Volumes/chef_software" >/dev/null 2>&1 || true
                          hdiutil attach "$2" -mountpoint "/Volumes/chef_software"
                          cd / && /usr/sbin/installer -pkg `find "/Volumes/chef_software" -name \*.pkg` -target /
                          hdiutil detach "/Volumes/chef_software"
                          ;;
                        "sh" )
                          echo "installing with sh..."
                          sh "$2"
                          ;;
                        *)
                          echo "Unknown filetype: $1"
                          report_bug
                          exit 1
                          ;;
                      esac
                      if test $? -ne 0; then
                        echo "Installation failed"
                        report_bug
                        exit 1
                      fi
                    }

                    if test "x$TMPDIR" = "x"; then
                      tmp="/tmp"
                    else
                      tmp=$TMPDIR
                    fi
                    # secure-ish temp dir creation without having mktemp available (DDoS-able but not expliotable)
                    tmp_dir="$tmp/install.sh.$$"
                    (umask 077 && mkdir $tmp_dir) || exit 1

                    ############
                    # end of helpers.sh
                    ############


                    project=chef
                    version=12.13.8+20160721014124
                    channel=unstable


                    # platform_detection.sh
                    ############
                    # This section makes platform detection compatible with omnitruck on the system
                    #   it runs.
                    #
                    # Outputs:
                    # $platform: Name of the platform.
                    # $platform_version: Version of the platform.
                    # $machine: System's architecture.
                    ############

                    #
                    # Platform and Platform Version detection
                    #
                    # NOTE: This should now match ohai platform and platform_version matching.
                    # do not invented new platform and platform_version schemas, just make this behave
                    # like what ohai returns as platform and platform_version for the server.
                    #
                    # ALSO NOTE: Do not mangle platform or platform_version here.  It is less error
                    # prone and more future-proof to do that in the server, and then all omnitruck clients
                    # will 'inherit' the changes (install.sh is not the only client of the omnitruck
                    # endpoint out there).
                    #

                    machine=`uname -m`
                    os=`uname -s`

                    if test -f "/etc/lsb-release" && grep -q DISTRIB_ID /etc/lsb-release && ! grep -q wrlinux /etc/lsb-release; then
                      platform=`grep DISTRIB_ID /etc/lsb-release | cut -d "=" -f 2 | tr '[A-Z]' '[a-z]'`
                      platform_version=`grep DISTRIB_RELEASE /etc/lsb-release | cut -d "=" -f 2`
                    elif test -f "/etc/debian_version"; then
                      platform="debian"
                      platform_version=`cat /etc/debian_version`
                    elif test -f "/etc/redhat-release"; then
                      platform=`sed 's/^\(.\+\) release.*/\1/' /etc/redhat-release | tr '[A-Z]' '[a-z]'`
                      platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/redhat-release`

                      # If /etc/redhat-release exists, we act like RHEL by default
                      if test "$platform" = "fedora"; then
                        # FIXME: stop remapping fedora to el
                        # FIXME: remove client side platform_version mangling and hard coded yolo
                        # Change platform version for use below.
                        platform_version="6.0"
                      fi

                      if test "$platform" = "xenserver"; then
                        # Current XenServer 6.2 is based on CentOS 5, platform is not reset to "el" server should hanlde response
                        platform="xenserver"
                      else
                        # FIXME: use "redhat"
                        platform="el"
                      fi

                    elif test -f "/etc/system-release"; then
                      platform=`sed 's/^\(.\+\) release.\+/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
                      platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
                      # amazon is built off of fedora, so act like RHEL
                      if test "$platform" = "amazon linux ami"; then
                        # FIXME: remove client side platform_version mangling and hard coded yolo, and remapping to deprecated "el"
                        platform="el"
                        platform_version="6.0"
                      fi
                    # Apple OS X
                    elif test -f "/usr/bin/sw_vers"; then
                      platform="mac_os_x"
                      # Matching the tab-space with sed is error-prone
                      platform_version=`sw_vers | awk '/^ProductVersion:/ { print $2 }' | cut -d. -f1,2`

                      # x86_64 Apple hardware often runs 32-bit kernels (see OHAI-63)
                      x86_64=`sysctl -n hw.optional.x86_64`
                      if test $x86_64 -eq 1; then
                        machine="x86_64"
                      fi
                    elif test -f "/etc/release"; then
                      machine=`/usr/bin/uname -p`
                      if grep -q SmartOS /etc/release; then
                        platform="smartos"
                        platform_version=`grep ^Image /etc/product | awk '{ print $3 }'`
                      else
                        platform="solaris2"
                        platform_version=`/usr/bin/uname -r`
                      fi
                    elif test -f "/etc/SuSE-release"; then
                      if grep -q 'Enterprise' /etc/SuSE-release;
                      then
                          platform="sles"
                          platform_version=`awk '/^VERSION/ {V = $3}; /^PATCHLEVEL/ {P = $3}; END {print V "." P}' /etc/SuSE-release`
                      else
                          platform="suse"
                          platform_version=`awk '/^VERSION =/ { print $3 }' /etc/SuSE-release`
                      fi
                    elif test "x$os" = "xFreeBSD"; then
                      platform="freebsd"
                      platform_version=`uname -r | sed 's/-.*//'`
                    elif test "x$os" = "xAIX"; then
                      platform="aix"
                      platform_version="`uname -v`.`uname -r`"
                      machine="powerpc"
                    elif test -f "/etc/os-release"; then
                      . /etc/os-release
                      if test "x$CISCO_RELEASE_INFO" != "x"; then
                        . $CISCO_RELEASE_INFO
                      fi

                      platform=$ID
                      platform_version=$VERSION
                    fi

                    if test "x$platform" = "x"; then
                      echo "Unable to determine platform version!"
                      report_bug
                      exit 1
                    fi

                    #
                    # NOTE: platform manging in the install.sh is DEPRECATED
                    #
                    # - install.sh should be true to ohai and should not remap
                    #   platform or platform versions.
                    #
                    # - remapping platform and mangling platform version numbers is
                    #   now the complete responsibility of the server-side endpoints
                    #

                    major_version=`echo $platform_version | cut -d. -f1`
                    case $platform in
                      # FIXME: should remove this case statement completely
                      "el")
                        # FIXME:  "el" is deprecated, should use "redhat"
                        platform_version=$major_version
                        ;;
                      "debian")
                        if test "x$major_version" = "x5"; then
                          # This is here for potential back-compat.
                          # We do not have 5 in versions we publish for anymore but we
                          # might have it for earlier versions.
                          platform_version="6"
                        else
                          platform_version=$major_version
                        fi
                        ;;
                      "freebsd")
                        platform_version=$major_version
                        ;;
                      "sles")
                        platform_version=$major_version
                        ;;
                      "suse")
                        platform_version=$major_version
                        ;;
                    esac

                    # normalize the architecture we detected
                    case $machine in
                      "x86_64"|"amd64"|"x64")
                        machine="x86_64"
                        ;;
                      "i386"|"i86pc"|"x86"|"i686")
                        machine="i386"
                        ;;
                      "sparc"|"sun4u"|"sun4v")
                        machine="sparc"
                        ;;
                    esac

                    if test "x$platform_version" = "x"; then
                      echo "Unable to determine platform version!"
                      report_bug
                      exit 1
                    fi

                    if test "x$platform" = "xsolaris2"; then
                      # hack up the path on Solaris to find wget, pkgadd
                      PATH=/usr/sfw/bin:/usr/sbin:$PATH
                      export PATH
                    fi

                    echo "$platform $platform_version $machine"

                    ############
                    # end of platform_detection.sh
                    ############


                    # artifactory_urls.sh
                    ############
                    # This section sets up the information for a build to be installed from artifactory
                    #  then uses $platform, $platform_version and $machine to select the correct
                    #  version.
                    #
                    # Inputs:
                    # $platform:
                    # $platform_version:
                    # $machine:
                    #
                    # Outputs:
                    # $download_url:
                    # $sha256:
                    ############


                      artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.9/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.10/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.11/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/ppc64le"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ios_xr/6/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/nexus/7/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/6/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/6/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/7/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/8/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64le"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/6/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/7/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/8/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/amd64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2012/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/6/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2012/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/aix/6.1/powerpc"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/aix/7.1/powerpc"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/5/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/7/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/5/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/amd64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/sparc"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/sparc"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" >> "$artifact_info_dir/artifact_info"


                    artifact_info_for_platform="$tmp_dir/artifact_info/$platform/$platform_version/$machine/artifact_info"

                    download_url=`awk '$1 == "url" { print $2 }' "$artifact_info_for_platform"`
                    sha256=`awk '$1 == "sha256" { print $2 }' "$artifact_info_for_platform"`


                    # fetch_package.sh
                    ############
                    # This section fetchs a package from $download_url and verifies its metadata.
                    #
                    # Inputs:
                    # $download_url:
                    # $tmp_dir:
                    # Optional Inputs:
                    # $cmdline_filename: Name of the package downloaded on local disk.
                    # $cmdline_dl_dir: Name of the directory downloaded package will be saved to on local disk.
                    #
                    # Outputs:
                    # $download_filename: Name of the downloaded file on local disk.
                    # $filetype: Type of the file downloaded.
                    ############

                    filename=`echo $download_url | sed -e 's/^.*\///'`
                    filetype=`echo $filename | sed -e 's/^.*\.//'`

                    # use either $tmp_dir, the provided directory (-d) or the provided filename (-f)
                    if test "x$cmdline_filename" != "x"; then
                      download_filename="$cmdline_filename"
                    elif test "x$cmdline_dl_dir" != "x"; then
                      download_filename="$cmdline_dl_dir/$filename"
                    else
                      download_filename="$tmp_dir/$filename"
                    fi

                    # ensure the parent directory where to download the installer always exists
                    download_dir=`dirname $download_filename`
                    (umask 077 && mkdir -p $download_dir) || exit 1

                    # check if we have that file locally available and if so verify the checksum
                    cached_file_available="false"
                    if test -f $download_filename; then
                      echo "$download_filename already exists, verifiying checksum..."
                      if do_checksum "$download_filename" "$sha256"; then
                        echo "checksum compare succeeded, using existing file!"
                        cached_file_available="true"
                      else
                        echo "checksum mismatch, downloading latest version of the file"
                      fi
                    fi

                    # download if no local version of the file available
                    if test "x$cached_file_available" != "xtrue"; then
                      do_download "$download_url"  "$download_filename"
                      do_checksum "$download_filename" "$sha256" || checksum_mismatch
                    fi

                    ############
                    # end of fetch_package.sh
                    ############


                    # install_package.sh
                    ############
                    # Installs a package and removed the temp directory.
                    #
                    # Inputs:
                    # $download_filename: Name of the file to be installed.
                    # $filetype: Type of the file to be installed.
                    # $version: The version requested. Used only for warning user if not set.
                    ############

                    if test "x$version" = "x"; then
                      echo
                      echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
                      echo
                      echo "You are installing an omnibus package without a version pin.  If you are installing"
                      echo "on production servers via an automated process this is DANGEROUS and you will"
                      echo "be upgraded without warning on new releases, even to new major releases."
                      echo "Letting the version float is only appropriate in desktop, test, development or"
                      echo "CI/CD environments."
                      echo
                      echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
                      echo
                    fi

                    install_file $filetype "$download_filename"

                    if test "x$tmp_dir" != "x"; then
                      rm -r "$tmp_dir"
                    fi

                    ############
                    # end of install_package.sh
                    ############

                    EOL
                    chmod +x /tmp/chef-installer.sh
                    sudo -E /tmp/chef-installer.sh)
                           Waited 90/300s for instance <i-a38c0b0c> to become ready.
                           bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           /bin/bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           el 6 x86_64
                    D      Console output: ---
                    2016/07/21 04:09:36Z: EC2ConfigMonitorState: 0
                    2016/07/21 04:09:36Z: Windows sysprep configuration complete.
                    2016/07/21 04:09:39Z: AMI Origin Version: 2016.07.13
                    2016/07/21 04:09:39Z: AMI Origin Name: Windows_Server-2012-R2_RTM-English-64Bit-Base
                    2016/07/21 04:09:39Z: OS: Microsoft Windows NT 6.3.9600
                    2016/07/21 04:09:39Z: OsVersion: 6.3
                    2016/07/21 04:09:39Z: OsProductName: Windows Server 2012 R2 Standard
                    2016/07/21 04:09:39Z: OsBuildLabEx: 9600.18289.amd64fre.winblue_ltsb.160328-1315
                    2016/07/21 04:09:39Z: Language: en-US
                    2016/07/21 04:09:39Z: TimeZone: Coordinated Universal Time
                    2016/07/21 04:09:39Z: Offset: UTC 00:00:00
                    2016/07/21 04:09:39Z: EC2 Agent: Ec2Config service v3.17.1032
                    2016/07/21 04:09:41Z: Message: Waiting for meta-data accessibility...
                    2016/07/21 04:09:41Z: Message: Meta-data is now available.
                    2016/07/21 04:09:42Z: AMI-ID: ami-26e72546
                    2016/07/21 04:09:42Z: Instance-ID: i-a38c0b0c
                    2016/07/21 04:09:42Z: Driver: AWS PV Network Device v7.4.2.0
                    2016/07/21 04:09:42Z: Driver: AWS PV Storage Host Adapter v7.4.2.0
                    2016/07/21 04:09:42Z: Ec2SetPassword: Enabled
                    2016/07/21 04:09:42Z: RDPCERTIFICATE-SUBJECTNAME: WIN-SPDQM60MCAH
                    2016/07/21 04:09:42Z: RDPCERTIFICATE-THUMBPRINT: 7B748E7277E6D9B2EE5FF6456D61FD8C43E840C1
                    2016/07/21 04:09:45Z: Username: Administrator
                    2016/07/21 04:09:45Z: Password: <Password>
                    Gc0okSKE+zAvbptyjEnxravOnlfzTPwltDucMLU6Yjfbeqjz3baSN/73iPzwWeZrVXt/4ucplKS06pcmYEaOWsfCjt+VDXAA3YTMN6sXqzLr0QF/BYDlIt3ZrDPLIZqu1NH9snvHQeQdtTlfb5mknYL3Tvqmq++9sjUnHKxYtc2fjYc8P6n6YxCMYmsvUReT6M829nElJxP0ExFIUklPYb3RMAcsuNYZ7ORRWm+892iQAUXrjz3IkpAeZ898Ktor1mIEK31TOc3nnMLmTwV40FJS74bOuGjhgbVIRLq5H4m7nxTlWt7DcTyWO7BMvCIGEOQIOJxVit9ylgX/U8trmw==
                    </Password>
                    2016/07/21 04:09:47Z: Message: Windows is Ready to use

                           Waited 0/300s for instance <i-a38c0b0c> to fetch windows admin password.
                           downloading http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm
                             to file /tmp/install.sh.961/chef-12.13.8+20160721014124-1.el6.x86_64.rpm
                           trying curl...
                           Retrieved Windows password for instance <i-a38c0b0c>.
                           EC2 instance <i-a38c0b0c> ready.
                    D      [WinRM] <{:endpoint=>"http://10.194.12.123:5985/wsman", :user=>"administrator", :password=>"ussS(6;D@$p", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"ussS(6;D@$p", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (Write-Host '[WinRM] Established
                    ')
                    D      [WinRM] opening remote shell on http://10.194.12.123:5985/wsman
                           Comparing checksum with sha256sum...
                           Installing chef 12.13.8+20160721014124
                           installing with rpm...
                           warning: /tmp/install.sh.961/chef-12.13.8+20160721014124-1.el6.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID 83ef826a: NOKEY
                           Preparing...                                                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                    D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                           Waiting for SSH service on 10.194.9.186:22, retrying in 3 seconds
                    D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] connection failed (#<Net::SSH::AuthenticationFailed: Authentication failed for user root@10.194.9.186>)
                           Waiting for SSH service on 10.194.9.186:22, retrying in 3 seconds
                           Waited 95/300s for instance <i-998d0a36> to become ready.
                              1:chef                                                               (  1%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (  3%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (  6%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (  8%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        ( 10%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       ( 13%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      ( 15%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     ( 17%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    ( 19%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   ( 22%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  ( 24%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 ( 26%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                ( 28%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               ( 31%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              ( 33%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             ( 35%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            ( 38%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           ( 40%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          ( 42%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         ( 44%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        ( 47%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       ( 49%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      ( 51%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     ( 53%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    ( 56%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   ( 58%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  ( 60%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 ( 63%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                ( 65%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               ( 67%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              ( 69%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             ( 72%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            ( 74%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           ( 76%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          ( 78%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         ( 81%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        ( 83%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       ( 85%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      ( 88%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     ( 90%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    ( 92%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   ( 94%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  ( 97%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### ( 99%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                           /bin/sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           Thank you for installing Chef!
                    D      [SSH] root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
                    sudo_rm="sudo -E rm"
                    dirs="/tmp/kitchen/clients /tmp/kitchen/cookbooks /tmp/kitchen/data /tmp/kitchen/data_bags /tmp/kitchen/encrypted_data_bag_secret /tmp/kitchen/environments /tmp/kitchen/roles"
                    root_path="/tmp/kitchen"

                    $sudo_rm -rf $dirs
                    mkdir -p $root_path
                    ')
                           bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                    D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (echo '[SSH] Established')
                           Transferring files to <fips-unit-functional-centos-6>
                    D      TIMING: scp async upload (Kitchen::Transport::Ssh)
                           bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           [SSH] Established
                    D      Using sudo_command='sudo -E' for ohai hints
                    D      [SSH] reusing existing connection root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E mkdir -p /etc/chef/ohai/hints; sudo -E touch /etc/chef/ohai/hints/ec2.json)
                           bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                    D      TIMING: scp async upload (Kitchen::Transport::Ssh) took (0m0.16s)
                    D      Transfer complete
                    D      Attempting to execute command - try 1 of 1.
                    D      [SSH] root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
                    sudo -E /opt/chef/bin/chef-client --local-mode --config /tmp/kitchen/client.rb --log_level auto --force-formatter --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889
                    ')
                           bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                    D      ec2:create '10.194.9.186'
                           Finished creating <fips-integration-centos-6> (1m45.15s).
                    -----> Converging <fips-integration-centos-6>...
                           Preparing files for transfer
                    D      Creating local sandbox in /tmp/cheftest/fips-integration-centos-6-sandbox-20160721-21168-2nhx28
                           Preparing dna.json
                    D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                           Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                           Removing non-cookbook files before transfer
                           Preparing validation.pem
                    D      Using a dummy validation.pem
                           Preparing client.rb
                    D      Creating client.rb from {:node_name=>"fips-integration-centos-6", :checksum_path=>"/tmp/kitchen/checksums", :file_cache_path=>"/tmp/kitchen/cache", :file_backup_path=>"/tmp/kitchen/backup", :cookbook_path=>["/tmp/kitchen/cookbooks", "/tmp/kitchen/site-cookbooks"], :data_bag_path=>"/tmp/kitchen/data_bags", :environment_path=>"/tmp/kitchen/environments", :node_path=>"/tmp/kitchen/nodes", :role_path=>"/tmp/kitchen/roles", :client_path=>"/tmp/kitchen/clients", :user_path=>"/tmp/kitchen/users", :validation_key=>"/tmp/kitchen/validation.pem", :client_key=>"/tmp/kitchen/client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"/tmp/kitchen/encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
                    D      [SSH] reusing existing connection root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E cat > /tmp/chef-installer.sh <<"EOL"
                    #!/bin/bash
                    #!/bin/sh
                    # WARNING: REQUIRES /bin/sh
                    #
                    # - must run on /bin/sh on solaris 9
                    # - must run on /bin/sh on AIX 6.x
                    #
                    # Copyright:: Copyright (c) 2010-2015 Chef Software, Inc.
                    # License:: Apache License, Version 2.0
                    #
                    # Licensed under the Apache License, Version 2.0 (the "License");
                    # you may not use this file except in compliance with the License.
                    # You may obtain a copy of the License at
                    #
                    #     http://www.apache.org/licenses/LICENSE-2.0
                    #
                    # Unless required by applicable law or agreed to in writing, software
                    # distributed under the License is distributed on an "AS IS" BASIS,
                    # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                    # See the License for the specific language governing permissions and
                    # limitations under the License.
                    #

                    # helpers.sh
                    ############
                    # This section has some helper functions to make life easier.
                    #
                    # Outputs:
                    # $tmp_dir: secure-ish temp directory that can be used during installation.
                    ############

                    # Check whether a command exists - returns 0 if it does, 1 if it does not
                    exists() {
                      if command -v $1 >/dev/null 2>&1
                      then
                        return 0
                      else
                        return 1
                      fi
                    }

                    # Output the instructions to report bug about this script
                    report_bug() {
                      echo "Version: $version"
                      echo ""
                      echo "Please file a Bug Report at https://github.com/chef/omnitruck/issues/new"
                      echo "Alternatively, feel free to open a Support Ticket at https://www.chef.io/support/tickets"
                      echo "More Chef support resources can be found at https://www.chef.io/support"
                      echo ""
                      echo "Please include as many details about the problem as possible i.e., how to reproduce"
                      echo "the problem (if possible), type of the Operating System and its version, etc.,"
                      echo "and any other relevant details that might help us with troubleshooting."
                      echo ""
                    }

                    checksum_mismatch() {
                      echo "Package checksum mismatch!"
                      report_bug
                      exit 1
                    }

                    unable_to_retrieve_package() {
                      echo "Unable to retrieve a valid package!"
                      report_bug
                      echo "Metadata URL: $metadata_url"
                      if test "x$download_url" != "x"; then
                        echo "Download URL: $download_url"
                      fi
                      if test "x$stderr_results" != "x"; then
                        echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
                      fi
                      exit 1
                    }

                    http_404_error() {
                      echo "Omnitruck artifact does not exist for version $version on platform $platform"
                      echo ""
                      echo "Either this means:"
                      echo "   - We do not support $platform"
                      echo "   - We do not have an artifact for $version"
                      echo ""
                      echo "This is often the latter case due to running a prerelease or RC version of chef"
                      echo "or a gem version which was only pushed to rubygems and not omnitruck."
                      echo ""
                      echo "You may be able to set your knife[:bootstrap_version] to the most recent stable"
                      echo "release of Chef to fix this problem (or the most recent stable major version number)."
                      echo ""
                      echo "In order to test the version parameter, adventurous users may take the Metadata URL"
                      echo "below and modify the '&v=<number>' parameter until you successfully get a URL that"
                      echo "does not 404 (e.g. via curl or wget).  You should be able to use '&v=11' or '&v=12'"
                      echo "succesfully."
                      echo ""
                      echo "If you cannot fix this problem by setting the bootstrap_version, it probably means"
                      echo "that $platform is not supported."
                      echo ""
                      # deliberately do not call report_bug to suppress bug report noise.
                      echo "Metadata URL: $metadata_url"
                      if test "x$download_url" != "x"; then
                        echo "Download URL: $download_url"
                      fi
                      if test "x$stderr_results" != "x"; then
                        echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
                      fi
                      exit 1
                    }

                    capture_tmp_stderr() {
                      # spool up /tmp/stderr from all the commands we called
                      if test -f "$tmp_dir/stderr"; then
                        output=`cat $tmp_dir/stderr`
                        stderr_results="${stderr_results}\nSTDERR from $1:\n\n$output\n"
                        rm $tmp_dir/stderr
                      fi
                    }

                    # do_wget URL FILENAME
                    do_wget() {
                      echo "trying wget..."
                      wget -O "$2" "$1" 2>$tmp_dir/stderr
                      rc=$?
                      # check for 404
                      grep "ERROR 404" $tmp_dir/stderr 2>&1 >/dev/null
                      if test $? -eq 0; then
                        echo "ERROR 404"
                        http_404_error
                      fi

                      # check for bad return status or empty output
                      if test $rc -ne 0 || test ! -s "$2"; then
                        capture_tmp_stderr "wget"
                        return 1
                      fi

                      return 0
                    }

                    # do_curl URL FILENAME
                    do_curl() {
                      echo "trying curl..."
                      curl --retry 5 -sL -D $tmp_dir/stderr "$1" > "$2"
                      rc=$?
                      # check for 404
                      grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
                      if test $? -eq 0; then
                        echo "ERROR 404"
                        http_404_error
                      fi

                      # check for bad return status or empty output
                      if test $rc -ne 0 || test ! -s "$2"; then
                        capture_tmp_stderr "curl"
                        return 1
                      fi

                      return 0
                    }

                    # do_fetch URL FILENAME
                    do_fetch() {
                      echo "trying fetch..."
                      fetch -o "$2" "$1" 2>$tmp_dir/stderr
                      # check for bad return status
                      test $? -ne 0 && return 1
                      return 0
                    }

                    # do_perl URL FILENAME
                    do_perl() {
                      echo "trying perl..."
                      perl -e 'use LWP::Simple; getprint($ARGV[0]);' "$1" > "$2" 2>$tmp_dir/stderr
                      rc=$?
                      # check for 404
                      grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
                      if test $? -eq 0; then
                        echo "ERROR 404"
                        http_404_error
                      fi

                      # check for bad return status or empty output
                      if test $rc -ne 0 || test ! -s "$2"; then
                        capture_tmp_stderr "perl"
                        return 1
                      fi

                      return 0
                    }

                    # do_python URL FILENAME
                    do_python() {
                      echo "trying python..."
                      python -c "import sys,urllib2 ; sys.stdout.write(urllib2.urlopen(sys.argv[1]).read())" "$1" > "$2" 2>$tmp_dir/stderr
                      rc=$?
                      # check for 404
                      grep "HTTP Error 404" $tmp_dir/stderr 2>&1 >/dev/null
                      if test $? -eq 0; then
                        echo "ERROR 404"
                        http_404_error
                      fi

                      # check for bad return status or empty output
                      if test $rc -ne 0 || test ! -s "$2"; then
                        capture_tmp_stderr "python"
                        return 1
                      fi
                      return 0
                    }

                    # returns 0 if checksums match
                    do_checksum() {
                      if exists sha256sum; then
                        echo "Comparing checksum with sha256sum..."
                        checksum=`sha256sum $1 | awk '{ print $1 }'`
                        return `test "x$checksum" = "x$2"`
                      elif exists shasum; then
                        echo "Comparing checksum with shasum..."
                        checksum=`shasum -a 256 $1 | awk '{ print $1 }'`
                        return `test "x$checksum" = "x$2"`
                      else
                        echo "WARNING: could not find a valid checksum program, pre-install shasum or sha256sum in your O/S image to get valdation..."
                        return 0
                      fi
                    }

                    # do_download URL FILENAME
                    do_download() {
                      echo "downloading $1"
                      echo "  to file $2"

                      url=`echo $1`
                      if test "x$platform" = "xsolaris2"; then
                        if test "x$platform_version" = "x5.9" -o "x$platform_version" = "x5.10"; then
                          # solaris 9 lacks openssl, solaris 10 lacks recent enough credentials - your base O/S is completely insecure, please upgrade
                          url=`echo $url | sed -e 's/https/http/'`
                        fi
                      fi

                      # we try all of these until we get success.
                      # perl, in particular may be present but LWP::Simple may not be installed

                      if exists wget; then
                        do_wget $url $2 && return 0
                      fi

                      if exists curl; then
                        do_curl $url $2 && return 0
                      fi

                      if exists fetch; then
                        do_fetch $url $2 && return 0
                      fi

                      if exists perl; then
                        do_perl $url $2 && return 0
                      fi

                      if exists python; then
                        do_python $url $2 && return 0
                      fi

                      unable_to_retrieve_package
                    }

                    # install_file TYPE FILENAME
                    # TYPE is "rpm", "deb", "solaris", "sh", etc.
                    install_file() {
                      echo "Installing $project $version"
                      case "$1" in
                        "rpm")
                          if test "x$platform" = "xnexus" || test "x$platform" = "xios_xr"; then
                            echo "installing with yum..."
                            yum install -yv "$2"
                          else
                            echo "installing with rpm..."
                            rpm -Uvh --oldpackage --replacepkgs "$2"
                          fi
                          ;;
                        "deb")
                          echo "installing with dpkg..."
                          dpkg -i "$2"
                          ;;
                        "bff")
                          echo "installing with installp..."
                          installp -aXYgd "$2" all
                          ;;
                        "solaris")
                          echo "installing with pkgadd..."
                          echo "conflict=nocheck" > $tmp_dir/nocheck
                          echo "action=nocheck" >> $tmp_dir/nocheck
                          echo "mail=" >> $tmp_dir/nocheck
                          pkgrm -a $tmp_dir/nocheck -n $project >/dev/null 2>&1 || true
                          pkgadd -G -n -d "$2" -a $tmp_dir/nocheck $project
                          ;;
                        "pkg")
                          echo "installing with installer..."
                          cd / && /usr/sbin/installer -pkg "$2" -target /
                          ;;
                        "dmg")
                          echo "installing dmg file..."
                          hdiutil detach "/Volumes/chef_software" >/dev/null 2>&1 || true
                          hdiutil attach "$2" -mountpoint "/Volumes/chef_software"
                          cd / && /usr/sbin/installer -pkg `find "/Volumes/chef_software" -name \*.pkg` -target /
                          hdiutil detach "/Volumes/chef_software"
                          ;;
                        "sh" )
                          echo "installing with sh..."
                          sh "$2"
                          ;;
                        *)
                          echo "Unknown filetype: $1"
                          report_bug
                          exit 1
                          ;;
                      esac
                      if test $? -ne 0; then
                        echo "Installation failed"
                        report_bug
                        exit 1
                      fi
                    }

                    if test "x$TMPDIR" = "x"; then
                      tmp="/tmp"
                    else
                      tmp=$TMPDIR
                    fi
                    # secure-ish temp dir creation without having mktemp available (DDoS-able but not expliotable)
                    tmp_dir="$tmp/install.sh.$$"
                    (umask 077 && mkdir $tmp_dir) || exit 1

                    ############
                    # end of helpers.sh
                    ############


                    project=chef
                    version=12.13.8+20160721014124
                    channel=unstable


                    # platform_detection.sh
                    ############
                    # This section makes platform detection compatible with omnitruck on the system
                    #   it runs.
                    #
                    # Outputs:
                    # $platform: Name of the platform.
                    # $platform_version: Version of the platform.
                    # $machine: System's architecture.
                    ############

                    #
                    # Platform and Platform Version detection
                    #
                    # NOTE: This should now match ohai platform and platform_version matching.
                    # do not invented new platform and platform_version schemas, just make this behave
                    # like what ohai returns as platform and platform_version for the server.
                    #
                    # ALSO NOTE: Do not mangle platform or platform_version here.  It is less error
                    # prone and more future-proof to do that in the server, and then all omnitruck clients
                    # will 'inherit' the changes (install.sh is not the only client of the omnitruck
                    # endpoint out there).
                    #

                    machine=`uname -m`
                    os=`uname -s`

                    if test -f "/etc/lsb-release" && grep -q DISTRIB_ID /etc/lsb-release && ! grep -q wrlinux /etc/lsb-release; then
                      platform=`grep DISTRIB_ID /etc/lsb-release | cut -d "=" -f 2 | tr '[A-Z]' '[a-z]'`
                      platform_version=`grep DISTRIB_RELEASE /etc/lsb-release | cut -d "=" -f 2`
                    elif test -f "/etc/debian_version"; then
                      platform="debian"
                      platform_version=`cat /etc/debian_version`
                    elif test -f "/etc/redhat-release"; then
                      platform=`sed 's/^\(.\+\) release.*/\1/' /etc/redhat-release | tr '[A-Z]' '[a-z]'`
                      platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/redhat-release`

                      # If /etc/redhat-release exists, we act like RHEL by default
                      if test "$platform" = "fedora"; then
                        # FIXME: stop remapping fedora to el
                        # FIXME: remove client side platform_version mangling and hard coded yolo
                        # Change platform version for use below.
                        platform_version="6.0"
                      fi

                      if test "$platform" = "xenserver"; then
                        # Current XenServer 6.2 is based on CentOS 5, platform is not reset to "el" server should hanlde response
                        platform="xenserver"
                      else
                        # FIXME: use "redhat"
                        platform="el"
                      fi

                    elif test -f "/etc/system-release"; then
                      platform=`sed 's/^\(.\+\) release.\+/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
                      platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
                      # amazon is built off of fedora, so act like RHEL
                      if test "$platform" = "amazon linux ami"; then
                        # FIXME: remove client side platform_version mangling and hard coded yolo, and remapping to deprecated "el"
                        platform="el"
                        platform_version="6.0"
                      fi
                    # Apple OS X
                    elif test -f "/usr/bin/sw_vers"; then
                      platform="mac_os_x"
                      # Matching the tab-space with sed is error-prone
                      platform_version=`sw_vers | awk '/^ProductVersion:/ { print $2 }' | cut -d. -f1,2`

                      # x86_64 Apple hardware often runs 32-bit kernels (see OHAI-63)
                      x86_64=`sysctl -n hw.optional.x86_64`
                      if test $x86_64 -eq 1; then
                        machine="x86_64"
                      fi
                    elif test -f "/etc/release"; then
                      machine=`/usr/bin/uname -p`
                      if grep -q SmartOS /etc/release; then
                        platform="smartos"
                        platform_version=`grep ^Image /etc/product | awk '{ print $3 }'`
                      else
                        platform="solaris2"
                        platform_version=`/usr/bin/uname -r`
                      fi
                    elif test -f "/etc/SuSE-release"; then
                      if grep -q 'Enterprise' /etc/SuSE-release;
                      then
                          platform="sles"
                          platform_version=`awk '/^VERSION/ {V = $3}; /^PATCHLEVEL/ {P = $3}; END {print V "." P}' /etc/SuSE-release`
                      else
                          platform="suse"
                          platform_version=`awk '/^VERSION =/ { print $3 }' /etc/SuSE-release`
                      fi
                    elif test "x$os" = "xFreeBSD"; then
                      platform="freebsd"
                      platform_version=`uname -r | sed 's/-.*//'`
                    elif test "x$os" = "xAIX"; then
                      platform="aix"
                      platform_version="`uname -v`.`uname -r`"
                      machine="powerpc"
                    elif test -f "/etc/os-release"; then
                      . /etc/os-release
                      if test "x$CISCO_RELEASE_INFO" != "x"; then
                        . $CISCO_RELEASE_INFO
                      fi

                      platform=$ID
                      platform_version=$VERSION
                    fi

                    if test "x$platform" = "x"; then
                      echo "Unable to determine platform version!"
                      report_bug
                      exit 1
                    fi

                    #
                    # NOTE: platform manging in the install.sh is DEPRECATED
                    #
                    # - install.sh should be true to ohai and should not remap
                    #   platform or platform versions.
                    #
                    # - remapping platform and mangling platform version numbers is
                    #   now the complete responsibility of the server-side endpoints
                    #

                    major_version=`echo $platform_version | cut -d. -f1`
                    case $platform in
                      # FIXME: should remove this case statement completely
                      "el")
                        # FIXME:  "el" is deprecated, should use "redhat"
                        platform_version=$major_version
                        ;;
                      "debian")
                        if test "x$major_version" = "x5"; then
                          # This is here for potential back-compat.
                          # We do not have 5 in versions we publish for anymore but we
                          # might have it for earlier versions.
                          platform_version="6"
                        else
                          platform_version=$major_version
                        fi
                        ;;
                      "freebsd")
                        platform_version=$major_version
                        ;;
                      "sles")
                        platform_version=$major_version
                        ;;
                      "suse")
                        platform_version=$major_version
                        ;;
                    esac

                    # normalize the architecture we detected
                    case $machine in
                      "x86_64"|"amd64"|"x64")
                        machine="x86_64"
                        ;;
                      "i386"|"i86pc"|"x86"|"i686")
                        machine="i386"
                        ;;
                      "sparc"|"sun4u"|"sun4v")
                        machine="sparc"
                        ;;
                    esac

                    if test "x$platform_version" = "x"; then
                      echo "Unable to determine platform version!"
                      report_bug
                      exit 1
                    fi

                    if test "x$platform" = "xsolaris2"; then
                      # hack up the path on Solaris to find wget, pkgadd
                      PATH=/usr/sfw/bin:/usr/sbin:$PATH
                      export PATH
                    fi

                    echo "$platform $platform_version $machine"

                    ############
                    # end of platform_detection.sh
                    ############


                    # artifactory_urls.sh
                    ############
                    # This section sets up the information for a build to be installed from artifactory
                    #  then uses $platform, $platform_version and $machine to select the correct
                    #  version.
                    #
                    # Inputs:
                    # $platform:
                    # $platform_version:
                    # $machine:
                    #
                    # Outputs:
                    # $download_url:
                    # $sha256:
                    ############


                      artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.9/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.10/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.11/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/ppc64le"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ios_xr/6/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/nexus/7/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/6/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/6/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/7/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/8/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64le"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/6/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/7/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/debian/8/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/amd64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2012/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/i386"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/6/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2012/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/aix/6.1/powerpc"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/aix/7.1/powerpc"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/5/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/i686"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/7/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/el/5/x86_64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/amd64"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/sparc"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" >> "$artifact_info_dir/artifact_info"

                      artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/sparc"
                      mkdir -p $artifact_info_dir
                      touch "$artifact_info_dir/artifact_info"
                      echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
                      echo "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" >> "$artifact_info_dir/artifact_info"


                    artifact_info_for_platform="$tmp_dir/artifact_info/$platform/$platform_version/$machine/artifact_info"

                    download_url=`awk '$1 == "url" { print $2 }' "$artifact_info_for_platform"`
                    sha256=`awk '$1 == "sha256" { print $2 }' "$artifact_info_for_platform"`


                    # fetch_package.sh
                    ############
                    # This section fetchs a package from $download_url and verifies its metadata.
                    #
                    # Inputs:
                    # $download_url:
                    # $tmp_dir:
                    # Optional Inputs:
                    # $cmdline_filename: Name of the package downloaded on local disk.
                    # $cmdline_dl_dir: Name of the directory downloaded package will be saved to on local disk.
                    #
                    # Outputs:
                    # $download_filename: Name of the downloaded file on local disk.
                    # $filetype: Type of the file downloaded.
                    ############

                    filename=`echo $download_url | sed -e 's/^.*\///'`
                    filetype=`echo $filename | sed -e 's/^.*\.//'`

                    # use either $tmp_dir, the provided directory (-d) or the provided filename (-f)
                    if test "x$cmdline_filename" != "x"; then
                      download_filename="$cmdline_filename"
                    elif test "x$cmdline_dl_dir" != "x"; then
                      download_filename="$cmdline_dl_dir/$filename"
                    else
                      download_filename="$tmp_dir/$filename"
                    fi

                    # ensure the parent directory where to download the installer always exists
                    download_dir=`dirname $download_filename`
                    (umask 077 && mkdir -p $download_dir) || exit 1

                    # check if we have that file locally available and if so verify the checksum
                    cached_file_available="false"
                    if test -f $download_filename; then
                      echo "$download_filename already exists, verifiying checksum..."
                      if do_checksum "$download_filename" "$sha256"; then
                        echo "checksum compare succeeded, using existing file!"
                        cached_file_available="true"
                      else
                        echo "checksum mismatch, downloading latest version of the file"
                      fi
                    fi

                    # download if no local version of the file available
                    if test "x$cached_file_available" != "xtrue"; then
                      do_download "$download_url"  "$download_filename"
                      do_checksum "$download_filename" "$sha256" || checksum_mismatch
                    fi

                    ############
                    # end of fetch_package.sh
                    ############


                    # install_package.sh
                    ############
                    # Installs a package and removed the temp directory.
                    #
                    # Inputs:
                    # $download_filename: Name of the file to be installed.
                    # $filetype: Type of the file to be installed.
                    # $version: The version requested. Used only for warning user if not set.
                    ############

                    if test "x$version" = "x"; then
                      echo
                      echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
                      echo
                      echo "You are installing an omnibus package without a version pin.  If you are installing"
                      echo "on production servers via an automated process this is DANGEROUS and you will"
                      echo "be upgraded without warning on new releases, even to new major releases."
                      echo "Letting the version float is only appropriate in desktop, test, development or"
                      echo "CI/CD environments."
                      echo
                      echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
                      echo
                    fi

                    install_file $filetype "$download_filename"

                    if test "x$tmp_dir" != "x"; then
                      rm -r "$tmp_dir"
                    fi

                    ############
                    # end of install_package.sh
                    ############

                    EOL
                    chmod +x /tmp/chef-installer.sh
                    sudo -E /tmp/chef-installer.sh)
                           bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           /bin/bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           el 6 x86_64
                           downloading http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm
                             to file /tmp/install.sh.959/chef-12.13.8+20160721014124-1.el6.x86_64.rpm
                           trying curl...
                           Comparing checksum with sha256sum...
                           Installing chef 12.13.8+20160721014124
                           installing with rpm...
                           warning: /tmp/install.sh.959/chef-12.13.8+20160721014124-1.el6.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID 83ef826a: NOKEY
                           Starting Chef Client, version 12.13.8
                           Preparing...                                                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                           Waited 100/300s for instance <i-998d0a36> to become ready.
                    D      Console output: ---
                    2016/07/21 04:09:48Z: EC2ConfigMonitorState: 0
                    2016/07/21 04:09:48Z: Windows sysprep configuration complete.
                    2016/07/21 04:09:51Z: AMI Origin Version: 2016.07.13
                    2016/07/21 04:09:51Z: AMI Origin Name: Windows_Server-2012-R2_RTM-English-64Bit-Base
                    2016/07/21 04:09:51Z: OS: Microsoft Windows NT 6.3.9600
                    2016/07/21 04:09:51Z: OsVersion: 6.3
                    2016/07/21 04:09:51Z: OsProductName: Windows Server 2012 R2 Standard
                    2016/07/21 04:09:51Z: OsBuildLabEx: 9600.18289.amd64fre.winblue_ltsb.160328-1315
                    2016/07/21 04:09:51Z: Language: en-US
                    2016/07/21 04:09:51Z: TimeZone: Coordinated Universal Time
                    2016/07/21 04:09:51Z: Offset: UTC 00:00:00
                    2016/07/21 04:09:51Z: EC2 Agent: Ec2Config service v3.17.1032
                    2016/07/21 04:09:53Z: Message: Waiting for meta-data accessibility...
                    2016/07/21 04:09:53Z: Message: Meta-data is now available.
                    2016/07/21 04:09:54Z: AMI-ID: ami-26e72546
                    2016/07/21 04:09:54Z: Instance-ID: i-998d0a36
                    2016/07/21 04:09:57Z: Driver: AWS PV Network Device v7.4.2.0
                    2016/07/21 04:09:57Z: Driver: AWS PV Storage Host Adapter v7.4.2.0
                    2016/07/21 04:09:57Z: Ec2SetPassword: Enabled
                    2016/07/21 04:09:57Z: RDPCERTIFICATE-SUBJECTNAME: WIN-92QQ3FH7A5C
                    2016/07/21 04:09:57Z: RDPCERTIFICATE-THUMBPRINT: 1C269189A5A3B5133C5AA0EFAD7040A198453128
                    2016/07/21 04:10:00Z: Username: Administrator
                    2016/07/21 04:10:00Z: Password: <Password>
                    l8oWy+hTmePCztgfyCQgGjiX69rQTP1zlwuy+YU6hjQhF6EkVunATppMlULRzEEkzNv6qpwJjH15S4hSZ3klYZzq/D2U35j+JL8oN9g6g6oL7Jo1XUM8ksuYGNvlQN7qO/fOrhmzMNR+mTqCh/GibnIYUn/wZuU2ZT+J0MdEI7Ww68d4ct+/EJI93aw6klxW0R4u+V7VAZUw+7YRdTuinC/ZCDIImVe1x6dELDu7oqSO6EZrlZvPQ4fJKOYlh343D8fl2hOySZtLyx3RnigrCeKacK3YREO0uLEar099eoy51AjK0qLcYiiCY6gwwD9V+jUv/R+z6KxOwfE+iOpYiw==
                    </Password>
                    2016/07/21 04:10:01Z: Message: Windows is Ready to use

                           Waited 0/300s for instance <i-998d0a36> to fetch windows admin password.
                           Retrieved Windows password for instance <i-998d0a36>.
                           EC2 instance <i-998d0a36> ready.
                    D      [WinRM] <{:endpoint=>"http://10.194.13.35:5985/wsman", :user=>"administrator", :password=>"A8=ria;bCb.", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"A8=ria;bCb.", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (Write-Host '[WinRM] Established
                    ')
                    D      [WinRM] opening remote shell on http://10.194.13.35:5985/wsman
                           Creating a new client identity for fips-unit-functional-centos-6 using the validator key.
                           resolving cookbooks for run list: []
                           Synchronizing Cookbooks:
                           Installing Cookbook Gems:
                           Compiling Cookbooks...
                           [2016-07-21T04:10:06+00:00] WARN: Node fips-unit-functional-centos-6 has an empty run list.
                           Converging 0 resources
                           Starting audit phase

                           Finished in 0.00028 seconds (files took 0.39181 seconds to load)
                           0 examples, 0 failures
                           Auditing complete

                           Running handlers:
                           Running handlers complete
                           Chef Client finished, 0/0 resources updated in 03 seconds
                           [2016-07-21T04:10:06+00:00] ERROR: Failed to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json
                    D      Cleaning up local sandbox in /tmp/cheftest/fips-unit-functional-centos-6-sandbox-20160721-21168-kwydkn
                           Finished converging <fips-unit-functional-centos-6> (0m13.46s).
                    D      [SSH] shutting previous connection root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] closing connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                              1:chef                                                               (  1%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (  3%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (  6%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (  8%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        ( 10%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       ( 13%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      ( 15%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     ( 17%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    ( 19%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   ( 22%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  ( 24%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 ( 26%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                ( 28%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               ( 31%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              ( 33%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             ( 35%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            ( 38%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           ( 40%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          ( 42%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         ( 44%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        ( 47%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       ( 49%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      ( 51%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     ( 53%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    ( 56%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   ( 58%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  ( 60%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 ( 63%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                ( 65%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               ( 67%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              ( 69%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             ( 72%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            ( 74%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           ( 76%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          ( 78%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         ( 81%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        ( 83%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       ( 85%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      ( 88%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     ( 90%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    ( 92%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   ( 94%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  ( 97%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### ( 99%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                           /bin/sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           Thank you for installing Chef!
                    D      [SSH] root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
                    sudo_rm="sudo -E rm"
                    dirs="/tmp/kitchen/clients /tmp/kitchen/cookbooks /tmp/kitchen/data /tmp/kitchen/data_bags /tmp/kitchen/encrypted_data_bag_secret /tmp/kitchen/environments /tmp/kitchen/roles"
                    root_path="/tmp/kitchen"

                    $sudo_rm -rf $dirs
                    mkdir -p $root_path
                    ')
                           bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           Transferring files to <fips-integration-centos-6>
                    D      TIMING: scp async upload (Kitchen::Transport::Ssh)
                    D      TIMING: scp async upload (Kitchen::Transport::Ssh) took (0m0.14s)
                    D      Transfer complete
                    D      Attempting to execute command - try 1 of 1.
                    D      [SSH] root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
                    sudo -E /opt/chef/bin/chef-client --local-mode --config /tmp/kitchen/client.rb --log_level auto --force-formatter --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889
                    ')
                           bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                           Starting Chef Client, version 12.13.8
                           Creating a new client identity for fips-integration-centos-6 using the validator key.
                           resolving cookbooks for run list: []
                           Synchronizing Cookbooks:
                           Installing Cookbook Gems:
                           Compiling Cookbooks...
                           [2016-07-21T04:10:14+00:00] WARN: Node fips-integration-centos-6 has an empty run list.
                           Converging 0 resources
                           Starting audit phase

                           Finished in 0.00032 seconds (files took 0.38658 seconds to load)
                           0 examples, 0 failures
                           Auditing complete

                           Running handlers:
                           Running handlers complete
                           Chef Client finished, 0/0 resources updated in 03 seconds
                           [2016-07-21T04:10:14+00:00] ERROR: Failed to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json
                    D      Cleaning up local sandbox in /tmp/cheftest/fips-integration-centos-6-sandbox-20160721-21168-2nhx28
                           Finished converging <fips-integration-centos-6> (0m13.32s).
                    D      [SSH] shutting previous connection root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [SSH] closing connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                    D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000001d57248 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.2</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                    D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000000043cb208 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">2.0</Version></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version></LST></Obj></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">6.3.9600.17400</Version></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.2</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                    D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000000042bb3b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                    D      [WinRM] remote shell created with shell_id: CC87BBC9-9EDC-4389-B005-95C105A1031C
                    D      [WinRM] Command created for Write-Host '[WinRM] Established
                    ' with id: 9A2B6CC0-22CD-40B1-8EB3-DFA2E33DD5B3
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                           [WinRM] Established

                    D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.12.123:5985/wsman", :user=>"administrator", :password=>"ussS(6;D@$p", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"ussS(6;D@$p", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                    D      [WinRM] <{:endpoint=>"http://10.194.12.123:5985/wsman", :user=>"administrator", :password=>"ussS(6;D@$p", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"ussS(6;D@$p", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File)
                    D      [WinRM] Command created for New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File with id: C38A59C4-EEB4-4F84-B49D-BD307C1825E6
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output


                               Directory: C:\chef\ohai\hints


                           Mode                LastWriteTime     Length Name
                           ----                -------------     ------ ----
                           -a---         7/21/2016   4:10 AM          0 ec2.json


                    D      ec2:create '10.194.12.123'
                           Finished creating <fips-integration-windows-2012r2> (2m0.73s).
                    -----> Converging <fips-integration-windows-2012r2>...
                           Preparing files for transfer
                    D      Creating local sandbox in /tmp/cheftest/fips-integration-windows-2012r2-sandbox-20160721-21168-orerim
                           Preparing dna.json
                    D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                           Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                           Removing non-cookbook files before transfer
                           Preparing validation.pem
                    D      Using a dummy validation.pem
                           Preparing client.rb
                    D      Creating client.rb from {:node_name=>"fips-integration-windows-2012r2", :checksum_path=>"\#{ENV['TEMP']}\\kitchen\\checksums", :file_cache_path=>"\#{ENV['TEMP']}\\kitchen\\cache", :file_backup_path=>"\#{ENV['TEMP']}\\kitchen\\backup", :cookbook_path=>["\#{ENV['TEMP']}\\kitchen\\cookbooks", "\#{ENV['TEMP']}\\kitchen\\site-cookbooks"], :data_bag_path=>"\#{ENV['TEMP']}\\kitchen\\data_bags", :environment_path=>"\#{ENV['TEMP']}\\kitchen\\environments", :node_path=>"\#{ENV['TEMP']}\\kitchen\\nodes", :role_path=>"\#{ENV['TEMP']}\\kitchen\\roles", :client_path=>"\#{ENV['TEMP']}\\kitchen\\clients", :user_path=>"\#{ENV['TEMP']}\\kitchen\\users", :validation_key=>"\#{ENV['TEMP']}\\kitchen\\validation.pem", :client_key=>"\#{ENV['TEMP']}\\kitchen\\client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"\#{ENV['TEMP']}\\kitchen\\encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
                    D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.12.123:5985/wsman", :user=>"administrator", :password=>"ussS(6;D@$p", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"ussS(6;D@$p", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                    D      [WinRM] <{:endpoint=>"http://10.194.12.123:5985/wsman", :user=>"administrator", :password=>"ussS(6;D@$p", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"ussS(6;D@$p", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (new-module -name Omnitruck -scriptblock {
                    function Get-PlatformVersion {
                      switch -regex ((get-wmiobject win32_operatingsystem).version) {
                        '10\.0\.\d+' {$platform_version = '2012r2'}
                        '6\.3\.\d+'  {$platform_version = '2012r2'}
                        '6\.2\.\d+'  {$platform_version = '2012'}
                        '6\.1\.\d+'  {$platform_version = '2008r2'}
                        '6\.0\.\d+'  {$platform_version = '2008'}
                      }
                      return $platform_version
                    }

                    function Get-PlatformArchitecture {
                      if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                        $architecture = 'x86_64'
                      } else {
                        $architecture = 'i386'
                      }
                      return $architecture
                    }

                    function New-Uri {
                      param ($baseuri, $newuri)

                      try {
                      new-object System.Uri $baseuri, $newuri
                      }
                      catch [System.Management.Automation.MethodInvocationException]{
                        Write-Error "$($_.exception.message)"
                        throw $_.exception
                      }
                    }

                    function Get-WebContent {
                      param ($uri, $filepath)
                      $proxy = New-Object -TypeName System.Net.WebProxy
                      $wc = new-object System.Net.WebClient
                      $proxy.Address = $env:http_proxy
                      $wc.Proxy = $proxy

                      try {
                        if ([string]::IsNullOrEmpty($filepath)) {
                          $wc.downloadstring($uri)
                        }
                        else {
                          $wc.downloadfile($uri, $filepath)
                        }
                      }
                      catch {
                        $exception = $_.Exception
                        Write-Host "There was an error: "
                        do {
                          Write-Host "`t$($exception.message)"
                          $exception = $exception.innerexception
                        } while ($exception)
                        throw "Failed to download from $uri."
                      }
                    }

                    function Test-ProjectPackage {
                      [cmdletbinding()]
                      param ($Path, $Algorithm = 'SHA256', $Hash)

                      if (-not (get-command get-filehash))   {
                        function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                        function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                        function Get-FileHash ($Path, $Algorithm) {
                          $Path = (resolve-path $path).providerpath
                          $hash = @{Algorithm = $Algorithm; Path = $Path}
                          use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                            use ($in = (gi $path).OpenRead()) {
                              $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                            }
                          }
                          new-object PSObject -Property $hash
                        }
                      }
                      Write-Verbose "Testing the $Algorithm hash for $path."
                      $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                      Write-Verbose "`tDesired Hash - '$hash'"
                      Write-Verbose "`tActual Hash  - '$ActualHash'"
                      $Valid = $ActualHash -eq $Hash
                      if (-not $Valid) {
                        Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                      }
                      return $Valid
                    }

                    function Get-ProjectMetadata {
                      <#
                        .SYNOPSIS
                        Get metadata for a Chef Software, Inc. project
                        .DESCRIPTION
                        Get metadata for project
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                        Gets the download url and SHA256 checksum for the latest stable release of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                        Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                      #>
                      [cmdletbinding()]
                      param (
                        # Base url to retrieve metadata from.
                        [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                        [string]
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Release channel to install from
                        $channel = 'unstable',
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      # PowerShell is only on Windows ATM
                      $platform = 'windows'
                      Write-Verbose "Platform: $platform"

                      $platform_version = Get-PlatformVersion
                      Write-Verbose "Platform Version: $platform_version"

                      if ($architecture -eq 'auto') {
                        $architecture = Get-PlatformArchitecture
                      }

                      Write-Verbose "Architecture: $architecture"
                      Write-Verbose "Project: $project"


                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                      $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                      $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                        foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                      Write-Verbose "Project details: "
                      foreach ($key in $package_metadata.keys) {
                        Write-Verbose "`t$key = $($package_metadata[$key])"
                      }
                      $package_metadata
                    }

                    function Install-Project {
                      <#
                        .SYNOPSIS
                        Install a Chef Software, Inc. product
                        .DESCRIPTION
                        Install a Chef Software, Inc. product
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                        Installs the latest stable version of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                        Installs the latest integration build of the Chef Development Kit
                      #>
                      [cmdletbinding(SupportsShouldProcess=$true)]
                      param (
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Release channel to install from
                        [validateset('current', 'stable', 'unstable')]
                        [string]
                        $channel = 'stable',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Full path for the downloaded installer.
                        [string]
                        $filename,
                        # Full path to the location to download the installer
                        [string]
                        $download_directory = $env:temp,
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                      if (-not [string]::IsNullOrEmpty($filename)) {
                        $download_directory = split-path $filename
                        $filename = split-path $filename -leaf
                        if ([string]::IsNullOrEmpty($download_directory)) {
                          $download_directory = $pwd
                        }
                      }
                      else {
                        $filename = ($package_metadata.url -split '/')[-1]
                      }
                      Write-Verbose "Download directory: $download_directory"
                      Write-Verbose "Filename: $filename"

                      if (-not (test-path $download_directory)) {
                        mkdir $download_directory
                      }
                      $download_directory = (resolve-path $download_directory).providerpath
                      $download_destination = join-path $download_directory $filename

                      if ((test-path $download_destination) -and
                        (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                        Write-Verbose "Found existing valid installer at $download_destination."
                      }
                      else {
                        if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                          Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                          Get-WebContent $package_metadata.url -filepath $download_destination
                        }
                      }

                      if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                        if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                          Write-Host "Installing $project from $download_destination"
                          $installingProject = $True
                          $installAttempts = 0
                          while ($installingProject) {
                            $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                            $p.WaitForExit()
                            if ($p.ExitCode -eq 1618) {
                              Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                              continue
                            } elseif ($p.ExitCode -ne 0) {
                              throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                            }
                            $installingProject = $False
                          }
                        }
                        else {
                          throw "Failed to validate the downloaded installer for $project."
                        }
                      }
                    }
                    set-alias install -value Install-Project
                    export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                    }

                    install -project chef -version 12.13.8+20160721014124 -channel unstable
                    )
                    D      [WinRM] Command created for new-module -name Omnitruck -scriptblock {
                    function Get-PlatformVersion {
                      switch -regex ((get-wmiobject win32_operatingsystem).version) {
                        '10\.0\.\d+' {$platform_version = '2012r2'}
                        '6\.3\.\d+'  {$platform_version = '2012r2'}
                        '6\.2\.\d+'  {$platform_version = '2012'}
                        '6\.1\.\d+'  {$platform_version = '2008r2'}
                        '6\.0\.\d+'  {$platform_version = '2008'}
                      }
                      return $platform_version
                    }

                    function Get-PlatformArchitecture {
                      if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                        $architecture = 'x86_64'
                      } else {
                        $architecture = 'i386'
                      }
                      return $architecture
                    }

                    function New-Uri {
                      param ($baseuri, $newuri)

                      try {
                      new-object System.Uri $baseuri, $newuri
                      }
                      catch [System.Management.Automation.MethodInvocationException]{
                        Write-Error "$($_.exception.message)"
                        throw $_.exception
                      }
                    }

                    function Get-WebContent {
                      param ($uri, $filepath)
                      $proxy = New-Object -TypeName System.Net.WebProxy
                      $wc = new-object System.Net.WebClient
                      $proxy.Address = $env:http_proxy
                      $wc.Proxy = $proxy

                      try {
                        if ([string]::IsNullOrEmpty($filepath)) {
                          $wc.downloadstring($uri)
                        }
                        else {
                          $wc.downloadfile($uri, $filepath)
                        }
                      }
                      catch {
                        $exception = $_.Exception
                        Write-Host "There was an error: "
                        do {
                          Write-Host "`t$($exception.message)"
                          $exception = $exception.innerexception
                        } while ($exception)
                        throw "Failed to download from $uri."
                      }
                    }

                    function Test-ProjectPackage {
                      [cmdletbinding()]
                      param ($Path, $Algorithm = 'SHA256', $Hash)

                      if (-not (get-command get-filehash))   {
                        function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                        function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                        function Get-FileHash ($Path, $Algorithm) {
                          $Path = (resolve-path $path).providerpath
                          $hash = @{Algorithm = $Algorithm; Path = $Path}
                          use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                            use ($in = (gi $path).OpenRead()) {
                              $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                            }
                          }
                          new-object PSObject -Property $hash
                        }
                      }
                      Write-Verbose "Testing the $Algorithm hash for $path."
                      $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                      Write-Verbose "`tDesired Hash - '$hash'"
                      Write-Verbose "`tActual Hash  - '$ActualHash'"
                      $Valid = $ActualHash -eq $Hash
                      if (-not $Valid) {
                        Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                      }
                      return $Valid
                    }

                    function Get-ProjectMetadata {
                      <#
                        .SYNOPSIS
                        Get metadata for a Chef Software, Inc. project
                        .DESCRIPTION
                        Get metadata for project
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                        Gets the download url and SHA256 checksum for the latest stable release of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                        Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                      #>
                      [cmdletbinding()]
                      param (
                        # Base url to retrieve metadata from.
                        [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                        [string]
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Release channel to install from
                        $channel = 'unstable',
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      # PowerShell is only on Windows ATM
                      $platform = 'windows'
                      Write-Verbose "Platform: $platform"

                      $platform_version = Get-PlatformVersion
                      Write-Verbose "Platform Version: $platform_version"

                      if ($architecture -eq 'auto') {
                        $architecture = Get-PlatformArchitecture
                      }

                      Write-Verbose "Architecture: $architecture"
                      Write-Verbose "Project: $project"


                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                      $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                      $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                        foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                      Write-Verbose "Project details: "
                      foreach ($key in $package_metadata.keys) {
                        Write-Verbose "`t$key = $($package_metadata[$key])"
                      }
                      $package_metadata
                    }

                    function Install-Project {
                      <#
                        .SYNOPSIS
                        Install a Chef Software, Inc. product
                        .DESCRIPTION
                        Install a Chef Software, Inc. product
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                        Installs the latest stable version of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                        Installs the latest integration build of the Chef Development Kit
                      #>
                      [cmdletbinding(SupportsShouldProcess=$true)]
                      param (
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Release channel to install from
                        [validateset('current', 'stable', 'unstable')]
                        [string]
                        $channel = 'stable',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Full path for the downloaded installer.
                        [string]
                        $filename,
                        # Full path to the location to download the installer
                        [string]
                        $download_directory = $env:temp,
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                      if (-not [string]::IsNullOrEmpty($filename)) {
                        $download_directory = split-path $filename
                        $filename = split-path $filename -leaf
                        if ([string]::IsNullOrEmpty($download_directory)) {
                          $download_directory = $pwd
                        }
                      }
                      else {
                        $filename = ($package_metadata.url -split '/')[-1]
                      }
                      Write-Verbose "Download directory: $download_directory"
                      Write-Verbose "Filename: $filename"

                      if (-not (test-path $download_directory)) {
                        mkdir $download_directory
                      }
                      $download_directory = (resolve-path $download_directory).providerpath
                      $download_destination = join-path $download_directory $filename

                      if ((test-path $download_destination) -and
                        (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                        Write-Verbose "Found existing valid installer at $download_destination."
                      }
                      else {
                        if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                          Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                          Get-WebContent $package_metadata.url -filepath $download_destination
                        }
                      }

                      if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                        if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                          Write-Host "Installing $project from $download_destination"
                          $installingProject = $True
                          $installAttempts = 0
                          while ($installingProject) {
                            $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                            $p.WaitForExit()
                            if ($p.ExitCode -eq 1618) {
                              Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                              continue
                            } elseif ($p.ExitCode -ne 0) {
                              throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                            }
                            $installingProject = $False
                          }
                        }
                        else {
                          throw "Failed to validate the downloaded installer for $project."
                        }
                      }
                    }
                    set-alias install -value Install-Project
                    export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                    }

                    install -project chef -version 12.13.8+20160721014124 -channel unstable
                     with id: FA8ADA0B-D404-434E-B941-93E0ECA6FBD6
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output

                           ModuleType Version    Name                                ExportedCommands
                           ---------- -------    ----                                ----------------
                           Script     0.0        Omnitruck                           {Get-ProjectMetada...
                    D      [WinRM] Waiting for output...
                    D      Cleaning up local sandbox in /tmp/cheftest/fips-integration-windows-2012r2-sandbox-20160721-21168-orerim
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                    D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000004136358 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.2</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                    D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000004025838 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">2.0</Version></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version></LST></Obj></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">6.3.9600.17400</Version></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.2</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                    D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000003f348c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                    D      [WinRM] remote shell created with shell_id: A53C76D4-D8A8-4A0C-B255-C8C5EF54F5C9
                    D      [WinRM] Command created for Write-Host '[WinRM] Established
                    ' with id: 52DE39C0-4A63-46CB-A886-98F6A17567FB
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output
                           [WinRM] Established

                    D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.13.35:5985/wsman", :user=>"administrator", :password=>"A8=ria;bCb.", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"A8=ria;bCb.", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                    D      [WinRM] <{:endpoint=>"http://10.194.13.35:5985/wsman", :user=>"administrator", :password=>"A8=ria;bCb.", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"A8=ria;bCb.", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File)
                    D      [WinRM] Command created for New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File with id: A55131FA-2314-4B39-AC69-D47D3DB02CDB
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output


                               Directory: C:\chef\ohai\hints


                           Mode                LastWriteTime     Length Name
                           ----                -------------     ------ ----
                           -a---         7/21/2016   4:10 AM          0 ec2.json


                    D      ec2:create '10.194.13.35'
                           Finished creating <fips-unit-functional-windows-2012r2> (2m20.98s).
                    -----> Converging <fips-unit-functional-windows-2012r2>...
                           Preparing files for transfer
                    D      Creating local sandbox in /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160721-21168-etwy1n
                           Preparing dna.json
                    D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                           Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                           Removing non-cookbook files before transfer
                           Preparing validation.pem
                    D      Using a dummy validation.pem
                           Preparing client.rb
                    D      Creating client.rb from {:node_name=>"fips-unit-functional-windows-2012r2", :checksum_path=>"\#{ENV['TEMP']}\\kitchen\\checksums", :file_cache_path=>"\#{ENV['TEMP']}\\kitchen\\cache", :file_backup_path=>"\#{ENV['TEMP']}\\kitchen\\backup", :cookbook_path=>["\#{ENV['TEMP']}\\kitchen\\cookbooks", "\#{ENV['TEMP']}\\kitchen\\site-cookbooks"], :data_bag_path=>"\#{ENV['TEMP']}\\kitchen\\data_bags", :environment_path=>"\#{ENV['TEMP']}\\kitchen\\environments", :node_path=>"\#{ENV['TEMP']}\\kitchen\\nodes", :role_path=>"\#{ENV['TEMP']}\\kitchen\\roles", :client_path=>"\#{ENV['TEMP']}\\kitchen\\clients", :user_path=>"\#{ENV['TEMP']}\\kitchen\\users", :validation_key=>"\#{ENV['TEMP']}\\kitchen\\validation.pem", :client_key=>"\#{ENV['TEMP']}\\kitchen\\client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"\#{ENV['TEMP']}\\kitchen\\encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
                    D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.13.35:5985/wsman", :user=>"administrator", :password=>"A8=ria;bCb.", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"A8=ria;bCb.", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                    D      [WinRM] <{:endpoint=>"http://10.194.13.35:5985/wsman", :user=>"administrator", :password=>"A8=ria;bCb.", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"A8=ria;bCb.", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (new-module -name Omnitruck -scriptblock {
                    function Get-PlatformVersion {
                      switch -regex ((get-wmiobject win32_operatingsystem).version) {
                        '10\.0\.\d+' {$platform_version = '2012r2'}
                        '6\.3\.\d+'  {$platform_version = '2012r2'}
                        '6\.2\.\d+'  {$platform_version = '2012'}
                        '6\.1\.\d+'  {$platform_version = '2008r2'}
                        '6\.0\.\d+'  {$platform_version = '2008'}
                      }
                      return $platform_version
                    }

                    function Get-PlatformArchitecture {
                      if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                        $architecture = 'x86_64'
                      } else {
                        $architecture = 'i386'
                      }
                      return $architecture
                    }

                    function New-Uri {
                      param ($baseuri, $newuri)

                      try {
                      new-object System.Uri $baseuri, $newuri
                      }
                      catch [System.Management.Automation.MethodInvocationException]{
                        Write-Error "$($_.exception.message)"
                        throw $_.exception
                      }
                    }

                    function Get-WebContent {
                      param ($uri, $filepath)
                      $proxy = New-Object -TypeName System.Net.WebProxy
                      $wc = new-object System.Net.WebClient
                      $proxy.Address = $env:http_proxy
                      $wc.Proxy = $proxy

                      try {
                        if ([string]::IsNullOrEmpty($filepath)) {
                          $wc.downloadstring($uri)
                        }
                        else {
                          $wc.downloadfile($uri, $filepath)
                        }
                      }
                      catch {
                        $exception = $_.Exception
                        Write-Host "There was an error: "
                        do {
                          Write-Host "`t$($exception.message)"
                          $exception = $exception.innerexception
                        } while ($exception)
                        throw "Failed to download from $uri."
                      }
                    }

                    function Test-ProjectPackage {
                      [cmdletbinding()]
                      param ($Path, $Algorithm = 'SHA256', $Hash)

                      if (-not (get-command get-filehash))   {
                        function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                        function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                        function Get-FileHash ($Path, $Algorithm) {
                          $Path = (resolve-path $path).providerpath
                          $hash = @{Algorithm = $Algorithm; Path = $Path}
                          use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                            use ($in = (gi $path).OpenRead()) {
                              $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                            }
                          }
                          new-object PSObject -Property $hash
                        }
                      }
                      Write-Verbose "Testing the $Algorithm hash for $path."
                      $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                      Write-Verbose "`tDesired Hash - '$hash'"
                      Write-Verbose "`tActual Hash  - '$ActualHash'"
                      $Valid = $ActualHash -eq $Hash
                      if (-not $Valid) {
                        Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                      }
                      return $Valid
                    }

                    function Get-ProjectMetadata {
                      <#
                        .SYNOPSIS
                        Get metadata for a Chef Software, Inc. project
                        .DESCRIPTION
                        Get metadata for project
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                        Gets the download url and SHA256 checksum for the latest stable release of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                        Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                      #>
                      [cmdletbinding()]
                      param (
                        # Base url to retrieve metadata from.
                        [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                        [string]
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Release channel to install from
                        $channel = 'unstable',
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      # PowerShell is only on Windows ATM
                      $platform = 'windows'
                      Write-Verbose "Platform: $platform"

                      $platform_version = Get-PlatformVersion
                      Write-Verbose "Platform Version: $platform_version"

                      if ($architecture -eq 'auto') {
                        $architecture = Get-PlatformArchitecture
                      }

                      Write-Verbose "Architecture: $architecture"
                      Write-Verbose "Project: $project"


                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                      $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                      $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                        foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                      Write-Verbose "Project details: "
                      foreach ($key in $package_metadata.keys) {
                        Write-Verbose "`t$key = $($package_metadata[$key])"
                      }
                      $package_metadata
                    }

                    function Install-Project {
                      <#
                        .SYNOPSIS
                        Install a Chef Software, Inc. product
                        .DESCRIPTION
                        Install a Chef Software, Inc. product
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                        Installs the latest stable version of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                        Installs the latest integration build of the Chef Development Kit
                      #>
                      [cmdletbinding(SupportsShouldProcess=$true)]
                      param (
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Release channel to install from
                        [validateset('current', 'stable', 'unstable')]
                        [string]
                        $channel = 'stable',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Full path for the downloaded installer.
                        [string]
                        $filename,
                        # Full path to the location to download the installer
                        [string]
                        $download_directory = $env:temp,
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                      if (-not [string]::IsNullOrEmpty($filename)) {
                        $download_directory = split-path $filename
                        $filename = split-path $filename -leaf
                        if ([string]::IsNullOrEmpty($download_directory)) {
                          $download_directory = $pwd
                        }
                      }
                      else {
                        $filename = ($package_metadata.url -split '/')[-1]
                      }
                      Write-Verbose "Download directory: $download_directory"
                      Write-Verbose "Filename: $filename"

                      if (-not (test-path $download_directory)) {
                        mkdir $download_directory
                      }
                      $download_directory = (resolve-path $download_directory).providerpath
                      $download_destination = join-path $download_directory $filename

                      if ((test-path $download_destination) -and
                        (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                        Write-Verbose "Found existing valid installer at $download_destination."
                      }
                      else {
                        if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                          Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                          Get-WebContent $package_metadata.url -filepath $download_destination
                        }
                      }

                      if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                        if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                          Write-Host "Installing $project from $download_destination"
                          $installingProject = $True
                          $installAttempts = 0
                          while ($installingProject) {
                            $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                            $p.WaitForExit()
                            if ($p.ExitCode -eq 1618) {
                              Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                              continue
                            } elseif ($p.ExitCode -ne 0) {
                              throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                            }
                            $installingProject = $False
                          }
                        }
                        else {
                          throw "Failed to validate the downloaded installer for $project."
                        }
                      }
                    }
                    set-alias install -value Install-Project
                    export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                    }

                    install -project chef -version 12.13.8+20160721014124 -channel unstable
                    )
                    D      [WinRM] Command created for new-module -name Omnitruck -scriptblock {
                    function Get-PlatformVersion {
                      switch -regex ((get-wmiobject win32_operatingsystem).version) {
                        '10\.0\.\d+' {$platform_version = '2012r2'}
                        '6\.3\.\d+'  {$platform_version = '2012r2'}
                        '6\.2\.\d+'  {$platform_version = '2012'}
                        '6\.1\.\d+'  {$platform_version = '2008r2'}
                        '6\.0\.\d+'  {$platform_version = '2008'}
                      }
                      return $platform_version
                    }

                    function Get-PlatformArchitecture {
                      if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                        $architecture = 'x86_64'
                      } else {
                        $architecture = 'i386'
                      }
                      return $architecture
                    }

                    function New-Uri {
                      param ($baseuri, $newuri)

                      try {
                      new-object System.Uri $baseuri, $newuri
                      }
                      catch [System.Management.Automation.MethodInvocationException]{
                        Write-Error "$($_.exception.message)"
                        throw $_.exception
                      }
                    }

                    function Get-WebContent {
                      param ($uri, $filepath)
                      $proxy = New-Object -TypeName System.Net.WebProxy
                      $wc = new-object System.Net.WebClient
                      $proxy.Address = $env:http_proxy
                      $wc.Proxy = $proxy

                      try {
                        if ([string]::IsNullOrEmpty($filepath)) {
                          $wc.downloadstring($uri)
                        }
                        else {
                          $wc.downloadfile($uri, $filepath)
                        }
                      }
                      catch {
                        $exception = $_.Exception
                        Write-Host "There was an error: "
                        do {
                          Write-Host "`t$($exception.message)"
                          $exception = $exception.innerexception
                        } while ($exception)
                        throw "Failed to download from $uri."
                      }
                    }

                    function Test-ProjectPackage {
                      [cmdletbinding()]
                      param ($Path, $Algorithm = 'SHA256', $Hash)

                      if (-not (get-command get-filehash))   {
                        function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                        function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                        function Get-FileHash ($Path, $Algorithm) {
                          $Path = (resolve-path $path).providerpath
                          $hash = @{Algorithm = $Algorithm; Path = $Path}
                          use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                            use ($in = (gi $path).OpenRead()) {
                              $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                            }
                          }
                          new-object PSObject -Property $hash
                        }
                      }
                      Write-Verbose "Testing the $Algorithm hash for $path."
                      $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                      Write-Verbose "`tDesired Hash - '$hash'"
                      Write-Verbose "`tActual Hash  - '$ActualHash'"
                      $Valid = $ActualHash -eq $Hash
                      if (-not $Valid) {
                        Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                      }
                      return $Valid
                    }

                    function Get-ProjectMetadata {
                      <#
                        .SYNOPSIS
                        Get metadata for a Chef Software, Inc. project
                        .DESCRIPTION
                        Get metadata for project
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                        Gets the download url and SHA256 checksum for the latest stable release of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                        Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                      #>
                      [cmdletbinding()]
                      param (
                        # Base url to retrieve metadata from.
                        [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                        [string]
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Release channel to install from
                        $channel = 'unstable',
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      # PowerShell is only on Windows ATM
                      $platform = 'windows'
                      Write-Verbose "Platform: $platform"

                      $platform_version = Get-PlatformVersion
                      Write-Verbose "Platform Version: $platform_version"

                      if ($architecture -eq 'auto') {
                        $architecture = Get-PlatformArchitecture
                      }

                      Write-Verbose "Architecture: $architecture"
                      Write-Verbose "Project: $project"


                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                        $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                        New-Item -ItemType directory -Path $artifact_info_dir -force
                        New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                        "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                        "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                      $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                      $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                        foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                      Write-Verbose "Project details: "
                      foreach ($key in $package_metadata.keys) {
                        Write-Verbose "`t$key = $($package_metadata[$key])"
                      }
                      $package_metadata
                    }

                    function Install-Project {
                      <#
                        .SYNOPSIS
                        Install a Chef Software, Inc. product
                        .DESCRIPTION
                        Install a Chef Software, Inc. product
                        .EXAMPLE
                        iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                        Installs the latest stable version of Chef.
                        .EXAMPLE
                        iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                        Installs the latest integration build of the Chef Development Kit
                      #>
                      [cmdletbinding(SupportsShouldProcess=$true)]
                      param (
                        # Project to install
                        [string]
                        $project = 'chef',
                        # Release channel to install from
                        [validateset('current', 'stable', 'unstable')]
                        [string]
                        $channel = 'stable',
                        # Version of the application to install
                        # This parameter is optional, if not supplied it will provide the latest version,
                        # and if an iteration number is not specified, it will grab the latest available iteration.
                        # Partial version numbers are also acceptable (using v=11
                        # will grab the latest 11.x client which matches the other flags).
                        [string]
                        $version,
                        # Full path for the downloaded installer.
                        [string]
                        $filename,
                        # Full path to the location to download the installer
                        [string]
                        $download_directory = $env:temp,
                        # The following legacy switches are just aliases for the current channel
                        [switch]
                        $prerelease,
                        [switch]
                        $nightlies,
                        [validateset('auto', 'i386', 'x86_64')]
                        [string]
                        $architecture = 'auto'
                      )

                      $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                      if (-not [string]::IsNullOrEmpty($filename)) {
                        $download_directory = split-path $filename
                        $filename = split-path $filename -leaf
                        if ([string]::IsNullOrEmpty($download_directory)) {
                          $download_directory = $pwd
                        }
                      }
                      else {
                        $filename = ($package_metadata.url -split '/')[-1]
                      }
                      Write-Verbose "Download directory: $download_directory"
                      Write-Verbose "Filename: $filename"

                      if (-not (test-path $download_directory)) {
                        mkdir $download_directory
                      }
                      $download_directory = (resolve-path $download_directory).providerpath
                      $download_destination = join-path $download_directory $filename

                      if ((test-path $download_destination) -and
                        (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                        Write-Verbose "Found existing valid installer at $download_destination."
                      }
                      else {
                        if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                          Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                          Get-WebContent $package_metadata.url -filepath $download_destination
                        }
                      }

                      if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                        if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                          Write-Host "Installing $project from $download_destination"
                          $installingProject = $True
                          $installAttempts = 0
                          while ($installingProject) {
                            $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                            $p.WaitForExit()
                            if ($p.ExitCode -eq 1618) {
                              Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                              continue
                            } elseif ($p.ExitCode -ne 0) {
                              throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                            }
                            $installingProject = $False
                          }
                        }
                        else {
                          throw "Failed to validate the downloaded installer for $project."
                        }
                      }
                    }
                    set-alias install -value Install-Project
                    export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                    }

                    install -project chef -version 12.13.8+20160721014124 -channel unstable
                     with id: D26CAAA3-B143-4C43-A7E7-55C89F397410
                    D      [WinRM] Waiting for output...
                    D      [WinRM] Processing output

                           ModuleType Version    Name                                ExportedCommands
                           ---------- -------    ----                                ----------------
                           Script     0.0        Omnitruck                           {Get-ProjectMetada...
                    D      [WinRM] Waiting for output...
                    D      Cleaning up local sandbox in /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160721-21168-etwy1n
                    D      ------Exception-------
                    D      Class: Kitchen::ActionFailed
                    D      Message: 2 actions failed.
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                    D      ----------------------
                    D      ------Backtrace-------
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:187:in `report_errors'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:178:in `run_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:39:in `block in call'
                    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:37:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:56:in `perform'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:184:in `block (2 levels) in <class:CLI>'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/command.rb:27:in `run'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/invocation.rb:126:in `invoke_command'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:325:in `invoke_task'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor.rb:359:in `dispatch'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/base.rb:440:in `start'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `block in <top (required)>'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/errors.rb:174:in `with_friendly_errors'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `<top (required)>'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `load'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `<top (required)>'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `load'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `kernel_load'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:24:in `run'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:304:in `exec'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor.rb:359:in `dispatch'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/base.rb:440:in `start'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:11:in `start'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:27:in `block in <top (required)>'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/friendly_errors.rb:98:in `with_friendly_errors'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:19:in `<top (required)>'
                    D      /opt/chefdk/embedded/bin/bundle:22:in `load'
                    D      /opt/chefdk/embedded/bin/bundle:22:in `<main>'
                    D      ----End Backtrace-----
                    D      -Composite Exception--
                    D      Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                    D      ----------------------
                    D      ------Backtrace-------
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:138:in `converge'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                    D      ----End Backtrace-----
                    D      ---Nested Exception---
                    D      Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                    D      ----------------------
                    D      ------Backtrace-------
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:138:in `converge'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                    D      ----End Backtrace-----
                    D      -Composite Exception--
                    D      Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                    D      ----------------------
                    D      ------Backtrace-------
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:138:in `converge'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                    D      ----End Backtrace-----
                    D      ---Nested Exception---
                    D      Class: Kitchen::ActionFailed
                    D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                    D      ----------------------
                    D      ------Backtrace-------
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:138:in `converge'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                    D      ----End Backtrace-----
                    STDERR: >>>>>> ------Exception-------
                    >>>>>> Class: Kitchen::ActionFailed
                    >>>>>> Message: 2 actions failed.
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                    >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                    >>>>>> ----------------------
                    >>>>>> Please see .kitchen/logs/kitchen.log for more details
                    >>>>>> Also try running `kitchen diagnose --all` for configuration
                    ---- End output of bundle exec kitchen converge  -c -l debug ----
                    Ran bundle exec kitchen converge  -c -l debug returned 20

                    Cookbook Trace:
                    ---------------
                    /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                    Resource Declaration:
                    ---------------------
                    # In /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb

                     39:       ruby_block "copy_kitchen_logs_to_data_path" do
                     40:         block do
                     41:           cmd_env = {
                     42:             "KITCHEN_DRIVER" => driver,
                     43:             "KITCHEN_INSTANCES" => instances,
                     44:             "KITCHEN_LOCAL_YAML" => ::File.expand_path("../../.kitchen.#{driver}.yml", __FILE__),
                     45:             "KITCHEN_CHEF_PRODUCT" => chef_product,
                     46:             "KITCHEN_CHEF_CHANNEL" => chef_channel,
                     47:             "KITCHEN_CHEF_VERSION" => chef_version,
                     48:             "ARTIFACTORY_USERNAME" => artifactory_username,
                     49:             "ARTIFACTORY_PASSWORD" => artifactory_password
                     50:           }.merge(new_resource.env)
                     51:           suite = kitchen_dir.split("/").last
                     52:           kitchen_log_path = ENV["WORKSPACE"] ? "#{ENV["WORKSPACE"]}/chef-acceptance-data/logs" : "#{kitchen_dir}/../.acceptance_data/logs/"
                     53:
                     54:           begin
                     55:             shell_out!("bundle exec kitchen #{command}#{instances ? " #{instances}" : ""}#{kitchen_options ? " #{kitchen_options}" : ""}",
                     56:                        env: cmd_env,
                     57:                        cwd: kitchen_dir)
                     58:           ensure
                     59:             FileUtils.mkdir_p("#{kitchen_log_path}/#{suite}/#{command}")
                     60:             FileUtils.cp_r("#{kitchen_dir}/.kitchen/logs/.", "#{kitchen_log_path}/#{suite}/#{command}")
                     61:           end
                     62:         end
                     63:       end

                    Compiled Resource:
                    ------------------
                    # Declared in /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:39:in `block in <class:Kitchen>'

                    ruby_block("copy_kitchen_logs_to_data_path") do
                      action [:run]
                      retries 0
                      retry_delay 2
                      default_guard_interpreter :default
                      block_name "copy_kitchen_logs_to_data_path"
                      declared_type :ruby_block
                      cookbook_name "acceptance-cookbook"
                      block #<Proc:0x000000041e1e38@/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:40>
                    end

                    Platform:
                    ---------
                    x86_64-linux


                  ================================================================================
                  Error executing action `run` on resource 'kitchen[converge]'
                  ================================================================================

                  Mixlib::ShellOut::ShellCommandFailed
                  ------------------------------------
                  ruby_block[copy_kitchen_logs_to_data_path] (/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb line 39) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '20'
                  ---- Begin output of bundle exec kitchen converge  -c -l debug ----
                  STDOUT: -----> Starting Kitchen (v1.10.2)
                  D      winrm requested, loading winrm gem (["~> 2.0"])
                  D      winrm is loaded.
                  D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                  D      winrm-fs is loaded.
                  D      winrm requested, loading winrm gem (["~> 2.0"])
                  D      winrm was already loaded.
                  D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                  D      winrm-fs was already loaded.
                  -----> Creating <fips-unit-functional-windows-2012r2>...
                  D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
                  -----> Creating <fips-unit-functional-centos-6>...
                  D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
                  D      platform name centos-6 appears to be a standard platform. Searching for centos 6 ...
                  D      Searching for images matching {:name=>"CentOS-6.5-GA-*", :"owner-alias"=>"aws-marketplace", :architecture=>"x86_64", :"virtualization-type"=>"paravirtual", :"block-device-mapping.volume-type"=>"standard", :"image-type"=>"machine"} ...
                  -----> Creating <fips-integration-windows-2012r2>...
                  D      platform name windows-2012r2 appears to be a standard platform. Searching for windows 2012r2 ...
                  D      Searching for images matching {:name=>"Windows_Server-2012-R2*-English-*-Base-*", :"owner-alias"=>"amazon", :architecture=>"x86_64", :"virtualization-type"=>"hvm", :"block-device-mapping.volume-type"=>"gp2", :"image-type"=>"machine"} ...
                  -----> Creating <fips-integration-centos-6>...
                  D      platform name centos-6 appears to be a standard platform. Searching for centos 6 ...
                  D      Searching for images matching {:name=>"CentOS-6.5-GA-*", :"owner-alias"=>"aws-marketplace", :architecture=>"x86_64", :"virtualization-type"=>"paravirtual", :"block-device-mapping.volume-type"=>"standard", :"image-type"=>"machine"} ...
                  D      Search returned 1 images:
                  D      - CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2: Detected centos 6.5 x86_64.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
                  D      Search returned 1 images:
                  D      - CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2: Detected centos 6.5 x86_64.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
                  D      Image for fips-integration-centos-6: CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
                         Detected platform: centos version 6.5 on x86_64. Instance Type: m3.large. Default username: root (default).
                  D      No SSH username specified: using default username root  for image ami-b6bdde86, which we detected as centos 6.5 x86_64.
                         If you are not using an account that qualifies under the AWS
                  free-tier, you may be charged to run these suites. The charge
                  should be minimal, but neither Test Kitchen nor its maintainers
                  are responsible for your incurred costs.

                  D      Creating EC2 instance in region us-west-2 with properties:
                  D      - instance_type = "m3.large"
                  D      - ebs_optimized = false
                  D      - image_id = "ami-b6bdde86"
                  D      - key_name = "jenkins"
                  D      - subnet_id = "subnet-19ac017c"
                  D      - private_ip_address = nil
                  D      - placement = {:availability_zone=>"us-west-2a"}
                  D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                  D      Image for fips-unit-functional-centos-6: CentOS-6.5-GA-03.3-f4325b48-37b0-405a-9847-236c64622e3e-ami-6be4dc02.2.  Architecture: x86_64, Virtualization: paravirtual, Storage: ebs, Created: 2014-02-05T16:52:47.000Z
                         Detected platform: centos version 6.5 on x86_64. Instance Type: m3.large. Default username: root (default).
                  D      No SSH username specified: using default username root  for image ami-b6bdde86, which we detected as centos 6.5 x86_64.
                         If you are not using an account that qualifies under the AWS
                  free-tier, you may be charged to run these suites. The charge
                  should be minimal, but neither Test Kitchen nor its maintainers
                  are responsible for your incurred costs.

                  D      Creating EC2 instance in region us-west-2 with properties:
                  D      - instance_type = "m3.large"
                  D      - ebs_optimized = false
                  D      - image_id = "ami-b6bdde86"
                  D      - key_name = "jenkins"
                  D      - subnet_id = "subnet-19ac017c"
                  D      - private_ip_address = nil
                  D      - placement = {:availability_zone=>"us-west-2a"}
                  D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                  D      Search returned 3 images:
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
                  D      Image for fips-unit-functional-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                         Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
                  D      No SSH username specified: using default username administrator  for image ami-26e72546, which we detected as windows 2012r2rtm x86_64.
                         If you are not using an account that qualifies under the AWS
                  free-tier, you may be charged to run these suites. The charge
                  should be minimal, but neither Test Kitchen nor its maintainers
                  are responsible for your incurred costs.

                  D      Creating EC2 instance in region us-west-2 with properties:
                  D      - instance_type = "m3.large"
                  D      - ebs_optimized = false
                  D      - image_id = "ami-26e72546"
                  D      - key_name = "jenkins"
                  D      - subnet_id = "subnet-19ac017c"
                  D      - private_ip_address = nil
                  D      - placement = {:availability_zone=>"us-west-2a"}
                  D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                  D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                  D      Search returned 3 images:
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.06.15: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-06-16T16:58:39.000Z
                  D      - Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.05.11: Detected windows 2012r2rtm x86_64.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-05-12T20:22:38.000Z
                  D      Image for fips-integration-windows-2012r2: Windows_Server-2012-R2_RTM-English-64Bit-Base-2016.07.13.  Architecture: x86_64, Virtualization: hvm, Storage: ebs gp2, Created: 2016-07-14T09:59:33.000Z
                         Detected platform: windows version 2012r2rtm on x86_64. Instance Type: m3.large. Default username: administrator (default).
                  D      No SSH username specified: using default username administrator  for image ami-26e72546, which we detected as windows 2012r2rtm x86_64.
                         If you are not using an account that qualifies under the AWS
                  free-tier, you may be charged to run these suites. The charge
                  should be minimal, but neither Test Kitchen nor its maintainers
                  are responsible for your incurred costs.

                  D      Creating EC2 instance in region us-west-2 with properties:
                  D      - instance_type = "m3.large"
                  D      - ebs_optimized = false
                  D      - image_id = "ami-26e72546"
                  D      - key_name = "jenkins"
                  D      - subnet_id = "subnet-19ac017c"
                  D      - private_ip_address = nil
                  D      - placement = {:availability_zone=>"us-west-2a"}
                  D      - security_group_ids = ["sg-e401eb83", "sg-96274af3"]
                  D      - user_data = "PHBvd2Vyc2hlbGw+CiRsb2dmaWxlPSJDOlxcUHJvZ3JhbSBGaWxlc1xcQW1h\nem9uXFxFYzJDb25maWdTZXJ2aWNlXFxMb2dzXFxraXRjaGVuLWVjMi5sb2ci\nCiNQUyBSZW1vdGluZyBhbmQgJiB3aW5ybS5jbWQgYmFzaWMgY29uZmlnCkVu\nYWJsZS1QU1JlbW90aW5nIC1Gb3JjZSAtU2tpcE5ldHdvcmtQcm9maWxlQ2hl\nY2sKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZyAnQHtNYXhUaW1lb3V0\nbXM9IjE4MDAwMDAifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdp\nbnJtL2NvbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0\nIn0nID4+ICRsb2dmaWxlCiYgd2lucm0uY21kIHNldCB3aW5ybS9jb25maWcv\nd2lucnMgJ0B7TWF4U2hlbGxzUGVyVXNlcj0iNTAifScgPj4gJGxvZ2ZpbGUK\nI1NlcnZlciBzZXR0aW5ncyAtIHN1cHBvcnQgdXNlcm5hbWUvcGFzc3dvcmQg\nbG9naW4KJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlL2F1\ndGggJ0B7QmFzaWM9InRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQg\nc2V0IHdpbnJtL2NvbmZpZy9zZXJ2aWNlICdAe0FsbG93VW5lbmNyeXB0ZWQ9\nInRydWUifScgPj4gJGxvZ2ZpbGUKJiB3aW5ybS5jbWQgc2V0IHdpbnJtL2Nv\nbmZpZy93aW5ycyAnQHtNYXhNZW1vcnlQZXJTaGVsbE1CPSIxMDI0In0nID4+\nICRsb2dmaWxlCiNGaXJld2FsbCBDb25maWcKJiBuZXRzaCBhZHZmaXJld2Fs\nbCBmaXJld2FsbCBzZXQgcnVsZSBuYW1lPSJXaW5kb3dzIFJlbW90ZSBNYW5h\nZ2VtZW50IChIVFRQLUluKSIgcHJvZmlsZT1wdWJsaWMgcHJvdG9jb2w9dGNw\nIGxvY2FscG9ydD01OTg1IHJlbW90ZWlwPWxvY2Fsc3VibmV0IG5ldyByZW1v\ndGVpcD1hbnkgID4+ICRsb2dmaWxlCiNTZXQgc2NyaXB0IGV4ZWN1dGlvbiB0\nbyB1bnJlc3RyaWN0ZWQKJiBTZXQtRXhlY3V0aW9uUG9saWN5IFVucmVzdHJp\nY3RlZCAtRm9yY2UKPC9wb3dlcnNoZWxsPgo=\n"
                         Instance <i-a68c0b09> requested.
                         Polling AWS for existence, attempt 0...
                         Instance <i-9e8d0a31> requested.
                         Polling AWS for existence, attempt 0...
                         Instance <i-998d0a36> requested.
                         Polling AWS for existence, attempt 0...
                         Attempting to tag the instance, 0 retries
                         Attempting to tag the instance, 0 retries
                         Attempting to tag the instance, 0 retries
                         EC2 instance <i-9e8d0a31> created.
                         Waited 0/300s for instance <i-9e8d0a31> to become ready.
                         EC2 instance <i-998d0a36> created.
                         Waited 0/300s for instance <i-998d0a36> to become ready.
                         EC2 instance <i-a68c0b09> created.
                         Waited 0/300s for instance <i-a68c0b09> to become ready.
                         Instance <i-a38c0b0c> requested.
                         Polling AWS for existence, attempt 0...
                         Attempting to tag the instance, 0 retries
                         EC2 instance <i-a38c0b0c> created.
                         Waited 0/300s for instance <i-a38c0b0c> to become ready.
                         Waited 5/300s for instance <i-998d0a36> to become ready.
                         Waited 5/300s for instance <i-9e8d0a31> to become ready.
                         Waited 5/300s for instance <i-a68c0b09> to become ready.
                         Waited 5/300s for instance <i-a38c0b0c> to become ready.
                         Waited 10/300s for instance <i-9e8d0a31> to become ready.
                         Waited 10/300s for instance <i-998d0a36> to become ready.
                         Waited 10/300s for instance <i-a68c0b09> to become ready.
                         Waited 10/300s for instance <i-a38c0b0c> to become ready.
                         Waited 15/300s for instance <i-9e8d0a31> to become ready.
                         Waited 15/300s for instance <i-998d0a36> to become ready.
                         Waited 15/300s for instance <i-a68c0b09> to become ready.
                         Waited 15/300s for instance <i-a38c0b0c> to become ready.
                         Waited 20/300s for instance <i-998d0a36> to become ready.
                         Waited 20/300s for instance <i-9e8d0a31> to become ready.
                         Waited 20/300s for instance <i-a68c0b09> to become ready.
                         Waited 20/300s for instance <i-a38c0b0c> to become ready.
                         Waited 25/300s for instance <i-998d0a36> to become ready.
                         Waited 25/300s for instance <i-9e8d0a31> to become ready.
                         Waited 25/300s for instance <i-a68c0b09> to become ready.
                         EC2 instance <i-9e8d0a31> ready.
                  D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"]}>
                         EC2 instance <i-a68c0b09> ready.
                  D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"]}>
                         Waited 25/300s for instance <i-a38c0b0c> to become ready.
                         Waited 30/300s for instance <i-998d0a36> to become ready.
                         Waited 30/300s for instance <i-a38c0b0c> to become ready.
                         Waited 35/300s for instance <i-998d0a36> to become ready.
                         Waited 35/300s for instance <i-a38c0b0c> to become ready.
                  D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                         Waiting for SSH service on 10.194.9.186:22, retrying in 3 seconds
                  D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                         Waiting for SSH service on 10.194.8.37:22, retrying in 3 seconds
                         Waited 40/300s for instance <i-998d0a36> to become ready.
                         Waited 40/300s for instance <i-a38c0b0c> to become ready.
                  D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                         Waited 45/300s for instance <i-998d0a36> to become ready.
                         Waited 45/300s for instance <i-a38c0b0c> to become ready.
                         Waited 50/300s for instance <i-998d0a36> to become ready.
                         Waited 50/300s for instance <i-a38c0b0c> to become ready.
                         Waited 55/300s for instance <i-998d0a36> to become ready.
                         Waited 55/300s for instance <i-a38c0b0c> to become ready.
                  D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                         Waiting for SSH service on 10.194.9.186:22, retrying in 3 seconds
                  D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                         Waiting for SSH service on 10.194.8.37:22, retrying in 3 seconds
                  D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                         Waited 60/300s for instance <i-998d0a36> to become ready.
                         Waited 60/300s for instance <i-a38c0b0c> to become ready.
                         Waited 65/300s for instance <i-998d0a36> to become ready.
                         Waited 65/300s for instance <i-a38c0b0c> to become ready.
                         Waited 70/300s for instance <i-998d0a36> to become ready.
                         Waited 70/300s for instance <i-a38c0b0c> to become ready.
                  D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                         Waiting for SSH service on 10.194.9.186:22, retrying in 3 seconds
                  D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                         Waiting for SSH service on 10.194.8.37:22, retrying in 3 seconds
                         Waited 75/300s for instance <i-998d0a36> to become ready.
                         Waited 75/300s for instance <i-a38c0b0c> to become ready.
                  D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                         Waited 80/300s for instance <i-998d0a36> to become ready.
                         Waited 80/300s for instance <i-a38c0b0c> to become ready.
                  D      [SSH] connection failed (#<Errno::ECONNREFUSED: Connection refused - connect(2) for 10.194.8.37:22>)
                         Waiting for SSH service on 10.194.8.37:22, retrying in 3 seconds
                         Waited 85/300s for instance <i-998d0a36> to become ready.
                         Waited 85/300s for instance <i-a38c0b0c> to become ready.
                  D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] connection failed (#<Net::SSH::AuthenticationFailed: Authentication failed for user root@10.194.8.37>)
                         Waiting for SSH service on 10.194.8.37:22, retrying in 3 seconds
                  D      [SSH] opening connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (echo '[SSH] Established')
                         bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         [SSH] Established
                  D      Using sudo_command='sudo -E' for ohai hints
                  D      [SSH] reusing existing connection root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E mkdir -p /etc/chef/ohai/hints; sudo -E touch /etc/chef/ohai/hints/ec2.json)
                         bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         Waited 90/300s for instance <i-998d0a36> to become ready.
                  D      ec2:create '10.194.8.37'
                         Finished creating <fips-unit-functional-centos-6> (1m37.17s).
                  -----> Converging <fips-unit-functional-centos-6>...
                         Preparing files for transfer
                  D      Creating local sandbox in /tmp/cheftest/fips-unit-functional-centos-6-sandbox-20160721-21168-kwydkn
                         Preparing dna.json
                  D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                         Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                         Removing non-cookbook files before transfer
                         Preparing validation.pem
                  D      Using a dummy validation.pem
                         Preparing client.rb
                  D      Creating client.rb from {:node_name=>"fips-unit-functional-centos-6", :checksum_path=>"/tmp/kitchen/checksums", :file_cache_path=>"/tmp/kitchen/cache", :file_backup_path=>"/tmp/kitchen/backup", :cookbook_path=>["/tmp/kitchen/cookbooks", "/tmp/kitchen/site-cookbooks"], :data_bag_path=>"/tmp/kitchen/data_bags", :environment_path=>"/tmp/kitchen/environments", :node_path=>"/tmp/kitchen/nodes", :role_path=>"/tmp/kitchen/roles", :client_path=>"/tmp/kitchen/clients", :user_path=>"/tmp/kitchen/users", :validation_key=>"/tmp/kitchen/validation.pem", :client_key=>"/tmp/kitchen/client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"/tmp/kitchen/encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
                  D      [SSH] reusing existing connection root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E cat > /tmp/chef-installer.sh <<"EOL"
                  #!/bin/bash
                  #!/bin/sh
                  # WARNING: REQUIRES /bin/sh
                  #
                  # - must run on /bin/sh on solaris 9
                  # - must run on /bin/sh on AIX 6.x
                  #
                  # Copyright:: Copyright (c) 2010-2015 Chef Software, Inc.
                  # License:: Apache License, Version 2.0
                  #
                  # Licensed under the Apache License, Version 2.0 (the "License");
                  # you may not use this file except in compliance with the License.
                  # You may obtain a copy of the License at
                  #
                  #     http://www.apache.org/licenses/LICENSE-2.0
                  #
                  # Unless required by applicable law or agreed to in writing, software
                  # distributed under the License is distributed on an "AS IS" BASIS,
                  # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                  # See the License for the specific language governing permissions and
                  # limitations under the License.
                  #

                  # helpers.sh
                  ############
                  # This section has some helper functions to make life easier.
                  #
                  # Outputs:
                  # $tmp_dir: secure-ish temp directory that can be used during installation.
                  ############

                  # Check whether a command exists - returns 0 if it does, 1 if it does not
                  exists() {
                    if command -v $1 >/dev/null 2>&1
                    then
                      return 0
                    else
                      return 1
                    fi
                  }

                  # Output the instructions to report bug about this script
                  report_bug() {
                    echo "Version: $version"
                    echo ""
                    echo "Please file a Bug Report at https://github.com/chef/omnitruck/issues/new"
                    echo "Alternatively, feel free to open a Support Ticket at https://www.chef.io/support/tickets"
                    echo "More Chef support resources can be found at https://www.chef.io/support"
                    echo ""
                    echo "Please include as many details about the problem as possible i.e., how to reproduce"
                    echo "the problem (if possible), type of the Operating System and its version, etc.,"
                    echo "and any other relevant details that might help us with troubleshooting."
                    echo ""
                  }

                  checksum_mismatch() {
                    echo "Package checksum mismatch!"
                    report_bug
                    exit 1
                  }

                  unable_to_retrieve_package() {
                    echo "Unable to retrieve a valid package!"
                    report_bug
                    echo "Metadata URL: $metadata_url"
                    if test "x$download_url" != "x"; then
                      echo "Download URL: $download_url"
                    fi
                    if test "x$stderr_results" != "x"; then
                      echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
                    fi
                    exit 1
                  }

                  http_404_error() {
                    echo "Omnitruck artifact does not exist for version $version on platform $platform"
                    echo ""
                    echo "Either this means:"
                    echo "   - We do not support $platform"
                    echo "   - We do not have an artifact for $version"
                    echo ""
                    echo "This is often the latter case due to running a prerelease or RC version of chef"
                    echo "or a gem version which was only pushed to rubygems and not omnitruck."
                    echo ""
                    echo "You may be able to set your knife[:bootstrap_version] to the most recent stable"
                    echo "release of Chef to fix this problem (or the most recent stable major version number)."
                    echo ""
                    echo "In order to test the version parameter, adventurous users may take the Metadata URL"
                    echo "below and modify the '&v=<number>' parameter until you successfully get a URL that"
                    echo "does not 404 (e.g. via curl or wget).  You should be able to use '&v=11' or '&v=12'"
                    echo "succesfully."
                    echo ""
                    echo "If you cannot fix this problem by setting the bootstrap_version, it probably means"
                    echo "that $platform is not supported."
                    echo ""
                    # deliberately do not call report_bug to suppress bug report noise.
                    echo "Metadata URL: $metadata_url"
                    if test "x$download_url" != "x"; then
                      echo "Download URL: $download_url"
                    fi
                    if test "x$stderr_results" != "x"; then
                      echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
                    fi
                    exit 1
                  }

                  capture_tmp_stderr() {
                    # spool up /tmp/stderr from all the commands we called
                    if test -f "$tmp_dir/stderr"; then
                      output=`cat $tmp_dir/stderr`
                      stderr_results="${stderr_results}\nSTDERR from $1:\n\n$output\n"
                      rm $tmp_dir/stderr
                    fi
                  }

                  # do_wget URL FILENAME
                  do_wget() {
                    echo "trying wget..."
                    wget -O "$2" "$1" 2>$tmp_dir/stderr
                    rc=$?
                    # check for 404
                    grep "ERROR 404" $tmp_dir/stderr 2>&1 >/dev/null
                    if test $? -eq 0; then
                      echo "ERROR 404"
                      http_404_error
                    fi

                    # check for bad return status or empty output
                    if test $rc -ne 0 || test ! -s "$2"; then
                      capture_tmp_stderr "wget"
                      return 1
                    fi

                    return 0
                  }

                  # do_curl URL FILENAME
                  do_curl() {
                    echo "trying curl..."
                    curl --retry 5 -sL -D $tmp_dir/stderr "$1" > "$2"
                    rc=$?
                    # check for 404
                    grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
                    if test $? -eq 0; then
                      echo "ERROR 404"
                      http_404_error
                    fi

                    # check for bad return status or empty output
                    if test $rc -ne 0 || test ! -s "$2"; then
                      capture_tmp_stderr "curl"
                      return 1
                    fi

                    return 0
                  }

                  # do_fetch URL FILENAME
                  do_fetch() {
                    echo "trying fetch..."
                    fetch -o "$2" "$1" 2>$tmp_dir/stderr
                    # check for bad return status
                    test $? -ne 0 && return 1
                    return 0
                  }

                  # do_perl URL FILENAME
                  do_perl() {
                    echo "trying perl..."
                    perl -e 'use LWP::Simple; getprint($ARGV[0]);' "$1" > "$2" 2>$tmp_dir/stderr
                    rc=$?
                    # check for 404
                    grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
                    if test $? -eq 0; then
                      echo "ERROR 404"
                      http_404_error
                    fi

                    # check for bad return status or empty output
                    if test $rc -ne 0 || test ! -s "$2"; then
                      capture_tmp_stderr "perl"
                      return 1
                    fi

                    return 0
                  }

                  # do_python URL FILENAME
                  do_python() {
                    echo "trying python..."
                    python -c "import sys,urllib2 ; sys.stdout.write(urllib2.urlopen(sys.argv[1]).read())" "$1" > "$2" 2>$tmp_dir/stderr
                    rc=$?
                    # check for 404
                    grep "HTTP Error 404" $tmp_dir/stderr 2>&1 >/dev/null
                    if test $? -eq 0; then
                      echo "ERROR 404"
                      http_404_error
                    fi

                    # check for bad return status or empty output
                    if test $rc -ne 0 || test ! -s "$2"; then
                      capture_tmp_stderr "python"
                      return 1
                    fi
                    return 0
                  }

                  # returns 0 if checksums match
                  do_checksum() {
                    if exists sha256sum; then
                      echo "Comparing checksum with sha256sum..."
                      checksum=`sha256sum $1 | awk '{ print $1 }'`
                      return `test "x$checksum" = "x$2"`
                    elif exists shasum; then
                      echo "Comparing checksum with shasum..."
                      checksum=`shasum -a 256 $1 | awk '{ print $1 }'`
                      return `test "x$checksum" = "x$2"`
                    else
                      echo "WARNING: could not find a valid checksum program, pre-install shasum or sha256sum in your O/S image to get valdation..."
                      return 0
                    fi
                  }

                  # do_download URL FILENAME
                  do_download() {
                    echo "downloading $1"
                    echo "  to file $2"

                    url=`echo $1`
                    if test "x$platform" = "xsolaris2"; then
                      if test "x$platform_version" = "x5.9" -o "x$platform_version" = "x5.10"; then
                        # solaris 9 lacks openssl, solaris 10 lacks recent enough credentials - your base O/S is completely insecure, please upgrade
                        url=`echo $url | sed -e 's/https/http/'`
                      fi
                    fi

                    # we try all of these until we get success.
                    # perl, in particular may be present but LWP::Simple may not be installed

                    if exists wget; then
                      do_wget $url $2 && return 0
                    fi

                    if exists curl; then
                      do_curl $url $2 && return 0
                    fi

                    if exists fetch; then
                      do_fetch $url $2 && return 0
                    fi

                    if exists perl; then
                      do_perl $url $2 && return 0
                    fi

                    if exists python; then
                      do_python $url $2 && return 0
                    fi

                    unable_to_retrieve_package
                  }

                  # install_file TYPE FILENAME
                  # TYPE is "rpm", "deb", "solaris", "sh", etc.
                  install_file() {
                    echo "Installing $project $version"
                    case "$1" in
                      "rpm")
                        if test "x$platform" = "xnexus" || test "x$platform" = "xios_xr"; then
                          echo "installing with yum..."
                          yum install -yv "$2"
                        else
                          echo "installing with rpm..."
                          rpm -Uvh --oldpackage --replacepkgs "$2"
                        fi
                        ;;
                      "deb")
                        echo "installing with dpkg..."
                        dpkg -i "$2"
                        ;;
                      "bff")
                        echo "installing with installp..."
                        installp -aXYgd "$2" all
                        ;;
                      "solaris")
                        echo "installing with pkgadd..."
                        echo "conflict=nocheck" > $tmp_dir/nocheck
                        echo "action=nocheck" >> $tmp_dir/nocheck
                        echo "mail=" >> $tmp_dir/nocheck
                        pkgrm -a $tmp_dir/nocheck -n $project >/dev/null 2>&1 || true
                        pkgadd -G -n -d "$2" -a $tmp_dir/nocheck $project
                        ;;
                      "pkg")
                        echo "installing with installer..."
                        cd / && /usr/sbin/installer -pkg "$2" -target /
                        ;;
                      "dmg")
                        echo "installing dmg file..."
                        hdiutil detach "/Volumes/chef_software" >/dev/null 2>&1 || true
                        hdiutil attach "$2" -mountpoint "/Volumes/chef_software"
                        cd / && /usr/sbin/installer -pkg `find "/Volumes/chef_software" -name \*.pkg` -target /
                        hdiutil detach "/Volumes/chef_software"
                        ;;
                      "sh" )
                        echo "installing with sh..."
                        sh "$2"
                        ;;
                      *)
                        echo "Unknown filetype: $1"
                        report_bug
                        exit 1
                        ;;
                    esac
                    if test $? -ne 0; then
                      echo "Installation failed"
                      report_bug
                      exit 1
                    fi
                  }

                  if test "x$TMPDIR" = "x"; then
                    tmp="/tmp"
                  else
                    tmp=$TMPDIR
                  fi
                  # secure-ish temp dir creation without having mktemp available (DDoS-able but not expliotable)
                  tmp_dir="$tmp/install.sh.$$"
                  (umask 077 && mkdir $tmp_dir) || exit 1

                  ############
                  # end of helpers.sh
                  ############


                  project=chef
                  version=12.13.8+20160721014124
                  channel=unstable


                  # platform_detection.sh
                  ############
                  # This section makes platform detection compatible with omnitruck on the system
                  #   it runs.
                  #
                  # Outputs:
                  # $platform: Name of the platform.
                  # $platform_version: Version of the platform.
                  # $machine: System's architecture.
                  ############

                  #
                  # Platform and Platform Version detection
                  #
                  # NOTE: This should now match ohai platform and platform_version matching.
                  # do not invented new platform and platform_version schemas, just make this behave
                  # like what ohai returns as platform and platform_version for the server.
                  #
                  # ALSO NOTE: Do not mangle platform or platform_version here.  It is less error
                  # prone and more future-proof to do that in the server, and then all omnitruck clients
                  # will 'inherit' the changes (install.sh is not the only client of the omnitruck
                  # endpoint out there).
                  #

                  machine=`uname -m`
                  os=`uname -s`

                  if test -f "/etc/lsb-release" && grep -q DISTRIB_ID /etc/lsb-release && ! grep -q wrlinux /etc/lsb-release; then
                    platform=`grep DISTRIB_ID /etc/lsb-release | cut -d "=" -f 2 | tr '[A-Z]' '[a-z]'`
                    platform_version=`grep DISTRIB_RELEASE /etc/lsb-release | cut -d "=" -f 2`
                  elif test -f "/etc/debian_version"; then
                    platform="debian"
                    platform_version=`cat /etc/debian_version`
                  elif test -f "/etc/redhat-release"; then
                    platform=`sed 's/^\(.\+\) release.*/\1/' /etc/redhat-release | tr '[A-Z]' '[a-z]'`
                    platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/redhat-release`

                    # If /etc/redhat-release exists, we act like RHEL by default
                    if test "$platform" = "fedora"; then
                      # FIXME: stop remapping fedora to el
                      # FIXME: remove client side platform_version mangling and hard coded yolo
                      # Change platform version for use below.
                      platform_version="6.0"
                    fi

                    if test "$platform" = "xenserver"; then
                      # Current XenServer 6.2 is based on CentOS 5, platform is not reset to "el" server should hanlde response
                      platform="xenserver"
                    else
                      # FIXME: use "redhat"
                      platform="el"
                    fi

                  elif test -f "/etc/system-release"; then
                    platform=`sed 's/^\(.\+\) release.\+/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
                    platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
                    # amazon is built off of fedora, so act like RHEL
                    if test "$platform" = "amazon linux ami"; then
                      # FIXME: remove client side platform_version mangling and hard coded yolo, and remapping to deprecated "el"
                      platform="el"
                      platform_version="6.0"
                    fi
                  # Apple OS X
                  elif test -f "/usr/bin/sw_vers"; then
                    platform="mac_os_x"
                    # Matching the tab-space with sed is error-prone
                    platform_version=`sw_vers | awk '/^ProductVersion:/ { print $2 }' | cut -d. -f1,2`

                    # x86_64 Apple hardware often runs 32-bit kernels (see OHAI-63)
                    x86_64=`sysctl -n hw.optional.x86_64`
                    if test $x86_64 -eq 1; then
                      machine="x86_64"
                    fi
                  elif test -f "/etc/release"; then
                    machine=`/usr/bin/uname -p`
                    if grep -q SmartOS /etc/release; then
                      platform="smartos"
                      platform_version=`grep ^Image /etc/product | awk '{ print $3 }'`
                    else
                      platform="solaris2"
                      platform_version=`/usr/bin/uname -r`
                    fi
                  elif test -f "/etc/SuSE-release"; then
                    if grep -q 'Enterprise' /etc/SuSE-release;
                    then
                        platform="sles"
                        platform_version=`awk '/^VERSION/ {V = $3}; /^PATCHLEVEL/ {P = $3}; END {print V "." P}' /etc/SuSE-release`
                    else
                        platform="suse"
                        platform_version=`awk '/^VERSION =/ { print $3 }' /etc/SuSE-release`
                    fi
                  elif test "x$os" = "xFreeBSD"; then
                    platform="freebsd"
                    platform_version=`uname -r | sed 's/-.*//'`
                  elif test "x$os" = "xAIX"; then
                    platform="aix"
                    platform_version="`uname -v`.`uname -r`"
                    machine="powerpc"
                  elif test -f "/etc/os-release"; then
                    . /etc/os-release
                    if test "x$CISCO_RELEASE_INFO" != "x"; then
                      . $CISCO_RELEASE_INFO
                    fi

                    platform=$ID
                    platform_version=$VERSION
                  fi

                  if test "x$platform" = "x"; then
                    echo "Unable to determine platform version!"
                    report_bug
                    exit 1
                  fi

                  #
                  # NOTE: platform manging in the install.sh is DEPRECATED
                  #
                  # - install.sh should be true to ohai and should not remap
                  #   platform or platform versions.
                  #
                  # - remapping platform and mangling platform version numbers is
                  #   now the complete responsibility of the server-side endpoints
                  #

                  major_version=`echo $platform_version | cut -d. -f1`
                  case $platform in
                    # FIXME: should remove this case statement completely
                    "el")
                      # FIXME:  "el" is deprecated, should use "redhat"
                      platform_version=$major_version
                      ;;
                    "debian")
                      if test "x$major_version" = "x5"; then
                        # This is here for potential back-compat.
                        # We do not have 5 in versions we publish for anymore but we
                        # might have it for earlier versions.
                        platform_version="6"
                      else
                        platform_version=$major_version
                      fi
                      ;;
                    "freebsd")
                      platform_version=$major_version
                      ;;
                    "sles")
                      platform_version=$major_version
                      ;;
                    "suse")
                      platform_version=$major_version
                      ;;
                  esac

                  # normalize the architecture we detected
                  case $machine in
                    "x86_64"|"amd64"|"x64")
                      machine="x86_64"
                      ;;
                    "i386"|"i86pc"|"x86"|"i686")
                      machine="i386"
                      ;;
                    "sparc"|"sun4u"|"sun4v")
                      machine="sparc"
                      ;;
                  esac

                  if test "x$platform_version" = "x"; then
                    echo "Unable to determine platform version!"
                    report_bug
                    exit 1
                  fi

                  if test "x$platform" = "xsolaris2"; then
                    # hack up the path on Solaris to find wget, pkgadd
                    PATH=/usr/sfw/bin:/usr/sbin:$PATH
                    export PATH
                  fi

                  echo "$platform $platform_version $machine"

                  ############
                  # end of platform_detection.sh
                  ############


                  # artifactory_urls.sh
                  ############
                  # This section sets up the information for a build to be installed from artifactory
                  #  then uses $platform, $platform_version and $machine to select the correct
                  #  version.
                  #
                  # Inputs:
                  # $platform:
                  # $platform_version:
                  # $machine:
                  #
                  # Outputs:
                  # $download_url:
                  # $sha256:
                  ############


                    artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.9/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.10/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.11/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/ppc64le"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ios_xr/6/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/nexus/7/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/6/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/6/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/7/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/8/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64le"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/6/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/7/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/8/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/amd64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2012/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/6/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2012/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/aix/6.1/powerpc"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/aix/7.1/powerpc"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/5/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/7/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/5/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/amd64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/sparc"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/sparc"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" >> "$artifact_info_dir/artifact_info"


                  artifact_info_for_platform="$tmp_dir/artifact_info/$platform/$platform_version/$machine/artifact_info"

                  download_url=`awk '$1 == "url" { print $2 }' "$artifact_info_for_platform"`
                  sha256=`awk '$1 == "sha256" { print $2 }' "$artifact_info_for_platform"`


                  # fetch_package.sh
                  ############
                  # This section fetchs a package from $download_url and verifies its metadata.
                  #
                  # Inputs:
                  # $download_url:
                  # $tmp_dir:
                  # Optional Inputs:
                  # $cmdline_filename: Name of the package downloaded on local disk.
                  # $cmdline_dl_dir: Name of the directory downloaded package will be saved to on local disk.
                  #
                  # Outputs:
                  # $download_filename: Name of the downloaded file on local disk.
                  # $filetype: Type of the file downloaded.
                  ############

                  filename=`echo $download_url | sed -e 's/^.*\///'`
                  filetype=`echo $filename | sed -e 's/^.*\.//'`

                  # use either $tmp_dir, the provided directory (-d) or the provided filename (-f)
                  if test "x$cmdline_filename" != "x"; then
                    download_filename="$cmdline_filename"
                  elif test "x$cmdline_dl_dir" != "x"; then
                    download_filename="$cmdline_dl_dir/$filename"
                  else
                    download_filename="$tmp_dir/$filename"
                  fi

                  # ensure the parent directory where to download the installer always exists
                  download_dir=`dirname $download_filename`
                  (umask 077 && mkdir -p $download_dir) || exit 1

                  # check if we have that file locally available and if so verify the checksum
                  cached_file_available="false"
                  if test -f $download_filename; then
                    echo "$download_filename already exists, verifiying checksum..."
                    if do_checksum "$download_filename" "$sha256"; then
                      echo "checksum compare succeeded, using existing file!"
                      cached_file_available="true"
                    else
                      echo "checksum mismatch, downloading latest version of the file"
                    fi
                  fi

                  # download if no local version of the file available
                  if test "x$cached_file_available" != "xtrue"; then
                    do_download "$download_url"  "$download_filename"
                    do_checksum "$download_filename" "$sha256" || checksum_mismatch
                  fi

                  ############
                  # end of fetch_package.sh
                  ############


                  # install_package.sh
                  ############
                  # Installs a package and removed the temp directory.
                  #
                  # Inputs:
                  # $download_filename: Name of the file to be installed.
                  # $filetype: Type of the file to be installed.
                  # $version: The version requested. Used only for warning user if not set.
                  ############

                  if test "x$version" = "x"; then
                    echo
                    echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
                    echo
                    echo "You are installing an omnibus package without a version pin.  If you are installing"
                    echo "on production servers via an automated process this is DANGEROUS and you will"
                    echo "be upgraded without warning on new releases, even to new major releases."
                    echo "Letting the version float is only appropriate in desktop, test, development or"
                    echo "CI/CD environments."
                    echo
                    echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
                    echo
                  fi

                  install_file $filetype "$download_filename"

                  if test "x$tmp_dir" != "x"; then
                    rm -r "$tmp_dir"
                  fi

                  ############
                  # end of install_package.sh
                  ############

                  EOL
                  chmod +x /tmp/chef-installer.sh
                  sudo -E /tmp/chef-installer.sh)
                         Waited 90/300s for instance <i-a38c0b0c> to become ready.
                         bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         /bin/bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         el 6 x86_64
                  D      Console output: ---
                  2016/07/21 04:09:36Z: EC2ConfigMonitorState: 0
                  2016/07/21 04:09:36Z: Windows sysprep configuration complete.
                  2016/07/21 04:09:39Z: AMI Origin Version: 2016.07.13
                  2016/07/21 04:09:39Z: AMI Origin Name: Windows_Server-2012-R2_RTM-English-64Bit-Base
                  2016/07/21 04:09:39Z: OS: Microsoft Windows NT 6.3.9600
                  2016/07/21 04:09:39Z: OsVersion: 6.3
                  2016/07/21 04:09:39Z: OsProductName: Windows Server 2012 R2 Standard
                  2016/07/21 04:09:39Z: OsBuildLabEx: 9600.18289.amd64fre.winblue_ltsb.160328-1315
                  2016/07/21 04:09:39Z: Language: en-US
                  2016/07/21 04:09:39Z: TimeZone: Coordinated Universal Time
                  2016/07/21 04:09:39Z: Offset: UTC 00:00:00
                  2016/07/21 04:09:39Z: EC2 Agent: Ec2Config service v3.17.1032
                  2016/07/21 04:09:41Z: Message: Waiting for meta-data accessibility...
                  2016/07/21 04:09:41Z: Message: Meta-data is now available.
                  2016/07/21 04:09:42Z: AMI-ID: ami-26e72546
                  2016/07/21 04:09:42Z: Instance-ID: i-a38c0b0c
                  2016/07/21 04:09:42Z: Driver: AWS PV Network Device v7.4.2.0
                  2016/07/21 04:09:42Z: Driver: AWS PV Storage Host Adapter v7.4.2.0
                  2016/07/21 04:09:42Z: Ec2SetPassword: Enabled
                  2016/07/21 04:09:42Z: RDPCERTIFICATE-SUBJECTNAME: WIN-SPDQM60MCAH
                  2016/07/21 04:09:42Z: RDPCERTIFICATE-THUMBPRINT: 7B748E7277E6D9B2EE5FF6456D61FD8C43E840C1
                  2016/07/21 04:09:45Z: Username: Administrator
                  2016/07/21 04:09:45Z: Password: <Password>
                  Gc0okSKE+zAvbptyjEnxravOnlfzTPwltDucMLU6Yjfbeqjz3baSN/73iPzwWeZrVXt/4ucplKS06pcmYEaOWsfCjt+VDXAA3YTMN6sXqzLr0QF/BYDlIt3ZrDPLIZqu1NH9snvHQeQdtTlfb5mknYL3Tvqmq++9sjUnHKxYtc2fjYc8P6n6YxCMYmsvUReT6M829nElJxP0ExFIUklPYb3RMAcsuNYZ7ORRWm+892iQAUXrjz3IkpAeZ898Ktor1mIEK31TOc3nnMLmTwV40FJS74bOuGjhgbVIRLq5H4m7nxTlWt7DcTyWO7BMvCIGEOQIOJxVit9ylgX/U8trmw==
                  </Password>
                  2016/07/21 04:09:47Z: Message: Windows is Ready to use

                         Waited 0/300s for instance <i-a38c0b0c> to fetch windows admin password.
                         downloading http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm
                           to file /tmp/install.sh.961/chef-12.13.8+20160721014124-1.el6.x86_64.rpm
                         trying curl...
                         Retrieved Windows password for instance <i-a38c0b0c>.
                         EC2 instance <i-a38c0b0c> ready.
                  D      [WinRM] <{:endpoint=>"http://10.194.12.123:5985/wsman", :user=>"administrator", :password=>"ussS(6;D@$p", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"ussS(6;D@$p", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (Write-Host '[WinRM] Established
                  ')
                  D      [WinRM] opening remote shell on http://10.194.12.123:5985/wsman
                         Comparing checksum with sha256sum...
                         Installing chef 12.13.8+20160721014124
                         installing with rpm...
                         warning: /tmp/install.sh.961/chef-12.13.8+20160721014124-1.el6.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID 83ef826a: NOKEY
                         Preparing...                                                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                  D      [SSH] connection failed (#<Net::SSH::ConnectionTimeout: Net::SSH::ConnectionTimeout>)
                         Waiting for SSH service on 10.194.9.186:22, retrying in 3 seconds
                  D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] connection failed (#<Net::SSH::AuthenticationFailed: Authentication failed for user root@10.194.9.186>)
                         Waiting for SSH service on 10.194.9.186:22, retrying in 3 seconds
                         Waited 95/300s for instance <i-998d0a36> to become ready.
                            1:chef                                                               (  1%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (  3%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (  6%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (  8%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        ( 10%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       ( 13%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      ( 15%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     ( 17%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    ( 19%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   ( 22%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  ( 24%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 ( 26%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                ( 28%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               ( 31%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              ( 33%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             ( 35%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            ( 38%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           ( 40%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          ( 42%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         ( 44%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        ( 47%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       ( 49%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      ( 51%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     ( 53%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    ( 56%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   ( 58%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  ( 60%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 ( 63%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                ( 65%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               ( 67%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              ( 69%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             ( 72%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            ( 74%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           ( 76%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          ( 78%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         ( 81%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        ( 83%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       ( 85%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      ( 88%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     ( 90%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    ( 92%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   ( 94%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  ( 97%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### ( 99%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                         /bin/sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         Thank you for installing Chef!
                  D      [SSH] root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
                  sudo_rm="sudo -E rm"
                  dirs="/tmp/kitchen/clients /tmp/kitchen/cookbooks /tmp/kitchen/data /tmp/kitchen/data_bags /tmp/kitchen/encrypted_data_bag_secret /tmp/kitchen/environments /tmp/kitchen/roles"
                  root_path="/tmp/kitchen"

                  $sudo_rm -rf $dirs
                  mkdir -p $root_path
                  ')
                         bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                  D      [SSH] opening connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (echo '[SSH] Established')
                         Transferring files to <fips-unit-functional-centos-6>
                  D      TIMING: scp async upload (Kitchen::Transport::Ssh)
                         bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         [SSH] Established
                  D      Using sudo_command='sudo -E' for ohai hints
                  D      [SSH] reusing existing connection root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E mkdir -p /etc/chef/ohai/hints; sudo -E touch /etc/chef/ohai/hints/ec2.json)
                         bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                  D      TIMING: scp async upload (Kitchen::Transport::Ssh) took (0m0.16s)
                  D      Transfer complete
                  D      Attempting to execute command - try 1 of 1.
                  D      [SSH] root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
                  sudo -E /opt/chef/bin/chef-client --local-mode --config /tmp/kitchen/client.rb --log_level auto --force-formatter --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889
                  ')
                         bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                  D      ec2:create '10.194.9.186'
                         Finished creating <fips-integration-centos-6> (1m45.15s).
                  -----> Converging <fips-integration-centos-6>...
                         Preparing files for transfer
                  D      Creating local sandbox in /tmp/cheftest/fips-integration-centos-6-sandbox-20160721-21168-2nhx28
                         Preparing dna.json
                  D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                         Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                         Removing non-cookbook files before transfer
                         Preparing validation.pem
                  D      Using a dummy validation.pem
                         Preparing client.rb
                  D      Creating client.rb from {:node_name=>"fips-integration-centos-6", :checksum_path=>"/tmp/kitchen/checksums", :file_cache_path=>"/tmp/kitchen/cache", :file_backup_path=>"/tmp/kitchen/backup", :cookbook_path=>["/tmp/kitchen/cookbooks", "/tmp/kitchen/site-cookbooks"], :data_bag_path=>"/tmp/kitchen/data_bags", :environment_path=>"/tmp/kitchen/environments", :node_path=>"/tmp/kitchen/nodes", :role_path=>"/tmp/kitchen/roles", :client_path=>"/tmp/kitchen/clients", :user_path=>"/tmp/kitchen/users", :validation_key=>"/tmp/kitchen/validation.pem", :client_key=>"/tmp/kitchen/client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"/tmp/kitchen/encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
                  D      [SSH] reusing existing connection root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sudo -E cat > /tmp/chef-installer.sh <<"EOL"
                  #!/bin/bash
                  #!/bin/sh
                  # WARNING: REQUIRES /bin/sh
                  #
                  # - must run on /bin/sh on solaris 9
                  # - must run on /bin/sh on AIX 6.x
                  #
                  # Copyright:: Copyright (c) 2010-2015 Chef Software, Inc.
                  # License:: Apache License, Version 2.0
                  #
                  # Licensed under the Apache License, Version 2.0 (the "License");
                  # you may not use this file except in compliance with the License.
                  # You may obtain a copy of the License at
                  #
                  #     http://www.apache.org/licenses/LICENSE-2.0
                  #
                  # Unless required by applicable law or agreed to in writing, software
                  # distributed under the License is distributed on an "AS IS" BASIS,
                  # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
                  # See the License for the specific language governing permissions and
                  # limitations under the License.
                  #

                  # helpers.sh
                  ############
                  # This section has some helper functions to make life easier.
                  #
                  # Outputs:
                  # $tmp_dir: secure-ish temp directory that can be used during installation.
                  ############

                  # Check whether a command exists - returns 0 if it does, 1 if it does not
                  exists() {
                    if command -v $1 >/dev/null 2>&1
                    then
                      return 0
                    else
                      return 1
                    fi
                  }

                  # Output the instructions to report bug about this script
                  report_bug() {
                    echo "Version: $version"
                    echo ""
                    echo "Please file a Bug Report at https://github.com/chef/omnitruck/issues/new"
                    echo "Alternatively, feel free to open a Support Ticket at https://www.chef.io/support/tickets"
                    echo "More Chef support resources can be found at https://www.chef.io/support"
                    echo ""
                    echo "Please include as many details about the problem as possible i.e., how to reproduce"
                    echo "the problem (if possible), type of the Operating System and its version, etc.,"
                    echo "and any other relevant details that might help us with troubleshooting."
                    echo ""
                  }

                  checksum_mismatch() {
                    echo "Package checksum mismatch!"
                    report_bug
                    exit 1
                  }

                  unable_to_retrieve_package() {
                    echo "Unable to retrieve a valid package!"
                    report_bug
                    echo "Metadata URL: $metadata_url"
                    if test "x$download_url" != "x"; then
                      echo "Download URL: $download_url"
                    fi
                    if test "x$stderr_results" != "x"; then
                      echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
                    fi
                    exit 1
                  }

                  http_404_error() {
                    echo "Omnitruck artifact does not exist for version $version on platform $platform"
                    echo ""
                    echo "Either this means:"
                    echo "   - We do not support $platform"
                    echo "   - We do not have an artifact for $version"
                    echo ""
                    echo "This is often the latter case due to running a prerelease or RC version of chef"
                    echo "or a gem version which was only pushed to rubygems and not omnitruck."
                    echo ""
                    echo "You may be able to set your knife[:bootstrap_version] to the most recent stable"
                    echo "release of Chef to fix this problem (or the most recent stable major version number)."
                    echo ""
                    echo "In order to test the version parameter, adventurous users may take the Metadata URL"
                    echo "below and modify the '&v=<number>' parameter until you successfully get a URL that"
                    echo "does not 404 (e.g. via curl or wget).  You should be able to use '&v=11' or '&v=12'"
                    echo "succesfully."
                    echo ""
                    echo "If you cannot fix this problem by setting the bootstrap_version, it probably means"
                    echo "that $platform is not supported."
                    echo ""
                    # deliberately do not call report_bug to suppress bug report noise.
                    echo "Metadata URL: $metadata_url"
                    if test "x$download_url" != "x"; then
                      echo "Download URL: $download_url"
                    fi
                    if test "x$stderr_results" != "x"; then
                      echo "\nDEBUG OUTPUT FOLLOWS:\n$stderr_results"
                    fi
                    exit 1
                  }

                  capture_tmp_stderr() {
                    # spool up /tmp/stderr from all the commands we called
                    if test -f "$tmp_dir/stderr"; then
                      output=`cat $tmp_dir/stderr`
                      stderr_results="${stderr_results}\nSTDERR from $1:\n\n$output\n"
                      rm $tmp_dir/stderr
                    fi
                  }

                  # do_wget URL FILENAME
                  do_wget() {
                    echo "trying wget..."
                    wget -O "$2" "$1" 2>$tmp_dir/stderr
                    rc=$?
                    # check for 404
                    grep "ERROR 404" $tmp_dir/stderr 2>&1 >/dev/null
                    if test $? -eq 0; then
                      echo "ERROR 404"
                      http_404_error
                    fi

                    # check for bad return status or empty output
                    if test $rc -ne 0 || test ! -s "$2"; then
                      capture_tmp_stderr "wget"
                      return 1
                    fi

                    return 0
                  }

                  # do_curl URL FILENAME
                  do_curl() {
                    echo "trying curl..."
                    curl --retry 5 -sL -D $tmp_dir/stderr "$1" > "$2"
                    rc=$?
                    # check for 404
                    grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
                    if test $? -eq 0; then
                      echo "ERROR 404"
                      http_404_error
                    fi

                    # check for bad return status or empty output
                    if test $rc -ne 0 || test ! -s "$2"; then
                      capture_tmp_stderr "curl"
                      return 1
                    fi

                    return 0
                  }

                  # do_fetch URL FILENAME
                  do_fetch() {
                    echo "trying fetch..."
                    fetch -o "$2" "$1" 2>$tmp_dir/stderr
                    # check for bad return status
                    test $? -ne 0 && return 1
                    return 0
                  }

                  # do_perl URL FILENAME
                  do_perl() {
                    echo "trying perl..."
                    perl -e 'use LWP::Simple; getprint($ARGV[0]);' "$1" > "$2" 2>$tmp_dir/stderr
                    rc=$?
                    # check for 404
                    grep "404 Not Found" $tmp_dir/stderr 2>&1 >/dev/null
                    if test $? -eq 0; then
                      echo "ERROR 404"
                      http_404_error
                    fi

                    # check for bad return status or empty output
                    if test $rc -ne 0 || test ! -s "$2"; then
                      capture_tmp_stderr "perl"
                      return 1
                    fi

                    return 0
                  }

                  # do_python URL FILENAME
                  do_python() {
                    echo "trying python..."
                    python -c "import sys,urllib2 ; sys.stdout.write(urllib2.urlopen(sys.argv[1]).read())" "$1" > "$2" 2>$tmp_dir/stderr
                    rc=$?
                    # check for 404
                    grep "HTTP Error 404" $tmp_dir/stderr 2>&1 >/dev/null
                    if test $? -eq 0; then
                      echo "ERROR 404"
                      http_404_error
                    fi

                    # check for bad return status or empty output
                    if test $rc -ne 0 || test ! -s "$2"; then
                      capture_tmp_stderr "python"
                      return 1
                    fi
                    return 0
                  }

                  # returns 0 if checksums match
                  do_checksum() {
                    if exists sha256sum; then
                      echo "Comparing checksum with sha256sum..."
                      checksum=`sha256sum $1 | awk '{ print $1 }'`
                      return `test "x$checksum" = "x$2"`
                    elif exists shasum; then
                      echo "Comparing checksum with shasum..."
                      checksum=`shasum -a 256 $1 | awk '{ print $1 }'`
                      return `test "x$checksum" = "x$2"`
                    else
                      echo "WARNING: could not find a valid checksum program, pre-install shasum or sha256sum in your O/S image to get valdation..."
                      return 0
                    fi
                  }

                  # do_download URL FILENAME
                  do_download() {
                    echo "downloading $1"
                    echo "  to file $2"

                    url=`echo $1`
                    if test "x$platform" = "xsolaris2"; then
                      if test "x$platform_version" = "x5.9" -o "x$platform_version" = "x5.10"; then
                        # solaris 9 lacks openssl, solaris 10 lacks recent enough credentials - your base O/S is completely insecure, please upgrade
                        url=`echo $url | sed -e 's/https/http/'`
                      fi
                    fi

                    # we try all of these until we get success.
                    # perl, in particular may be present but LWP::Simple may not be installed

                    if exists wget; then
                      do_wget $url $2 && return 0
                    fi

                    if exists curl; then
                      do_curl $url $2 && return 0
                    fi

                    if exists fetch; then
                      do_fetch $url $2 && return 0
                    fi

                    if exists perl; then
                      do_perl $url $2 && return 0
                    fi

                    if exists python; then
                      do_python $url $2 && return 0
                    fi

                    unable_to_retrieve_package
                  }

                  # install_file TYPE FILENAME
                  # TYPE is "rpm", "deb", "solaris", "sh", etc.
                  install_file() {
                    echo "Installing $project $version"
                    case "$1" in
                      "rpm")
                        if test "x$platform" = "xnexus" || test "x$platform" = "xios_xr"; then
                          echo "installing with yum..."
                          yum install -yv "$2"
                        else
                          echo "installing with rpm..."
                          rpm -Uvh --oldpackage --replacepkgs "$2"
                        fi
                        ;;
                      "deb")
                        echo "installing with dpkg..."
                        dpkg -i "$2"
                        ;;
                      "bff")
                        echo "installing with installp..."
                        installp -aXYgd "$2" all
                        ;;
                      "solaris")
                        echo "installing with pkgadd..."
                        echo "conflict=nocheck" > $tmp_dir/nocheck
                        echo "action=nocheck" >> $tmp_dir/nocheck
                        echo "mail=" >> $tmp_dir/nocheck
                        pkgrm -a $tmp_dir/nocheck -n $project >/dev/null 2>&1 || true
                        pkgadd -G -n -d "$2" -a $tmp_dir/nocheck $project
                        ;;
                      "pkg")
                        echo "installing with installer..."
                        cd / && /usr/sbin/installer -pkg "$2" -target /
                        ;;
                      "dmg")
                        echo "installing dmg file..."
                        hdiutil detach "/Volumes/chef_software" >/dev/null 2>&1 || true
                        hdiutil attach "$2" -mountpoint "/Volumes/chef_software"
                        cd / && /usr/sbin/installer -pkg `find "/Volumes/chef_software" -name \*.pkg` -target /
                        hdiutil detach "/Volumes/chef_software"
                        ;;
                      "sh" )
                        echo "installing with sh..."
                        sh "$2"
                        ;;
                      *)
                        echo "Unknown filetype: $1"
                        report_bug
                        exit 1
                        ;;
                    esac
                    if test $? -ne 0; then
                      echo "Installation failed"
                      report_bug
                      exit 1
                    fi
                  }

                  if test "x$TMPDIR" = "x"; then
                    tmp="/tmp"
                  else
                    tmp=$TMPDIR
                  fi
                  # secure-ish temp dir creation without having mktemp available (DDoS-able but not expliotable)
                  tmp_dir="$tmp/install.sh.$$"
                  (umask 077 && mkdir $tmp_dir) || exit 1

                  ############
                  # end of helpers.sh
                  ############


                  project=chef
                  version=12.13.8+20160721014124
                  channel=unstable


                  # platform_detection.sh
                  ############
                  # This section makes platform detection compatible with omnitruck on the system
                  #   it runs.
                  #
                  # Outputs:
                  # $platform: Name of the platform.
                  # $platform_version: Version of the platform.
                  # $machine: System's architecture.
                  ############

                  #
                  # Platform and Platform Version detection
                  #
                  # NOTE: This should now match ohai platform and platform_version matching.
                  # do not invented new platform and platform_version schemas, just make this behave
                  # like what ohai returns as platform and platform_version for the server.
                  #
                  # ALSO NOTE: Do not mangle platform or platform_version here.  It is less error
                  # prone and more future-proof to do that in the server, and then all omnitruck clients
                  # will 'inherit' the changes (install.sh is not the only client of the omnitruck
                  # endpoint out there).
                  #

                  machine=`uname -m`
                  os=`uname -s`

                  if test -f "/etc/lsb-release" && grep -q DISTRIB_ID /etc/lsb-release && ! grep -q wrlinux /etc/lsb-release; then
                    platform=`grep DISTRIB_ID /etc/lsb-release | cut -d "=" -f 2 | tr '[A-Z]' '[a-z]'`
                    platform_version=`grep DISTRIB_RELEASE /etc/lsb-release | cut -d "=" -f 2`
                  elif test -f "/etc/debian_version"; then
                    platform="debian"
                    platform_version=`cat /etc/debian_version`
                  elif test -f "/etc/redhat-release"; then
                    platform=`sed 's/^\(.\+\) release.*/\1/' /etc/redhat-release | tr '[A-Z]' '[a-z]'`
                    platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/redhat-release`

                    # If /etc/redhat-release exists, we act like RHEL by default
                    if test "$platform" = "fedora"; then
                      # FIXME: stop remapping fedora to el
                      # FIXME: remove client side platform_version mangling and hard coded yolo
                      # Change platform version for use below.
                      platform_version="6.0"
                    fi

                    if test "$platform" = "xenserver"; then
                      # Current XenServer 6.2 is based on CentOS 5, platform is not reset to "el" server should hanlde response
                      platform="xenserver"
                    else
                      # FIXME: use "redhat"
                      platform="el"
                    fi

                  elif test -f "/etc/system-release"; then
                    platform=`sed 's/^\(.\+\) release.\+/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
                    platform_version=`sed 's/^.\+ release \([.0-9]\+\).*/\1/' /etc/system-release | tr '[A-Z]' '[a-z]'`
                    # amazon is built off of fedora, so act like RHEL
                    if test "$platform" = "amazon linux ami"; then
                      # FIXME: remove client side platform_version mangling and hard coded yolo, and remapping to deprecated "el"
                      platform="el"
                      platform_version="6.0"
                    fi
                  # Apple OS X
                  elif test -f "/usr/bin/sw_vers"; then
                    platform="mac_os_x"
                    # Matching the tab-space with sed is error-prone
                    platform_version=`sw_vers | awk '/^ProductVersion:/ { print $2 }' | cut -d. -f1,2`

                    # x86_64 Apple hardware often runs 32-bit kernels (see OHAI-63)
                    x86_64=`sysctl -n hw.optional.x86_64`
                    if test $x86_64 -eq 1; then
                      machine="x86_64"
                    fi
                  elif test -f "/etc/release"; then
                    machine=`/usr/bin/uname -p`
                    if grep -q SmartOS /etc/release; then
                      platform="smartos"
                      platform_version=`grep ^Image /etc/product | awk '{ print $3 }'`
                    else
                      platform="solaris2"
                      platform_version=`/usr/bin/uname -r`
                    fi
                  elif test -f "/etc/SuSE-release"; then
                    if grep -q 'Enterprise' /etc/SuSE-release;
                    then
                        platform="sles"
                        platform_version=`awk '/^VERSION/ {V = $3}; /^PATCHLEVEL/ {P = $3}; END {print V "." P}' /etc/SuSE-release`
                    else
                        platform="suse"
                        platform_version=`awk '/^VERSION =/ { print $3 }' /etc/SuSE-release`
                    fi
                  elif test "x$os" = "xFreeBSD"; then
                    platform="freebsd"
                    platform_version=`uname -r | sed 's/-.*//'`
                  elif test "x$os" = "xAIX"; then
                    platform="aix"
                    platform_version="`uname -v`.`uname -r`"
                    machine="powerpc"
                  elif test -f "/etc/os-release"; then
                    . /etc/os-release
                    if test "x$CISCO_RELEASE_INFO" != "x"; then
                      . $CISCO_RELEASE_INFO
                    fi

                    platform=$ID
                    platform_version=$VERSION
                  fi

                  if test "x$platform" = "x"; then
                    echo "Unable to determine platform version!"
                    report_bug
                    exit 1
                  fi

                  #
                  # NOTE: platform manging in the install.sh is DEPRECATED
                  #
                  # - install.sh should be true to ohai and should not remap
                  #   platform or platform versions.
                  #
                  # - remapping platform and mangling platform version numbers is
                  #   now the complete responsibility of the server-side endpoints
                  #

                  major_version=`echo $platform_version | cut -d. -f1`
                  case $platform in
                    # FIXME: should remove this case statement completely
                    "el")
                      # FIXME:  "el" is deprecated, should use "redhat"
                      platform_version=$major_version
                      ;;
                    "debian")
                      if test "x$major_version" = "x5"; then
                        # This is here for potential back-compat.
                        # We do not have 5 in versions we publish for anymore but we
                        # might have it for earlier versions.
                        platform_version="6"
                      else
                        platform_version=$major_version
                      fi
                      ;;
                    "freebsd")
                      platform_version=$major_version
                      ;;
                    "sles")
                      platform_version=$major_version
                      ;;
                    "suse")
                      platform_version=$major_version
                      ;;
                  esac

                  # normalize the architecture we detected
                  case $machine in
                    "x86_64"|"amd64"|"x64")
                      machine="x86_64"
                      ;;
                    "i386"|"i86pc"|"x86"|"i686")
                      machine="i386"
                      ;;
                    "sparc"|"sun4u"|"sun4v")
                      machine="sparc"
                      ;;
                  esac

                  if test "x$platform_version" = "x"; then
                    echo "Unable to determine platform version!"
                    report_bug
                    exit 1
                  fi

                  if test "x$platform" = "xsolaris2"; then
                    # hack up the path on Solaris to find wget, pkgadd
                    PATH=/usr/sfw/bin:/usr/sbin:$PATH
                    export PATH
                  fi

                  echo "$platform $platform_version $machine"

                  ############
                  # end of platform_detection.sh
                  ############


                  # artifactory_urls.sh
                  ############
                  # This section sets up the information for a build to be installed from artifactory
                  #  then uses $platform, $platform_version and $machine to select the correct
                  #  version.
                  #
                  # Inputs:
                  # $platform:
                  # $platform_version:
                  # $machine:
                  #
                  # Outputs:
                  # $download_url:
                  # $sha256:
                  ############


                    artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.9/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.10/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/mac_os_x/10.11/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/ppc64le"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ios_xr/6/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/nexus/7/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/6/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/6/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/7/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/8/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/7/ppc64le"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/6/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/7/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/debian/8/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/freebsd/10/amd64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2012/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/i386"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/6/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2008r2/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2012/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/windows/2012r2/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/aix/6.1/powerpc"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/aix/7.1/powerpc"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/5/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ubuntu/12.04/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/ubuntu/14.04/i686"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/7/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/el/5/x86_64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/freebsd/9/amd64"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.10/sparc"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" >> "$artifact_info_dir/artifact_info"

                    artifact_info_dir="$tmp_dir/artifact_info/solaris2/5.11/sparc"
                    mkdir -p $artifact_info_dir
                    touch "$artifact_info_dir/artifact_info"
                    echo "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" >> "$artifact_info_dir/artifact_info"
                    echo "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" >> "$artifact_info_dir/artifact_info"


                  artifact_info_for_platform="$tmp_dir/artifact_info/$platform/$platform_version/$machine/artifact_info"

                  download_url=`awk '$1 == "url" { print $2 }' "$artifact_info_for_platform"`
                  sha256=`awk '$1 == "sha256" { print $2 }' "$artifact_info_for_platform"`


                  # fetch_package.sh
                  ############
                  # This section fetchs a package from $download_url and verifies its metadata.
                  #
                  # Inputs:
                  # $download_url:
                  # $tmp_dir:
                  # Optional Inputs:
                  # $cmdline_filename: Name of the package downloaded on local disk.
                  # $cmdline_dl_dir: Name of the directory downloaded package will be saved to on local disk.
                  #
                  # Outputs:
                  # $download_filename: Name of the downloaded file on local disk.
                  # $filetype: Type of the file downloaded.
                  ############

                  filename=`echo $download_url | sed -e 's/^.*\///'`
                  filetype=`echo $filename | sed -e 's/^.*\.//'`

                  # use either $tmp_dir, the provided directory (-d) or the provided filename (-f)
                  if test "x$cmdline_filename" != "x"; then
                    download_filename="$cmdline_filename"
                  elif test "x$cmdline_dl_dir" != "x"; then
                    download_filename="$cmdline_dl_dir/$filename"
                  else
                    download_filename="$tmp_dir/$filename"
                  fi

                  # ensure the parent directory where to download the installer always exists
                  download_dir=`dirname $download_filename`
                  (umask 077 && mkdir -p $download_dir) || exit 1

                  # check if we have that file locally available and if so verify the checksum
                  cached_file_available="false"
                  if test -f $download_filename; then
                    echo "$download_filename already exists, verifiying checksum..."
                    if do_checksum "$download_filename" "$sha256"; then
                      echo "checksum compare succeeded, using existing file!"
                      cached_file_available="true"
                    else
                      echo "checksum mismatch, downloading latest version of the file"
                    fi
                  fi

                  # download if no local version of the file available
                  if test "x$cached_file_available" != "xtrue"; then
                    do_download "$download_url"  "$download_filename"
                    do_checksum "$download_filename" "$sha256" || checksum_mismatch
                  fi

                  ############
                  # end of fetch_package.sh
                  ############


                  # install_package.sh
                  ############
                  # Installs a package and removed the temp directory.
                  #
                  # Inputs:
                  # $download_filename: Name of the file to be installed.
                  # $filetype: Type of the file to be installed.
                  # $version: The version requested. Used only for warning user if not set.
                  ############

                  if test "x$version" = "x"; then
                    echo
                    echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
                    echo
                    echo "You are installing an omnibus package without a version pin.  If you are installing"
                    echo "on production servers via an automated process this is DANGEROUS and you will"
                    echo "be upgraded without warning on new releases, even to new major releases."
                    echo "Letting the version float is only appropriate in desktop, test, development or"
                    echo "CI/CD environments."
                    echo
                    echo "WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING"
                    echo
                  fi

                  install_file $filetype "$download_filename"

                  if test "x$tmp_dir" != "x"; then
                    rm -r "$tmp_dir"
                  fi

                  ############
                  # end of install_package.sh
                  ############

                  EOL
                  chmod +x /tmp/chef-installer.sh
                  sudo -E /tmp/chef-installer.sh)
                         bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         /bin/bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         el 6 x86_64
                         downloading http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm
                           to file /tmp/install.sh.959/chef-12.13.8+20160721014124-1.el6.x86_64.rpm
                         trying curl...
                         Comparing checksum with sha256sum...
                         Installing chef 12.13.8+20160721014124
                         installing with rpm...
                         warning: /tmp/install.sh.959/chef-12.13.8+20160721014124-1.el6.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID 83ef826a: NOKEY
                         Starting Chef Client, version 12.13.8
                         Preparing...                                                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### (100%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                         Waited 100/300s for instance <i-998d0a36> to become ready.
                  D      Console output: ---
                  2016/07/21 04:09:48Z: EC2ConfigMonitorState: 0
                  2016/07/21 04:09:48Z: Windows sysprep configuration complete.
                  2016/07/21 04:09:51Z: AMI Origin Version: 2016.07.13
                  2016/07/21 04:09:51Z: AMI Origin Name: Windows_Server-2012-R2_RTM-English-64Bit-Base
                  2016/07/21 04:09:51Z: OS: Microsoft Windows NT 6.3.9600
                  2016/07/21 04:09:51Z: OsVersion: 6.3
                  2016/07/21 04:09:51Z: OsProductName: Windows Server 2012 R2 Standard
                  2016/07/21 04:09:51Z: OsBuildLabEx: 9600.18289.amd64fre.winblue_ltsb.160328-1315
                  2016/07/21 04:09:51Z: Language: en-US
                  2016/07/21 04:09:51Z: TimeZone: Coordinated Universal Time
                  2016/07/21 04:09:51Z: Offset: UTC 00:00:00
                  2016/07/21 04:09:51Z: EC2 Agent: Ec2Config service v3.17.1032
                  2016/07/21 04:09:53Z: Message: Waiting for meta-data accessibility...
                  2016/07/21 04:09:53Z: Message: Meta-data is now available.
                  2016/07/21 04:09:54Z: AMI-ID: ami-26e72546
                  2016/07/21 04:09:54Z: Instance-ID: i-998d0a36
                  2016/07/21 04:09:57Z: Driver: AWS PV Network Device v7.4.2.0
                  2016/07/21 04:09:57Z: Driver: AWS PV Storage Host Adapter v7.4.2.0
                  2016/07/21 04:09:57Z: Ec2SetPassword: Enabled
                  2016/07/21 04:09:57Z: RDPCERTIFICATE-SUBJECTNAME: WIN-92QQ3FH7A5C
                  2016/07/21 04:09:57Z: RDPCERTIFICATE-THUMBPRINT: 1C269189A5A3B5133C5AA0EFAD7040A198453128
                  2016/07/21 04:10:00Z: Username: Administrator
                  2016/07/21 04:10:00Z: Password: <Password>
                  l8oWy+hTmePCztgfyCQgGjiX69rQTP1zlwuy+YU6hjQhF6EkVunATppMlULRzEEkzNv6qpwJjH15S4hSZ3klYZzq/D2U35j+JL8oN9g6g6oL7Jo1XUM8ksuYGNvlQN7qO/fOrhmzMNR+mTqCh/GibnIYUn/wZuU2ZT+J0MdEI7Ww68d4ct+/EJI93aw6klxW0R4u+V7VAZUw+7YRdTuinC/ZCDIImVe1x6dELDu7oqSO6EZrlZvPQ4fJKOYlh343D8fl2hOySZtLyx3RnigrCeKacK3YREO0uLEar099eoy51AjK0qLcYiiCY6gwwD9V+jUv/R+z6KxOwfE+iOpYiw==
                  </Password>
                  2016/07/21 04:10:01Z: Message: Windows is Ready to use

                         Waited 0/300s for instance <i-998d0a36> to fetch windows admin password.
                         Retrieved Windows password for instance <i-998d0a36>.
                         EC2 instance <i-998d0a36> ready.
                  D      [WinRM] <{:endpoint=>"http://10.194.13.35:5985/wsman", :user=>"administrator", :password=>"A8=ria;bCb.", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"A8=ria;bCb.", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (Write-Host '[WinRM] Established
                  ')
                  D      [WinRM] opening remote shell on http://10.194.13.35:5985/wsman
                         Creating a new client identity for fips-unit-functional-centos-6 using the validator key.
                         resolving cookbooks for run list: []
                         Synchronizing Cookbooks:
                         Installing Cookbook Gems:
                         Compiling Cookbooks...
                         [2016-07-21T04:10:06+00:00] WARN: Node fips-unit-functional-centos-6 has an empty run list.
                         Converging 0 resources
                         Starting audit phase

                         Finished in 0.00028 seconds (files took 0.39181 seconds to load)
                         0 examples, 0 failures
                         Auditing complete

                         Running handlers:
                         Running handlers complete
                         Chef Client finished, 0/0 resources updated in 03 seconds
                         [2016-07-21T04:10:06+00:00] ERROR: Failed to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json
                  D      Cleaning up local sandbox in /tmp/cheftest/fips-unit-functional-centos-6-sandbox-20160721-21168-kwydkn
                         Finished converging <fips-unit-functional-centos-6> (0m13.46s).
                  D      [SSH] shutting previous connection root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] closing connection to root@10.194.8.37<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                            1:chef                                                               (  1%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#                                           (  3%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##                                          (  6%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###                                         (  8%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####                                        ( 10%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####                                       ( 13%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######                                      ( 15%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######                                     ( 17%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########                                    ( 19%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########                                   ( 22%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########                                  ( 24%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########                                 ( 26%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############                                ( 28%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############                               ( 31%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############                              ( 33%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############                             ( 35%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################                            ( 38%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################                           ( 40%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################                          ( 42%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################                         ( 44%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################                        ( 47%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################                       ( 49%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################                      ( 51%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################                     ( 53%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################                    ( 56%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################                   ( 58%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################                  ( 60%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###########################                 ( 63%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10############################                ( 65%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#############################               ( 67%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##############################              ( 69%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###############################             ( 72%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10################################            ( 74%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#################################           ( 76%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##################################          ( 78%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10###################################         ( 81%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10####################################        ( 83%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#####################################       ( 85%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10######################################      ( 88%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#######################################     ( 90%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################    ( 92%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10#########################################   ( 94%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10##########################################  ( 97%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### ( 99%)\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10\10########################################### [100%]
                         /bin/sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         Thank you for installing Chef!
                  D      [SSH] root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
                  sudo_rm="sudo -E rm"
                  dirs="/tmp/kitchen/clients /tmp/kitchen/cookbooks /tmp/kitchen/data /tmp/kitchen/data_bags /tmp/kitchen/encrypted_data_bag_secret /tmp/kitchen/environments /tmp/kitchen/roles"
                  root_path="/tmp/kitchen"

                  $sudo_rm -rf $dirs
                  mkdir -p $root_path
                  ')
                         bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         Transferring files to <fips-integration-centos-6>
                  D      TIMING: scp async upload (Kitchen::Transport::Ssh)
                  D      TIMING: scp async upload (Kitchen::Transport::Ssh) took (0m0.14s)
                  D      Transfer complete
                  D      Attempting to execute command - try 1 of 1.
                  D      [SSH] root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}> (sh -c '
                  sudo -E /opt/chef/bin/chef-client --local-mode --config /tmp/kitchen/client.rb --log_level auto --force-formatter --no-color --json-attributes /tmp/kitchen/dna.json --chef-zero-port 8889
                  ')
                         bash: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         sh: warning: setlocale: LC_ALL: cannot change locale (C.UTF-8)
                         Starting Chef Client, version 12.13.8
                         Creating a new client identity for fips-integration-centos-6 using the validator key.
                         resolving cookbooks for run list: []
                         Synchronizing Cookbooks:
                         Installing Cookbook Gems:
                         Compiling Cookbooks...
                         [2016-07-21T04:10:14+00:00] WARN: Node fips-integration-centos-6 has an empty run list.
                         Converging 0 resources
                         Starting audit phase

                         Finished in 0.00032 seconds (files took 0.38658 seconds to load)
                         0 examples, 0 failures
                         Auditing complete

                         Running handlers:
                         Running handlers complete
                         Chef Client finished, 0/0 resources updated in 03 seconds
                         [2016-07-21T04:10:14+00:00] ERROR: Failed to post audit report to server. Saving report to /tmp/kitchen/cache/failed-audit-data.json
                  D      Cleaning up local sandbox in /tmp/cheftest/fips-integration-centos-6-sandbox-20160721-21168-2nhx28
                         Finished converging <fips-integration-centos-6> (0m13.32s).
                  D      [SSH] shutting previous connection root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [SSH] closing connection to root@10.194.9.186<{:user_known_hosts_file=>"/dev/null", :paranoid=>false, :port=>22, :compression=>false, :compression_level=>0, :keepalive=>true, :keepalive_interval=>60, :timeout=>15, :keys_only=>true, :keys=>["/home/jenkins/.ssh/jenkins.pem"], :auth_methods=>["publickey"], :user=>"root"}>
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                  D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000001d57248 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.2</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                  D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000000043cb208 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">2.0</Version></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version></LST></Obj></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">6.3.9600.17400</Version></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.2</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                  D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000000042bb3b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                  D      [WinRM] remote shell created with shell_id: CC87BBC9-9EDC-4389-B005-95C105A1031C
                  D      [WinRM] Command created for Write-Host '[WinRM] Established
                  ' with id: 9A2B6CC0-22CD-40B1-8EB3-DFA2E33DD5B3
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                         [WinRM] Established

                  D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.12.123:5985/wsman", :user=>"administrator", :password=>"ussS(6;D@$p", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"ussS(6;D@$p", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                  D      [WinRM] <{:endpoint=>"http://10.194.12.123:5985/wsman", :user=>"administrator", :password=>"ussS(6;D@$p", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"ussS(6;D@$p", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File)
                  D      [WinRM] Command created for New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File with id: C38A59C4-EEB4-4F84-B49D-BD307C1825E6
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output


                             Directory: C:\chef\ohai\hints


                         Mode                LastWriteTime     Length Name
                         ----                -------------     ------ ----
                         -a---         7/21/2016   4:10 AM          0 ec2.json


                  D      ec2:create '10.194.12.123'
                         Finished creating <fips-integration-windows-2012r2> (2m0.73s).
                  -----> Converging <fips-integration-windows-2012r2>...
                         Preparing files for transfer
                  D      Creating local sandbox in /tmp/cheftest/fips-integration-windows-2012r2-sandbox-20160721-21168-orerim
                         Preparing dna.json
                  D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                         Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                         Removing non-cookbook files before transfer
                         Preparing validation.pem
                  D      Using a dummy validation.pem
                         Preparing client.rb
                  D      Creating client.rb from {:node_name=>"fips-integration-windows-2012r2", :checksum_path=>"\#{ENV['TEMP']}\\kitchen\\checksums", :file_cache_path=>"\#{ENV['TEMP']}\\kitchen\\cache", :file_backup_path=>"\#{ENV['TEMP']}\\kitchen\\backup", :cookbook_path=>["\#{ENV['TEMP']}\\kitchen\\cookbooks", "\#{ENV['TEMP']}\\kitchen\\site-cookbooks"], :data_bag_path=>"\#{ENV['TEMP']}\\kitchen\\data_bags", :environment_path=>"\#{ENV['TEMP']}\\kitchen\\environments", :node_path=>"\#{ENV['TEMP']}\\kitchen\\nodes", :role_path=>"\#{ENV['TEMP']}\\kitchen\\roles", :client_path=>"\#{ENV['TEMP']}\\kitchen\\clients", :user_path=>"\#{ENV['TEMP']}\\kitchen\\users", :validation_key=>"\#{ENV['TEMP']}\\kitchen\\validation.pem", :client_key=>"\#{ENV['TEMP']}\\kitchen\\client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"\#{ENV['TEMP']}\\kitchen\\encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
                  D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.12.123:5985/wsman", :user=>"administrator", :password=>"ussS(6;D@$p", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"ussS(6;D@$p", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                  D      [WinRM] <{:endpoint=>"http://10.194.12.123:5985/wsman", :user=>"administrator", :password=>"ussS(6;D@$p", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"ussS(6;D@$p", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (new-module -name Omnitruck -scriptblock {
                  function Get-PlatformVersion {
                    switch -regex ((get-wmiobject win32_operatingsystem).version) {
                      '10\.0\.\d+' {$platform_version = '2012r2'}
                      '6\.3\.\d+'  {$platform_version = '2012r2'}
                      '6\.2\.\d+'  {$platform_version = '2012'}
                      '6\.1\.\d+'  {$platform_version = '2008r2'}
                      '6\.0\.\d+'  {$platform_version = '2008'}
                    }
                    return $platform_version
                  }

                  function Get-PlatformArchitecture {
                    if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                      $architecture = 'x86_64'
                    } else {
                      $architecture = 'i386'
                    }
                    return $architecture
                  }

                  function New-Uri {
                    param ($baseuri, $newuri)

                    try {
                    new-object System.Uri $baseuri, $newuri
                    }
                    catch [System.Management.Automation.MethodInvocationException]{
                      Write-Error "$($_.exception.message)"
                      throw $_.exception
                    }
                  }

                  function Get-WebContent {
                    param ($uri, $filepath)
                    $proxy = New-Object -TypeName System.Net.WebProxy
                    $wc = new-object System.Net.WebClient
                    $proxy.Address = $env:http_proxy
                    $wc.Proxy = $proxy

                    try {
                      if ([string]::IsNullOrEmpty($filepath)) {
                        $wc.downloadstring($uri)
                      }
                      else {
                        $wc.downloadfile($uri, $filepath)
                      }
                    }
                    catch {
                      $exception = $_.Exception
                      Write-Host "There was an error: "
                      do {
                        Write-Host "`t$($exception.message)"
                        $exception = $exception.innerexception
                      } while ($exception)
                      throw "Failed to download from $uri."
                    }
                  }

                  function Test-ProjectPackage {
                    [cmdletbinding()]
                    param ($Path, $Algorithm = 'SHA256', $Hash)

                    if (-not (get-command get-filehash))   {
                      function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                      function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                      function Get-FileHash ($Path, $Algorithm) {
                        $Path = (resolve-path $path).providerpath
                        $hash = @{Algorithm = $Algorithm; Path = $Path}
                        use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                          use ($in = (gi $path).OpenRead()) {
                            $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                          }
                        }
                        new-object PSObject -Property $hash
                      }
                    }
                    Write-Verbose "Testing the $Algorithm hash for $path."
                    $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                    Write-Verbose "`tDesired Hash - '$hash'"
                    Write-Verbose "`tActual Hash  - '$ActualHash'"
                    $Valid = $ActualHash -eq $Hash
                    if (-not $Valid) {
                      Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                    }
                    return $Valid
                  }

                  function Get-ProjectMetadata {
                    <#
                      .SYNOPSIS
                      Get metadata for a Chef Software, Inc. project
                      .DESCRIPTION
                      Get metadata for project
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                      Gets the download url and SHA256 checksum for the latest stable release of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                      Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                    #>
                    [cmdletbinding()]
                    param (
                      # Base url to retrieve metadata from.
                      [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                      [string]
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Release channel to install from
                      $channel = 'unstable',
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    # PowerShell is only on Windows ATM
                    $platform = 'windows'
                    Write-Verbose "Platform: $platform"

                    $platform_version = Get-PlatformVersion
                    Write-Verbose "Platform Version: $platform_version"

                    if ($architecture -eq 'auto') {
                      $architecture = Get-PlatformArchitecture
                    }

                    Write-Verbose "Architecture: $architecture"
                    Write-Verbose "Project: $project"


                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                    $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                    $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                      foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                    Write-Verbose "Project details: "
                    foreach ($key in $package_metadata.keys) {
                      Write-Verbose "`t$key = $($package_metadata[$key])"
                    }
                    $package_metadata
                  }

                  function Install-Project {
                    <#
                      .SYNOPSIS
                      Install a Chef Software, Inc. product
                      .DESCRIPTION
                      Install a Chef Software, Inc. product
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                      Installs the latest stable version of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                      Installs the latest integration build of the Chef Development Kit
                    #>
                    [cmdletbinding(SupportsShouldProcess=$true)]
                    param (
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Release channel to install from
                      [validateset('current', 'stable', 'unstable')]
                      [string]
                      $channel = 'stable',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Full path for the downloaded installer.
                      [string]
                      $filename,
                      # Full path to the location to download the installer
                      [string]
                      $download_directory = $env:temp,
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                    if (-not [string]::IsNullOrEmpty($filename)) {
                      $download_directory = split-path $filename
                      $filename = split-path $filename -leaf
                      if ([string]::IsNullOrEmpty($download_directory)) {
                        $download_directory = $pwd
                      }
                    }
                    else {
                      $filename = ($package_metadata.url -split '/')[-1]
                    }
                    Write-Verbose "Download directory: $download_directory"
                    Write-Verbose "Filename: $filename"

                    if (-not (test-path $download_directory)) {
                      mkdir $download_directory
                    }
                    $download_directory = (resolve-path $download_directory).providerpath
                    $download_destination = join-path $download_directory $filename

                    if ((test-path $download_destination) -and
                      (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                      Write-Verbose "Found existing valid installer at $download_destination."
                    }
                    else {
                      if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                        Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                        Get-WebContent $package_metadata.url -filepath $download_destination
                      }
                    }

                    if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                      if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                        Write-Host "Installing $project from $download_destination"
                        $installingProject = $True
                        $installAttempts = 0
                        while ($installingProject) {
                          $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                          $p.WaitForExit()
                          if ($p.ExitCode -eq 1618) {
                            Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                            continue
                          } elseif ($p.ExitCode -ne 0) {
                            throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                          }
                          $installingProject = $False
                        }
                      }
                      else {
                        throw "Failed to validate the downloaded installer for $project."
                      }
                    }
                  }
                  set-alias install -value Install-Project
                  export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                  }

                  install -project chef -version 12.13.8+20160721014124 -channel unstable
                  )
                  D      [WinRM] Command created for new-module -name Omnitruck -scriptblock {
                  function Get-PlatformVersion {
                    switch -regex ((get-wmiobject win32_operatingsystem).version) {
                      '10\.0\.\d+' {$platform_version = '2012r2'}
                      '6\.3\.\d+'  {$platform_version = '2012r2'}
                      '6\.2\.\d+'  {$platform_version = '2012'}
                      '6\.1\.\d+'  {$platform_version = '2008r2'}
                      '6\.0\.\d+'  {$platform_version = '2008'}
                    }
                    return $platform_version
                  }

                  function Get-PlatformArchitecture {
                    if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                      $architecture = 'x86_64'
                    } else {
                      $architecture = 'i386'
                    }
                    return $architecture
                  }

                  function New-Uri {
                    param ($baseuri, $newuri)

                    try {
                    new-object System.Uri $baseuri, $newuri
                    }
                    catch [System.Management.Automation.MethodInvocationException]{
                      Write-Error "$($_.exception.message)"
                      throw $_.exception
                    }
                  }

                  function Get-WebContent {
                    param ($uri, $filepath)
                    $proxy = New-Object -TypeName System.Net.WebProxy
                    $wc = new-object System.Net.WebClient
                    $proxy.Address = $env:http_proxy
                    $wc.Proxy = $proxy

                    try {
                      if ([string]::IsNullOrEmpty($filepath)) {
                        $wc.downloadstring($uri)
                      }
                      else {
                        $wc.downloadfile($uri, $filepath)
                      }
                    }
                    catch {
                      $exception = $_.Exception
                      Write-Host "There was an error: "
                      do {
                        Write-Host "`t$($exception.message)"
                        $exception = $exception.innerexception
                      } while ($exception)
                      throw "Failed to download from $uri."
                    }
                  }

                  function Test-ProjectPackage {
                    [cmdletbinding()]
                    param ($Path, $Algorithm = 'SHA256', $Hash)

                    if (-not (get-command get-filehash))   {
                      function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                      function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                      function Get-FileHash ($Path, $Algorithm) {
                        $Path = (resolve-path $path).providerpath
                        $hash = @{Algorithm = $Algorithm; Path = $Path}
                        use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                          use ($in = (gi $path).OpenRead()) {
                            $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                          }
                        }
                        new-object PSObject -Property $hash
                      }
                    }
                    Write-Verbose "Testing the $Algorithm hash for $path."
                    $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                    Write-Verbose "`tDesired Hash - '$hash'"
                    Write-Verbose "`tActual Hash  - '$ActualHash'"
                    $Valid = $ActualHash -eq $Hash
                    if (-not $Valid) {
                      Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                    }
                    return $Valid
                  }

                  function Get-ProjectMetadata {
                    <#
                      .SYNOPSIS
                      Get metadata for a Chef Software, Inc. project
                      .DESCRIPTION
                      Get metadata for project
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                      Gets the download url and SHA256 checksum for the latest stable release of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                      Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                    #>
                    [cmdletbinding()]
                    param (
                      # Base url to retrieve metadata from.
                      [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                      [string]
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Release channel to install from
                      $channel = 'unstable',
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    # PowerShell is only on Windows ATM
                    $platform = 'windows'
                    Write-Verbose "Platform: $platform"

                    $platform_version = Get-PlatformVersion
                    Write-Verbose "Platform Version: $platform_version"

                    if ($architecture -eq 'auto') {
                      $architecture = Get-PlatformArchitecture
                    }

                    Write-Verbose "Architecture: $architecture"
                    Write-Verbose "Project: $project"


                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                    $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                    $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                      foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                    Write-Verbose "Project details: "
                    foreach ($key in $package_metadata.keys) {
                      Write-Verbose "`t$key = $($package_metadata[$key])"
                    }
                    $package_metadata
                  }

                  function Install-Project {
                    <#
                      .SYNOPSIS
                      Install a Chef Software, Inc. product
                      .DESCRIPTION
                      Install a Chef Software, Inc. product
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                      Installs the latest stable version of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                      Installs the latest integration build of the Chef Development Kit
                    #>
                    [cmdletbinding(SupportsShouldProcess=$true)]
                    param (
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Release channel to install from
                      [validateset('current', 'stable', 'unstable')]
                      [string]
                      $channel = 'stable',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Full path for the downloaded installer.
                      [string]
                      $filename,
                      # Full path to the location to download the installer
                      [string]
                      $download_directory = $env:temp,
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                    if (-not [string]::IsNullOrEmpty($filename)) {
                      $download_directory = split-path $filename
                      $filename = split-path $filename -leaf
                      if ([string]::IsNullOrEmpty($download_directory)) {
                        $download_directory = $pwd
                      }
                    }
                    else {
                      $filename = ($package_metadata.url -split '/')[-1]
                    }
                    Write-Verbose "Download directory: $download_directory"
                    Write-Verbose "Filename: $filename"

                    if (-not (test-path $download_directory)) {
                      mkdir $download_directory
                    }
                    $download_directory = (resolve-path $download_directory).providerpath
                    $download_destination = join-path $download_directory $filename

                    if ((test-path $download_destination) -and
                      (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                      Write-Verbose "Found existing valid installer at $download_destination."
                    }
                    else {
                      if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                        Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                        Get-WebContent $package_metadata.url -filepath $download_destination
                      }
                    }

                    if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                      if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                        Write-Host "Installing $project from $download_destination"
                        $installingProject = $True
                        $installAttempts = 0
                        while ($installingProject) {
                          $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                          $p.WaitForExit()
                          if ($p.ExitCode -eq 1618) {
                            Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                            continue
                          } elseif ($p.ExitCode -ne 0) {
                            throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                          }
                          $installingProject = $False
                        }
                      }
                      else {
                        throw "Failed to validate the downloaded installer for $project."
                      }
                    }
                  }
                  set-alias install -value Install-Project
                  export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                  }

                  install -project chef -version 12.13.8+20160721014124 -channel unstable
                   with id: FA8ADA0B-D404-434E-B941-93E0ECA6FBD6
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output

                         ModuleType Version    Name                                ExportedCommands
                         ---------- -------    ----                                ----------------
                         Script     0.0        Omnitruck                           {Get-ProjectMetada...
                  D      [WinRM] Waiting for output...
                  D      Cleaning up local sandbox in /tmp/cheftest/fips-integration-windows-2012r2-sandbox-20160721-21168-orerim
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                  D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000004136358 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.2</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                  D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000004025838 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">2.0</Version></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version></LST></Obj></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">6.3.9600.17400</Version></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.2</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                  D      [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000003f348c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
                  D      [WinRM] remote shell created with shell_id: A53C76D4-D8A8-4A0C-B255-C8C5EF54F5C9
                  D      [WinRM] Command created for Write-Host '[WinRM] Established
                  ' with id: 52DE39C0-4A63-46CB-A886-98F6A17567FB
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output
                         [WinRM] Established

                  D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.13.35:5985/wsman", :user=>"administrator", :password=>"A8=ria;bCb.", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"A8=ria;bCb.", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                  D      [WinRM] <{:endpoint=>"http://10.194.13.35:5985/wsman", :user=>"administrator", :password=>"A8=ria;bCb.", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"A8=ria;bCb.", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File)
                  D      [WinRM] Command created for New-Item -Force C:\chef\ohai\hints\ec2.json -ItemType File with id: A55131FA-2314-4B39-AC69-D47D3DB02CDB
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output


                             Directory: C:\chef\ohai\hints


                         Mode                LastWriteTime     Length Name
                         ----                -------------     ------ ----
                         -a---         7/21/2016   4:10 AM          0 ec2.json


                  D      ec2:create '10.194.13.35'
                         Finished creating <fips-unit-functional-windows-2012r2> (2m20.98s).
                  -----> Converging <fips-unit-functional-windows-2012r2>...
                         Preparing files for transfer
                  D      Creating local sandbox in /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160721-21168-etwy1n
                         Preparing dna.json
                  D      Creating dna.json from {:chef_acceptance=>"true", :use_system_chef=>"true", :run_list=>[]}
                         Berksfile, Cheffile, cookbooks/, or metadata.rb not found so Chef will run with effectively no cookbooks. Is this intended?
                         Removing non-cookbook files before transfer
                         Preparing validation.pem
                  D      Using a dummy validation.pem
                         Preparing client.rb
                  D      Creating client.rb from {:node_name=>"fips-unit-functional-windows-2012r2", :checksum_path=>"\#{ENV['TEMP']}\\kitchen\\checksums", :file_cache_path=>"\#{ENV['TEMP']}\\kitchen\\cache", :file_backup_path=>"\#{ENV['TEMP']}\\kitchen\\backup", :cookbook_path=>["\#{ENV['TEMP']}\\kitchen\\cookbooks", "\#{ENV['TEMP']}\\kitchen\\site-cookbooks"], :data_bag_path=>"\#{ENV['TEMP']}\\kitchen\\data_bags", :environment_path=>"\#{ENV['TEMP']}\\kitchen\\environments", :node_path=>"\#{ENV['TEMP']}\\kitchen\\nodes", :role_path=>"\#{ENV['TEMP']}\\kitchen\\roles", :client_path=>"\#{ENV['TEMP']}\\kitchen\\clients", :user_path=>"\#{ENV['TEMP']}\\kitchen\\users", :validation_key=>"\#{ENV['TEMP']}\\kitchen\\validation.pem", :client_key=>"\#{ENV['TEMP']}\\kitchen\\client.pem", :chef_server_url=>"http://127.0.0.1:8889", :encrypted_data_bag_secret=>"\#{ENV['TEMP']}\\kitchen\\encrypted_data_bag_secret", :audit_mode=>":enabled", :named_run_list=>{}}
                  D      [WinRM] reusing existing connection <{:endpoint=>"http://10.194.13.35:5985/wsman", :user=>"administrator", :password=>"A8=ria;bCb.", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"A8=ria;bCb.", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}>
                  D      [WinRM] <{:endpoint=>"http://10.194.13.35:5985/wsman", :user=>"administrator", :password=>"A8=ria;bCb.", :transport=>:negotiate, :elevated_username=>"administrator", :elevated_password=>"A8=ria;bCb.", :no_ssl_peer_verification=>true, :disable_sspi=>false, :basic_auth_only=>false}> (new-module -name Omnitruck -scriptblock {
                  function Get-PlatformVersion {
                    switch -regex ((get-wmiobject win32_operatingsystem).version) {
                      '10\.0\.\d+' {$platform_version = '2012r2'}
                      '6\.3\.\d+'  {$platform_version = '2012r2'}
                      '6\.2\.\d+'  {$platform_version = '2012'}
                      '6\.1\.\d+'  {$platform_version = '2008r2'}
                      '6\.0\.\d+'  {$platform_version = '2008'}
                    }
                    return $platform_version
                  }

                  function Get-PlatformArchitecture {
                    if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                      $architecture = 'x86_64'
                    } else {
                      $architecture = 'i386'
                    }
                    return $architecture
                  }

                  function New-Uri {
                    param ($baseuri, $newuri)

                    try {
                    new-object System.Uri $baseuri, $newuri
                    }
                    catch [System.Management.Automation.MethodInvocationException]{
                      Write-Error "$($_.exception.message)"
                      throw $_.exception
                    }
                  }

                  function Get-WebContent {
                    param ($uri, $filepath)
                    $proxy = New-Object -TypeName System.Net.WebProxy
                    $wc = new-object System.Net.WebClient
                    $proxy.Address = $env:http_proxy
                    $wc.Proxy = $proxy

                    try {
                      if ([string]::IsNullOrEmpty($filepath)) {
                        $wc.downloadstring($uri)
                      }
                      else {
                        $wc.downloadfile($uri, $filepath)
                      }
                    }
                    catch {
                      $exception = $_.Exception
                      Write-Host "There was an error: "
                      do {
                        Write-Host "`t$($exception.message)"
                        $exception = $exception.innerexception
                      } while ($exception)
                      throw "Failed to download from $uri."
                    }
                  }

                  function Test-ProjectPackage {
                    [cmdletbinding()]
                    param ($Path, $Algorithm = 'SHA256', $Hash)

                    if (-not (get-command get-filehash))   {
                      function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                      function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                      function Get-FileHash ($Path, $Algorithm) {
                        $Path = (resolve-path $path).providerpath
                        $hash = @{Algorithm = $Algorithm; Path = $Path}
                        use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                          use ($in = (gi $path).OpenRead()) {
                            $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                          }
                        }
                        new-object PSObject -Property $hash
                      }
                    }
                    Write-Verbose "Testing the $Algorithm hash for $path."
                    $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                    Write-Verbose "`tDesired Hash - '$hash'"
                    Write-Verbose "`tActual Hash  - '$ActualHash'"
                    $Valid = $ActualHash -eq $Hash
                    if (-not $Valid) {
                      Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                    }
                    return $Valid
                  }

                  function Get-ProjectMetadata {
                    <#
                      .SYNOPSIS
                      Get metadata for a Chef Software, Inc. project
                      .DESCRIPTION
                      Get metadata for project
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                      Gets the download url and SHA256 checksum for the latest stable release of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                      Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                    #>
                    [cmdletbinding()]
                    param (
                      # Base url to retrieve metadata from.
                      [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                      [string]
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Release channel to install from
                      $channel = 'unstable',
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    # PowerShell is only on Windows ATM
                    $platform = 'windows'
                    Write-Verbose "Platform: $platform"

                    $platform_version = Get-PlatformVersion
                    Write-Verbose "Platform Version: $platform_version"

                    if ($architecture -eq 'auto') {
                      $architecture = Get-PlatformArchitecture
                    }

                    Write-Verbose "Architecture: $architecture"
                    Write-Verbose "Project: $project"


                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                    $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                    $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                      foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                    Write-Verbose "Project details: "
                    foreach ($key in $package_metadata.keys) {
                      Write-Verbose "`t$key = $($package_metadata[$key])"
                    }
                    $package_metadata
                  }

                  function Install-Project {
                    <#
                      .SYNOPSIS
                      Install a Chef Software, Inc. product
                      .DESCRIPTION
                      Install a Chef Software, Inc. product
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                      Installs the latest stable version of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                      Installs the latest integration build of the Chef Development Kit
                    #>
                    [cmdletbinding(SupportsShouldProcess=$true)]
                    param (
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Release channel to install from
                      [validateset('current', 'stable', 'unstable')]
                      [string]
                      $channel = 'stable',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Full path for the downloaded installer.
                      [string]
                      $filename,
                      # Full path to the location to download the installer
                      [string]
                      $download_directory = $env:temp,
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                    if (-not [string]::IsNullOrEmpty($filename)) {
                      $download_directory = split-path $filename
                      $filename = split-path $filename -leaf
                      if ([string]::IsNullOrEmpty($download_directory)) {
                        $download_directory = $pwd
                      }
                    }
                    else {
                      $filename = ($package_metadata.url -split '/')[-1]
                    }
                    Write-Verbose "Download directory: $download_directory"
                    Write-Verbose "Filename: $filename"

                    if (-not (test-path $download_directory)) {
                      mkdir $download_directory
                    }
                    $download_directory = (resolve-path $download_directory).providerpath
                    $download_destination = join-path $download_directory $filename

                    if ((test-path $download_destination) -and
                      (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                      Write-Verbose "Found existing valid installer at $download_destination."
                    }
                    else {
                      if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                        Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                        Get-WebContent $package_metadata.url -filepath $download_destination
                      }
                    }

                    if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                      if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                        Write-Host "Installing $project from $download_destination"
                        $installingProject = $True
                        $installAttempts = 0
                        while ($installingProject) {
                          $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                          $p.WaitForExit()
                          if ($p.ExitCode -eq 1618) {
                            Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                            continue
                          } elseif ($p.ExitCode -ne 0) {
                            throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                          }
                          $installingProject = $False
                        }
                      }
                      else {
                        throw "Failed to validate the downloaded installer for $project."
                      }
                    }
                  }
                  set-alias install -value Install-Project
                  export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                  }

                  install -project chef -version 12.13.8+20160721014124 -channel unstable
                  )
                  D      [WinRM] Command created for new-module -name Omnitruck -scriptblock {
                  function Get-PlatformVersion {
                    switch -regex ((get-wmiobject win32_operatingsystem).version) {
                      '10\.0\.\d+' {$platform_version = '2012r2'}
                      '6\.3\.\d+'  {$platform_version = '2012r2'}
                      '6\.2\.\d+'  {$platform_version = '2012'}
                      '6\.1\.\d+'  {$platform_version = '2008r2'}
                      '6\.0\.\d+'  {$platform_version = '2008'}
                    }
                    return $platform_version
                  }

                  function Get-PlatformArchitecture {
                    if ((get-wmiobject win32_operatingsystem).osarchitecture -like '64-bit') {
                      $architecture = 'x86_64'
                    } else {
                      $architecture = 'i386'
                    }
                    return $architecture
                  }

                  function New-Uri {
                    param ($baseuri, $newuri)

                    try {
                    new-object System.Uri $baseuri, $newuri
                    }
                    catch [System.Management.Automation.MethodInvocationException]{
                      Write-Error "$($_.exception.message)"
                      throw $_.exception
                    }
                  }

                  function Get-WebContent {
                    param ($uri, $filepath)
                    $proxy = New-Object -TypeName System.Net.WebProxy
                    $wc = new-object System.Net.WebClient
                    $proxy.Address = $env:http_proxy
                    $wc.Proxy = $proxy

                    try {
                      if ([string]::IsNullOrEmpty($filepath)) {
                        $wc.downloadstring($uri)
                      }
                      else {
                        $wc.downloadfile($uri, $filepath)
                      }
                    }
                    catch {
                      $exception = $_.Exception
                      Write-Host "There was an error: "
                      do {
                        Write-Host "`t$($exception.message)"
                        $exception = $exception.innerexception
                      } while ($exception)
                      throw "Failed to download from $uri."
                    }
                  }

                  function Test-ProjectPackage {
                    [cmdletbinding()]
                    param ($Path, $Algorithm = 'SHA256', $Hash)

                    if (-not (get-command get-filehash))   {
                      function disposable($o){($o -is [IDisposable]) -and (($o | get-member | foreach-object {$_.name}) -contains 'Dispose')}
                      function use($obj, [scriptblock]$sb){try {& $sb} catch [exception]{throw $_} finally {if (disposable $obj) {$obj.Dispose()}} }
                      function Get-FileHash ($Path, $Algorithm) {
                        $Path = (resolve-path $path).providerpath
                        $hash = @{Algorithm = $Algorithm; Path = $Path}
                        use ($c = New-Object -TypeName Security.Cryptography.SHA256Managed) {
                          use ($in = (gi $path).OpenRead()) {
                            $hash.Hash = ([BitConverter]::ToString($c.ComputeHash($in))).Replace("-", "").ToUpper()
                          }
                        }
                        new-object PSObject -Property $hash
                      }
                    }
                    Write-Verbose "Testing the $Algorithm hash for $path."
                    $ActualHash = (Get-FileHash -Algorithm $Algorithm -Path $Path).Hash.ToLower()
                    Write-Verbose "`tDesired Hash - '$hash'"
                    Write-Verbose "`tActual Hash  - '$ActualHash'"
                    $Valid = $ActualHash -eq $Hash
                    if (-not $Valid) {
                      Write-Error "Failed to validate the downloaded installer.  The expected $Algorithm hash was '$Hash' and the actual hash was '$ActualHash' for $path"
                    }
                    return $Valid
                  }

                  function Get-ProjectMetadata {
                    <#
                      .SYNOPSIS
                      Get metadata for a Chef Software, Inc. project
                      .DESCRIPTION
                      Get metadata for project
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chef -channel stable

                      Gets the download url and SHA256 checksum for the latest stable release of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Get-ProjectMetadata -project chefdk -channel stable -version 0.8.0

                      Gets the download url, and SHA256 checksum for ChefDK 0.8.0.
                    #>
                    [cmdletbinding()]
                    param (
                      # Base url to retrieve metadata from.
                      [uri]$base_server_uri = 'https://omnitruck.chef.io/',
                      [string]
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Release channel to install from
                      $channel = 'unstable',
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    # PowerShell is only on Windows ATM
                    $platform = 'windows'
                    Write-Verbose "Platform: $platform"

                    $platform_version = Get-PlatformVersion
                    Write-Verbose "Platform Version: $platform_version"

                    if ($architecture -eq 'auto') {
                      $architecture = Get-PlatformArchitecture
                    }

                    Write-Verbose "Architecture: $architecture"
                    Write-Verbose "Project: $project"


                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.9/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.9/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.10/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.10/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/mac_os_x/10.11/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/mac_os_x/10.11/chef-12.13.8+20160721014124-1.dmg" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9658c58732c3474bbfc02293d18a8ad0005011a6365241d654ef3778ac02a0c0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_ppc64el.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 d022414db345785abc021aeae3d423c3629ed4fd8b96b9d9462fdb659f0ecee0" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ios_xr/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ios_xr/6/chef-12.13.8+20160721014124-1.ios_xr6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 3367768d792b134d4b9dd4e500dacdd8e82a2870be33a3c1eae845a69a69380e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/nexus/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/nexus/7/chef-12.13.8+20160721014124-1.nexus7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 96050b02bc6a51e3519e7cfd68bae90791dcdc668252bcd20d983895742f7da3" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 80d6fabfdf5524dd5f0a29120a22e4934796726973e353d0822fa2b26e06853e" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.i386.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1743646b1c28a2769fb5e4425369f28b78a749c6d4f7ad770fa32ec5705e83c4" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 da9b5b8777578597d38002d2ccd57200f1cb3992a7ea6a9effbecbf64f59086c" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 a54ca2c7dcaf720d61e4c0760beee8d063e2879e4a66cb1cb07554fac5d7199b" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.i386.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 1ccac18778042df857f76282c06b2b35d269bf6400e1448020ec102e35d00059" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 20dfe52721f8fa4e472c6f4b72415194efb6fbd8d5413ab344dff4e03c36d8ff" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/ppc64le"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.ppc64le.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 c2e753ccf1b24b76ed6b5fbd6c95ea6eb17b003a4b04ebaf7365e14fdfd3cc50" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 52be43e74de9f5e587bfa322ccc3dbec931ecee8c42bbb808e80a8febf4e5179" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/6/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/7/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/debian/8/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/debian/8/chef_12.13.8+20160721014124-1_amd64.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 07175cd7dab329a6acde9331aa5b74f699ff731bb996cbaa3776eebc81382fb6" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/10/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/10/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 8163334db9f7ea174dfff2b38ab4a841829dabc7103816cef5980512943e6a41" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/i386"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x86.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 74f960b6437c99aba57e29a49ce9f9848f5dd3b341e0d0bbece01edfa50ff40d" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/6/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/6/chef-12.13.8+20160721014124-1.el6.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 833b0c25a970651569883f7d62f80ac30181529ba0d1c7058e2edff2477084b9" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2008r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2008r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/windows/2012r2/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/windows/2012r2/chef-client-12.13.8+20160721014124-1-x64.msi" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 46e00dab020b66d47d0aee2c00825dd8a0b4555e35f75b5ccd9333dbeb4987dc" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/6.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/6.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/aix/7.1/powerpc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/aix/7.1/chef-12.13.8+20160721014124-1.powerpc.bff" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 b83bdff4c459259d4749be64aed3224b3ecaf10fdfebbf3a96e7b3f664b45773" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.i386.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 2c9947c02f6a9281a95d049a4a040cd3c394a214110aa63a1915ffd4f56168cb" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/12.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/12.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/ubuntu/14.04/i686"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/ubuntu/14.04/chef_12.13.8+20160721014124-1_i386.deb" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 9a78b0da13bcb1e0d7183681b3a576bbd143e827ef954e569edf34d04bcf365f" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/7/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/7/chef-12.13.8+20160721014124-1.el7.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 ace440edac44f3853df15c608f3f5418f91bb21f748b68facd7c53c5e18e6959" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/el/5/x86_64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/el/5/chef-12.13.8+20160721014124-1.el5.x86_64.rpm" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 120cffbc3ab8470cd4e4b23c4d0e6758f1b499e99e617967b57e282732ca6717" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/freebsd/9/amd64"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/freebsd/9/chef-12.13.8+20160721014124_1.amd64.sh" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 4f914f36d62e7e9374a1292eac7078f5a63517c57a459749a2bed7321c217797" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.10/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.10/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append

                      $artifact_info_dir = "$($env:temp)/artifact_info/solaris2/5.11/sparc"
                      New-Item -ItemType directory -Path $artifact_info_dir -force
                      New-Item -ItemType file "$($artifact_info_dir)/artifact_info" -force
                      "url http://artifactory.chef.co:8081/omnibus-unstable-local/com/getchef/chef/12.13.8+20160721014124/solaris2/5.11/chef-12.13.8+20160721014124-1.sparc.solaris" | out-file "$artifact_info_dir/artifact_info"
                      "sha256 615e8b9e6d06f7b4d62e1f692ff8117753aff841b222e50a4a6b38d8b5f8fd16" | out-file "$artifact_info_dir/artifact_info" -Append


                    $artifact_info_for_platform = Get-Content "$($env:temp)/artifact_info/$($platform)/$($platform_version)/$($architecture)/artifact_info"

                    $package_metadata = ($artifact_info_for_platform).trim() -split '\n' |
                      foreach { $hash = @{} } {$key, $value = $_ -split '\s+'; $hash.Add($key, $value)} {$hash}

                    Write-Verbose "Project details: "
                    foreach ($key in $package_metadata.keys) {
                      Write-Verbose "`t$key = $($package_metadata[$key])"
                    }
                    $package_metadata
                  }

                  function Install-Project {
                    <#
                      .SYNOPSIS
                      Install a Chef Software, Inc. product
                      .DESCRIPTION
                      Install a Chef Software, Inc. product
                      .EXAMPLE
                      iex (new-object net.webclient).downloadstring('https://omnitruck.chef.io/install.ps1'); Install-Project -project chef -channel stable

                      Installs the latest stable version of Chef.
                      .EXAMPLE
                      iex (irm 'https://omnitruck.chef.io/install.ps1'); Install-Project -project chefdk -channel current

                      Installs the latest integration build of the Chef Development Kit
                    #>
                    [cmdletbinding(SupportsShouldProcess=$true)]
                    param (
                      # Project to install
                      [string]
                      $project = 'chef',
                      # Release channel to install from
                      [validateset('current', 'stable', 'unstable')]
                      [string]
                      $channel = 'stable',
                      # Version of the application to install
                      # This parameter is optional, if not supplied it will provide the latest version,
                      # and if an iteration number is not specified, it will grab the latest available iteration.
                      # Partial version numbers are also acceptable (using v=11
                      # will grab the latest 11.x client which matches the other flags).
                      [string]
                      $version,
                      # Full path for the downloaded installer.
                      [string]
                      $filename,
                      # Full path to the location to download the installer
                      [string]
                      $download_directory = $env:temp,
                      # The following legacy switches are just aliases for the current channel
                      [switch]
                      $prerelease,
                      [switch]
                      $nightlies,
                      [validateset('auto', 'i386', 'x86_64')]
                      [string]
                      $architecture = 'auto'
                    )

                    $package_metadata = Get-ProjectMetadata -project $project -channel $channel -version $version -prerelease:$prerelease -nightlies:$nightlies -architecture $architecture

                    if (-not [string]::IsNullOrEmpty($filename)) {
                      $download_directory = split-path $filename
                      $filename = split-path $filename -leaf
                      if ([string]::IsNullOrEmpty($download_directory)) {
                        $download_directory = $pwd
                      }
                    }
                    else {
                      $filename = ($package_metadata.url -split '/')[-1]
                    }
                    Write-Verbose "Download directory: $download_directory"
                    Write-Verbose "Filename: $filename"

                    if (-not (test-path $download_directory)) {
                      mkdir $download_directory
                    }
                    $download_directory = (resolve-path $download_directory).providerpath
                    $download_destination = join-path $download_directory $filename

                    if ((test-path $download_destination) -and
                      (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256 -ea SilentlyContinue)){
                      Write-Verbose "Found existing valid installer at $download_destination."
                    }
                    else {
                      if ($pscmdlet.ShouldProcess("$($package_metadata.url)", "Download $project")) {
                        Write-Verbose "Downloading $project from $($package_metadata.url) to $download_destination."
                        Get-WebContent $package_metadata.url -filepath $download_destination
                      }
                    }

                    if ($pscmdlet.ShouldProcess("$download_destination", "Installing")){
                      if (Test-ProjectPackage -Path $download_destination -Algorithm 'SHA256' -Hash $package_metadata.sha256) {
                        Write-Host "Installing $project from $download_destination"
                        $installingProject = $True
                        $installAttempts = 0
                        while ($installingProject) {
                          $p = Start-Process -FilePath "msiexec" -ArgumentList "/qn /i $download_destination" -Passthru -Wait
                          $p.WaitForExit()
                          if ($p.ExitCode -eq 1618) {
                            Write-Host "Another msi install is in progress (exit code 1618), retrying ($($installAttempts))..."
                            continue
                          } elseif ($p.ExitCode -ne 0) {
                            throw "msiexec was not successful. Received exit code $($p.ExitCode)"
                          }
                          $installingProject = $False
                        }
                      }
                      else {
                        throw "Failed to validate the downloaded installer for $project."
                      }
                    }
                  }
                  set-alias install -value Install-Project
                  export-modulemember -function 'Install-Project','Get-ProjectMetadata' -alias 'install'

                  }

                  install -project chef -version 12.13.8+20160721014124 -channel unstable
                   with id: D26CAAA3-B143-4C43-A7E7-55C89F397410
                  D      [WinRM] Waiting for output...
                  D      [WinRM] Processing output

                         ModuleType Version    Name                                ExportedCommands
                         ---------- -------    ----                                ----------------
                         Script     0.0        Omnitruck                           {Get-ProjectMetada...
                  D      [WinRM] Waiting for output...
                  D      Cleaning up local sandbox in /tmp/cheftest/fips-unit-functional-windows-2012r2-sandbox-20160721-21168-etwy1n
                  D      ------Exception-------
                  D      Class: Kitchen::ActionFailed
                  D      Message: 2 actions failed.
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:187:in `report_errors'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:178:in `run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:39:in `block in call'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:37:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:56:in `perform'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:184:in `block (2 levels) in <class:CLI>'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/command.rb:27:in `run'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/invocation.rb:126:in `invoke_command'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:325:in `invoke_task'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor.rb:359:in `dispatch'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/base.rb:440:in `start'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `block in <top (required)>'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/errors.rb:174:in `with_friendly_errors'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `<top (required)>'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `load'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `<top (required)>'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `load'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `kernel_load'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:24:in `run'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:304:in `exec'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor.rb:359:in `dispatch'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/base.rb:440:in `start'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:11:in `start'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:27:in `block in <top (required)>'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/friendly_errors.rb:98:in `with_friendly_errors'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:19:in `<top (required)>'
                  D      /opt/chefdk/embedded/bin/bundle:22:in `load'
                  D      /opt/chefdk/embedded/bin/bundle:22:in `<main>'
                  D      ----End Backtrace-----
                  D      -Composite Exception--
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:138:in `converge'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                  D      ----End Backtrace-----
                  D      ---Nested Exception---
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:138:in `converge'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                  D      ----End Backtrace-----
                  D      -Composite Exception--
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:138:in `converge'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                  D      ----End Backtrace-----
                  D      ---Nested Exception---
                  D      Class: Kitchen::ActionFailed
                  D      Message: Failed to complete #converge action: [Bad HTTP response returned from server (500).]
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:90:in `raise_transport_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:54:in `raise_if_error'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/response_handler.rb:36:in `parse_to_xml'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/http/transport.rb:186:in `send_request'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:144:in `cleanup_command'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `ensure in with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:127:in `with_command_shell'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/winrm-31dbcbb163a5/lib/winrm/shells/base.rb:75:in `run'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:218:in `execute_with_exit_code'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:100:in `execute'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:72:in `block in call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:478:in `reuse_connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/transport/winrm.rb:72:in `connection'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/provisioner/base.rb:71:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:373:in `block in converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:369:in `converge_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:138:in `converge'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                  D      ----End Backtrace-----
                  STDERR: >>>>>> ------Exception-------
                  >>>>>> Class: Kitchen::ActionFailed
                  >>>>>> Message: 2 actions failed.
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-integration-windows-2012r2
                  >>>>>>     Failed to complete #converge action: [Bad HTTP response returned from server (500).] on fips-unit-functional-windows-2012r2
                  >>>>>> ----------------------
                  >>>>>> Please see .kitchen/logs/kitchen.log for more details
                  >>>>>> Also try running `kitchen diagnose --all` for configuration
                  ---- End output of bundle exec kitchen converge  -c -l debug ----
                  Ran bundle exec kitchen converge  -c -l debug returned 20

                  Cookbook Trace:
                  ---------------
                  /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                  Resource Declaration:
                  ---------------------
                  # In /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb

                    1: kitchen "converge"

                  Compiled Resource:
                  ------------------
                  # Declared in /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/cookbooks/acceptance-cookbook/recipes/provision.rb:1:in `from_file'

                  kitchen("converge") do
                    action [:run]
                    retries 0
                    retry_delay 2
                    default_guard_interpreter :default
                    declared_type :kitchen
                    cookbook_name "acceptance-cookbook"
                    recipe_name "provision"
                    chef_product "chef"
                    kitchen_dir "/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/fips"
                    command "converge"
                    kitchen_options "-c -l debug"
                  end

                  Platform:
                  ---------
                  x86_64-linux

              Starting audit phase
            24850: |2

              Running handlers:
              [2016-07-21T04:10:42+00:00] ERROR: Running exception handlers
              Running handlers complete
              [2016-07-21T04:10:42+00:00] ERROR: Exception handlers complete
              Chef Client failed. 0 resources updated in 02 minutes 30 seconds
              [2016-07-21T04:10:42+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/failed-audit-data.json
              [2016-07-21T04:10:42+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/cache/chef-stacktrace.out
              [2016-07-21T04:10:42+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
              [2016-07-21T04:10:42+00:00] ERROR: Found 1 errors, they are stored in the backtrace
              [2016-07-21T04:10:43+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
              STDERR:
              ---- End output of chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/dna.json -o acceptance-cookbook::provision --no-color ----
              Ran chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/fips/provision/dna.json -o acceptance-cookbook::provision --no-color returned 1
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:289:in `invalid!'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:276:in `error!'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:53:in `block in run!'
              /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `block in with_clean_env'
              /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:447:in `with_env'
              /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `with_clean_env'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:42:in `run!'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:149:in `run_command'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:116:in `block in run_suite'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `each'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `run_suite'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:76:in `block (2 levels) in start_worker'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `loop'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `block in start_worker'
              CHEF-ACCEPTANCE::[2016-07-21 04:10:44 +0000] --force-destroy specified so attempting to run the destroy recipe
              FIPS::DESTROY::[2016-07-21 04:10:44 +0000] Initialized [/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/logs/fips/destroy.log] logger...
            25121: |2
                    Cookbook Trace:
                    ---------------
                    /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                    Resource Declaration:
            25174: |2

              WINDOWS-SERVICE::VERIFY::[2016-07-21 04:11:10 +0000]
                  ================================================================================
                  Error executing action `run` on resource 'kitchen[verify]'
                  ================================================================================

                  Mixlib::ShellOut::ShellCommandFailed
                  ------------------------------------
                  ruby_block[copy_kitchen_logs_to_data_path] (/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb line 39) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '20'
                  ---- Begin output of bundle exec kitchen verify  -c -l debug ----
                  STDOUT: -----> Starting Kitchen (v1.10.2)
                  D      winrm requested, loading winrm gem (["~> 2.0"])
                  D      winrm is loaded.
                  D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                  D      winrm-fs is loaded.
                  -----> Setting up <chef-windows-service-windows-2012r2>...
                         Finished setting up <chef-windows-service-windows-2012r2> (0m0.00s).
                  -----> Verifying <chef-windows-service-windows-2012r2>...
                  D      Initialize InSpec
                         Detected alternative framework tests for `inspec`
                         Use `/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/windows-service/test/integration/chef-windows-service/inspec` for testing
                  D      Running tests from: ["/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/windows-service/test/integration/chef-windows-service/inspec"]

                  Target:  winrm://administrator@http://10.194.12.130:5985/wsman:3389

                  \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager should exist\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Service chef-client should not be enabled\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a install exit_status should eq 0\33[0m
                  \33[31m  \357\277\275\357\277\275\357\277\275  Service chef-client should be enabledexpected that `Service chef-client` is enabled\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a start exit_status should eq 0\33[0m
                  \33[31m  \357\277\275\357\277\275\357\277\275  Service chef-client should be enabledexpected that `Service chef-client` is enabled\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a stop exit_status should eq 0\33[0m
                  \33[31m  \357\277\275\357\277\275\357\277\275  Service chef-client should be enabledexpected that `Service chef-client` is enabled\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a uninstall exit_status should eq 0\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Service chef-client should not be enabled\33[0m

                  Summary:  14 successful   11 failures    0 skipped
                  D      ------Exception-------
                  D      Class: Kitchen::ActionFailed
                  D      Message: 1 actions failed.
                  >>>>>>     Verify failed on instance <chef-windows-service-windows-2012r2>.  Please see .kitchen/logs/chef-windows-service-windows-2012r2.log for more details
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:187:in `report_errors'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:178:in `run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:39:in `block in call'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:37:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/pro
              WINDOWS-SERVICE::VERIFY::[2016-07-21 04:11:10 +0000] ject/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:56:in `perform'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:184:in `block (2 levels) in <class:CLI>'
            25309: |2
                  Cookbook Trace:
                  ---------------
                  /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                  Resource Declaration:
            25346: |2

              Running handlers:
              [2016-07-21T04:11:12+00:00] ERROR: Running exception handlers
              Running handlers complete
              [2016-07-21T04:11:12+00:00] ERROR: Exception handlers complete
              Chef Client failed. 0 resources updated in 30 seconds
              WINDOWS-SERVICE::VERIFY::[2016-07-21 04:11:12 +0000] [2016-07-21T04:11:12+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/failed-audit-data.json
              WINDOWS-SERVICE::VERIFY::[2016-07-21 04:11:12 +0000] [2016-07-21T04:11:12+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/chef-stacktrace.out
              WINDOWS-SERVICE::VERIFY::[2016-07-21 04:11:12 +0000] [2016-07-21T04:11:12+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
              [2016-07-21T04:11:12+00:00] ERROR: Found 1 errors, they are stored in the backtrace
              WINDOWS-SERVICE::VERIFY::[2016-07-21 04:11:13 +0000] [2016-07-21T04:11:13+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
              CHEF-ACCEPTANCE::[2016-07-21 04:11:14 +0000] Encountered an error running the recipe verify: Expected process to exit with [0], but received '1'
              ---- Begin output of chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/dna.json -o acceptance-cookbook::verify --no-color ----
            25374: |2
                  * ruby_block[copy_kitchen_logs_to_data_path] action run

                    ================================================================================
                    Error executing action `run` on resource 'ruby_block[copy_kitchen_logs_to_data_path]'
                    ================================================================================

                    Mixlib::ShellOut::ShellCommandFailed
                    ------------------------------------
                    Expected process to exit with [0], but received '20'
                    ---- Begin output of bundle exec kitchen verify  -c -l debug ----
                    STDOUT: -----> Starting Kitchen (v1.10.2)
                    D      winrm requested, loading winrm gem (["~> 2.0"])
                    D      winrm is loaded.
                    D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                    D      winrm-fs is loaded.
                    -----> Setting up <chef-windows-service-windows-2012r2>...
                           Finished setting up <chef-windows-service-windows-2012r2> (0m0.00s).
                    -----> Verifying <chef-windows-service-windows-2012r2>...
                    D      Initialize InSpec
                           Detected alternative framework tests for `inspec`
                           Use `/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/windows-service/test/integration/chef-windows-service/inspec` for testing
                    D      Running tests from: ["/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/windows-service/test/integration/chef-windows-service/inspec"]

                    Target:  winrm://administrator@http://10.194.12.130:5985/wsman:3389

                    \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager should exist\33[0m
                    \33[32m  \357\277\275\357\277\275\357\277\275  Service chef-client should not be enabled\33[0m
                    \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a install exit_status should eq 0\33[0m
                    \33[31m  \357\277\275\357\277\275\357\277\275  Service chef-client should be enabledexpected that `Service chef-client` is enabled\33[0m
                    \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a start exit_status should eq 0\33[0m
                    \33[31m  \357\277\275\357\277\275\357\277\275  Service chef-client should be enabledexpected that `Service chef-client` is enabled\33[0m
                    \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a stop exit_status should eq 0\33[0m
                    \33[31m  \357\277\275\357\277\275\357\277\275  Service chef-client should be enabledexpected that `Service chef-client` is enabled\33[0m
                    \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a uninstall exit_status should eq 0\33[0m
                    \33[32m  \357\277\275\357\277\275\357\277\275  Service chef-client should not be enabled\33[0m

                    Summary:  14 successful   11 failures    0 skipped
                    D      ------Exception-------
                    D      Class: Kitchen::ActionFailed
                    D      Message: 1 actions failed.
                    >>>>>>     Verify failed on instance <chef-windows-service-windows-2012r2>.  Please see .kitchen/logs/chef-windows-service-windows-2012r2.log for more details
                    D      ----------------------
                    D      ------Backtrace-------
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:187:in `report_errors'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:178:in `run_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:39:in `block in call'
                    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:37:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:56:in `perform'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:184:in `block (2 levels) in <class:CLI>'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/command.rb:27:in `run'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/invocation.rb:126:in `invoke_command'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:325:in `invoke_task'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor.rb:359:in `dispatch'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/base.rb:440:in `start'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `block in <top (required)>'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/errors.rb:174:in `with_friendly_errors'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `<top (required)>'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `load'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `<top (required)>'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `load'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `kernel_load'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:24:in `run'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:304:in `exec'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor.rb:359:in `dispatch'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/base.rb:440:in `start'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:11:in `start'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:27:in `block in <top (required)>'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/friendly_errors.rb:98:in `with_friendly_errors'
                    D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:19:in `<top (required)>'
                    D      /opt/chefdk/embedded/bin/bundle:22:in `load'
                    D      /opt/chefdk/embedded/bin/bundle:22:in `<main>'
                    D      ----End Backtrace-----
                    D      -Composite Exception--
                    D      Class: Kitchen::InstanceFailure
                    D      Message: Verify failed on instance <chef-windows-service-windows-2012r2>.  Please see .kitchen/logs/chef-windows-service-windows-2012r2.log for more details
                    D      ----------------------
                    D      ------Backtrace-------
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/kitchen-inspec-d63240a44667/lib/kitchen/verifier/inspec.rb:52:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:423:in `block in verify_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:415:in `verify_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:160:in `verify'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                    D      ----End Backtrace-----
                    D      ---Nested Exception---
                    D      Class: Kitchen::ActionFailed
                    D      Message: Inspec Runner returns 1
                    D      ----------------------
                    D      ------Backtrace-------
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/kitchen-inspec-d63240a44667/lib/kitchen/verifier/inspec.rb:52:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:423:in `block in verify_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                    D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:415:in `verify_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:160:in `verify'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                    D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                    D      ----End Backtrace-----
                    STDERR: >>>>>> ------Exception-------
                    >>>>>> Class: Kitchen::ActionFailed
                    >>>>>> Message: 1 actions failed.
                    >>>>>>     Verify failed on instance <chef-windows-service-windows-2012r2>.  Please see .kitchen/logs/chef-windows-service-windows-2012r2.log for more details
                    >>>>>> ----------------------
                    >>>>>> Please see .kitchen/logs/kitchen.log for more details
                    >>>>>> Also try running `kitchen diagnose --all` for configuration
                    ---- End output of bundle exec kitchen verify  -c -l debug ----
                    Ran bundle exec kitchen verify  -c -l debug returned 20

                    Cookbook Trace:
                    ---------------
                    /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                    Resource Declaration:
                    ---------------------
                    # In /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb

                     39:       ruby_block "copy_kitchen_logs_to_data_path" do
                     40:         block do
                     41:           cmd_env = {
                     42:             "KITCHEN_DRIVER" => driver,
                     43:             "KITCHEN_INSTANCES" => instances,
                     44:             "KITCHEN_LOCAL_YAML" => ::File.expand_path("../../.kitchen.#{driver}.yml", __FILE__),
                     45:             "KITCHEN_CHEF_PRODUCT" => chef_product,
                     46:             "KITCHEN_CHEF_CHANNEL" => chef_channel,
                     47:             "KITCHEN_CHEF_VERSION" => chef_version,
                     48:             "ARTIFACTORY_USERNAME" => artifactory_username,
                     49:             "ARTIFACTORY_PASSWORD" => artifactory_password
                     50:           }.merge(new_resource.env)
                     51:           suite = kitchen_dir.split("/").last
                     52:           kitchen_log_path = ENV["WORKSPACE"] ? "#{ENV["WORKSPACE"]}/chef-acceptance-data/logs" : "#{kitchen_dir}/../.acceptance_data/logs/"
                     53:
                     54:           begin
                     55:             shell_out!("bundle exec kitchen #{command}#{instances ? " #{instances}" : ""}#{kitchen_options ? " #{kitchen_options}" : ""}",
                     56:                        env: cmd_env,
                     57:                        cwd: kitchen_dir)
                     58:           ensure
                     59:             FileUtils.mkdir_p("#{kitchen_log_path}/#{suite}/#{command}")
                     60:             FileUtils.cp_r("#{kitchen_dir}/.kitchen/logs/.", "#{kitchen_log_path}/#{suite}/#{command}")
                     61:           end
                     62:         end
                     63:       end

                    Compiled Resource:
                    ------------------
                    # Declared in /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:39:in `block in <class:Kitchen>'

                    ruby_block("copy_kitchen_logs_to_data_path") do
                      action [:run]
                      retries 0
                      retry_delay 2
                      default_guard_interpreter :default
                      block_name "copy_kitchen_logs_to_data_path"
                      declared_type :ruby_block
                      cookbook_name "acceptance-cookbook"
                      block #<Proc:0x00000003c94868@/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:40>
                    end

                    Platform:
                    ---------
                    x86_64-linux


                  ================================================================================
                  Error executing action `run` on resource 'kitchen[verify]'
                  ================================================================================

                  Mixlib::ShellOut::ShellCommandFailed
                  ------------------------------------
                  ruby_block[copy_kitchen_logs_to_data_path] (/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb line 39) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '20'
                  ---- Begin output of bundle exec kitchen verify  -c -l debug ----
                  STDOUT: -----> Starting Kitchen (v1.10.2)
                  D      winrm requested, loading winrm gem (["~> 2.0"])
                  D      winrm is loaded.
                  D      winrm-fs requested, loading winrm-fs gem (["~> 1.0"])
                  D      winrm-fs is loaded.
                  -----> Setting up <chef-windows-service-windows-2012r2>...
                         Finished setting up <chef-windows-service-windows-2012r2> (0m0.00s).
                  -----> Verifying <chef-windows-service-windows-2012r2>...
                  D      Initialize InSpec
                         Detected alternative framework tests for `inspec`
                         Use `/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/windows-service/test/integration/chef-windows-service/inspec` for testing
                  D      Running tests from: ["/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/windows-service/test/integration/chef-windows-service/inspec"]

                  Target:  winrm://administrator@http://10.194.12.130:5985/wsman:3389

                  \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager should exist\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Service chef-client should not be enabled\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a install exit_status should eq 0\33[0m
                  \33[31m  \357\277\275\357\277\275\357\277\275  Service chef-client should be enabledexpected that `Service chef-client` is enabled\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a start exit_status should eq 0\33[0m
                  \33[31m  \357\277\275\357\277\275\357\277\275  Service chef-client should be enabledexpected that `Service chef-client` is enabled\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a stop exit_status should eq 0\33[0m
                  \33[31m  \357\277\275\357\277\275\357\277\275  Service chef-client should be enabledexpected that `Service chef-client` is enabled\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Command chef-service-manager -a uninstall exit_status should eq 0\33[0m
                  \33[32m  \357\277\275\357\277\275\357\277\275  Service chef-client should not be enabled\33[0m

                  Summary:  14 successful   11 failures    0 skipped
                  D      ------Exception-------
                  D      Class: Kitchen::ActionFailed
                  D      Message: 1 actions failed.
                  >>>>>>     Verify failed on instance <chef-windows-service-windows-2012r2>.  Please see .kitchen/logs/chef-windows-service-windows-2012r2.log for more details
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:187:in `report_errors'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:178:in `run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:39:in `block in call'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command/action.rb:37:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:56:in `perform'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:184:in `block (2 levels) in <class:CLI>'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/command.rb:27:in `run'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/invocation.rb:126:in `invoke_command'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/cli.rb:325:in `invoke_task'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor.rb:359:in `dispatch'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/thor-0.19.1/lib/thor/base.rb:440:in `start'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `block in <top (required)>'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/errors.rb:174:in `with_friendly_errors'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/bin/kitchen:13:in `<top (required)>'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `load'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bin/kitchen:22:in `<top (required)>'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `load'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:63:in `kernel_load'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli/exec.rb:24:in `run'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:304:in `exec'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor.rb:359:in `dispatch'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/vendor/thor/lib/thor/base.rb:440:in `start'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/cli.rb:11:in `start'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:27:in `block in <top (required)>'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler/friendly_errors.rb:98:in `with_friendly_errors'
                  D      /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/exe/bundle:19:in `<top (required)>'
                  D      /opt/chefdk/embedded/bin/bundle:22:in `load'
                  D      /opt/chefdk/embedded/bin/bundle:22:in `<main>'
                  D      ----End Backtrace-----
                  D      -Composite Exception--
                  D      Class: Kitchen::InstanceFailure
                  D      Message: Verify failed on instance <chef-windows-service-windows-2012r2>.  Please see .kitchen/logs/chef-windows-service-windows-2012r2.log for more details
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/kitchen-inspec-d63240a44667/lib/kitchen/verifier/inspec.rb:52:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:423:in `block in verify_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:415:in `verify_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:160:in `verify'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                  D      ----End Backtrace-----
                  D      ---Nested Exception---
                  D      Class: Kitchen::ActionFailed
                  D      Message: Inspec Runner returns 1
                  D      ----------------------
                  D      ------Backtrace-------
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/kitchen-inspec-d63240a44667/lib/kitchen/verifier/inspec.rb:52:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:423:in `block in verify_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:513:in `synchronize_or_call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:478:in `block in action'
                  D      /opt/chefdk/embedded/lib/ruby/2.1.0/benchmark.rb:279:in `measure'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:477:in `action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:415:in `verify_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:348:in `block in transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `each'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:347:in `transition_to'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/instance.rb:160:in `verify'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `public_send'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:201:in `run_action_in_thread'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/test-kitchen-06d7c0168ed6/lib/kitchen/command.rb:173:in `block (2 levels) in run_action'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `call'
                  D      /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/logging-2.1.0/lib/logging/diagnostic_context.rb:450:in `block in create_with_logging_context'
                  D      ----End Backtrace-----
                  STDERR: >>>>>> ------Exception-------
                  >>>>>> Class: Kitchen::ActionFailed
                  >>>>>> Message: 1 actions failed.
                  >>>>>>     Verify failed on instance <chef-windows-service-windows-2012r2>.  Please see .kitchen/logs/chef-windows-service-windows-2012r2.log for more details
                  >>>>>> ----------------------
                  >>>>>> Please see .kitchen/logs/kitchen.log for more details
                  >>>>>> Also try running `kitchen diagnose --all` for configuration
                  ---- End output of bundle exec kitchen verify  -c -l debug ----
                  Ran bundle exec kitchen verify  -c -l debug returned 20

                  Cookbook Trace:
                  ---------------
                  /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/cookbooks/kitchen_acceptance/libraries/kitchen.rb:55:in `block (3 levels) in <class:Kitchen>'

                  Resource Declaration:
                  ---------------------
                  # In /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/cookbooks/acceptance-cookbook/recipes/verify.rb

                    1: kitchen "verify"

                  Compiled Resource:
                  ------------------
                  # Declared in /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/cookbooks/acceptance-cookbook/recipes/verify.rb:1:in `from_file'

                  kitchen("verify") do
                    action [:run]
                    retries 0
                    retry_delay 2
                    default_guard_interpreter :default
                    declared_type :kitchen
                    cookbook_name "acceptance-cookbook"
                    recipe_name "verify"
                    chef_product "chef"
                    kitchen_dir "/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/windows-service"
                    command "verify"
                    kitchen_options "-c -l debug"
                  end

                  Platform:
                  ---------
                  x86_64-linux

              Starting audit phase
            25725: |2

              Running handlers:
              [2016-07-21T04:11:12+00:00] ERROR: Running exception handlers
              Running handlers complete
              [2016-07-21T04:11:12+00:00] ERROR: Exception handlers complete
              Chef Client failed. 0 resources updated in 30 seconds
              [2016-07-21T04:11:12+00:00] ERROR: Failed to post audit report to server. Saving report to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/failed-audit-data.json
              [2016-07-21T04:11:12+00:00] FATAL: Stacktrace dumped to /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/cache/chef-stacktrace.out
              [2016-07-21T04:11:12+00:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report
              [2016-07-21T04:11:12+00:00] ERROR: Found 1 errors, they are stored in the backtrace
              [2016-07-21T04:11:13+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
              STDERR:
              ---- End output of chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/dna.json -o acceptance-cookbook::verify --no-color ----
              Ran chef-client -z -c /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/.chef/config.rb --force-formatter -j /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/chef/windows-service/verify/dna.json -o acceptance-cookbook::verify --no-color returned 1
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:289:in `invalid!'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/gems/mixlib-shellout-2.2.6/lib/mixlib/shellout.rb:276:in `error!'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:53:in `block in run!'
              /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `block in with_clean_env'
              /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:447:in `with_env'
              /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/bundler-1.12.5/lib/bundler.rb:237:in `with_clean_env'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/chef_runner.rb:42:in `run!'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:149:in `run_command'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:116:in `block in run_suite'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `each'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:114:in `run_suite'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:76:in `block (2 levels) in start_worker'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `loop'
              /home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/acceptance/vendor/bundle/ruby/2.1.0/bundler/gems/chef-acceptance-e92ddae46d21/lib/chef-acceptance/application.rb:74:in `block in start_worker'
              CHEF-ACCEPTANCE::[2016-07-21 04:11:14 +0000] --force-destroy specified so attempting to run the destroy recipe
              WINDOWS-SERVICE::DESTROY::[2016-07-21 04:11:14 +0000] Initialized [/home/jenkins/workspace/chef-test/architecture/x86_64/platform/acceptance/project/chef/role/tester/chef-acceptance-data/logs/windows-service/destroy.log] logger...
            26431: |
              CHEF-ACCEPTANCE::[2016-07-21 04:48:48 +0000] | top-cookbooks   | Total         | 00:43:40 | N     |
              CHEF-ACCEPTANCE::[2016-07-21 04:48:48 +0000] | Run             | Total         | 00:43:40 | Y     |
              Build step 'Invoke XShell command' marked build as failure
              Archiving artifacts
              Recording fingerprints
        steps:
          total: 46m3s
          before (setup time): 2m23s
          CHEF-ACCEPTANCE:
            total: 43m41s
            OMNITRUCK::PROVISION: 17s
            TRIVIAL::PROVISION: 2m50s
            TOP-COOKBOOKS::PROVISION: 42m7s
            OMNITRUCK::VERIFY: 19s
            WINDOWS-SERVICE::PROVISION: 4m47s
            TRIVIAL::DESTROY: 11s
            FIPS::PROVISION: 2m36s
            WINDOWS-SERVICE::VERIFY: 37s
            FIPS::DESTROY: 17s
            BASICS::PROVISION: 1m11s
            WINDOWS-SERVICE::DESTROY: 17s
            DATA-COLLECTOR::PROVISION: 1m9s
            BASICS::VERIFY: 25s
            BASICS::DESTROY: 19s
            DATA-COLLECTOR::VERIFY: 50s
            DATA-COLLECTOR::DESTROY: 9m48s
            TOP-COOKBOOKS::VERIFY: 47s
            TOP-COOKBOOKS::DESTROY: 47s
        chef_acceptance_timing:
        - omnitruck:
            provision: 9s
            verify: 13s
            destroy: 4s
            Total: 42s
          trivial:
            provision: 2m22s
            force-destroy: 7s
            Total: 3m1s
          windows-service:
            provision: 4m18s
            verify: 23s
            force-destroy: 11s
            Total: 5m41s
          fips:
            provision: 2m20s
            force-destroy: 11s
            Total: 2m53s
          basics:
            provision: 54s
            verify: 21s
            destroy: 11s
            Total: 1m55s
          data-collector:
            provision: 58s
            verify: 40s
            destroy: 7s
            Total: 2m9s
          top-cookbooks:
            provision: 38m47s
            verify: 33s
            destroy: 33s
            Total: 43m40s
          Run:
            Total: 43m40s
      debian-6-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=i386,platform=debian-6,project=chef,role=tester/81/
        duration: 11m3s
      debian-7-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=i386,platform=debian-7,project=chef,role=tester/81/
        duration: 11m15s
      el-5-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=i386,platform=el-5,project=chef,role=tester/81/
        duration: 23m19s
      el-6-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=i386,platform=el-6,project=chef,role=tester/81/
        duration: 31m21s
      freebsd-10-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=i386,platform=freebsd-10,project=chef,role=tester/81/
        duration: 9m30s
      freebsd-9-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=i386,platform=freebsd-9,project=chef,role=tester/81/
        duration: 10m13s
      ubuntu-12.04-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=i386,platform=ubuntu-12.04,project=chef,role=tester/81/
        duration: 11m4s
      ubuntu-14.04-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=i386,platform=ubuntu-14.04,project=chef,role=tester/81/
        duration: 11m2s
      windows-2008r2-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=i386,platform=windows-2008r2,project=chef,role=tester/81/
        duration: 17m29s
      solaris-10-i86pc:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=i86pc,platform=solaris-10,project=chef,role=tester/81/
        duration: 8m14s
      solaris-11-i86pc:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=i86pc,platform=solaris-11,project=chef,role=tester/81/
        duration: 8m37s
      aix-6.1-powerpc:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=powerpc,platform=aix-6.1,project=chef,role=tester/81/
        duration: 22m33s
      aix-7.1-powerpc:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=powerpc,platform=aix-7.1,project=chef,role=tester/81/
        duration: 21m32s
      el-7-ppc64:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=ppc64,platform=el-7,project=chef,role=tester/81/
        duration: 9m57s
      el-7-ppc64le:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=ppc64le,platform=el-7,project=chef,role=tester/81/
        duration: 9m59s
      ubuntu-14.04-ppc64le:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=ppc64le,platform=ubuntu-14.04,project=chef,role=tester/81/
        duration: 7m40s
      solaris-10-sun4v:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=sun4v,platform=solaris-10,project=chef,role=tester/81/
        duration: 1h14m39s
      solaris-11-sun4v:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=sun4v,platform=solaris-11,project=chef,role=tester/81/
        duration: 1h18m37s
      debian-6:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=debian-6,project=chef,role=tester/81/
        duration: 20m12s
      debian-7:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=debian-7,project=chef,role=tester/81/
        duration: 14m37s
      debian-8:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=debian-8,project=chef,role=tester/81/
        duration: 14m39s
      el-5:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=el-5,project=chef,role=tester/81/
        duration: 32m51s
      el-6:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=el-6,project=chef,role=tester/81/
        duration: 50m17s
      el-7:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=el-7,project=chef,role=tester/81/
        duration: 13m28s
      freebsd-10:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=freebsd-10,project=chef,role=tester/81/
        duration: 15m
      freebsd-9:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=freebsd-9,project=chef,role=tester/81/
        duration: 17m8s
      ios_xr-6:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=ios_xr-6,project=chef,role=tester/81/
        duration: 9m8s
      mac_os_x-10.10:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=mac_os_x-10.10,project=chef,role=tester/81/
        duration: 10m46s
      mac_os_x-10.11:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=mac_os_x-10.11,project=chef,role=tester/81/
        duration: 10m11s
      mac_os_x-10.9:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=mac_os_x-10.9,project=chef,role=tester/81/
        duration: 10m47s
      nexus-7:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=nexus-7,project=chef,role=tester/81/
        duration: 11m15s
      ubuntu-12.04:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=ubuntu-12.04,project=chef,role=tester/81/
        duration: 17m2s
      ubuntu-14.04:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=ubuntu-14.04,project=chef,role=tester/81/
        duration: 14m20s
      windows-2008r2:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=windows-2008r2,project=chef,role=tester/81/
        duration: 17m38s
      windows-2012:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=windows-2012,project=chef,role=tester/81/
        duration: 16m44s
      windows-2012r2:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-test/architecture=x86_64,platform=windows-2012r2,project=chef,role=tester/81/
        duration: 18m11s
  chef-build:
    result: SUCCESS
    url: http://manhattan.ci.chef.co/job/chef-build/166/
    duration: 4h46m7s
    active_duration: 33m3s
    retries: 3
    retry_delay: 4h13m4s
    queue_delay: 10s
    runs:
      debian-6-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=i386,platform=debian-6,project=chef,role=builder/166/
        duration: 7m31s
        steps:
          total: 7m31s
          before (setup time): 4m3s
          omnibus:
            total: 3m51s
            fetch:
              PathFetcher:
                chef: 37s
            build:
              total: 3m7s
              GitCache: 1m40s
              Software: 1m40s
              Builder:
                total: 1m27s
                chef: 49s
                chef-appbundle: 29s
              Project:
                chef: 1m27s
              Licensing: 10s
              HealthCheck: 12s
              Packager::DEB: 1m5s
          after (cleanup time): "-23s"
      el-5-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=i386,platform=el-5,project=chef,role=builder/166/
        duration: 19m
        steps:
          total: 19m
          before (setup time): 14m29s
          omnibus:
            total: 4m47s
            fetch:
              PathFetcher:
                chef: 36s
            build:
              total: 4m3s
              GitCache: 1m54s
              Software: 1m54s
              Builder:
                total: 1m40s
                chef: 59s
                chef-appbundle: 31s
              Project:
                chef: 2m9s
              Licensing: 14s
              HealthCheck: 15s
              Packager::RPM: 1m40s
          after (cleanup time): "-16s"
      el-6-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=i386,platform=el-6,project=chef,role=builder/166/
        duration: 7m8s
        steps:
          total: 7m8s
          before (setup time): "-1m43s"
          omnibus:
            total: 4m53s
            fetch:
              PathFetcher:
                chef: 38s
            build:
              total: 4m9s
              GitCache: 2m4s
              Software: 2m5s
              Builder:
                total: 1m46s
                chef: 1m
                chef-appbundle: 33s
              Project:
                chef: 2m5s
              Licensing: 17s
              HealthCheck: 21s
              Packager::RPM: 1m26s
          after (cleanup time): 3m58s
      freebsd-10-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=i386,platform=freebsd-10,project=chef,role=builder/166/
        duration: 6m8s
        steps:
          total: 6m8s
          before (setup time): 1m30s
          omnibus:
            total: 3m54s
            fetch:
              PathFetcher:
                chef: 36s
            build:
              total: 3m12s
              GitCache: 1m52s
              Software: 1m52s
              Builder:
                total: 1m35s
                chef: 51s
                chef-appbundle: 30s
              Project:
                chef: 1m20s
              Licensing: 15s
              Packager::Makeself: 1m4s
          after (cleanup time): 43s
      freebsd-9-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=i386,platform=freebsd-9,project=chef,role=builder/166/
        duration: 7m33s
        steps:
          total: 7m33s
          before (setup time): 7m
          omnibus:
            total: 4m16s
            fetch:
              PathFetcher:
                chef: 38s
            build:
              total: 3m31s
              GitCache: 1m57s
              Software: 1m56s
              Builder:
                total: 1m39s
                chef: 54s
                chef-appbundle: 30s
              Project:
                chef: 1m34s
              Licensing: 14s
              Packager::Makeself: 1m20s
          after (cleanup time): "-3m43s"
      ubuntu-12.04-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=i386,platform=ubuntu-12.04,project=chef,role=builder/166/
        duration: 19m23s
        steps:
          total: 19m23s
          before (setup time): 15m38s
          omnibus:
            total: 4m9s
            fetch:
              PathFetcher:
                chef: 36s
            build:
              total: 3m27s
              GitCache: 1m42s
              Software: 1m42s
              Builder:
                total: 1m28s
                chef: 51s
                chef-appbundle: 29s
              Project:
                chef: 1m45s
              Licensing: 14s
              HealthCheck: 12s
              Packager::DEB: 1m19s
          after (cleanup time): "-24s"
      windows-2008r2-i386:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=i386,platform=windows-2008r2,project=chef,role=builder/166/
        duration: 9m30s
        steps:
          total: 9m30s
          before (setup time): "-4m58s"
          omnibus:
            total: 6m51s
            fetch:
              PathFetcher:
                chef: 32s
            build:
              total: 6m11s
              GitCache:
                chef 2: 10s
              Software: 3m45s
              Builder:
                total: 3m11s
                chef: 1m52s
                chef-appbundle: 39s
                ruby-windows-devkit: 12s
              GitFetcher: 25s
              NetFetcher: 18s
              Project:
                chef: 2m24s
              Licensing: 17s
              Packager::MSI: 2m7s
          after (cleanup time): 7m37s
      solaris-10-i86pc:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=i86pc,platform=solaris-10,project=chef,role=builder/166/
        duration: 7m1s
        steps:
          total: 7m1s
          before (setup time): 4m50s
          omnibus:
            total: 2m11s
            fetch:
              PathFetcher:
                chef: 23s
            build:
              total: 1m44s
              GitCache: 1m22s
              Software: 1m22s
              Builder:
                total: 1m12s
                chef: 36s
                chef-appbundle: 21s
              Project:
                chef: 22s
              Packager::Solaris: 13s
      aix-6.1-powerpc:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=powerpc,platform=aix-6.1,project=chef,role=builder/166/
        duration: 16m32s
        steps:
          total: 16m32s
          before (setup time): 2m15s
          omnibus:
            total: 10m5s
            fetch:
              PathFetcher:
                total: 50s
                chef: 49s
                chef-appbundle: 12s
            build:
              total: 9m5s
              GitCache: 2m28s
              Software: 2m27s
              Builder:
                total: 2m14s
                chef: 1m10s
                chef-appbundle: 49s
              Project:
                chef: 6m37s
              Licensing: 11s
              Packager::BFF: 6m25s
          after (cleanup time): 4m11s
      el-7-ppc64:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=ppc64,platform=el-7,project=chef,role=builder/166/
        duration: 7m42s
        steps:
          total: 7m42s
          before (setup time): 5m9s
          omnibus:
            total: 2m57s
            fetch:
              PathFetcher:
                chef: 18s
            build:
              total: 2m36s
              GitCache: 1m4s
              Software: 1m4s
              Builder:
                total: 53s
                chef: 29s
                chef-appbundle: 19s
              Project:
                chef: 1m32s
              Licensing: 12s
              Packager::RPM: 1m15s
          after (cleanup time): "-24s"
      el-7-ppc64le:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=ppc64le,platform=el-7,project=chef,role=builder/166/
        duration: 8m1s
        steps:
          total: 8m1s
          before (setup time): 5m36s
          omnibus:
            total: 2m48s
            fetch:
              PathFetcher:
                chef: 19s
            build:
              total: 2m24s
              GitCache: 1m1s
              Software: 1m1s
              Builder:
                total: 51s
                chef: 28s
                chef-appbundle: 18s
              Project:
                chef: 1m23s
              Licensing: 12s
              Packager::RPM: 1m6s
          after (cleanup time): "-23s"
      ubuntu-14.04-ppc64le:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=ppc64le,platform=ubuntu-14.04,project=chef,role=builder/166/
        duration: 3m49s
        steps:
          total: 3m49s
          before (setup time): 1m37s
          omnibus:
            total: 2m37s
            fetch:
              PathFetcher:
                chef: 19s
            build:
              total: 2m14s
              GitCache: 58s
              Software: 58s
              Builder:
                total: 51s
                chef: 27s
                chef-appbundle: 19s
              Project:
                chef: 1m16s
              Licensing: 10s
              Packager::DEB: 1m
          after (cleanup time): "-25s"
      solaris-10-sun4v:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=sun4v,platform=solaris-10,project=chef,role=builder/166/
        duration: 32m30s
        steps:
          total: 32m30s
          before (setup time): 6m6s
          omnibus:
            total: 24m39s
            fetch:
              total: 6m29s
              Software:
                total: 20s
                chef: 19s
                config_guess: 18s
                pkg-config-lite: 17s
              PathFetcher:
                total: 6m5s
                chef-appbundle: 1m31s
                chef: 6m3s
            build:
              total: 17m31s
              GitCache:
                gem-permissions: 10s
              Software: 15m22s
              Builder:
                total: 14m23s
                chef: 7m35s
                chef-appbundle: 5m45s
                gem-permissions: 11s
              GitFetcher: 25s
              Project:
                chef: 2m8s
              Licensing: 13s
              Packager::Solaris: 1m55s
          after (cleanup time): 1m44s
      debian-6:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=x86_64,platform=debian-6,project=chef,role=builder/166/
        duration: 8m26s
        steps:
          total: 8m26s
          before (setup time): 2m42s
          omnibus:
            total: 6m6s
            fetch:
              total: 45s
              NullFetcher:
                chef-complete: 10s
                after (cleanup time): "-10s"
              PathFetcher:
                chef: 41s
            build:
              total: 5m16s
              GitCache: 2m36s
              Software: 2m36s
              Builder:
                total: 2m13s
                chef: 1m15s
                chef-appbundle: 44s
              Project:
                chef: 2m40s
              Licensing: 12s
              HealthCheck: 18s
              Packager::DEB: 2m10s
          after (cleanup time): "-22s"
      el-5:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=x86_64,platform=el-5,project=chef,role=builder/166/
        duration: 21m50s
        steps:
          total: 21m50s
          before (setup time): 15m22s
          omnibus:
            total: 6m48s
            fetch:
              total: 47s
              NullFetcher:
                chef-complete: 11s
                after (cleanup time): "-11s"
              PathFetcher:
                chef: 44s
            build:
              total: 5m56s
              GitCache: 2m38s
              Software: 2m37s
              Builder:
                total: 2m15s
                chef: 1m18s
                chef-appbundle: 39s
              Project:
                chef: 3m18s
              Licensing: 13s
              HealthCheck: 21s
              Packager::RPM: 2m44s
          after (cleanup time): "-20s"
      el-6:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=x86_64,platform=el-6,project=chef,role=builder/166/
        duration: 9m32s
        steps:
          total: 9m32s
          before (setup time): 11m57s
          omnibus:
            total: 7m8s
            fetch:
              total: 47s
              NullFetcher:
                chef-complete: 11s
                after (cleanup time): "-11s"
              PathFetcher:
                chef: 44s
            build:
              total: 6m15s
              GitCache: 2m57s
              Software: 2m56s
              Builder:
                total: 2m28s
                chef: 1m22s
                chef-appbundle: 46s
              Project:
                chef: 3m18s
              Licensing: 16s
              HealthCheck: 23s
              Packager::RPM: 2m39s
          after (cleanup time): "-9m33s"
      el-7:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=x86_64,platform=el-7,project=chef,role=builder/166/
        duration: 19m52s
        steps:
          total: 19m52s
          before (setup time): 15m19s
          omnibus:
            total: 4m57s
            fetch:
              PathFetcher:
                chef: 31s
            build:
              total: 4m20s
              GitCache: 1m45s
              Software: 1m44s
              Builder:
                total: 1m30s
                chef: 51s
                chef-appbundle: 32s
              Project:
                chef: 2m35s
              Licensing: 13s
              Packager::RPM: 2m14s
          after (cleanup time): "-24s"
      freebsd-10:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=x86_64,platform=freebsd-10,project=chef,role=builder/166/
        duration: 8m36s
        steps:
          total: 8m36s
          before (setup time): 2m16s
          omnibus:
            total: 6m6s
            fetch:
              PathFetcher:
                total: 52s
                chef: 52s
                chef-appbundle: 11s
            build:
              total: 5m5s
              GitCache: 2m58s
              Software: 2m58s
              Builder:
                total: 2m34s
                chef: 1m29s
                chef-appbundle: 45s
              Project:
                chef: 2m7s
              Licensing: 13s
              Packager::Makeself: 1m54s
          after (cleanup time): 13s
      freebsd-9:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=x86_64,platform=freebsd-9,project=chef,role=builder/166/
        duration: 29m43s
        steps:
          total: 29m43s
          before (setup time): 29m20s
          omnibus:
            total: 7m26s
            fetch:
              PathFetcher:
                chef: 1m3s
            build:
              total: 6m12s
              GitCache: 3m31s
              Software: 3m31s
              Builder:
                total: 3m5s
                chef: 1m47s
                chef-appbundle: 54s
              Project:
                chef: 2m41s
              Licensing: 13s
              Packager::Makeself: 2m28s
          after (cleanup time): "-7m3s"
      ios_xr-6:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=x86_64,platform=ios_xr-6,project=chef,role=builder/166/
        duration: 5m14s
        steps:
          total: 5m14s
          before (setup time): "-10m31s"
          omnibus:
            total: 3m49s
            fetch:
              PathFetcher:
                chef: 23s
            build:
              total: 3m21s
              GitCache: 1m52s
              Software: 1m52s
              Builder:
                total: 1m42s
                chef: 52s
                chef-appbundle: 43s
              Project:
                chef: 1m29s
              Packager::RPM: 1m15s
          after (cleanup time): 11m56s
      mac_os_x-10.9:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=x86_64,platform=mac_os_x-10.9,project=chef,role=builder/166/
        duration: 3m44s
        steps:
          total: 3m44s
          before (setup time): 3m58s
          omnibus:
            total: 2m18s
            fetch:
              PathFetcher:
                chef: 14s
            build:
              total: 2m
              GitCache: 1m8s
              Software: 1m8s
              Builder:
                total: 55s
                chef: 34s
                chef-appbundle: 15s
              Project:
                chef: 52s
              Licensing: 10s
              Packager::PKG: 16s
              Compressor::DMG: 26s
          after (cleanup time): "-2m32s"
      nexus-7:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=x86_64,platform=nexus-7,project=chef,role=builder/166/
        duration: 5m54s
        steps:
          total: 5m54s
          before (setup time): "-12m17s"
          omnibus:
            total: 4m29s
            fetch:
              PathFetcher:
                chef: 22s
            build:
              total: 4m3s
              GitCache: 2m18s
              Software: 2m12s
              Builder:
                total: 2m1s
                chef: 1m36s
                chef-appbundle: 20s
              Project:
                chef: 1m45s
              Packager::RPM: 1m30s
          after (cleanup time): 13m42s
      ubuntu-12.04:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=x86_64,platform=ubuntu-12.04,project=chef,role=builder/166/
        duration: 8m17s
        steps:
          total: 8m17s
          before (setup time): 3m10s
          omnibus:
            total: 5m31s
            fetch:
              total: 46s
              NullFetcher:
                chef-complete: 10s
                after (cleanup time): "-10s"
              PathFetcher:
                chef: 43s
            build:
              total: 4m40s
              GitCache: 2m5s
              Software: 2m4s
              Builder:
                total: 1m53s
                chef: 1m10s
                chef-appbundle: 35s
              Project:
                chef: 2m35s
              Licensing: 13s
              Packager::DEB: 2m13s
          after (cleanup time): "-24s"
      windows-2008r2:
        result: SUCCESS
        url: http://manhattan.ci.chef.co/job/chef-build/architecture=x86_64,platform=windows-2008r2,project=chef,role=builder/166/
        duration: 12m17s
        steps:
          total: 12m17s
          before (setup time): "-4m52s"
          omnibus:
            total: 8m16s
            fetch:
              PathFetcher:
                chef: 27s
            build:
              total: 7m41s
              GitCache:
                total: 3m55s
                chef 2: 12s
                ruby-windows-devkit: 17s
              Software: 3m54s
              Builder:
                total: 3m25s
                chef: 1m48s
                chef-appbundle: 38s
                ruby-windows-devkit: 13s
              GitFetcher: 42s
              NetFetcher: 30s
              Project:
                chef: 3m46s
              Licensing: 16s
              Packager::MSI: 3m30s
          after (cleanup time): 8m53s
  chef-trigger-ad_hoc:
    result: SUCCESS
    url: http://manhattan.ci.chef.co/job/chef-trigger-ad_hoc/74/
    duration: 29s
